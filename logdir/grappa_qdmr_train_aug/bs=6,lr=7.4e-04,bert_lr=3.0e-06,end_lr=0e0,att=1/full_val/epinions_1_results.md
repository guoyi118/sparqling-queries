 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **item** | i_id | + |   | 
 | 2 |   | title |   |   | 
 | 3 | **review** | a_id | + |   | 
 | 4 |   | u_id |   | --> 8 | 
 | 5 |   | i_id |   | --> 1 | 
 | 6 |   | rating |   |   | 
 | 7 |   | rank |   |   | 
 | 8 | **useracct** | u_id | + |   | 
 | 9 |   | name |   |   | 
 | 10 | **trust** | source_u_id |   | --> 8 | 
 | 11 |   | target_u_id |   | --> 8 | 
 | 12 |   | trust |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_1689 | Find the id of the item whose title is "orange". | SELECT i_id FROM item WHERE title  =  "orange" | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​item:​title, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​orange:​col:​item:​title] <br>4. PROJECT[col:​item:​i_id, #3] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​item:​title, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​orange:​col:​item:​title] <br>4. PROJECT[col:​item:​i_id, #3] <br> | + | easy | 
  | SPIDER_train_1691 | Find the number of reviews. | SELECT count(*) FROM review | 1. SELECT[tbl:​review] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​review] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1693 | Find the average and maximum rating of all reviews. | SELECT avg(rating) ,  max(rating) FROM review | 1. SELECT[tbl:​review] <br>2. PROJECT[col:​review:​rating, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[max, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​review] <br>2. PROJECT[col:​review:​rating, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[max, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_1695 | How many different users wrote some reviews? | SELECT count(DISTINCT u_id) FROM review | 1. SELECT[tbl:​review] <br>2. PROJECT[col:​review:​u_id, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​review] <br>2. PROJECT[col:​review:​u_id, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_1696 | How many different items were reviewed by some users? | SELECT count(DISTINCT i_id) FROM review | 1. SELECT[col:​review:​i_id] <br>2. FILTER[#1, tbl:​review] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​review:​i_id] <br>2. COMPARATIVE[#1, #1, tbl:​review] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_1697 | Find the number of items that did not receive any review. | SELECT count(*) FROM item WHERE i_id NOT IN (SELECT i_id FROM review) | 1. SELECT[tbl:​item] <br>2. FILTER[#1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​item] <br>2. COMPARATIVE[#1, #1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_1698 | Find the names of users who did not leave any review. | SELECT name FROM useracct WHERE u_id NOT IN (SELECT u_id FROM review) | 1. SELECT[tbl:​useracct] <br>2. FILTER[#1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​useracct:​name, #3] <br> | 1. SELECT[tbl:​useracct] <br>2. COMPARATIVE[#1, #1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​useracct:​name, #3] <br> | + | hard | 
  | SPIDER_train_1700 | Find the titles of items whose rating is higher than the average review rating of all items. | SELECT T1.title FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id WHERE T2.rating  >  (SELECT avg(rating) FROM review) | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​item:​title, #4] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​item:​title, #4] <br> | - | extra | 
  | SPIDER_train_1701 | Find the titles of items that received any rating below 5. | SELECT T1.title FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id WHERE T2.rating  <  5 | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​5:​col:​review:​rating] <br>4. PROJECT[col:​item:​title, #3] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​5:​col:​review:​rating] <br>4. PROJECT[col:​item:​title, #3] <br> | + | medium | 
  | SPIDER_train_1702 | Find the titles of items that received both a rating higher than 8 and a rating below 5. | SELECT T1.title FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id WHERE T2.rating  >  8 INTERSECT SELECT T1.title FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id WHERE T2.rating  <  5 | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​8:​col:​review:​rating] <br>4. COMPARATIVE[#1, #2, comparative:​<:​5:​col:​review:​rating] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​item:​title, #5] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​8:​col:​review:​rating] <br>4. COMPARATIVE[#1, #2, comparative:​<:​5:​col:​review:​rating] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​item:​title, #5] <br> | + | extra | 
  | SPIDER_train_1703 | Find the names of items whose rank is higher than 3 and whose average rating is above 5. | SELECT T1.title FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id WHERE T2.rank  >  3 INTERSECT SELECT T1.title FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id GROUP BY T2.i_id HAVING avg(T2.rating)  >  5 | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rank, #1] <br>3. PROJECT[col:​review:​rating, #1] <br>4. GROUP[col:​review:​rating, #3, #1] <br>5. COMPARATIVE[#1, #2, comparative:​>:​3:​col:​review:​rank] <br>6. COMPARATIVE[#1, #4, comparative:​>:​5:​col:​review:​rating] <br>7. INTERSECTION[#1, #5, #6] <br>8. PROJECT[col:​item:​title, #7] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rank, #1] <br>3. PROJECT[col:​review:​rating, #1] <br>4. GROUP[sum, #3, #1] <br>5. COMPARATIVE[#1, #2, comparative:​>:​3:​col:​review:​rank] <br>6. COMPARATIVE[#1, #4, comparative:​>:​5:​col:​review:​rating] <br>7. INTERSECTION[#1, #5, #6] <br>8. PROJECT[col:​item:​title, #7] <br> | + | extra | 
  | SPIDER_train_1704 | Find the name of the item with the lowest average rating. | SELECT T1.title FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id GROUP BY T2.i_id ORDER BY avg(T2.rating) LIMIT 1 | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. GROUP[avg, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​item:​title, #4] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rating, #1] <br>3. GROUP[avg, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​item:​title, #4] <br> | + | extra | 
  | SPIDER_train_1705 | List the titles of all items in alphabetic order . | SELECT title FROM item ORDER BY title | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​item:​title, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​item:​title, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_1706 | Find the name of the user who gives the most reviews. | SELECT T1.name FROM useracct AS T1 JOIN review AS T2 ON T1.u_id  =  T2.u_id GROUP BY T2.u_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​useracct] <br>2. SELECT[tbl:​review] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​useracct:​name, #4] <br> | 1. SELECT[tbl:​useracct] <br>2. SELECT[tbl:​review] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​useracct:​name, #4] <br> | + | extra | 
  | SPIDER_train_1708 | Find the name and id of the good with the highest average rank. | SELECT T1.title ,  T1.i_id FROM item AS T1 JOIN review AS T2 ON T1.i_id  =  T2.i_id GROUP BY T2.i_id ORDER BY avg(T2.rank) DESC LIMIT 1 | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rank, #1] <br>3. GROUP[avg, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​item:​title, #4] <br>6. PROJECT[col:​item:​i_id, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​item] <br>2. PROJECT[col:​review:​rank, #1] <br>3. GROUP[avg, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​item:​title, #4] <br>6. PROJECT[col:​item:​i_id, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_1709 | For each user, return the name and the average rating of reviews given by them. | SELECT T1.name ,  avg(T2.rating) FROM useracct AS T1 JOIN review AS T2 ON T1.u_id  =  T2.u_id GROUP BY T2.u_id | 1. SELECT[col:​review:​u_id] <br>2. PROJECT[col:​useracct:​name, #1] <br>3. PROJECT[tbl:​review, #1] <br>4. PROJECT[col:​review:​rating, #3] <br>5. GROUP[avg, #4, #1] <br>6. UNION[#2, #5] <br> | 1. SELECT[col:​review:​u_id] <br>2. PROJECT[col:​useracct:​name, #1] <br>3. PROJECT[tbl:​review, #1] <br>4. PROJECT[col:​review:​rating, #3] <br>5. GROUP[avg, #4, #1] <br>6. UNION[#2, #5] <br> | + | medium | 
  | SPIDER_train_1710 | For each user, find their name and the number of reviews written by them. | SELECT T1.name ,  count(*) FROM useracct AS T1 JOIN review AS T2 ON T1.u_id  =  T2.u_id GROUP BY T2.u_id | 1. SELECT[col:​review:​u_id] <br>2. PROJECT[col:​useracct:​name, #1] <br>3. PROJECT[tbl:​review, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​review:​u_id] <br>2. PROJECT[col:​useracct:​name, #1] <br>3. PROJECT[tbl:​review, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1711 | Find the name of the user who gave the highest rating. | SELECT T1.name FROM useracct AS T1 JOIN review AS T2 ON T1.u_id  =  T2.u_id ORDER BY T2.rating DESC LIMIT 1 | 1. SELECT[tbl:​useracct] <br>2. PROJECT[col:​review:​rating, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​useracct:​name, #3] <br> | 1. SELECT[tbl:​useracct] <br>2. PROJECT[col:​review:​rating, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​useracct:​name, #3] <br> | + | hard | 
  | SPIDER_train_1714 | Find the name of the target user with the lowest trust score. | SELECT T1.name FROM useracct AS T1 JOIN trust AS T2 ON T1.u_id  =  T2.target_u_id ORDER BY trust LIMIT 1 | 1. SELECT[tbl:​useracct] <br>2. PROJECT[col:​trust:​trust, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​useracct:​name, #3] <br> | 1. SELECT[tbl:​useracct] <br>2. PROJECT[col:​trust:​trust, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​useracct:​name, #3] <br> | + | hard | 
  | SPIDER_train_1715 | Find the names of the items that did not receive any review. | SELECT title FROM item WHERE i_id NOT IN (SELECT i_id FROM review) | 1. SELECT[tbl:​item] <br>2. FILTER[#1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​item:​title, #3] <br> | 1. SELECT[tbl:​item] <br>2. COMPARATIVE[#1, #1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​item:​title, #3] <br> | + | hard | 
  | SPIDER_train_1718 | Find the number of items without any review. | SELECT count(*) FROM item WHERE i_id NOT IN (SELECT i_id FROM review) | 1. SELECT[tbl:​item] <br>2. FILTER[#1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​item] <br>2. COMPARATIVE[#1, #1, tbl:​review] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
 ***
 Exec acc: **0.9524**
