 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **manufacturer** | Manufacturer_ID | + |   | 
 | 2 |   | Open_Year |   |   | 
 | 3 |   | Name |   |   | 
 | 4 |   | Num_of_Factories |   |   | 
 | 5 |   | Num_of_Shops |   |   | 
 | 6 | **furniture** | Furniture_ID | + |   | 
 | 7 |   | Name |   |   | 
 | 8 |   | Num_of_Component |   |   | 
 | 9 |   | Market_Rate |   |   | 
 | 10 | **furniture_manufacte** | Manufacturer_ID | + | --> 1 | 
 | 11 |   | Furniture_ID |   | --> 6 | 
 | 12 |   | Price_in_Dollar |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3392 | Find the component amounts and names of all furnitures that have more than 10 components. | SELECT Num_of_Component ,  name FROM furniture WHERE Num_of_Component  >  10 | 1. SELECT[tbl:​furniture] <br>2. FILTER[#1, comparative:​>:​10:​col:​furniture:​Num_of_Component] <br>3. PROJECT[col:​furniture:​Num_of_Component, #2] <br>4. PROJECT[col:​furniture:​Name, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​furniture] <br>2. COMPARATIVE[#1, #1, comparative:​>:​10:​col:​furniture:​Num_of_Component] <br>3. PROJECT[col:​furniture:​Num_of_Component, #2] <br>4. PROJECT[col:​furniture:​Name, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3394 | Find the names of furnitures whose prices are lower than the highest price. | SELECT t1.name FROM furniture AS t1 JOIN furniture_manufacte AS t2 ON t1.Furniture_ID  =  t2.Furniture_ID WHERE t2.Price_in_Dollar  <  (SELECT max(Price_in_Dollar) FROM furniture_manufacte) | 1. SELECT[tbl:​furniture] <br>2. PROJECT[col:​furniture_manufacte:​Price_in_Dollar, #1] <br>3. AGGREGATE[max, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5. PROJECT[col:​furniture:​Name, #4] <br> | 1. SELECT[tbl:​furniture] <br>2. PROJECT[col:​furniture_manufacte:​Price_in_Dollar, #1] <br>3. AGGREGATE[max, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​furniture:​Name, #4] <br> | - | extra | 
  | SPIDER_train_3395 | Which manufacturer has the most number of shops? List its name and year of opening. | SELECT open_year ,  name FROM manufacturer ORDER BY num_of_shops DESC LIMIT 1 | 1. SELECT[tbl:​manufacturer] <br>2. PROJECT[col:​manufacturer:​Num_of_Shops, #1] <br>3. GROUP[col:​manufacturer:​Num_of_Shops, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​manufacturer:​Open_Year, #4] <br>6. PROJECT[col:​manufacturer:​Name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​manufacturer] <br>2. PROJECT[col:​manufacturer:​Num_of_Shops, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​manufacturer:​Open_Year, #4] <br>6. PROJECT[col:​manufacturer:​Name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_3396 | Find the average number of factories for the manufacturers that have more than 20 shops. | SELECT avg(Num_of_Factories) FROM manufacturer WHERE num_of_shops  >  20 | 1. SELECT[tbl:​manufacturer] <br>2. FILTER[#1, comparative:​>:​20:​col:​manufacturer:​Num_of_Shops] <br>3. PROJECT[col:​manufacturer:​Num_of_Factories, #2] <br>4. GROUP[col:​manufacturer:​Num_of_Factories, #3, #2] <br>5. AGGREGATE[avg, #4] <br> | 1. SELECT[tbl:​manufacturer] <br>2. COMPARATIVE[#1, #1, comparative:​>:​20:​col:​manufacturer:​Num_of_Shops] <br>3. PROJECT[col:​manufacturer:​Num_of_Factories, #2] <br>4. GROUP[sum, #3, #2] <br>5. AGGREGATE[avg, #4] <br> | + | easy | 
  | SPIDER_train_3397 | List all manufacturer names and ids ordered by their opening year. | SELECT name ,  manufacturer_id FROM manufacturer ORDER BY open_year | 1. SELECT[tbl:​manufacturer] <br>2. PROJECT[col:​manufacturer:​Name, #1] <br>3. PROJECT[col:​manufacturer:​Manufacturer_ID, #1] <br>4. PROJECT[col:​manufacturer:​Open_Year, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4] <br> | 1. SELECT[tbl:​manufacturer] <br>2. PROJECT[col:​manufacturer:​Name, #1] <br>3. PROJECT[col:​manufacturer:​Manufacturer_ID, #1] <br>4. PROJECT[col:​manufacturer:​Open_Year, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3399 | what is the average number of factories and maximum number of shops for manufacturers that opened before 1990. | SELECT max(num_of_shops) ,  avg(Num_of_Factories) FROM manufacturer WHERE open_year  <  1990 | 1. SELECT[tbl:​manufacturer] <br>2. FILTER[#1, comparative:​<:​1990:​col:​manufacturer:​Open_Year] <br>3. PROJECT[col:​manufacturer:​Num_of_Factories, #2] <br>4. GROUP[col:​manufacturer:​Num_of_Shops, #3, #2] <br>5. AGGREGATE[avg, #4] <br>6. PROJECT[col:​manufacturer:​Num_of_Shops, #2] <br>7. GROUP[col:​manufacturer:​Num_of_Factories, #6, #2] <br>8. AGGREGATE[max, #7] <br>9. UNION[#5, #8] <br> | 1. SELECT[tbl:​manufacturer] <br>2. COMPARATIVE[#1, #1, comparative:​<:​1990:​col:​manufacturer:​Open_Year] <br>3. PROJECT[col:​manufacturer:​Num_of_Factories, #2] <br>4. GROUP[sum, #3, #2] <br>5. AGGREGATE[avg, #4] <br>6. PROJECT[col:​manufacturer:​Num_of_Shops, #2] <br>7. GROUP[sum, #6, #2] <br>8. AGGREGATE[max, #7] <br>9. UNION[#5, #8] <br> | - | medium | 
  | SPIDER_train_3400 | Find the id and number of shops for the company that produces the most expensive furniture. | SELECT t1.manufacturer_id ,  t1.num_of_shops FROM manufacturer AS t1 JOIN furniture_manufacte AS t2 ON t1.manufacturer_id  =  t2.manufacturer_id ORDER BY t2.Price_in_Dollar DESC LIMIT 1 | 1. SELECT[tbl:​furniture_manufacte] <br>2. PROJECT[col:​furniture_manufacte:​Price_in_Dollar, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​manufacturer:​Num_of_Shops, #3] <br>5. PROJECT[col:​manufacturer:​Manufacturer_ID, #4] <br>6. PROJECT[col:​manufacturer:​Num_of_Shops, #4] <br>7. AGGREGATE[col:​manufacturer:​Num_of_Shops, #6] <br>8. UNION[#5, #7] <br> | 1. SELECT[tbl:​furniture_manufacte] <br>2. PROJECT[col:​furniture_manufacte:​Price_in_Dollar, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​manufacturer:​Num_of_Shops, #3] <br>5. PROJECT[col:​manufacturer:​Manufacturer_ID, #4] <br>6. PROJECT[col:​manufacturer:​Num_of_Shops, #4] <br>7. AGGREGATE[sum, #6] <br>8. UNION[#5, #7] <br> | + | hard | 
  | SPIDER_train_3401 | Find the number of funiture types produced by each manufacturer as well as the company names. | SELECT count(*) ,  t1.name FROM manufacturer AS t1 JOIN furniture_manufacte AS t2 ON t1.manufacturer_id  =  t2.manufacturer_id GROUP BY t1.manufacturer_id | 1. SELECT[col:​manufacturer:​Manufacturer_ID] <br>2. PROJECT[tbl:​furniture_manufacte, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​manufacturer:​Name, #1] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​manufacturer:​Manufacturer_ID] <br>2. PROJECT[tbl:​furniture_manufacte, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​manufacturer:​Name, #1] <br>5. UNION[#3, #4] <br> | + | medium | 
 ***
 Exec acc: **0.7500**
