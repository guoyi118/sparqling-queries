 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Addresses** | address_id | + |   | 
 | 2 |   | address_details |   |   | 
 | 3 | **Staff** | staff_id | + |   | 
 | 4 |   | staff_gender |   |   | 
 | 5 |   | staff_name |   |   | 
 | 6 | **Suppliers** | supplier_id | + |   | 
 | 7 |   | supplier_name |   |   | 
 | 8 |   | supplier_phone |   |   | 
 | 9 | **Department_Store_Chain** | dept_store_chain_id | + |   | 
 | 10 |   | dept_store_chain_name |   |   | 
 | 11 | **Customers** | customer_id | + |   | 
 | 12 |   | payment_method_code |   |   | 
 | 13 |   | customer_code |   |   | 
 | 14 |   | customer_name |   |   | 
 | 15 |   | customer_address |   |   | 
 | 16 |   | customer_phone |   |   | 
 | 17 |   | customer_email |   |   | 
 | 18 | **Products** | product_id | + |   | 
 | 19 |   | product_type_code |   |   | 
 | 20 |   | product_name |   |   | 
 | 21 |   | product_price |   |   | 
 | 22 | **Supplier_Addresses** | supplier_id | + | --> 6 | 
 | 23 |   | address_id |   | --> 1 | 
 | 24 |   | date_from |   |   | 
 | 25 |   | date_to |   |   | 
 | 26 | **Customer_Addresses** | customer_id | + | --> 11 | 
 | 27 |   | address_id |   | --> 1 | 
 | 28 |   | date_from |   |   | 
 | 29 |   | date_to |   |   | 
 | 30 | **Customer_Orders** | order_id | + |   | 
 | 31 |   | customer_id |   | --> 11 | 
 | 32 |   | order_status_code |   |   | 
 | 33 |   | order_date |   |   | 
 | 34 | **Department_Stores** | dept_store_id | + |   | 
 | 35 |   | dept_store_chain_id |   | --> 9 | 
 | 36 |   | store_name |   |   | 
 | 37 |   | store_address |   |   | 
 | 38 |   | store_phone |   |   | 
 | 39 |   | store_email |   |   | 
 | 40 | **Departments** | department_id | + |   | 
 | 41 |   | dept_store_id |   | --> 34 | 
 | 42 |   | department_name |   |   | 
 | 43 | **Order_Items** | order_item_id | + |   | 
 | 44 |   | order_id |   | --> 30 | 
 | 45 |   | product_id |   | --> 18 | 
 | 46 | **Product_Suppliers** | product_id | + | --> 18 | 
 | 47 |   | supplier_id |   | --> 6 | 
 | 48 |   | date_supplied_from |   |   | 
 | 49 |   | date_supplied_to |   |   | 
 | 50 |   | total_amount_purchased |   |   | 
 | 51 |   | total_value_purchased |   |   | 
 | 52 | **Staff_Department_Assignments** | staff_id | + | --> 3 | 
 | 53 |   | department_id |   | --> 40 | 
 | 54 |   | date_assigned_from |   |   | 
 | 55 |   | job_title_code |   |   | 
 | 56 |   | date_assigned_to |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_4711 | What are the product id and product type of the cheapest product? | SELECT product_id ,  product_type_code FROM products ORDER BY product_price LIMIT 1 | 1. SELECT[col:​Products:​product_price] <br>2. FILTER[#1, comparative:​min:​None] <br>3. PROJECT[col:​Products:​product_id, #2] <br>4. PROJECT[col:​Products:​product_type_code, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​Products:​product_price] <br>2. SUPERLATIVE[comparative:​min:​None, #1, #1] <br>3. PROJECT[col:​Products:​product_id, #2] <br>4. PROJECT[col:​Products:​product_type_code, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_4712 | Give the id and product type of the product with the lowest price. | SELECT product_id ,  product_type_code FROM products ORDER BY product_price LIMIT 1 | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​Products:​product_id, #3] <br>5. PROJECT[col:​Products:​product_type_code, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​Products:​product_id, #3] <br>5. PROJECT[col:​Products:​product_type_code, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4715 | Return the address of customer 10. | SELECT T1.address_details FROM addresses AS T1 JOIN customer_addresses AS T2 ON T1.address_id  =  T2.address_id WHERE T2.customer_id  =  10 | 1. SELECT[val:​Customer_Addresses:​customer_id:​10] <br>2. PROJECT[col:​Addresses:​address_details, #1] <br> | 1. SELECT[val:​Staff_Department_Assignments:​staff_id:​10] <br>2. PROJECT[col:​Addresses:​address_details, #1] <br> | - | medium | 
  | SPIDER_train_4716 | What is the address for the customer with id 10? | SELECT T1.address_details FROM addresses AS T1 JOIN customer_addresses AS T2 ON T1.address_id  =  T2.address_id WHERE T2.customer_id  =  10 | 1. SELECT[tbl:​Customer_Addresses] <br>2. PROJECT[col:​Customer_Addresses:​customer_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​10:​col:​Customer_Addresses:​customer_id] <br>4. PROJECT[col:​Addresses:​address_details, #3] <br> | 1. SELECT[tbl:​Customer_Addresses] <br>2. PROJECT[col:​Customer_Addresses:​customer_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​10:​col:​Customer_Addresses:​customer_id] <br>4. PROJECT[col:​Addresses:​address_details, #3] <br> | + | medium | 
  | SPIDER_train_4717 | What are the staff ids and genders of all staffs whose job title is Department Manager? | SELECT T1.staff_id ,  T1.staff_gender FROM staff AS T1 JOIN staff_department_assignments AS T2 ON T1.staff_id  =  T2.staff_id WHERE T2.job_title_code  =  "Department Manager" | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Department Manager:​col:​Staff_Department_Assignments:​job_title_code] <br>4. PROJECT[col:​Staff:​staff_id, #3] <br>5. PROJECT[col:​Staff:​staff_gender, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Department Manager:​col:​Staff_Department_Assignments:​job_title_code] <br>4. PROJECT[col:​Staff:​staff_id, #3] <br>5. PROJECT[col:​Staff:​staff_gender, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4718 | Return the staff ids and genders for any staff with the title Department Manager. | SELECT T1.staff_id ,  T1.staff_gender FROM staff AS T1 JOIN staff_department_assignments AS T2 ON T1.staff_id  =  T2.staff_id WHERE T2.job_title_code  =  "Department Manager" | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Department Manager:​col:​Staff_Department_Assignments:​job_title_code] <br>4. PROJECT[col:​Staff:​staff_id, #3] <br>5. PROJECT[col:​Staff:​staff_gender, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Department Manager:​col:​Staff_Department_Assignments:​job_title_code] <br>4. PROJECT[col:​Staff:​staff_id, #3] <br>5. PROJECT[col:​Staff:​staff_gender, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4719 | For each payment method, return how many customers use it. | SELECT payment_method_code ,  count(*) FROM customers GROUP BY payment_method_code | 1. SELECT[col:​Customers:​payment_method_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customers:​payment_method_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_4720 | How many customers use each payment method? | SELECT payment_method_code ,  count(*) FROM customers GROUP BY payment_method_code | 1. SELECT[col:​Customers:​payment_method_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customers:​payment_method_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_4721 | What is the id of the product that was ordered the most often? | SELECT product_id FROM order_items GROUP BY product_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Order_Items:​product_id] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br>5. PROJECT[col:​Order_Items:​product_id, #4] <br> | 1. SELECT[col:​Order_Items:​product_id] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Order_Items:​product_id, #4] <br> | + | hard | 
  | SPIDER_train_4725 | What is the average price for each type of product? | SELECT product_type_code ,  avg(product_price) FROM products GROUP BY product_type_code | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[tbl:​Products, #1] <br>3. PROJECT[col:​Products:​product_price, #2] <br>4. GROUP[avg, #3, #1] <br>5. UNION[#1, #4] <br> | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[tbl:​Products, #1] <br>3. PROJECT[col:​Products:​product_price, #2] <br>4. GROUP[avg, #3, #1] <br>5. UNION[#1, #4] <br> | + | medium | 
  | SPIDER_train_4726 | Return the average price for each product type. | SELECT product_type_code ,  avg(product_price) FROM products GROUP BY product_type_code | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. GROUP[avg, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. GROUP[avg, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_4727 | How many department stores does the store chain South have? | SELECT count(*) FROM department_stores AS T1 JOIN department_store_chain AS T2 ON T1.dept_store_chain_id  =  T2.dept_store_chain_id WHERE T2.dept_store_chain_name  =  "South" | 1. SELECT[tbl:​Department_Stores] <br>2. PROJECT[tbl:​Department_Stores, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​South:​col:​Department_Store_Chain:​dept_store_chain_name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Department_Stores] <br>2. PROJECT[tbl:​Department_Stores, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​South:​col:​Department_Store_Chain:​dept_store_chain_name] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_4728 | Count the number of stores the chain South has. | SELECT count(*) FROM department_stores AS T1 JOIN department_store_chain AS T2 ON T1.dept_store_chain_id  =  T2.dept_store_chain_id WHERE T2.dept_store_chain_name  =  "South" | 1. SELECT[tbl:​Department_Stores] <br>2. FILTER[#1, comparative:​=:​South:​col:​Department_Store_Chain:​dept_store_chain_name] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Department_Stores] <br>2. COMPARATIVE[#1, #1, comparative:​=:​South:​col:​Department_Store_Chain:​dept_store_chain_name] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_4729 | What is the name and job title of the staff who was assigned the latest? | SELECT T1.staff_name ,  T2.job_title_code FROM staff AS T1 JOIN staff_department_assignments AS T2 ON T1.staff_id  =  T2.staff_id ORDER BY T2.date_assigned_to DESC LIMIT 1 | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​date_assigned_to, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​Staff:​staff_name, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​date_assigned_to, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Staff:​staff_name, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_4730 | Return the name and job title of the staff with the latest date assigned. | SELECT T1.staff_name ,  T2.job_title_code FROM staff AS T1 JOIN staff_department_assignments AS T2 ON T1.staff_id  =  T2.staff_id ORDER BY T2.date_assigned_to DESC LIMIT 1 | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​date_assigned_to, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​Staff:​staff_name, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff_Department_Assignments:​date_assigned_to, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Staff:​staff_name, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​job_title_code, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_4731 | Give me the product type, name and price for all the products supplied by supplier id 3. | SELECT T2.product_type_code ,  T2.product_name ,  T2.product_price FROM product_suppliers AS T1 JOIN products AS T2 ON T1.product_id  =  T2.product_id WHERE T1.supplier_id  =  3 | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[tbl:​Product_Suppliers, #1] <br>3. PROJECT[col:​Product_Suppliers:​supplier_id, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​3:​col:​Product_Suppliers:​supplier_id] <br>5. PROJECT[col:​Products:​product_type_code, #4] <br>6. PROJECT[col:​Products:​product_name, #4] <br>7. PROJECT[col:​Products:​product_price, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[tbl:​Product_Suppliers, #1] <br>3. PROJECT[col:​Product_Suppliers:​supplier_id, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​3:​col:​Product_Suppliers:​supplier_id] <br>5. PROJECT[col:​Products:​product_type_code, #4] <br>6. PROJECT[col:​Products:​product_name, #4] <br>7. PROJECT[col:​Products:​product_price, #4] <br>8. UNION[#5, #6, #7] <br> | + | medium | 
  | SPIDER_train_4732 | Return the product type, name, and price for products supplied by supplier 3. | SELECT T2.product_type_code ,  T2.product_name ,  T2.product_price FROM product_suppliers AS T1 JOIN products AS T2 ON T1.product_id  =  T2.product_id WHERE T1.supplier_id  =  3 | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[tbl:​Product_Suppliers, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​3:​col:​Product_Suppliers:​supplier_id] <br>4. PROJECT[col:​Products:​product_type_code, #3] <br>5. PROJECT[col:​Products:​product_name, #3] <br>6. PROJECT[col:​Products:​product_price, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[tbl:​Product_Suppliers, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​3:​col:​Product_Suppliers:​supplier_id] <br>4. PROJECT[col:​Products:​product_type_code, #3] <br>5. PROJECT[col:​Products:​product_name, #3] <br>6. PROJECT[col:​Products:​product_price, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_4733 | Return the distinct name of customers whose order status is Pending, in the order of customer id. | SELECT DISTINCT T1.customer_name FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.order_status_code  =  "Pending" ORDER BY T2.customer_id | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Pending:​col:​Customer_Orders:​order_status_code] <br>4. PROJECT[distinct #REF, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br>6. PROJECT[col:​Customer_Orders:​customer_id, #4] <br>7. SORT[#5, #6] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Pending:​col:​Customer_Orders:​order_status_code] <br>4. PROJECT[None, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br>6. PROJECT[col:​Customer_Orders:​customer_id, #4] <br>7. SORT[#5, #6, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_4735 | Find the name and address of the customers who have both New and Pending orders. | SELECT T1.customer_name ,  T1.customer_address FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.order_status_code  =  "New" INTERSECT SELECT T1.customer_name ,  T1.customer_address FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.order_status_code  =  "Pending" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​New:​col:​Customer_Orders:​order_status_code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Pending:​col:​Customer_Orders:​order_status_code] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br>7. PROJECT[col:​Customers:​customer_address, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​New:​col:​Customer_Orders:​order_status_code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Pending:​col:​Customer_Orders:​order_status_code] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br>7. PROJECT[col:​Customers:​customer_address, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_4736 | What are the names and addressed of customers who have both New and Pending orders? | SELECT T1.customer_name ,  T1.customer_address FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.order_status_code  =  "New" INTERSECT SELECT T1.customer_name ,  T1.customer_address FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.order_status_code  =  "Pending" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[tbl:​Customer_Orders, #1] <br>4. GROUP[tbl:​Customer_Orders, #2, #1] <br>5. GROUP[tbl:​Customer_Orders, #3, #1] <br>6. COMPARATIVE[#1, #4, comparative:​=:​New:​col:​Customer_Orders:​order_status_code] <br>7. COMPARATIVE[#1, #5, comparative:​=:​Pending:​col:​Customer_Orders:​order_status_code] <br>8. INTERSECTION[#1, #6, #7] <br>9. PROJECT[col:​Customers:​customer_name, #8] <br>10. PROJECT[col:​Customers:​customer_address, #8] <br>11. UNION[#9, #10] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[tbl:​Customer_Orders, #1] <br>4. GROUP[sum, #2, #1] <br>5. GROUP[sum, #3, #1] <br>6. COMPARATIVE[#1, #4, comparative:​=:​New:​col:​Customer_Orders:​order_status_code] <br>7. COMPARATIVE[#1, #5, comparative:​=:​Pending:​col:​Customer_Orders:​order_status_code] <br>8. INTERSECTION[#1, #6, #7] <br>9. PROJECT[col:​Customers:​customer_name, #8] <br>10. PROJECT[col:​Customers:​customer_address, #8] <br>11. UNION[#9, #10] <br> | + | extra | 
  | SPIDER_train_4737 | Return ids of all the products that are supplied by supplier id 2 and are more expensive than the average price of all products. | SELECT T1.product_id FROM product_suppliers AS T1 JOIN products AS T2 ON T1.product_id  =  T2.product_id WHERE T1.supplier_id  =  2 AND T2.product_price  >  (SELECT avg(product_price) FROM products) | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[tbl:​Product_Suppliers, #1] <br>6. PROJECT[col:​Product_Suppliers:​product_id, #5] <br>7. COMPARATIVE[#1, #6, comparative:​=:​2:​col:​Product_Suppliers:​supplier_id] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​Product_Suppliers:​product_id, #8] <br> | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[tbl:​Product_Suppliers, #1] <br>6. PROJECT[col:​Product_Suppliers:​product_id, #5] <br>7. COMPARATIVE[#1, #6, comparative:​=:​2:​col:​Product_Suppliers:​supplier_id] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​Product_Suppliers:​product_id, #8] <br> | + | extra | 
  | SPIDER_train_4738 | What are the ids of products from the supplier with id 2, which are more expensive than the average price across all products? | SELECT T1.product_id FROM product_suppliers AS T1 JOIN products AS T2 ON T1.product_id  =  T2.product_id WHERE T1.supplier_id  =  2 AND T2.product_price  >  (SELECT avg(product_price) FROM products) | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br>4. PROJECT[tbl:​Product_Suppliers, #2] <br>5. PROJECT[col:​Product_Suppliers:​product_id, #4] <br>6. COMPARATIVE[#1, #5, comparative:​=:​2:​col:​Product_Suppliers:​supplier_id] <br>7. PROJECT[col:​Products:​product_price, #6] <br>8. COMPARATIVE[#6, #7, comparative:​>:​#3] <br>9. PROJECT[col:​Product_Suppliers:​product_id, #8] <br> | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br>4. PROJECT[tbl:​Product_Suppliers, #2] <br>5. PROJECT[col:​Product_Suppliers:​product_id, #4] <br>6. COMPARATIVE[#1, #5, comparative:​=:​2:​col:​Product_Suppliers:​supplier_id] <br>7. PROJECT[col:​Products:​product_price, #6] <br>8. COMPARATIVE[#6, #7, comparative:​>:​#3] <br>9. PROJECT[col:​Product_Suppliers:​product_id, #8] <br> | + | extra | 
  | SPIDER_train_4739 | What is the id and name of the department store that has both marketing and managing department? | SELECT T2.dept_store_id ,  T2.store_name FROM departments AS T1 JOIN department_stores AS T2 ON T1.dept_store_id  =  T2.dept_store_id WHERE T1.department_name  =  "marketing" INTERSECT SELECT T2.dept_store_id ,  T2.store_name FROM departments AS T1 JOIN department_stores AS T2 ON T1.dept_store_id  =  T2.dept_store_id WHERE T1.department_name  =  "managing" | 1. SELECT[tbl:​Department_Stores] <br>2. FILTER[#1, comparative:​=:​marketing:​col:​Departments:​department_name] <br>3. FILTER[#1, comparative:​=:​managing:​col:​Departments:​department_name] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​Department_Stores:​dept_store_id, #4] <br>6. PROJECT[col:​Department_Stores:​store_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Department_Stores] <br>2. COMPARATIVE[#1, #1, comparative:​=:​marketing:​col:​Departments:​department_name] <br>3. COMPARATIVE[#1, #1, comparative:​=:​managing:​col:​Departments:​department_name] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​Department_Stores:​dept_store_id, #4] <br>6. PROJECT[col:​Department_Stores:​store_name, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_4740 | What are the ids and names of department stores with both marketing and managing departments? | SELECT T2.dept_store_id ,  T2.store_name FROM departments AS T1 JOIN department_stores AS T2 ON T1.dept_store_id  =  T2.dept_store_id WHERE T1.department_name  =  "marketing" INTERSECT SELECT T2.dept_store_id ,  T2.store_name FROM departments AS T1 JOIN department_stores AS T2 ON T1.dept_store_id  =  T2.dept_store_id WHERE T1.department_name  =  "managing" | 1. SELECT[tbl:​Department_Stores] <br>2. PROJECT[tbl:​Departments, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​marketing:​col:​Departments:​department_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​managing:​col:​Departments:​department_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Department_Stores:​dept_store_id, #5] <br>7. PROJECT[col:​Department_Stores:​store_name, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Department_Stores] <br>2. PROJECT[tbl:​Departments, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​marketing:​col:​Departments:​department_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​managing:​col:​Departments:​department_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Department_Stores:​dept_store_id, #5] <br>7. PROJECT[col:​Department_Stores:​store_name, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_4743 | What is the id of the department with the least number of staff? | SELECT department_id FROM staff_department_assignments GROUP BY department_id ORDER BY count(*) LIMIT 1 | 1. SELECT[col:​Staff_Department_Assignments:​department_id] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​department_id, #4] <br> | 1. SELECT[col:​Staff_Department_Assignments:​department_id] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​department_id, #4] <br> | + | hard | 
  | SPIDER_train_4744 | Return the id of the department with the fewest staff assignments. | SELECT department_id FROM staff_department_assignments GROUP BY department_id ORDER BY count(*) LIMIT 1 | 1. SELECT[col:​Staff_Department_Assignments:​department_id] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​department_id, #4] <br> | 1. SELECT[col:​Staff_Department_Assignments:​department_id] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Staff_Department_Assignments:​department_id, #4] <br> | + | hard | 
  | SPIDER_train_4747 | Find the product type whose average price is higher than the average price of all products. | SELECT product_type_code FROM products GROUP BY product_type_code HAVING avg(product_price)  >  (SELECT avg(product_price) FROM products) | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br>4. GROUP[avg, #2, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>:​#3] <br>6. PROJECT[col:​Products:​product_type_code, #5] <br> | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br>4. GROUP[avg, #2, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>:​mic:​col:​Products:​product_name] <br>6. PROJECT[col:​Products:​product_type_code, #5] <br> | - | hard | 
  | SPIDER_train_4748 | What is the code of the product type with an average price higher than the average price of all products? | SELECT product_type_code FROM products GROUP BY product_type_code HAVING avg(product_price)  >  (SELECT avg(product_price) FROM products) | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[tbl:​Products, #1] <br>3. PROJECT[col:​Products:​product_price, #2] <br>4. AGGREGATE[avg, #3] <br>5. GROUP[avg, #3, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​#4] <br>7. PROJECT[col:​Products:​product_type_code, #6] <br> | 1. SELECT[col:​Products:​product_type_code] <br>2. PROJECT[tbl:​Products, #1] <br>3. PROJECT[col:​Products:​product_price, #2] <br>4. AGGREGATE[avg, #3] <br>5. GROUP[avg, #3, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​mic:​col:​Products:​product_name] <br>7. PROJECT[col:​Products:​product_type_code, #6] <br> | - | hard | 
  | SPIDER_train_4749 | Find the id and name of the staff who has been assigned for the shortest period. | SELECT T1.staff_id ,  T1.staff_name FROM staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id  =  T2.staff_id ORDER BY date_assigned_to - date_assigned_from LIMIT 1 | 1. SELECT[col:​Staff_Department_Assignments:​staff_id] <br>2. FILTER[#1, comparative:​min:​None] <br>3. PROJECT[period of #REF, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #2, #3] <br>5. PROJECT[col:​Staff:​staff_id, #4] <br>6. PROJECT[col:​Staff:​staff_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​Staff_Department_Assignments:​staff_id] <br>2. SUPERLATIVE[comparative:​min:​None, #1, #1] <br>3. PROJECT[None, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #2, #3] <br>5. PROJECT[col:​Staff:​staff_id, #4] <br>6. PROJECT[col:​Staff:​staff_name, #4] <br>7. UNION[#5, #6] <br> | - | hard | 
  | SPIDER_train_4751 | Return the names and ids of all products whose price is between 600 and 700. | SELECT product_name ,  product_id FROM products WHERE product_price BETWEEN 600 AND 700 | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​700:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​600:​col:​Products:​product_price] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Products:​product_name, #5] <br>7. PROJECT[col:​Products:​product_id, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​700:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​600:​col:​Products:​product_price] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Products:​product_name, #5] <br>7. PROJECT[col:​Products:​product_id, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_4752 | What are the names and ids of products costing between 600 and 700? | SELECT product_name ,  product_id FROM products WHERE product_price BETWEEN 600 AND 700 | 1. SELECT[tbl:​Products] <br>2. PROJECT[cost of #REF, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​700:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​600:​col:​Products:​product_price] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Products:​product_name, #5] <br>7. PROJECT[col:​Products:​product_id, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[None, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​700:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​600:​col:​Products:​product_price] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Products:​product_name, #5] <br>7. PROJECT[col:​Products:​product_id, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_4757 | What are the names and ids of customers whose address contains TN? | SELECT customer_name ,  customer_id FROM customers WHERE customer_address LIKE "%TN%" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%TN%:​col:​Customers:​customer_address] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customers:​customer_id, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​TN:​col:​Customers:​customer_address] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customers:​customer_id, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4758 | Return the names and ids of customers who have TN in their address. | SELECT customer_name ,  customer_id FROM customers WHERE customer_address LIKE "%TN%" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%TN%:​col:​Customers:​customer_address] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customers:​customer_id, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​TN:​col:​Customers:​customer_address] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customers:​customer_id, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4761 | List the name of staff who has been assigned multiple jobs. | SELECT T1.staff_name FROM staff AS T1 JOIN staff_department_assignments AS T2 ON T1.staff_id  =  T2.staff_id GROUP BY T2.staff_id HAVING COUNT (*)  >  1 | 1. SELECT[tbl:​Staff] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Staff:​staff_name, #4] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​Clerical Staff:​col:​Staff_Department_Assignments:​job_title_code] <br>5. PROJECT[col:​Staff:​staff_name, #4] <br> | - | medium | 
  | SPIDER_train_4762 | What are the names of staff who have been assigned multiple jobs? | SELECT T1.staff_name FROM staff AS T1 JOIN staff_department_assignments AS T2 ON T1.staff_id  =  T2.staff_id GROUP BY T2.staff_id HAVING COUNT (*)  >  1 | 1. SELECT[col:​Staff_Department_Assignments:​staff_id] <br>2. PROJECT[jobs of #REF, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Staff:​staff_name, #4] <br> | 1. SELECT[col:​Staff_Department_Assignments:​staff_id] <br>2. PROJECT[None, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​Clerical Staff:​col:​Staff_Department_Assignments:​job_title_code] <br>5. PROJECT[col:​Staff:​staff_name, #4] <br> | - | medium | 
  | SPIDER_train_4763 | List the name and phone number of all suppliers in the alphabetical order of their addresses. | SELECT T1.supplier_name ,  T1.supplier_phone FROM Suppliers AS T1 JOIN supplier_addresses AS T2 ON T1.supplier_id  =  T2.supplier_id JOIN addresses AS T3 ON T2.address_id  =  T3.address_id ORDER BY T3.address_details | 1. SELECT[tbl:​Suppliers] <br>2. PROJECT[col:​Suppliers:​supplier_name, #1] <br>3. PROJECT[col:​Suppliers:​supplier_phone, #1] <br>4. PROJECT[col:​Addresses:​address_details, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | 1. SELECT[tbl:​Suppliers] <br>2. PROJECT[col:​Suppliers:​supplier_name, #1] <br>3. PROJECT[col:​Suppliers:​supplier_phone, #1] <br>4. PROJECT[col:​Addresses:​address_details, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_4764 | What are the names and phone numbers for all suppliers, sorted in alphabetical order of their addressed? | SELECT T1.supplier_name ,  T1.supplier_phone FROM Suppliers AS T1 JOIN supplier_addresses AS T2 ON T1.supplier_id  =  T2.supplier_id JOIN addresses AS T3 ON T2.address_id  =  T3.address_id ORDER BY T3.address_details | 1. SELECT[tbl:​Suppliers] <br>2. PROJECT[col:​Suppliers:​supplier_name, #1] <br>3. PROJECT[col:​Suppliers:​supplier_phone, #1] <br>4. PROJECT[col:​Addresses:​address_details, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | 1. SELECT[tbl:​Suppliers] <br>2. PROJECT[col:​Suppliers:​supplier_name, #1] <br>3. PROJECT[col:​Suppliers:​supplier_phone, #1] <br>4. PROJECT[col:​Addresses:​address_details, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_4769 | What are id and name of the products whose price is lower than 600 or higher than 900? | SELECT product_id ,  product_name FROM products WHERE product_price  <  600 OR product_price  >  900 | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​900:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​<:​600:​col:​Products:​product_price] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Products:​product_id, #5] <br>7. PROJECT[col:​Products:​product_name, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​900:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​<:​600:​col:​Products:​product_price] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Products:​product_id, #5] <br>7. PROJECT[col:​Products:​product_name, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_4770 | Give the ids and names of products with price lower than 600 or higher than 900. | SELECT product_id ,  product_name FROM products WHERE product_price  <  600 OR product_price  >  900 | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​900:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​<:​600:​col:​Products:​product_price] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Products:​product_id, #5] <br>7. PROJECT[col:​Products:​product_name, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​900:​col:​Products:​product_price] <br>4. COMPARATIVE[#1, #2, comparative:​<:​600:​col:​Products:​product_price] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Products:​product_id, #5] <br>7. PROJECT[col:​Products:​product_name, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_4774 | Return the average total amount purchased and total value purchased for the supplier who supplies the greatest number of products. | SELECT avg(total_amount_purchased) ,  avg(total_value_purchased) FROM Product_Suppliers WHERE supplier_id  =  (SELECT supplier_id FROM Product_Suppliers GROUP BY supplier_id ORDER BY count(*) DESC LIMIT 1) | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[tbl:​Product_Suppliers, #1] <br>3. GROUP[col:​Product_Suppliers:​supplier_id, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br>5. PROJECT[col:​Product_Suppliers:​total_amount_purchased, #4] <br>6. GROUP[sum, #5, #4] <br>7. PROJECT[col:​Product_Suppliers:​total_value_purchased, #4] <br>8. GROUP[sum, #7, #4] <br>9. AGGREGATE[avg, #6] <br>10. AGGREGATE[avg, #8] <br>11. UNION[#9, #10] <br> | 1. SELECT[tbl:​Product_Suppliers] <br>2. PROJECT[tbl:​Product_Suppliers, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Product_Suppliers:​total_amount_purchased, #4] <br>6. GROUP[sum, #5, #4] <br>7. PROJECT[col:​Product_Suppliers:​total_value_purchased, #4] <br>8. GROUP[sum, #7, #4] <br>9. AGGREGATE[avg, #6] <br>10. AGGREGATE[avg, #8] <br>11. UNION[#9, #10] <br> | - | extra | 
  | SPIDER_train_4776 | Return the maximum and minimum customer codes. | SELECT max(customer_code) ,  min(customer_code) FROM Customers | 1. SELECT[col:​Customers:​customer_code] <br>2. AGGREGATE[max, #1] <br>3. AGGREGATE[min, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[col:​Customers:​customer_code] <br>2. AGGREGATE[max, #1] <br>3. AGGREGATE[min, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_4778 | What are the distinct names of customers who have purchased a keyboard? | SELECT DISTINCT T1.customer_name FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id JOIN order_items AS T3 ON T2.order_id  =  T3.order_id JOIN products AS T4 ON T3.product_id  =  T4.product_id WHERE T4.product_name  =  "keyboard" | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[val:​Products:​product_name:​keyboard, #1] <br>3.*(distinct)* PROJECT[col:​Customers:​customer_name, #2] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[val:​Products:​product_name:​keyboard, #1] <br>3.*(distinct)* PROJECT[col:​Customers:​customer_name, #2] <br> | + | extra | 
  | SPIDER_train_4779 | List the names and phone numbers of all the distinct suppliers who supply red jeans. | SELECT DISTINCT T1.supplier_name ,  T1.supplier_phone FROM suppliers AS T1 JOIN product_suppliers AS T2 ON T1.supplier_id  =  T2.supplier_id JOIN products AS T3 ON T2.product_id  =  T3.product_id WHERE T3.product_name  =  "red jeans" | 1. SELECT[tbl:​Product_Suppliers] <br>2. FILTER[#1, comparative:​=:​red jeans:​col:​Products:​product_name] <br>3. PROJECT[distinct #REF, #2] <br>4. PROJECT[col:​Suppliers:​supplier_name, #3] <br>5. PROJECT[col:​Suppliers:​supplier_phone, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Product_Suppliers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​red jeans:​col:​Products:​product_name] <br>3. PROJECT[None, #2] <br>4. PROJECT[col:​Suppliers:​supplier_name, #3] <br>5. PROJECT[col:​Suppliers:​supplier_phone, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_4780 | What are the distinct names and phone numbers for suppliers who have red jeans? | SELECT DISTINCT T1.supplier_name ,  T1.supplier_phone FROM suppliers AS T1 JOIN product_suppliers AS T2 ON T1.supplier_id  =  T2.supplier_id JOIN products AS T3 ON T2.product_id  =  T3.product_id WHERE T3.product_name  =  "red jeans" | 1. SELECT[tbl:​Product_Suppliers] <br>2. FILTER[#1, comparative:​=:​red jeans:​col:​Products:​product_name] <br>3.*(distinct)* PROJECT[col:​Suppliers:​supplier_name, #2] <br>4. PROJECT[col:​Suppliers:​supplier_phone, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Product_Suppliers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​red jeans:​col:​Products:​product_name] <br>3.*(distinct)* PROJECT[col:​Suppliers:​supplier_name, #2] <br>4. PROJECT[col:​Suppliers:​supplier_phone, #2] <br>5. UNION[#3, #4] <br> | + | hard | 
  | SPIDER_train_4783 | List the order id, customer id for orders in Cancelled status, ordered by their order dates. | SELECT order_id ,  customer_id FROM customer_orders WHERE order_status_code  =   "Cancelled" ORDER BY order_date | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[col:​Customer_Orders:​order_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status_code] <br>4. PROJECT[col:​Customer_Orders:​order_id, #3] <br>5. PROJECT[col:​Customer_Orders:​customer_id, #3] <br>6. PROJECT[col:​Customer_Orders:​order_date, #3] <br>7. UNION[#4, #5] <br>8. SORT[#7, #6] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[col:​Customer_Orders:​order_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status_code] <br>4. PROJECT[col:​Customer_Orders:​order_id, #3] <br>5. PROJECT[col:​Customer_Orders:​customer_id, #3] <br>6. PROJECT[col:​Customer_Orders:​order_date, #3] <br>7. UNION[#4, #5] <br>8. SORT[#7, #6, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_4784 | What are the order ids and customer ids for orders that have been Cancelled, sorted by their order dates? | SELECT order_id ,  customer_id FROM customer_orders WHERE order_status_code  =   "Cancelled" ORDER BY order_date | 1. SELECT[tbl:​Customer_Orders] <br>2. FILTER[#1, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status_code] <br>3. PROJECT[col:​Customer_Orders:​order_id, #2] <br>4. PROJECT[col:​Customer_Orders:​customer_id, #2] <br>5. PROJECT[col:​Customer_Orders:​order_date, #2] <br>6. UNION[#3, #4] <br>7. SORT[#6, #5] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status_code] <br>3. PROJECT[col:​Customer_Orders:​order_id, #2] <br>4. PROJECT[col:​Customer_Orders:​customer_id, #2] <br>5. PROJECT[col:​Customer_Orders:​order_date, #2] <br>6. UNION[#3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_4789 | Find the name and gender of the staff who has been assigned the job of Sales Person but never Clerical Staff. | SELECT T1.staff_name ,  T1.staff_gender FROM staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id  =  T2.staff_id WHERE T2.job_title_code  =  "Sales Person" EXCEPT SELECT T1.staff_name ,  T1.staff_gender FROM staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id  =  T2.staff_id WHERE T2.job_title_code  =  "Clerical Staff" | 1. SELECT[tbl:​Staff_Department_Assignments] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Sales Person:​col:​Staff_Department_Assignments:​job_title_code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Clerical Staff:​col:​Staff_Department_Assignments:​job_title_code] <br>5. INTERSECTION[#1, #3, #4] <br>6. DISCARD[#3, #5] <br>7. PROJECT[col:​Staff:​staff_name, #6] <br>8. PROJECT[col:​Staff:​staff_gender, #6] <br>9. UNION[#7, #8] <br> | 1. SELECT[tbl:​Staff_Department_Assignments] <br>2. PROJECT[tbl:​Staff_Department_Assignments, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Sales Person:​col:​Staff_Department_Assignments:​job_title_code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Clerical Staff:​col:​Staff_Department_Assignments:​job_title_code] <br>5. INTERSECTION[#1, #3, #4] <br>6. DISCARD[#3, #5] <br>7. PROJECT[col:​Staff:​staff_name, #6] <br>8. PROJECT[col:​Staff:​staff_gender, #6] <br>9. UNION[#7, #8] <br> | + | extra | 
  | SPIDER_train_4790 | What are the names and genders of staff who have held the title Sales Person, but never Clerical Staff? | SELECT T1.staff_name ,  T1.staff_gender FROM staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id  =  T2.staff_id WHERE T2.job_title_code  =  "Sales Person" EXCEPT SELECT T1.staff_name ,  T1.staff_gender FROM staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id  =  T2.staff_id WHERE T2.job_title_code  =  "Clerical Staff" | 1. SELECT[tbl:​Staff] <br>2. FILTER[#1, comparative:​=:​Sales Person:​col:​Staff_Department_Assignments:​job_title_code] <br>3. FILTER[#1, comparative:​=:​Clerical Staff:​col:​Staff_Department_Assignments:​job_title_code] <br>4. DISCARD[#2, #3] <br>5. PROJECT[col:​Staff:​staff_name, #4] <br>6. PROJECT[col:​Staff:​staff_gender, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Staff] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Sales Person:​col:​Staff_Department_Assignments:​job_title_code] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Clerical Staff:​col:​Staff_Department_Assignments:​job_title_code] <br>4. DISCARD[#2, #3] <br>5. PROJECT[col:​Staff:​staff_name, #4] <br>6. PROJECT[col:​Staff:​staff_gender, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_4792 | What are the ids and names of customers with addressed that contain WY and who do not use a credit card for payment? | SELECT customer_id ,  customer_name FROM customers WHERE customer_address LIKE "%WY%" AND payment_method_code != "Credit Card" | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​!=:​Credit Card:​col:​Customers:​payment_method_code] <br>3. FILTER[#2, comparative:​like:​%WY%:​col:​Customers:​customer_address] <br>4. PROJECT[col:​Customers:​customer_id, #3] <br>5. PROJECT[col:​Customers:​customer_name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​!=:​Credit Card:​col:​Customers:​payment_method_code] <br>3. COMPARATIVE[#2, #2, comparative:​like:​WY:​col:​Customers:​customer_address] <br>4. PROJECT[col:​Customers:​customer_id, #3] <br>5. PROJECT[col:​Customers:​customer_name, #3] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_4793 | Find the average price of all product clothes. | SELECT avg(product_price) FROM products WHERE product_type_code  =  'Clothes' | 1. SELECT[val:​Products:​product_type_code:​Clothes] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[val:​Products:​product_type_code:​Clothes] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_4794 | What is the average price of clothes? | SELECT avg(product_price) FROM products WHERE product_type_code  =  'Clothes' | 1. SELECT[val:​Products:​product_type_code:​Clothes] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[val:​Products:​product_type_code:​Clothes] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_4796 | What is the name of the hardware product with the greatest price? | SELECT product_name FROM products WHERE product_type_code  =  'Hardware' ORDER BY product_price DESC LIMIT 1 | 1. SELECT[val:​Products:​product_type_code:​Hardware] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​Products:​product_name, #3] <br> | 1. SELECT[val:​Products:​product_type_code:​Hardware] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Products:​product_name, #3] <br> | + | hard | 
 ***
 Exec acc: **0.8654**
