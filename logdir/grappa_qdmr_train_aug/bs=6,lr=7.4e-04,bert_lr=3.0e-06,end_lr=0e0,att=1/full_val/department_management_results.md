 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **department** | Department_ID | + |   | 
 | 2 |   | Name |   |   | 
 | 3 |   | Creation |   |   | 
 | 4 |   | Ranking |   |   | 
 | 5 |   | Budget_in_Billions |   |   | 
 | 6 |   | Num_Employees |   |   | 
 | 7 | **head** | head_ID | + |   | 
 | 8 |   | name |   |   | 
 | 9 |   | born_state |   |   | 
 | 10 |   | age |   |   | 
 | 11 | **management** | department_ID | + | --> 1 | 
 | 12 |   | head_ID |   | --> 7 | 
 | 13 |   | temporary_acting |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_0 | How many heads of the departments are older than 56 ? | SELECT count(*) FROM head WHERE age  >  56 | 1. SELECT[tbl:​head] <br>2. FILTER[#1, comparative:​>:​56:​col:​head:​age] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​head] <br>2. COMPARATIVE[#1, #1, comparative:​>:​56:​col:​head:​age] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_2 | List the creation year, name and budget of each department. | SELECT creation ,  name ,  budget_in_billions FROM department | 1. SELECT[tbl:​department] <br>2. PROJECT[col:​department:​Creation, #1] <br>3. PROJECT[col:​department:​Name, #1] <br>4. PROJECT[col:​department:​Budget_in_Billions, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​department] <br>2. PROJECT[col:​department:​Creation, #1] <br>3. PROJECT[col:​department:​Name, #1] <br>4. PROJECT[col:​department:​Budget_in_Billions, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_3 | What are the maximum and minimum budget of the departments? | SELECT max(budget_in_billions) ,  min(budget_in_billions) FROM department | 1. SELECT[tbl:​department] <br>2. PROJECT[col:​department:​Budget_in_Billions, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​department] <br>2. PROJECT[col:​department:​Budget_in_Billions, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_5 | What are the names of the heads who are born outside the California state? | SELECT name FROM head WHERE born_state != 'California' | 1. SELECT[tbl:​head] <br>2. FILTER[#1, comparative:​!=:​California:​col:​head:​born_state] <br>3. PROJECT[col:​head:​name, #2] <br> | 1. SELECT[tbl:​head] <br>2. COMPARATIVE[#1, #1, comparative:​!=:​California:​col:​head:​born_state] <br>3. PROJECT[col:​head:​name, #2] <br> | + | easy | 
  | SPIDER_train_7 | What are the names of the states where at least 3 heads were born? | SELECT born_state FROM head GROUP BY born_state HAVING count(*)  >=  3 | 1. SELECT[col:​head:​born_state] <br>2. PROJECT[tbl:​head, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​3] <br>5. PROJECT[col:​head:​born_state, #4] <br> | 1. SELECT[col:​head:​born_state] <br>2. PROJECT[tbl:​head, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​3] <br>5. PROJECT[col:​head:​born_state, #4] <br> | + | easy | 
  | SPIDER_train_8 | In which year were most departments established? | SELECT creation FROM department GROUP BY creation ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​department:​Creation] <br>2. PROJECT[tbl:​department, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​department:​Creation] <br>2. PROJECT[tbl:​department, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_10 | How many acting statuses are there? | SELECT count(DISTINCT temporary_acting) FROM management | 1. SELECT[col:​management:​temporary_acting] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[col:​management:​temporary_acting] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_12 | What are the distinct ages of the heads who are acting? | SELECT DISTINCT T1.age FROM management AS T2 JOIN head AS T1 ON T1.head_id  =  T2.head_id WHERE T2.temporary_acting  =  'Yes' | 1. SELECT[tbl:​head] <br>2. FILTER[#1, comparative:​=:​Yes:​col:​management:​temporary_acting] <br>3.*(distinct)* PROJECT[col:​head:​age, #2] <br> | 1. SELECT[tbl:​head] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Yes:​col:​management:​temporary_acting] <br>3.*(distinct)* PROJECT[col:​head:​age, #2] <br> | + | medium | 
  | SPIDER_train_13 | List the states where both the secretary of 'Treasury' department and the secretary of 'Homeland Security' were born. | SELECT T3.born_state FROM department AS T1 JOIN management AS T2 ON T1.department_id  =  T2.department_id JOIN head AS T3 ON T2.head_id  =  T3.head_id WHERE T1.name  =  'Treasury' INTERSECT SELECT T3.born_state FROM department AS T1 JOIN management AS T2 ON T1.department_id  =  T2.department_id JOIN head AS T3 ON T2.head_id  =  T3.head_id WHERE T1.name  =  'Homeland Security' | 1. SELECT[col:​head:​born_state] <br>2. FILTER[#1, comparative:​=:​Treasury:​col:​department:​Name] <br>3. FILTER[#1, comparative:​=:​Homeland Security:​col:​department:​Name] <br>4. INTERSECTION[#1, #2, #3] <br> | 1. SELECT[col:​head:​born_state] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Treasury:​col:​department:​Name] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Homeland Security:​col:​department:​Name] <br>4. INTERSECTION[#1, #2, #3] <br> | + | extra | 
  | SPIDER_train_14 | Which department has more than 1 head at a time? List the id, name and the number of heads. | SELECT T1.department_id ,  T1.name ,  count(*) FROM management AS T2 JOIN department AS T1 ON T1.department_id  =  T2.department_id GROUP BY T1.department_id HAVING count(*)  >  1 | 1. SELECT[tbl:​department] <br>2. PROJECT[tbl:​head, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​department:​Department_ID, #4] <br>6. PROJECT[col:​department:​Name, #4] <br>7. PROJECT[tbl:​head, #4] <br>8. AGGREGATE[count, #7] <br>9. UNION[#5, #6, #8] <br> | 1. SELECT[tbl:​department] <br>2. PROJECT[tbl:​head, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​department:​Department_ID, #4] <br>6. PROJECT[col:​department:​Name, #4] <br>7. PROJECT[tbl:​head, #4] <br>8. AGGREGATE[count, #7] <br>9. UNION[#5, #6, #8] <br> | + | medium | 
  | SPIDER_train_15 | Which head's name has the substring 'Ha'? List the id and name. | SELECT head_id ,  name FROM head WHERE name LIKE '%Ha%' | 1. SELECT[tbl:​head] <br>2. PROJECT[col:​head:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Ha%:​col:​head:​name] <br>4. PROJECT[col:​head:​head_ID, #3] <br>5. PROJECT[col:​head:​name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​head] <br>2. PROJECT[col:​head:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Ha:​col:​head:​name] <br>4. PROJECT[col:​head:​head_ID, #3] <br>5. PROJECT[col:​head:​name, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
 ***
 Exec acc: **1.0000**
