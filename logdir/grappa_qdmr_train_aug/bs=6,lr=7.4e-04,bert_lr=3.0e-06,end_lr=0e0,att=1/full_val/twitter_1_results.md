 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **follows** | f1 | + | --> 7 | 
 | 2 |   | f2 |   | --> 7 | 
 | 3 | **tweets** | id | + |   | 
 | 4 |   | uid |   | --> 7 | 
 | 5 |   | text |   |   | 
 | 6 |   | createdate |   |   | 
 | 7 | **user_profiles** | uid | + |   | 
 | 8 |   | name |   |   | 
 | 9 |   | email |   |   | 
 | 10 |   | partitionid |   |   | 
 | 11 |   | followers |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_274 | Find the emails of the user named "Mary". | SELECT email FROM user_profiles WHERE name  =  'Mary' | 1. SELECT[tbl:​user_profiles] <br>2. FILTER[#1, comparative:​=:​Mary:​col:​user_profiles:​name] <br>3. PROJECT[col:​user_profiles:​email, #2] <br> | 1. SELECT[tbl:​user_profiles] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Mary:​col:​user_profiles:​name] <br>3. PROJECT[col:​user_profiles:​email, #2] <br> | + | easy | 
  | SPIDER_train_275 | What is the partition id of the user named "Iron Man". | SELECT partitionid FROM user_profiles WHERE name  =  'Iron Man' | 1. SELECT[tbl:​user_profiles] <br>2. FILTER[#1, comparative:​=:​Iron Man:​col:​user_profiles:​name] <br>3. PROJECT[col:​user_profiles:​partitionid, #2] <br> | 1. SELECT[tbl:​user_profiles] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Iron Man:​col:​user_profiles:​name] <br>3. PROJECT[col:​user_profiles:​partitionid, #2] <br> | + | easy | 
  | SPIDER_train_276 | How many users are there? | SELECT count(*) FROM user_profiles | 1. SELECT[tbl:​user_profiles] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​user_profiles] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_279 | Find the number of tweets in record. | SELECT count(*) FROM tweets | 1. SELECT[tbl:​tweets] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​tweets] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_281 | Find the name and email of the user whose name contains the word ‘Swift’. | SELECT name ,  email FROM user_profiles WHERE name LIKE '%Swift%' | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Swift%:​col:​user_profiles:​name] <br>4. PROJECT[col:​user_profiles:​name, #3] <br>5. PROJECT[col:​user_profiles:​email, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Swift:​col:​user_profiles:​name] <br>4. PROJECT[col:​user_profiles:​name, #3] <br>5. PROJECT[col:​user_profiles:​email, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_282 | Find the names of users whose emails contain ‘superstar’ or ‘edu’. | SELECT name FROM user_profiles WHERE email LIKE '%superstar%' OR email LIKE '%edu%' | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​email, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%superstar%:​col:​user_profiles:​email] <br>4. COMPARATIVE[#1, #2, comparative:​like:​%edu%:​col:​user_profiles:​email] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​user_profiles:​name, #5] <br> | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​email, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​superstar:​col:​user_profiles:​email] <br>4. COMPARATIVE[#1, #2, comparative:​like:​edu:​col:​user_profiles:​email] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​user_profiles:​name, #5] <br> | + | extra | 
  | SPIDER_train_283 | Return the text of tweets about the topic 'intern'. | SELECT text FROM tweets WHERE text LIKE '%intern%' | 1. SELECT[tbl:​tweets] <br>2. FILTER[#1, comparative:​like:​%intern%:​col:​tweets:​text] <br>3. PROJECT[col:​tweets:​text, #2] <br> | 1. SELECT[tbl:​tweets] <br>2. COMPARATIVE[#1, #1, comparative:​like:​intern:​col:​tweets:​text] <br>3. PROJECT[col:​tweets:​text, #2] <br> | + | medium | 
  | SPIDER_train_284 | Find the name and email of the users who have more than 1000 followers. | SELECT name ,  email FROM user_profiles WHERE followers  >  1000 | 1. SELECT[tbl:​user_profiles] <br>2. FILTER[#1, comparative:​>:​1000:​col:​user_profiles:​followers] <br>3. PROJECT[col:​user_profiles:​name, #2] <br>4. PROJECT[col:​user_profiles:​email, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​user_profiles] <br>2. COMPARATIVE[#1, #1, comparative:​>:​1000:​col:​user_profiles:​followers] <br>3. PROJECT[col:​user_profiles:​name, #2] <br>4. PROJECT[col:​user_profiles:​email, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_290 | Find the name of the user who has the largest number of followers. | SELECT name FROM user_profiles ORDER BY followers DESC LIMIT 1 | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​followers, #1] <br>3. GROUP[col:​user_profiles:​followers, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​user_profiles:​name, #4] <br> | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​followers, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​user_profiles:​name, #4] <br> | + | medium | 
  | SPIDER_train_291 | Find the name and email of the user followed by the least number of people. | SELECT name ,  email FROM user_profiles ORDER BY followers LIMIT 1 | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​followers, #1] <br>3. GROUP[col:​user_profiles:​followers, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​user_profiles:​name, #4] <br>6. PROJECT[col:​user_profiles:​email, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​followers, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​user_profiles:​name, #4] <br>6. PROJECT[col:​user_profiles:​email, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_292 | List the name and number of followers for each user, and sort the results by the number of followers in descending order. | SELECT name ,  followers FROM user_profiles ORDER BY followers DESC | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​name, #1] <br>3. PROJECT[col:​user_profiles:​followers, #1] <br>4. GROUP[col:​user_profiles:​followers, #3, #1] <br>5. UNION[#2, #4] <br>6. SORT[#5, #4, sortdir:​descending] <br> | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​name, #1] <br>3. PROJECT[col:​user_profiles:​followers, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br>6. SORT[#5, #4, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_294 | List the text of all tweets in the order of date. | SELECT text FROM tweets ORDER BY createdate | 1. SELECT[tbl:​tweets] <br>2. PROJECT[col:​tweets:​text, #1] <br>3. PROJECT[col:​tweets:​createdate, #1] <br>4. SORT[#2, #3] <br> | 1. SELECT[tbl:​tweets] <br>2. PROJECT[col:​tweets:​text, #1] <br>3. PROJECT[col:​tweets:​createdate, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_295 | Find the name of each user and number of tweets tweeted by each of them. | SELECT T1.name ,  count(*) FROM user_profiles AS T1 JOIN tweets AS T2 ON T1.uid  =  T2.uid GROUP BY T2.uid | 1. SELECT[col:​tweets:​uid] <br>2. PROJECT[col:​user_profiles:​name, #1] <br>3. PROJECT[tbl:​tweets, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​tweets:​uid] <br>2. PROJECT[col:​user_profiles:​name, #1] <br>3. PROJECT[tbl:​tweets, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_299 | Find the average number of followers for the users who had some tweets. | SELECT avg(followers) FROM user_profiles WHERE UID IN (SELECT UID FROM tweets) | 1. SELECT[tbl:​user_profiles] <br>2. FILTER[#1, tbl:​tweets] <br>3. PROJECT[col:​user_profiles:​followers, #2] <br>4. GROUP[col:​user_profiles:​followers, #3, #2] <br>5. AGGREGATE[avg, #4] <br> | 1. SELECT[tbl:​user_profiles] <br>2. COMPARATIVE[#1, #1, tbl:​tweets] <br>3. PROJECT[col:​user_profiles:​followers, #2] <br>4. GROUP[sum, #3, #2] <br>5. AGGREGATE[avg, #4] <br> | + | hard | 
  | SPIDER_train_300 | Find the maximum and total number of followers of all users. | SELECT max(followers) ,  sum(followers) FROM user_profiles | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​followers, #1] <br>3. GROUP[min, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[sum, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​user_profiles] <br>2. PROJECT[col:​user_profiles:​followers, #1] <br>3. GROUP[min, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[sum, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
 ***
 Exec acc: **1.0000**
