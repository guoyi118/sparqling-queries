 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **people** | People_ID | + |   | 
 | 2 |   | Age |   |   | 
 | 3 |   | Name |   |   | 
 | 4 |   | Nationality |   |   | 
 | 5 |   | Graduation_College |   |   | 
 | 6 | **company** | Company_ID | + |   | 
 | 7 |   | Name |   |   | 
 | 8 |   | Headquarters |   |   | 
 | 9 |   | Industry |   |   | 
 | 10 |   | Sales_in_Billion |   |   | 
 | 11 |   | Profits_in_Billion |   |   | 
 | 12 |   | Assets_in_Billion |   |   | 
 | 13 |   | Market_Value_in_Billion |   |   | 
 | 14 | **employment** | Company_ID | + | --> 6 | 
 | 15 |   | People_ID |   | --> 1 | 
 | 16 |   | Year_working |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_4096 | How many companies are headquartered in the US? | SELECT count(*) FROM company WHERE Headquarters  =  'USA' | 1. SELECT[tbl:​company] <br>2. FILTER[#1, comparative:​=:​USA:​col:​company:​Headquarters] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​company] <br>2. COMPARATIVE[#1, #1, comparative:​=:​USA:​col:​company:​Headquarters] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_4097 | List the names of companies by ascending number of sales. | SELECT Name FROM company ORDER BY Sales_in_Billion ASC | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Sales_in_Billion, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​company:​Name, #1] <br>5. SORT[#4, #3, sortdir:​ascending] <br> | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Sales_in_Billion, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​company:​Name, #1] <br>5. SORT[#4, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_4098 | What are the headquarters and industries of all companies? | SELECT Headquarters ,  Industry FROM company | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Headquarters, #1] <br>3. PROJECT[col:​company:​Industry, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Headquarters, #1] <br>3. PROJECT[col:​company:​Industry, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_4099 | Show the names of companies in the banking or retailing industry? | SELECT Name FROM company WHERE Industry  =  "Banking" OR Industry  =  "Retailing" | 1. SELECT[col:​company:​Industry] <br>2. PROJECT[tbl:​company, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Banking:​col:​company:​Industry] <br>4. COMPARATIVE[#2, #1, comparative:​=:​Retailing:​col:​company:​Industry] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​company:​Name, #5] <br> | 1. SELECT[col:​company:​Industry] <br>2. PROJECT[tbl:​company, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Banking:​col:​company:​Industry] <br>4. COMPARATIVE[#2, #1, comparative:​=:​Retailing:​col:​company:​Industry] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​company:​Name, #5] <br> | + | medium | 
  | SPIDER_train_4100 | What is the maximum and minimum market value of companies? | SELECT max(Market_Value_in_Billion) ,  min(Market_Value_in_Billion) FROM company | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Market_Value_in_Billion, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Market_Value_in_Billion, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_4101 | What is the headquarter of the company with the largest sales? | SELECT Headquarters FROM company ORDER BY Sales_in_Billion DESC LIMIT 1 | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Sales_in_Billion, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​company:​Headquarters, #3] <br> | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Sales_in_Billion, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​company:​Headquarters, #3] <br> | + | medium | 
  | SPIDER_train_4102 | Show the different headquarters and number of companies at each headquarter. | SELECT Headquarters ,  COUNT(*) FROM company GROUP BY Headquarters | 1. SELECT[col:​company:​Headquarters] <br>2.*(distinct)* PROJECT[different #REF, #1] <br>3. PROJECT[tbl:​company, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​company:​Headquarters] <br>2.*(distinct)* PROJECT[None, #1] <br>3. PROJECT[tbl:​company, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_4103 | Show the most common headquarter for companies. | SELECT Headquarters FROM company GROUP BY Headquarters ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Headquarters, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​max:​None] <br> | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Headquarters, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | + | hard | 
  | SPIDER_train_4104 | Show the headquarters that have at least two companies. | SELECT Headquarters FROM company GROUP BY Headquarters HAVING COUNT(*)  >=  2 | 1. SELECT[col:​company:​Headquarters] <br>2. PROJECT[tbl:​company, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br> | 1. SELECT[col:​company:​Headquarters] <br>2. PROJECT[tbl:​company, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br> | + | easy | 
  | SPIDER_train_4106 | Show the names of companies and of employees. | SELECT T3.Name ,  T2.Name FROM employment AS T1 JOIN people AS T2 ON T1.People_ID  =  T2.People_ID JOIN company AS T3 ON T1.Company_ID  =  T3.Company_ID | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Name, #1] <br>3. PROJECT[col:​people:​Name, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Name, #1] <br>3. PROJECT[col:​people:​Name, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_4107 | Show names of companies and that of employees in descending order of number of years working for that employee. | SELECT T3.Name ,  T2.Name FROM employment AS T1 JOIN people AS T2 ON T1.People_ID  =  T2.People_ID JOIN company AS T3 ON T1.Company_ID  =  T3.Company_ID ORDER BY T1.Year_working DESC | 1. SELECT[col:​employment:​Company_ID] <br>2. PROJECT[col:​company:​Name, #1] <br>3. PROJECT[tbl:​employment, #1] <br>4. PROJECT[col:​employment:​Year_working, #3] <br>5. GROUP[count, #4, #3] <br>6. PROJECT[col:​people:​Name, #3] <br>7. UNION[#2, #6] <br>8. SORT[#7, #5, sortdir:​descending] <br> | 1. SELECT[col:​employment:​Company_ID] <br>2. PROJECT[col:​company:​Name, #1] <br>3. PROJECT[tbl:​employment, #1] <br>4. PROJECT[col:​employment:​Year_working, #3] <br>5. GROUP[count, #4, #3] <br>6. PROJECT[col:​people:​Name, #3] <br>7. UNION[#2, #6] <br>8. SORT[#7, #5, sortdir:​descending] <br> | + | hard | 
  | SPIDER_train_4108 | Show the names of employees that work for companies with sales bigger than 200. | SELECT T2.Name FROM employment AS T1 JOIN people AS T2 ON T1.People_ID  =  T2.People_ID JOIN company AS T3 ON T1.Company_ID  =  T3.Company_ID WHERE T3.Sales_in_Billion  >  200 | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Sales_in_Billion, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​200:​col:​company:​Sales_in_Billion] <br>4. PROJECT[tbl:​employment, #3] <br>5. PROJECT[col:​people:​Name, #4] <br> | 1. SELECT[tbl:​company] <br>2. PROJECT[col:​company:​Sales_in_Billion, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​200:​col:​company:​Sales_in_Billion] <br>4. PROJECT[tbl:​employment, #3] <br>5. PROJECT[col:​people:​Name, #4] <br> | + | hard | 
  | SPIDER_train_4109 | Show the names of companies and the number of employees they have | SELECT T3.Name ,  COUNT(*) FROM employment AS T1 JOIN people AS T2 ON T1.People_ID  =  T2.People_ID JOIN company AS T3 ON T1.Company_ID  =  T3.Company_ID GROUP BY T3.Name | 1. SELECT[col:​company:​Name] <br>2. PROJECT[col:​company:​Name, #1] <br>3. PROJECT[tbl:​employment, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​company:​Name] <br>2. PROJECT[col:​company:​Name, #1] <br>3. PROJECT[tbl:​employment, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | hard | 
 ***
 Exec acc: **1.0000**
