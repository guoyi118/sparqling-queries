 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **captain** | Captain_ID | + |   | 
 | 2 |   | Name |   |   | 
 | 3 |   | Ship_ID |   | --> 7 | 
 | 4 |   | age |   |   | 
 | 5 |   | Class |   |   | 
 | 6 |   | Rank |   |   | 
 | 7 | **Ship** | Ship_ID | + |   | 
 | 8 |   | Name |   |   | 
 | 9 |   | Type |   |   | 
 | 10 |   | Built_Year |   |   | 
 | 11 |   | Class |   |   | 
 | 12 |   | Flag |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6220 | How many different captain ranks are there? | SELECT count(DISTINCT rank) FROM captain | 1. SELECT[col:​captain:​Rank] <br>2. FILTER[#1, tbl:​captain] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​captain:​Rank] <br>2. COMPARATIVE[#1, #1, tbl:​captain] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6226 | Sort all captain names by their ages from old to young. | SELECT name FROM captain ORDER BY age DESC | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​age, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​age, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_6227 | What are the names of captains, sorted by age descending? | SELECT name FROM captain ORDER BY age DESC | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​age, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​age, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_6228 | Find the name, class and rank of all captains. | SELECT name ,  CLASS ,  rank FROM captain | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​Class, #1] <br>4. PROJECT[col:​captain:​Rank, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​Class, #1] <br>4. PROJECT[col:​captain:​Rank, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6229 | What are the names, classes, and ranks of all captains? | SELECT name ,  CLASS ,  rank FROM captain | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​Class, #1] <br>4. PROJECT[col:​captain:​Rank, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Name, #1] <br>3. PROJECT[col:​captain:​Class, #1] <br>4. PROJECT[col:​captain:​Rank, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6230 | Which rank is the most common among captains? | SELECT rank FROM captain GROUP BY rank ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Rank, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​max:​None] <br> | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Rank, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | + | hard | 
  | SPIDER_train_6232 | Which classes have more than two captains? | SELECT CLASS FROM captain GROUP BY CLASS HAVING count(*)  >  2 | 1. SELECT[col:​captain:​Class] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | 1. SELECT[col:​captain:​Class] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | + | easy | 
  | SPIDER_train_6233 | Give the classes that have more than two captains. | SELECT CLASS FROM captain GROUP BY CLASS HAVING count(*)  >  2 | 1. SELECT[col:​captain:​Class] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | 1. SELECT[col:​captain:​Class] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | + | easy | 
  | SPIDER_train_6234 | Find the name of captains whose rank are either Midshipman or Lieutenant. | SELECT name FROM captain WHERE rank  =  'Midshipman' OR rank  =  'Lieutenant' | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Rank, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​captain:​Name, #5] <br> | 1. SELECT[tbl:​captain] <br>2. PROJECT[col:​captain:​Rank, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​captain:​Name, #5] <br> | + | medium | 
  | SPIDER_train_6235 | What are the names of captains that have either the rank Midshipman or Lieutenant? | SELECT name FROM captain WHERE rank  =  'Midshipman' OR rank  =  'Lieutenant' | 1. SELECT[tbl:​captain] <br>2. FILTER[#1, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>3. FILTER[#1, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​captain:​Name, #4] <br> | 1. SELECT[tbl:​captain] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​captain:​Name, #4] <br> | + | medium | 
  | SPIDER_train_6238 | Find the captain rank that has some captains in both Cutter and Armed schooner classes. | SELECT rank FROM captain WHERE CLASS  =  'Cutter' INTERSECT SELECT rank FROM captain WHERE CLASS  =  'Armed schooner' | 1. SELECT[val:​captain:​Class:​Cutter] <br>2. SELECT[val:​captain:​Class:​Armed schooner] <br>3. PROJECT[tbl:​captain, #1] <br>4. PROJECT[tbl:​captain, #2] <br>5. SELECT[col:​captain:​Rank] <br>6. INTERSECTION[#5, #3, #4] <br> | 1. SELECT[val:​captain:​Class:​Cutter] <br>2. SELECT[val:​captain:​Class:​Armed schooner] <br>3. PROJECT[tbl:​captain, #1] <br>4. PROJECT[tbl:​captain, #2] <br>5. SELECT[col:​captain:​Rank] <br>6. INTERSECTION[#5, #3, #4] <br> | + | hard | 
  | SPIDER_train_6240 | Find the captain rank that has no captain in Third-rate ship of the line class. | SELECT rank FROM captain EXCEPT SELECT rank FROM captain WHERE CLASS  =  'Third-rate ship of the line' | 1. SELECT[tbl:​captain] <br>2. FILTER[#1, comparative:​=:​Third-rate ship of the line:​col:​captain:​Class] <br>3. PROJECT[col:​captain:​Rank, #2] <br>4. SELECT[col:​captain:​Rank] <br>5. DISCARD[#4, #3] <br> | 1. SELECT[tbl:​captain] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Third-rate ship of the line:​col:​captain:​Class] <br>3. PROJECT[col:​captain:​Rank, #2] <br>4. SELECT[col:​captain:​Rank] <br>5. DISCARD[#4, #3] <br> | + | hard | 
  | SPIDER_train_6241 | What are the ranks of captains that have no captain that are in the Third-rate ship of the line class? | SELECT rank FROM captain EXCEPT SELECT rank FROM captain WHERE CLASS  =  'Third-rate ship of the line' | 1. SELECT[tbl:​captain] <br>2. FILTER[#1, comparative:​=:​Third-rate ship of the line:​col:​captain:​Class] <br>3. PROJECT[col:​captain:​Rank, #1] <br>4. PROJECT[col:​captain:​Rank, #2] <br>5. DISCARD[#3, #4] <br> | 1. SELECT[tbl:​captain] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Third-rate ship of the line:​col:​captain:​Class] <br>3. PROJECT[col:​captain:​Rank, #1] <br>4. PROJECT[col:​captain:​Rank, #2] <br>5. DISCARD[#3, #4] <br> | + | hard | 
  | SPIDER_train_6244 | how many ships are there? | SELECT count(*) FROM ship | 1. SELECT[tbl:​Ship] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Ship] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6245 | Count the number of ships. | SELECT count(*) FROM ship | 1. SELECT[tbl:​Ship] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Ship] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6246 | Find the name, type, and flag of the ship that is built in the most recent year. | SELECT name ,  TYPE ,  flag FROM ship ORDER BY built_year DESC LIMIT 1 | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Built_Year, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Ship:​Name, #3] <br>5. PROJECT[col:​Ship:​Type, #3] <br>6. PROJECT[col:​Ship:​Flag, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Built_Year, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Ship:​Name, #3] <br>5. PROJECT[col:​Ship:​Type, #3] <br>6. PROJECT[col:​Ship:​Flag, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6247 | What is the name, type, and flag of the ship that was built in the most recent year? | SELECT name ,  TYPE ,  flag FROM ship ORDER BY built_year DESC LIMIT 1 | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Built_Year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​Ship:​Name, #3] <br>5. PROJECT[col:​Ship:​Type, #3] <br>6. PROJECT[col:​Ship:​Flag, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Built_Year, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Ship:​Name, #3] <br>5. PROJECT[col:​Ship:​Type, #3] <br>6. PROJECT[col:​Ship:​Flag, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6250 | Which flag is most widely used among all ships? | SELECT flag FROM ship GROUP BY flag ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Ship:​Flag] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Ship:​Flag] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6251 | Return the flag that is most common among all ships. | SELECT flag FROM ship GROUP BY flag ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Ship:​Flag] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Ship:​Flag] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6252 | List all ship names in the order of built year and class. | SELECT name FROM ship ORDER BY built_year ,  CLASS | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Built_Year, #1] <br>3. PROJECT[col:​Ship:​Class, #1] <br>4. PROJECT[col:​Ship:​Name, #1] <br>5. UNION[#2, #3] <br>6. SORT[#4, #5] <br> | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Built_Year, #1] <br>3. PROJECT[col:​Ship:​Class, #1] <br>4. PROJECT[col:​Ship:​Name, #1] <br>5. UNION[#2, #3] <br>6. SORT[#4, #5, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_6253 | What are the names of ships, ordered by year they were built and their class? | SELECT name FROM ship ORDER BY built_year ,  CLASS | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Name, #1] <br>3. PROJECT[col:​Ship:​Built_Year, #1] <br>4. PROJECT[col:​Ship:​Class, #1] <br>5. UNION[#3, #4] <br>6. SORT[#2, #5] <br> | 1. SELECT[tbl:​Ship] <br>2. PROJECT[col:​Ship:​Name, #1] <br>3. PROJECT[col:​Ship:​Built_Year, #1] <br>4. PROJECT[col:​Ship:​Class, #1] <br>5. UNION[#3, #4] <br>6. SORT[#2, #5, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_6256 | In which year were most of ships built? | SELECT built_year FROM ship GROUP BY built_year ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Ship:​Built_Year] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Ship:​Built_Year] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6257 | What is the year in which most ships were built? | SELECT built_year FROM ship GROUP BY built_year ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Ship:​Built_Year] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Ship:​Built_Year] <br>2. PROJECT[tbl:​Ship, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6258 | Find the name of the ships that have more than one captain. | SELECT t1.name FROM ship AS t1 JOIN captain AS t2 ON t1.ship_id  =  t2.ship_id GROUP BY t2.ship_id HAVING count(*)  >  1 | 1. SELECT[tbl:​Ship] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Ship:​Name, #4] <br> | 1. SELECT[tbl:​Ship] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Ship:​Name, #4] <br> | + | medium | 
  | SPIDER_train_6259 | What are the names of ships that have more than one captain? | SELECT t1.name FROM ship AS t1 JOIN captain AS t2 ON t1.ship_id  =  t2.ship_id GROUP BY t2.ship_id HAVING count(*)  >  1 | 1. SELECT[tbl:​Ship] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Ship:​Name, #4] <br> | 1. SELECT[tbl:​Ship] <br>2. PROJECT[tbl:​captain, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Ship:​Name, #4] <br> | + | medium | 
  | SPIDER_train_6266 | Find the name of the ships that are steered by both a captain with Midshipman rank and a captain with Lieutenant rank. | SELECT t1.name FROM ship AS t1 JOIN captain AS t2 ON t1.ship_id  =  t2.ship_id WHERE t2.rank  =  'Midshipman' INTERSECT SELECT t1.name FROM ship AS t1 JOIN captain AS t2 ON t1.ship_id  =  t2.ship_id WHERE t2.rank  =  'Lieutenant' | 1. SELECT[tbl:​Ship] <br>2. PROJECT[tbl:​captain, #1] <br>3. PROJECT[col:​captain:​Rank, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Ship:​Name, #6] <br> | 1. SELECT[tbl:​Ship] <br>2. PROJECT[tbl:​captain, #1] <br>3. PROJECT[col:​captain:​Rank, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Ship:​Name, #6] <br> | + | extra | 
  | SPIDER_train_6267 | What are the names of ships that are commanded by both captains with the rank of Midshipman and captains with the rank of Lieutenant? | SELECT t1.name FROM ship AS t1 JOIN captain AS t2 ON t1.ship_id  =  t2.ship_id WHERE t2.rank  =  'Midshipman' INTERSECT SELECT t1.name FROM ship AS t1 JOIN captain AS t2 ON t1.ship_id  =  t2.ship_id WHERE t2.rank  =  'Lieutenant' | 1. SELECT[col:​Ship:​Name] <br>2. PROJECT[tbl:​captain, #1] <br>3. PROJECT[col:​captain:​Rank, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>6. INTERSECTION[#1, #4, #5] <br> | 1. SELECT[col:​Ship:​Name] <br>2. PROJECT[tbl:​captain, #1] <br>3. PROJECT[col:​captain:​Rank, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Midshipman:​col:​captain:​Rank] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Lieutenant:​col:​captain:​Rank] <br>6. INTERSECTION[#1, #4, #5] <br> | + | extra | 
 ***
 Exec acc: **1.0000**
