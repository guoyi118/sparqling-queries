 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **railway** | Railway_ID | + |   | 
 | 2 |   | Railway |   |   | 
 | 3 |   | Builder |   |   | 
 | 4 |   | Built |   |   | 
 | 5 |   | Wheels |   |   | 
 | 6 |   | Location |   |   | 
 | 7 |   | ObjectNumber |   |   | 
 | 8 | **train** | Train_ID | + |   | 
 | 9 |   | Train_Num |   |   | 
 | 10 |   | Name |   |   | 
 | 11 |   | From |   |   | 
 | 12 |   | Arrival |   |   | 
 | 13 |   | Railway_ID |   | --> 1 | 
 | 14 | **manager** | Manager_ID | + |   | 
 | 15 |   | Name |   |   | 
 | 16 |   | Country |   |   | 
 | 17 |   | Working_year_starts |   |   | 
 | 18 |   | Age |   |   | 
 | 19 |   | Level |   |   | 
 | 20 | **railway_manage** | Railway_ID | + | --> 1 | 
 | 21 |   | Manager_ID |   | --> 14 | 
 | 22 |   | From_Year |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_5632 | How many railways are there? | SELECT count(*) FROM railway | 1. SELECT[tbl:​railway] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​railway] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_5633 | List the builders of railways in ascending alphabetical order. | SELECT Builder FROM railway ORDER BY Builder ASC | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Builder, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Builder, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_5634 | List the wheels and locations of the railways. | SELECT Wheels ,  LOCATION FROM railway | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Wheels, #1] <br>3. PROJECT[col:​railway:​Location, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Wheels, #1] <br>3. PROJECT[col:​railway:​Location, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_5635 | What is the maximum level of managers in countries that are not "Australia"? | SELECT max(LEVEL) FROM manager WHERE Country != "Australia	" | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Australia	:​col:​manager:​Country] <br>4. PROJECT[col:​manager:​Level, #3] <br>5. AGGREGATE[max, #4] <br> | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Australia:​col:​manager:​Country] <br>4. PROJECT[col:​manager:​Level, #3] <br>5. AGGREGATE[max, #4] <br> | - | easy | 
  | SPIDER_train_5636 | What is the average age for all managers? | SELECT avg(Age) FROM manager | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Age, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Age, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_5637 | What are the names of managers in ascending order of level? | SELECT Name FROM manager ORDER BY LEVEL ASC | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Name, #1] <br>3. PROJECT[col:​manager:​Level, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Name, #1] <br>3. PROJECT[col:​manager:​Level, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_5638 | What are the names and arrival times of trains? | SELECT Name ,  Arrival FROM train | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Name, #1] <br>3. PROJECT[col:​train:​Arrival, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Name, #1] <br>3. PROJECT[col:​train:​Arrival, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_5640 | Show the names of trains and locations of railways they are in. | SELECT T2.Name ,  T1.Location FROM railway AS T1 JOIN train AS T2 ON T1.Railway_ID  =  T2.Railway_ID | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Name, #1] <br>3. PROJECT[tbl:​railway, #1] <br>4. PROJECT[col:​railway:​Location, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Name, #1] <br>3. PROJECT[tbl:​railway, #1] <br>4. PROJECT[col:​railway:​Location, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_5641 | Show the builder of railways associated with the trains named "Andaman Exp". | SELECT T1.Builder FROM railway AS T1 JOIN train AS T2 ON T1.Railway_ID  =  T2.Railway_ID WHERE T2.Name  =  "Andaman Exp" | 1. SELECT[tbl:​train] <br>2. FILTER[#1, comparative:​=:​Andaman Exp:​col:​train:​Name] <br>3. PROJECT[tbl:​railway, #2] <br>4. PROJECT[col:​railway:​Builder, #3] <br> | 1. SELECT[tbl:​train] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Andaman Exp:​col:​train:​Name] <br>3. PROJECT[tbl:​railway, #2] <br>4. PROJECT[col:​railway:​Builder, #3] <br> | + | medium | 
  | SPIDER_train_5642 | Show id and location of railways that are associated with more than one train. | SELECT T2.Railway_ID ,  T1.Location FROM railway AS T1 JOIN train AS T2 ON T1.Railway_ID  =  T2.Railway_ID GROUP BY T2.Railway_ID HAVING COUNT(*)  >  1 | 1. SELECT[tbl:​railway] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​train:​Railway_ID, #4] <br>6. PROJECT[col:​railway:​Location, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​railway] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​train:​Railway_ID, #4] <br>6. PROJECT[col:​railway:​Location, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_5643 | Show the id and builder of the railway that are associated with the most trains. | SELECT T2.Railway_ID ,  T1.Builder FROM railway AS T1 JOIN train AS T2 ON T1.Railway_ID  =  T2.Railway_ID GROUP BY T2.Railway_ID ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[tbl:​railway] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​train:​Railway_ID, #4] <br>6. PROJECT[col:​railway:​Builder, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​railway] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​train:​Railway_ID, #4] <br>6. PROJECT[col:​railway:​Builder, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_5644 | Show different builders of railways, along with the corresponding number of railways using each builder. | SELECT Builder ,  COUNT(*) FROM railway GROUP BY Builder | 1. SELECT[col:​railway:​Builder] <br>2.*(distinct)* PROJECT[different #REF, #1] <br>3. PROJECT[tbl:​railway, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​railway:​Builder] <br>2.*(distinct)* PROJECT[None, #1] <br>3. PROJECT[tbl:​railway, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_5645 | Show the most common builder of railways. | SELECT Builder FROM railway GROUP BY Builder ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Builder, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Builder, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | + | hard | 
  | SPIDER_train_5646 | Show different locations of railways along with the corresponding number of railways at each location. | SELECT LOCATION ,  COUNT(*) FROM railway GROUP BY LOCATION | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Location, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​railway] <br>2. PROJECT[col:​railway:​Location, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_5647 | Show the locations that have more than one railways. | SELECT LOCATION FROM railway GROUP BY LOCATION HAVING COUNT(*)  >  1 | 1. SELECT[col:​railway:​Location] <br>2. PROJECT[tbl:​railway, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br> | 1. SELECT[col:​railway:​Location] <br>2. PROJECT[tbl:​railway, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br> | + | easy | 
  | SPIDER_train_5649 | Show the countries that have both managers of age above 50 and managers of age below 46. | SELECT Country FROM manager WHERE Age  >  50 INTERSECT SELECT Country FROM manager WHERE Age  <  46 | 1. SELECT[tbl:​manager] <br>2. PROJECT[tbl:​manager, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​50:​col:​manager:​Age] <br>4. COMPARATIVE[#1, #2, comparative:​<:​46:​col:​manager:​Age] <br>5. PROJECT[col:​manager:​Country, #3] <br>6. PROJECT[col:​manager:​Country, #4] <br>7. PROJECT[col:​manager:​Country, #1] <br>8. INTERSECTION[#7, #5, #6] <br> | 1. SELECT[tbl:​manager] <br>2. PROJECT[tbl:​manager, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​50:​col:​manager:​Age] <br>4. COMPARATIVE[#1, #2, comparative:​<:​46:​col:​manager:​Age] <br>5. PROJECT[col:​manager:​Country, #3] <br>6. PROJECT[col:​manager:​Country, #4] <br>7. PROJECT[col:​manager:​Country, #1] <br>8. INTERSECTION[#7, #5, #6] <br> | + | hard | 
  | SPIDER_train_5650 | Show the distinct countries of managers. | SELECT DISTINCT Country FROM manager | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Country, #1] <br>3.*(distinct)* PROJECT[the distinct #REF, #2] <br> | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Country, #1] <br>3.*(distinct)* PROJECT[None, #2] <br> | + | easy | 
  | SPIDER_train_5651 | Show the working years of managers in descending order of their level. | SELECT Working_year_starts FROM manager ORDER BY LEVEL DESC | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Working_year_starts, #1] <br>3. PROJECT[col:​manager:​Level, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​manager] <br>2. PROJECT[col:​manager:​Working_year_starts, #1] <br>3. PROJECT[col:​manager:​Level, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
 ***
 Exec acc: **0.9444**
