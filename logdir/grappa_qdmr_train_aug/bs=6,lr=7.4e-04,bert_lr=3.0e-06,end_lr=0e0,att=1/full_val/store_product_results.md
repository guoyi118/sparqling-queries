 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **product** | product_id | + |   | 
 | 2 |   | product |   |   | 
 | 3 |   | dimensions |   |   | 
 | 4 |   | dpi |   |   | 
 | 5 |   | pages_per_minute_color |   |   | 
 | 6 |   | max_page_size |   |   | 
 | 7 |   | interface |   |   | 
 | 8 | **store** | Store_ID | + | --> 21 | 
 | 9 |   | Store_Name |   |   | 
 | 10 |   | Type |   |   | 
 | 11 |   | Area_size |   |   | 
 | 12 |   | Number_of_product_category |   |   | 
 | 13 |   | Ranking |   |   | 
 | 14 | **district** | District_ID | + | --> 22 | 
 | 15 |   | District_name |   |   | 
 | 16 |   | Headquartered_City |   |   | 
 | 17 |   | City_Population |   |   | 
 | 18 |   | City_Area |   |   | 
 | 19 | **store_product** | Store_ID | + |   | 
 | 20 |   | Product_ID |   | --> 1 | 
 | 21 | **store_district** | Store_ID | + |   | 
 | 22 |   | District_ID |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_4900 | Find all the distinct district names ordered by city area in descending. | SELECT DISTINCT District_name FROM district ORDER BY city_area DESC | 1. SELECT[tbl:​district] <br>2.*(distinct)* PROJECT[col:​district:​District_name, #1] <br>3. PROJECT[col:​district:​City_Area, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​district] <br>2.*(distinct)* PROJECT[col:​district:​District_name, #1] <br>3. PROJECT[col:​district:​City_Area, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_4901 | What are the different district names in order of descending city area? | SELECT DISTINCT District_name FROM district ORDER BY city_area DESC | 1. SELECT[tbl:​district] <br>2.*(distinct)* PROJECT[col:​district:​District_name, #1] <br>3. PROJECT[col:​district:​City_Area, #2] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​district] <br>2.*(distinct)* PROJECT[col:​district:​District_name, #1] <br>3. PROJECT[col:​district:​City_Area, #2] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_4902 | Find the list of page size which have more than 3 product listed | SELECT max_page_size FROM product GROUP BY max_page_size HAVING count(*)  >  3 | 1. SELECT[col:​product:​max_page_size] <br>2. PROJECT[tbl:​product, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br> | 1. SELECT[col:​product:​max_page_size] <br>2. PROJECT[tbl:​product, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br> | + | easy | 
  | SPIDER_train_4903 | What is the maximum page size for everything that has more than 3 products listed? | SELECT max_page_size FROM product GROUP BY max_page_size HAVING count(*)  >  3 | 1. SELECT[col:​product:​max_page_size] <br>2. SELECT[tbl:​product] <br>3. PROJECT[col:​product:​max_page_size, #2] <br>4. GROUP[count, #2, #3] <br>5. COMPARATIVE[#1, #4, comparative:​>:​3] <br>6. PROJECT[col:​product:​max_page_size, #5] <br>7. AGGREGATE[max, #6] <br> | 1. SELECT[col:​product:​max_page_size] <br>2. SELECT[tbl:​product] <br>3. PROJECT[col:​product:​max_page_size, #2] <br>4. GROUP[count, #2, #3] <br>5. COMPARATIVE[#1, #4, comparative:​>:​3] <br>6. PROJECT[col:​product:​max_page_size, #5] <br>7. AGGREGATE[max, #6] <br> | + | easy | 
  | SPIDER_train_4904 | Find the name and population of district with population between 200000 and 2000000 | SELECT District_name ,  City_Population FROM district WHERE City_Population BETWEEN 200000 AND 2000000 | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​2000000:​col:​district:​City_Population] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​200000:​col:​district:​City_Population] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​district:​District_name, #5] <br>7. PROJECT[col:​district:​City_Population, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​2000000:​col:​district:​City_Population] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​200000:​col:​district:​City_Population] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​district:​District_name, #5] <br>7. PROJECT[col:​district:​City_Population, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_4906 | Find the name all districts with city area greater than 10 or population larger than 100000 | SELECT district_name FROM district WHERE city_area  >  10 OR City_Population  >  100000 | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100000:​col:​district:​City_Population] <br>4. PROJECT[col:​district:​City_Population, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>:​10:​col:​district:​City_Area] <br>6. UNION[#3, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100000:​col:​district:​City_Population] <br>4. PROJECT[col:​district:​City_Population, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>:​10:​col:​district:​City_Area] <br>6. UNION[#3, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | + | medium | 
  | SPIDER_train_4907 | What are the names of all districts with a city area greater than 10 or have more than 100000 people living there? | SELECT district_name FROM district WHERE city_area  >  10 OR City_Population  >  100000 | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. PROJECT[col:​district:​City_Population, #1] <br>4. COMPARATIVE[#1, #2, comparative:​>:​100000:​col:​district:​City_Population] <br>5. COMPARATIVE[#1, #3, comparative:​>:​10:​col:​district:​City_Area] <br>6. UNION[#4, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. PROJECT[col:​district:​City_Population, #1] <br>4. COMPARATIVE[#1, #2, comparative:​>:​100000:​col:​district:​City_Population] <br>5. COMPARATIVE[#1, #3, comparative:​>:​10:​col:​district:​City_Area] <br>6. UNION[#4, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | + | medium | 
  | SPIDER_train_4908 | Which district has the largest population? | SELECT district_name FROM district ORDER BY city_population DESC LIMIT 1 | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br> | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br> | + | medium | 
  | SPIDER_train_4909 | What is the name of the district with the most residents? | SELECT district_name FROM district ORDER BY city_population DESC LIMIT 1 | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. GROUP[col:​district:​City_Population, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​district:​District_name, #4] <br> | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​district:​District_name, #4] <br> | + | medium | 
  | SPIDER_train_4910 | Which district has the least area? | SELECT district_name FROM district ORDER BY city_area ASC LIMIT 1 | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br> | 1. SELECT[col:​district:​District_name] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br> | + | medium | 
  | SPIDER_train_4911 | What is the name of the district with the smallest area? | SELECT district_name FROM district ORDER BY city_area ASC LIMIT 1 | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​district:​District_name, #3] <br> | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​district:​District_name, #3] <br> | + | medium | 
  | SPIDER_train_4915 | For each type of store, how many of them are there? | SELECT TYPE ,  count(*) FROM store GROUP BY TYPE | 1. SELECT[col:​store:​Type] <br>2. PROJECT[tbl:​store, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​store:​Type] <br>2. PROJECT[tbl:​store, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_4916 | Find the names of all stores in Khanewal District. | SELECT t1.store_name FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t3.district_name  =  "Khanewal District" | 1. SELECT[tbl:​store_district] <br>2. FILTER[#1, comparative:​=:​Khanewal District:​col:​district:​District_name] <br>3. PROJECT[col:​store:​Store_Name, #2] <br> | 1. SELECT[tbl:​store_district] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Khanewal District:​col:​district:​District_name] <br>3. PROJECT[col:​store:​Store_Name, #2] <br> | + | hard | 
  | SPIDER_train_4917 | What are the names of all the stores located in Khanewal District? | SELECT t1.store_name FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t3.district_name  =  "Khanewal District" | 1. SELECT[tbl:​store_district] <br>2. PROJECT[tbl:​store_district, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Khanewal District:​col:​district:​District_name] <br>4. PROJECT[col:​store:​Store_Name, #3] <br> | 1. SELECT[tbl:​store_district] <br>2. PROJECT[tbl:​store_district, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Khanewal District:​col:​district:​District_name] <br>4. PROJECT[col:​store:​Store_Name, #3] <br> | + | hard | 
  | SPIDER_train_4918 | Find all the stores in the district with the most population. | SELECT t1.store_name FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id WHERE district_id  =  (SELECT district_id FROM district ORDER BY city_population DESC LIMIT 1) | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​store:​Store_Name, #3] <br> | 1. SELECT[tbl:​district] <br>2. PROJECT[col:​district:​City_Population, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​store:​Store_Name, #3] <br> | + | extra | 
  | SPIDER_train_4920 | Which city is the headquarter of the store named "Blackville" in? | SELECT t3.headquartered_city FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t1.store_name  =  "Blackville" | 1. SELECT[tbl:​store_district] <br>2. FILTER[#1, comparative:​=:​Blackville:​col:​store:​Store_Name] <br>3. PROJECT[col:​district:​Headquartered_City, #2] <br>4. PROJECT[col:​district:​Headquartered_City, #3] <br> | 1. SELECT[tbl:​store_district] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Blackville:​col:​store:​Store_Name] <br>3. PROJECT[col:​district:​Headquartered_City, #2] <br>4. PROJECT[col:​district:​Headquartered_City, #3] <br> | + | hard | 
  | SPIDER_train_4921 | What city is the headquarter of the store Blackville? | SELECT t3.headquartered_city FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t1.store_name  =  "Blackville" | 1. SELECT[val:​store:​Store_Name:​Blackville] <br>2. PROJECT[col:​district:​Headquartered_City, #1] <br>3. PROJECT[col:​district:​Headquartered_City, #2] <br> | 1. SELECT[val:​store:​Store_Name:​Blackville] <br>2. PROJECT[col:​district:​Headquartered_City, #1] <br>3. PROJECT[col:​district:​Headquartered_City, #2] <br> | + | hard | 
  | SPIDER_train_4922 | Find the number of stores in each city. | SELECT t3.headquartered_city ,  count(*) FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id GROUP BY t3.headquartered_city | 1. SELECT[col:​district:​Headquartered_City] <br>2. PROJECT[tbl:​store_district, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​district:​Headquartered_City] <br>2. PROJECT[tbl:​store_district, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | hard | 
  | SPIDER_train_4923 | How many stores are headquarted in each city? | SELECT t3.headquartered_city ,  count(*) FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id GROUP BY t3.headquartered_city | 1. SELECT[col:​district:​Headquartered_City] <br>2. PROJECT[tbl:​store_district, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​district:​Headquartered_City] <br>2. PROJECT[tbl:​store_district, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | hard | 
  | SPIDER_train_4924 | Find the city with the most number of stores. | SELECT t3.headquartered_city FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id GROUP BY t3.headquartered_city ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​district:​Headquartered_City] <br>2. PROJECT[tbl:​store_district, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​district:​Headquartered_City] <br>2. PROJECT[tbl:​store_district, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_4927 | What is the average number of pages per minute color? | SELECT avg(pages_per_minute_color) FROM product | 1. SELECT[col:​product:​pages_per_minute_color] <br>2. AGGREGATE[col:​product:​pages_per_minute_color, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[col:​product:​pages_per_minute_color] <br>2. AGGREGATE[sum, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_4928 | What products are available at store named "Miramichi"? | SELECT t1.product FROM product AS t1 JOIN store_product AS t2 ON t1.product_id  =  t2.product_id JOIN store AS t3 ON t2.store_id  =  t3.store_id WHERE t3.store_name  =  "Miramichi" | 1. SELECT[tbl:​store_product] <br>2. FILTER[#1, comparative:​=:​Miramichi:​col:​store:​Store_Name] <br>3. PROJECT[col:​product:​product, #2] <br> | 1. SELECT[tbl:​store_product] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Miramichi:​col:​store:​Store_Name] <br>3. PROJECT[col:​product:​product, #2] <br> | + | hard | 
  | SPIDER_train_4929 | What products are sold at the store named Miramichi? | SELECT t1.product FROM product AS t1 JOIN store_product AS t2 ON t1.product_id  =  t2.product_id JOIN store AS t3 ON t2.store_id  =  t3.store_id WHERE t3.store_name  =  "Miramichi" | 1. SELECT[tbl:​store_product] <br>2. FILTER[#1, comparative:​=:​Miramichi:​col:​store:​Store_Name] <br>3. PROJECT[col:​product:​product, #2] <br> | 1. SELECT[tbl:​store_product] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Miramichi:​col:​store:​Store_Name] <br>3. PROJECT[col:​product:​product, #2] <br> | + | hard | 
  | SPIDER_train_4930 | Find products with max page size as "A4" and pages per minute color smaller than 5. | SELECT product FROM product WHERE max_page_size  =  "A4" AND pages_per_minute_color  <  5 | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​pages_per_minute_color, #1] <br>3. PROJECT[col:​product:​pages_per_minute_color, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​A4:​col:​product:​max_page_size] <br>5. COMPARATIVE[#1, #3, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br>6. INTERSECTION[#1, #4, #5] <br> | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​pages_per_minute_color, #1] <br>3. PROJECT[col:​product:​pages_per_minute_color, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​A4:​col:​product:​max_page_size] <br>5. COMPARATIVE[#1, #3, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br>6. INTERSECTION[#1, #4, #5] <br> | + | medium | 
  | SPIDER_train_4931 | What are the products with the maximum page size A4 that also have a pages per minute color smaller than 5? | SELECT product FROM product WHERE max_page_size  =  "A4" AND pages_per_minute_color  <  5 | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​pages_per_minute_color, #1] <br>3. GROUP[col:​product:​pages_per_minute_color, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​A4:​col:​product:​max_page_size] <br>5. PROJECT[col:​product:​pages_per_minute_color, #4] <br>6. COMPARATIVE[#4, #5, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br> | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​pages_per_minute_color, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​A4:​col:​product:​max_page_size] <br>5. PROJECT[col:​product:​pages_per_minute_color, #4] <br>6. COMPARATIVE[#4, #5, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br> | + | medium | 
  | SPIDER_train_4932 | Find products with max page size as "A4" or pages per minute color smaller than 5. | SELECT product FROM product WHERE max_page_size  =  "A4" OR pages_per_minute_color  <  5 | 1. SELECT[col:​product:​product] <br>2. FILTER[#1, comparative:​=:​A4:​col:​product:​max_page_size] <br>3. FILTER[#1, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br>4. UNION[#2, #3] <br> | 1. SELECT[col:​product:​product] <br>2. COMPARATIVE[#1, #1, comparative:​=:​A4:​col:​product:​max_page_size] <br>3. COMPARATIVE[#1, #1, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_4933 | What are the products with the maximum page size eqal to A4 or a pages per minute color less than 5? | SELECT product FROM product WHERE max_page_size  =  "A4" OR pages_per_minute_color  <  5 | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​pages_per_minute_color, #1] <br>3. GROUP[col:​product:​pages_per_minute_color, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​A4:​col:​product:​max_page_size] <br>5. PROJECT[col:​product:​pages_per_minute_color, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br>7. UNION[#4, #6] <br> | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​pages_per_minute_color, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​A4:​col:​product:​max_page_size] <br>5. PROJECT[col:​product:​pages_per_minute_color, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​5:​col:​product:​pages_per_minute_color] <br>7. UNION[#4, #6] <br> | + | medium | 
  | SPIDER_train_4934 | Find all the product whose name contains the word "Scanner". | SELECT product FROM product WHERE product LIKE "%Scanner%" | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​product, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Scanner%:​col:​product:​product] <br> | 1. SELECT[col:​product:​product] <br>2. PROJECT[col:​product:​product, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Scanner:​col:​product:​product] <br> | + | medium | 
  | SPIDER_train_4935 | What are all of the products whose name includes the substring "Scanner"? | SELECT product FROM product WHERE product LIKE "%Scanner%" | 1. SELECT[col:​product:​product] <br>2. FILTER[#1, comparative:​like:​%Scanner%:​col:​product:​product] <br> | 1. SELECT[col:​product:​product] <br>2. COMPARATIVE[#1, #1, comparative:​like:​Scanner:​col:​product:​product] <br> | + | medium | 
  | SPIDER_train_4936 | Find the most prominent max page size among all the products. | SELECT max_page_size FROM product GROUP BY max_page_size ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​product] <br>2. PROJECT[col:​product:​max_page_size, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​max:​None] <br> | 1. SELECT[tbl:​product] <br>2. PROJECT[col:​product:​max_page_size, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | + | hard | 
  | SPIDER_train_4941 | What is the total population for all the districts that have an area larger tahn the average city area? | SELECT sum(city_population) FROM district WHERE city_area  >  (SELECT avg(city_area) FROM district) | 1. SELECT[col:​district:​City_Population] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. AGGREGATE[avg, #2] <br>4. SELECT[tbl:​district] <br>5. PROJECT[col:​district:​City_Area, #4] <br>6. COMPARATIVE[#4, #5, comparative:​>:​#3] <br>7. PROJECT[col:​district:​City_Population, #6] <br>8. AGGREGATE[sum, #7] <br> | 1. SELECT[col:​district:​City_Population] <br>2. PROJECT[col:​district:​City_Area, #1] <br>3. AGGREGATE[avg, #2] <br>4. SELECT[tbl:​district] <br>5. PROJECT[col:​district:​City_Area, #4] <br>6. COMPARATIVE[#4, #5, comparative:​>:​City Mall:​col:​store:​Type] <br>7. PROJECT[col:​district:​City_Population, #6] <br>8. AGGREGATE[sum, #7] <br> | - | hard | 
  | SPIDER_train_4942 | Find the names of districts where have both city mall and village store type stores. | SELECT t3.District_name FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t1.Type  =  "City Mall" INTERSECT SELECT t3.District_name FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t1.Type  =  "Village Store" | 1. SELECT[tbl:​district] <br>2. PROJECT[tbl:​store_district, #1] <br>3. PROJECT[col:​store:​Type, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​City Mall:​col:​store:​Type] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Village Store:​col:​store:​Type] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | 1. SELECT[tbl:​district] <br>2. PROJECT[tbl:​store_district, #1] <br>3. PROJECT[col:​store:​Type, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​City Mall:​col:​store:​Type] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Village Store:​col:​store:​Type] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | + | extra | 
  | SPIDER_train_4943 | What are the names of the districts that have both mall and village store style shops? | SELECT t3.District_name FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t1.Type  =  "City Mall" INTERSECT SELECT t3.District_name FROM store AS t1 JOIN store_district AS t2 ON t1.store_id  =  t2.store_id JOIN district AS t3 ON t2.district_id  =  t3.district_id WHERE t1.Type  =  "Village Store" | 1. SELECT[tbl:​district] <br>2. PROJECT[shops of #REF, #1] <br>3. PROJECT[styles of #REF, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​City Mall:​col:​store:​Type] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Village Store:​col:​store:​Type] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | 1. SELECT[tbl:​district] <br>2. PROJECT[None, #1] <br>3. PROJECT[None, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​City Mall:​col:​store:​Type] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Village Store:​col:​store:​Type] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​district:​District_name, #6] <br> | + | extra | 
 ***
 Exec acc: **0.9697**
