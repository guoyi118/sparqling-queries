 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Third_Party_Companies** | company_id | + |   | 
 | 2 |   | company_type |   |   | 
 | 3 |   | company_name |   |   | 
 | 4 |   | company_address |   |   | 
 | 5 |   | other_company_details |   |   | 
 | 6 | **Maintenance_Contracts** | maintenance_contract_id | + |   | 
 | 7 |   | maintenance_contract_company_id |   | --> 1 | 
 | 8 |   | contract_start_date |   |   | 
 | 9 |   | contract_end_date |   |   | 
 | 10 |   | other_contract_details |   |   | 
 | 11 | **Parts** | part_id | + |   | 
 | 12 |   | part_name |   |   | 
 | 13 |   | chargeable_yn |   |   | 
 | 14 |   | chargeable_amount |   |   | 
 | 15 |   | other_part_details |   |   | 
 | 16 | **Skills** | skill_id | + |   | 
 | 17 |   | skill_code |   |   | 
 | 18 |   | skill_description |   |   | 
 | 19 | **Staff** | staff_id | + |   | 
 | 20 |   | staff_name |   |   | 
 | 21 |   | gender |   |   | 
 | 22 |   | other_staff_details |   |   | 
 | 23 | **Assets** | asset_id | + |   | 
 | 24 |   | maintenance_contract_id |   | --> 6 | 
 | 25 |   | supplier_company_id |   | --> 1 | 
 | 26 |   | asset_details |   |   | 
 | 27 |   | asset_make |   |   | 
 | 28 |   | asset_model |   |   | 
 | 29 |   | asset_acquired_date |   |   | 
 | 30 |   | asset_disposed_date |   |   | 
 | 31 |   | other_asset_details |   |   | 
 | 32 | **Asset_Parts** | asset_id |   | --> 23 | 
 | 33 |   | part_id |   | --> 11 | 
 | 34 | **Maintenance_Engineers** | engineer_id | + |   | 
 | 35 |   | company_id |   | --> 1 | 
 | 36 |   | first_name |   |   | 
 | 37 |   | last_name |   |   | 
 | 38 |   | other_details |   |   | 
 | 39 | **Engineer_Skills** | engineer_id |   | --> 34 | 
 | 40 |   | skill_id |   | --> 16 | 
 | 41 | **Fault_Log** | fault_log_entry_id | + |   | 
 | 42 |   | asset_id |   | --> 23 | 
 | 43 |   | recorded_by_staff_id |   | --> 19 | 
 | 44 |   | fault_log_entry_datetime |   |   | 
 | 45 |   | fault_description |   |   | 
 | 46 |   | other_fault_details |   |   | 
 | 47 | **Engineer_Visits** | engineer_visit_id | + |   | 
 | 48 |   | contact_staff_id |   | --> 19 | 
 | 49 |   | engineer_id |   | --> 34 | 
 | 50 |   | fault_log_entry_id |   | --> 41 | 
 | 51 |   | fault_status |   |   | 
 | 52 |   | visit_start_datetime |   |   | 
 | 53 |   | visit_end_datetime |   |   | 
 | 54 |   | other_visit_details |   |   | 
 | 55 | **Part_Faults** | part_fault_id | + |   | 
 | 56 |   | part_id |   | --> 11 | 
 | 57 |   | fault_short_name |   |   | 
 | 58 |   | fault_description |   |   | 
 | 59 |   | other_fault_details |   |   | 
 | 60 | **Fault_Log_Parts** | fault_log_entry_id |   | --> 41 | 
 | 61 |   | part_fault_id |   | --> 55 | 
 | 62 |   | fault_status |   |   | 
 | 63 | **Skills_Required_To_Fix** | part_fault_id |   | --> 55 | 
 | 64 |   | skill_id |   | --> 16 | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3126 | Which assets have 2 parts and have less than 2 fault logs? List the asset id and detail. | SELECT T1.asset_id ,  T1.asset_details FROM Assets AS T1 JOIN Asset_Parts AS T2 ON T1.asset_id  =  T2.asset_id GROUP BY T1.asset_id HAVING count(*)  =  2 INTERSECT SELECT T1.asset_id ,  T1.asset_details FROM Assets AS T1 JOIN Fault_Log AS T2 ON T1.asset_id  =  T2.asset_id GROUP BY T1.asset_id HAVING count(*)  <  2 | 1. SELECT[tbl:​Assets] <br>2. PROJECT[tbl:​Asset_Parts, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​2] <br>5. PROJECT[tbl:​Fault_Log, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​<:​2] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​Assets:​asset_id, #8] <br>10. PROJECT[col:​Assets:​asset_details, #8] <br>11. UNION[#9, #10] <br> | 1. SELECT[tbl:​Assets] <br>2. PROJECT[tbl:​Asset_Parts, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​2] <br>5. PROJECT[tbl:​Fault_Log, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​<:​2] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​Assets:​asset_id, #8] <br>10. PROJECT[col:​Assets:​asset_details, #8] <br>11. UNION[#9, #10] <br> | + | extra | 
  | SPIDER_train_3127 | How many assets does each maintenance contract contain? List the number and the contract id. | SELECT count(*) ,  T1.maintenance_contract_id FROM Maintenance_Contracts AS T1 JOIN Assets AS T2 ON T1.maintenance_contract_id  =  T2.maintenance_contract_id GROUP BY T1.maintenance_contract_id | 1. SELECT[col:​Maintenance_Contracts:​maintenance_contract_id] <br>2. PROJECT[tbl:​Assets, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Maintenance_Contracts:​maintenance_contract_id, #1] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​Maintenance_Contracts:​maintenance_contract_id] <br>2. PROJECT[tbl:​Assets, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Maintenance_Contracts:​maintenance_contract_id, #1] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3128 | How many assets does each third party company supply? List the count and the company id. | SELECT count(*) ,  T1.company_id FROM Third_Party_Companies AS T1 JOIN Assets AS T2 ON T1.company_id  =  T2.supplier_company_id GROUP BY T1.company_id | 1. SELECT[col:​Third_Party_Companies:​company_id] <br>2. PROJECT[tbl:​Assets, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Third_Party_Companies:​company_id, #1] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​Third_Party_Companies:​company_id] <br>2. PROJECT[tbl:​Assets, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Third_Party_Companies:​company_id, #1] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3129 | Which third party companies have at least 2 maintenance engineers or have at least 2 maintenance contracts? List the company id and name. | SELECT T1.company_id ,  T1.company_name FROM Third_Party_Companies AS T1 JOIN Maintenance_Engineers AS T2 ON T1.company_id  =  T2.company_id GROUP BY T1.company_id HAVING count(*)  >=  2 UNION SELECT T3.company_id ,  T3.company_name FROM Third_Party_Companies AS T3 JOIN Maintenance_Contracts AS T4 ON T3.company_id  =  T4.maintenance_contract_company_id GROUP BY T3.company_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​Third_Party_Companies] <br>2. PROJECT[tbl:​Maintenance_Engineers, #1] <br>3. PROJECT[tbl:​Maintenance_Contracts, #1] <br>4. GROUP[count, #2, #1] <br>5. GROUP[count, #3, #1] <br>6. COMPARATIVE[#1, #4, comparative:​>=:​2] <br>7. COMPARATIVE[#1, #5, comparative:​>=:​2] <br>8. UNION[#6, #7] <br>9. PROJECT[col:​Third_Party_Companies:​company_id, #8] <br>10. PROJECT[col:​Third_Party_Companies:​company_name, #8] <br>11. UNION[#9, #10] <br> | 1. SELECT[tbl:​Third_Party_Companies] <br>2. PROJECT[tbl:​Maintenance_Engineers, #1] <br>3. PROJECT[tbl:​Maintenance_Contracts, #1] <br>4. GROUP[count, #2, #1] <br>5. GROUP[count, #3, #1] <br>6. COMPARATIVE[#1, #4, comparative:​>=:​2] <br>7. COMPARATIVE[#1, #5, comparative:​>=:​2] <br>8. UNION[#6, #7] <br>9. PROJECT[col:​Third_Party_Companies:​company_id, #8] <br>10. PROJECT[col:​Third_Party_Companies:​company_name, #8] <br>11. UNION[#9, #10] <br> | + | extra | 
  | SPIDER_train_3130 | What is the name and id of the staff who recorded the fault log but has not contacted any visiting engineers? | SELECT T1.staff_name ,  T1.staff_id FROM Staff AS T1 JOIN Fault_Log AS T2 ON T1.staff_id  =  T2.recorded_by_staff_id EXCEPT SELECT T3.staff_name ,  T3.staff_id FROM Staff AS T3 JOIN Engineer_Visits AS T4 ON T3.staff_id  =  T4.contact_staff_id | 1. SELECT[tbl:​Staff] <br>2. FILTER[#1, tbl:​Fault_Log] <br>3. FILTER[#1, tbl:​Engineer_Visits] <br>4. DISCARD[#1, #3] <br>5. INTERSECTION[#1, #2, #4] <br>6. PROJECT[col:​Staff:​staff_name, #5] <br>7. PROJECT[col:​Staff:​staff_id, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Staff] <br>2. COMPARATIVE[#1, #1, tbl:​Fault_Log] <br>3. COMPARATIVE[#1, #1, tbl:​Engineer_Visits] <br>4. DISCARD[#1, #3] <br>5. INTERSECTION[#1, #2, #4] <br>6. PROJECT[col:​Staff:​staff_name, #5] <br>7. PROJECT[col:​Staff:​staff_id, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_3132 | Which parts have more than 2 faults? Show the part name and id. | SELECT T1.part_name ,  T1.part_id FROM Parts AS T1 JOIN Part_Faults AS T2 ON T1.part_id  =  T2.part_id GROUP BY T1.part_id HAVING count(*)  >  2 | 1. SELECT[tbl:​Parts] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Parts:​part_name, #4] <br>6. PROJECT[col:​Parts:​part_id, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Parts] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Parts:​part_name, #4] <br>6. PROJECT[col:​Parts:​part_id, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_3134 | For all the faults of different parts, what are all the decriptions of the skills required to fix them? List the name of the faults and the skill description. | SELECT T1.fault_short_name ,  T3.skill_description FROM Part_Faults AS T1 JOIN Skills_Required_To_Fix AS T2 ON T1.part_fault_id  =  T2.part_fault_id JOIN Skills AS T3 ON T2.skill_id  =  T3.skill_id | 1. SELECT[tbl:​Part_Faults] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. PROJECT[col:​Part_Faults:​fault_short_name, #2] <br>4. PROJECT[tbl:​Skills_Required_To_Fix, #2] <br>5. PROJECT[col:​Skills:​skill_description, #4] <br>6. UNION[#3, #5] <br> | 1. SELECT[tbl:​Part_Faults] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. PROJECT[col:​Part_Faults:​fault_short_name, #2] <br>4. PROJECT[tbl:​Skills_Required_To_Fix, #2] <br>5. PROJECT[col:​Skills:​skill_description, #4] <br>6. UNION[#3, #5] <br> | + | medium | 
  | SPIDER_train_3135 | How many assets can each parts be used in? List the part name and the number. | SELECT T1.part_name ,  count(*) FROM Parts AS T1 JOIN Asset_Parts AS T2 ON T1.part_id  =  T2.part_id GROUP BY T1.part_name | 1. SELECT[col:​Parts:​part_name] <br>2. PROJECT[tbl:​Asset_Parts, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Parts:​part_name, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[col:​Parts:​part_name] <br>2. PROJECT[tbl:​Asset_Parts, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Parts:​part_name, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_3136 | What are all the fault descriptions and the fault status of all the faults recoreded in the logs? | SELECT T1.fault_description ,  T2.fault_status FROM Fault_Log AS T1 JOIN Fault_Log_Parts AS T2 ON T1.fault_log_entry_id  =  T2.fault_log_entry_id | 1. SELECT[tbl:​Fault_Log] <br>2. PROJECT[tbl:​Fault_Log, #1] <br>3. PROJECT[col:​Fault_Log:​fault_description, #2] <br>4. PROJECT[col:​Fault_Log_Parts:​fault_status, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Fault_Log] <br>2. PROJECT[tbl:​Fault_Log, #1] <br>3. PROJECT[col:​Fault_Log:​fault_description, #2] <br>4. PROJECT[col:​Fault_Log_Parts:​fault_status, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3138 | What are all the distinct last names of all the engineers? | SELECT DISTINCT last_name FROM Maintenance_Engineers | 1. SELECT[tbl:​Maintenance_Engineers] <br>2. PROJECT[col:​Maintenance_Engineers:​last_name, #1] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br> | 1. SELECT[tbl:​Maintenance_Engineers] <br>2. PROJECT[col:​Maintenance_Engineers:​last_name, #1] <br>3.*(distinct)* PROJECT[None, #2] <br> | + | easy | 
  | SPIDER_train_3139 | How many fault status codes are recorded in the fault log parts table? | SELECT DISTINCT fault_status FROM Fault_Log_Parts | 1. SELECT[col:​Fault_Log_Parts:​fault_status] <br>2. PROJECT[col:​Fault_Log_Parts:​fault_status, #1] <br>3. AGGREGATE[col:​Fault_Log_Parts:​fault_status, #2] <br> | 1. SELECT[col:​Fault_Log_Parts:​fault_status] <br>2. PROJECT[col:​Fault_Log_Parts:​fault_status, #1] <br>3. AGGREGATE[sum, #2] <br> | + | easy | 
  | SPIDER_train_3140 | Which engineers have never visited to maintain the assets? List the engineer first name and last name. | SELECT first_name ,  last_name FROM Maintenance_Engineers WHERE engineer_id NOT IN (SELECT engineer_id FROM Engineer_Visits) | 1. SELECT[tbl:​Maintenance_Engineers] <br>2. FILTER[#1, tbl:​Engineer_Visits] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Maintenance_Engineers:​first_name, #3] <br>5. PROJECT[col:​Maintenance_Engineers:​last_name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Maintenance_Engineers] <br>2. COMPARATIVE[#1, #1, tbl:​Engineer_Visits] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Maintenance_Engineers:​first_name, #3] <br>5. PROJECT[col:​Maintenance_Engineers:​last_name, #3] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_3141 | List the asset id, details, make and model for every asset. | SELECT asset_id ,  asset_details ,  asset_make ,  asset_model FROM Assets | 1. SELECT[tbl:​Assets] <br>2. PROJECT[col:​Assets:​asset_id, #1] <br>3. PROJECT[col:​Assets:​asset_details, #1] <br>4. PROJECT[col:​Assets:​asset_make, #1] <br>5. PROJECT[col:​Assets:​asset_model, #1] <br>6. UNION[#2, #3, #4, #5] <br> | 1. SELECT[tbl:​Assets] <br>2. PROJECT[col:​Assets:​asset_id, #1] <br>3. PROJECT[col:​Assets:​asset_details, #1] <br>4. PROJECT[col:​Assets:​asset_make, #1] <br>5. PROJECT[col:​Assets:​asset_model, #1] <br>6. UNION[#2, #3, #4, #5] <br> | + | medium | 
  | SPIDER_train_3143 | Which part fault requires the most number of skills to fix? List part id and name. | SELECT T1.part_id ,  T1.part_name FROM Parts AS T1 JOIN Part_Faults AS T2 ON T1.part_id  =  T2.part_id JOIN Skills_Required_To_Fix AS T3 ON T2.part_fault_id  =  T3.part_fault_id GROUP BY T1.part_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​Parts] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. PROJECT[tbl:​Skills_Required_To_Fix, #2] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​Parts:​part_name, #5] <br>7. PROJECT[col:​Parts:​part_id, #5] <br>8. UNION[#7, #6] <br> | 1. SELECT[tbl:​Parts] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. PROJECT[tbl:​Skills_Required_To_Fix, #2] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​Parts:​part_name, #5] <br>7. PROJECT[col:​Parts:​part_id, #5] <br>8. UNION[#7, #6] <br> | + | extra | 
  | SPIDER_train_3144 | Which kind of part has the least number of faults? List the part name. | SELECT T1.part_name FROM Parts AS T1 JOIN Part_Faults AS T2 ON T1.part_id  =  T2.part_id GROUP BY T1.part_name ORDER BY count(*) ASC LIMIT 1 | 1. SELECT[tbl:​Parts] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Parts:​part_name, #4] <br> | 1. SELECT[tbl:​Parts] <br>2. PROJECT[tbl:​Part_Faults, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Parts:​part_name, #4] <br> | + | extra | 
  | SPIDER_train_3145 | Among those engineers who have visited, which engineer makes the least number of visits? List the engineer id, first name and last name. | SELECT T1.engineer_id ,  T1.first_name ,  T1.last_name FROM Maintenance_Engineers AS T1 JOIN Engineer_Visits AS T2 ON T1.engineer_id  =  T2.engineer_id GROUP BY T1.engineer_id ORDER BY count(*) ASC LIMIT 1 | 1. SELECT[tbl:​Maintenance_Engineers] <br>2. FILTER[#1, tbl:​Engineer_Visits] <br>3. PROJECT[tbl:​Engineer_Visits, #2] <br>4. GROUP[count, #3, #2] <br>5. COMPARATIVE[#2, #4, comparative:​min:​None] <br>6. PROJECT[col:​Maintenance_Engineers:​engineer_id, #5] <br>7. PROJECT[col:​Maintenance_Engineers:​first_name, #5] <br>8. PROJECT[col:​Maintenance_Engineers:​last_name, #5] <br>9. UNION[#6, #7, #8] <br> | 1. SELECT[tbl:​Maintenance_Engineers] <br>2. COMPARATIVE[#1, #1, tbl:​Engineer_Visits] <br>3. PROJECT[tbl:​Engineer_Visits, #2] <br>4. GROUP[count, #3, #2] <br>5. SUPERLATIVE[comparative:​min:​None, #2, #4] <br>6. PROJECT[col:​Maintenance_Engineers:​engineer_id, #5] <br>7. PROJECT[col:​Maintenance_Engineers:​first_name, #5] <br>8. PROJECT[col:​Maintenance_Engineers:​last_name, #5] <br>9. UNION[#6, #7, #8] <br> | + | extra | 
  | SPIDER_train_3146 | Which staff have contacted which engineers? List the staff name and the engineer first name and last name. | SELECT T1.staff_name ,  T3.first_name ,  T3.last_name FROM Staff AS T1 JOIN Engineer_Visits AS T2 ON T1.staff_id  =  T2.contact_staff_id JOIN Maintenance_Engineers AS T3 ON T2.engineer_id  =  T3.engineer_id | 1. SELECT[tbl:​Staff] <br>2. FILTER[#1, tbl:​Maintenance_Engineers] <br>3. PROJECT[col:​Staff:​staff_name, #2] <br>4. PROJECT[tbl:​Maintenance_Engineers, #2] <br>5. PROJECT[col:​Maintenance_Engineers:​first_name, #4] <br>6. PROJECT[col:​Maintenance_Engineers:​last_name, #4] <br>7. UNION[#3, #5, #6] <br> | 1. SELECT[tbl:​Staff] <br>2. COMPARATIVE[#1, #1, tbl:​Maintenance_Engineers] <br>3. PROJECT[col:​Staff:​staff_name, #2] <br>4. PROJECT[tbl:​Maintenance_Engineers, #2] <br>5. PROJECT[col:​Maintenance_Engineers:​first_name, #4] <br>6. PROJECT[col:​Maintenance_Engineers:​last_name, #4] <br>7. UNION[#3, #5, #6] <br> | + | medium | 
  | SPIDER_train_3147 | Which fault log included the most number of faulty parts? List the fault log id, description and record time. | SELECT T1.fault_log_entry_id ,  T1.fault_description ,  T1.fault_log_entry_datetime FROM Fault_Log AS T1 JOIN Fault_Log_Parts AS T2 ON T1.fault_log_entry_id  =  T2.fault_log_entry_id GROUP BY T1.fault_log_entry_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Fault_Log_Parts:​fault_log_entry_id] <br>2. PROJECT[tbl:​Fault_Log, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Fault_Log:​fault_log_entry_id, #4] <br>6. PROJECT[col:​Fault_Log:​fault_description, #4] <br>7. PROJECT[col:​Fault_Log:​fault_log_entry_datetime, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[col:​Fault_Log_Parts:​fault_log_entry_id] <br>2. PROJECT[tbl:​Fault_Log, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Fault_Log:​fault_log_entry_id, #4] <br>6. PROJECT[col:​Fault_Log:​fault_description, #4] <br>7. PROJECT[col:​Fault_Log:​fault_log_entry_datetime, #4] <br>8. UNION[#5, #6, #7] <br> | + | extra | 
  | SPIDER_train_3148 | Which skill is used in fixing the most number of faults? List the skill id and description. | SELECT T1.skill_id ,  T1.skill_description FROM Skills AS T1 JOIN Skills_Required_To_Fix AS T2 ON T1.skill_id  =  T2.skill_id GROUP BY T1.skill_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Skills_Required_To_Fix:​skill_id] <br>2. FILTER[#1, comparative:​max:​None] <br>3. PROJECT[col:​Skills:​skill_id, #2] <br>4. PROJECT[col:​Skills:​skill_description, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​Skills_Required_To_Fix:​skill_id] <br>2. SUPERLATIVE[comparative:​max:​None, #1, #1] <br>3. PROJECT[col:​Skills:​skill_id, #2] <br>4. PROJECT[col:​Skills:​skill_description, #2] <br>5. UNION[#3, #4] <br> | - | extra | 
  | SPIDER_train_3149 | What are all the distinct asset models? | SELECT DISTINCT asset_model FROM Assets | 1. SELECT[col:​Assets:​asset_model] <br>2.*(distinct)* PROJECT[distinct #REF, #1] <br> | 1. SELECT[col:​Assets:​asset_model] <br>2.*(distinct)* PROJECT[None, #1] <br> | + | easy | 
  | SPIDER_train_3150 | List the all the assets make, model, details by the disposed date ascendingly. | SELECT asset_make ,  asset_model ,  asset_details FROM Assets ORDER BY asset_disposed_date ASC | 1. SELECT[tbl:​Assets] <br>2. PROJECT[col:​Assets:​asset_make, #1] <br>3. PROJECT[col:​Assets:​asset_model, #1] <br>4. PROJECT[col:​Assets:​asset_details, #1] <br>5. PROJECT[col:​Assets:​asset_disposed_date, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | 1. SELECT[tbl:​Assets] <br>2. PROJECT[col:​Assets:​asset_make, #1] <br>3. PROJECT[col:​Assets:​asset_model, #1] <br>4. PROJECT[col:​Assets:​asset_details, #1] <br>5. PROJECT[col:​Assets:​asset_disposed_date, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3151 | Which part has the least chargeable amount? List the part id and amount. | SELECT part_id ,  chargeable_amount FROM Parts ORDER BY chargeable_amount ASC LIMIT 1 | 1. SELECT[tbl:​Parts] <br>2. PROJECT[col:​Parts:​chargeable_amount, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​Parts:​part_id, #3] <br>5. PROJECT[col:​Parts:​chargeable_amount, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Parts] <br>2. PROJECT[col:​Parts:​chargeable_amount, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​Parts:​part_id, #3] <br>5. PROJECT[col:​Parts:​chargeable_amount, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3152 | Which company started the earliest the maintenance contract? Show the company name. | SELECT T1.company_name FROM Third_Party_Companies AS T1 JOIN Maintenance_Contracts AS T2 ON T1.company_id  =  T2.maintenance_contract_company_id ORDER BY T2.contract_start_date ASC LIMIT 1 | 1. SELECT[col:​Third_Party_Companies:​company_name] <br>2. PROJECT[tbl:​Maintenance_Contracts, #1] <br>3. PROJECT[col:​Maintenance_Contracts:​contract_start_date, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | 1. SELECT[col:​Third_Party_Companies:​company_name] <br>2. PROJECT[tbl:​Maintenance_Contracts, #1] <br>3. PROJECT[col:​Maintenance_Contracts:​contract_start_date, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_3154 | Which gender makes up the majority of the staff? | SELECT gender FROM staff GROUP BY gender ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​gender, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​max:​None] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​gender, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | + | hard | 
  | SPIDER_train_3155 | How many engineers did each staff contact? List both the contact staff name and number of engineers contacted. | SELECT T1.staff_name ,  count(*) FROM Staff AS T1 JOIN Engineer_Visits AS T2 ON T1.staff_id  =  T2.contact_staff_id GROUP BY T1.staff_name | 1. SELECT[col:​Staff:​staff_name] <br>2. PROJECT[tbl:​Engineer_Visits, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Staff:​staff_name, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[col:​Staff:​staff_name] <br>2. PROJECT[tbl:​Engineer_Visits, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Staff:​staff_name, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_3156 | Which assets did not incur any fault log? List the asset model. | SELECT asset_model FROM Assets WHERE asset_id NOT IN (SELECT asset_id FROM Fault_Log) | 1. SELECT[tbl:​Assets] <br>2. PROJECT[tbl:​Fault_Log, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, is higher than zero] <br>5. DISCARD[#1, #4] <br>6. PROJECT[col:​Assets:​asset_model, #5] <br> | 1. SELECT[tbl:​Assets] <br>2. PROJECT[tbl:​Fault_Log, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, None] <br>5. DISCARD[#1, #4] <br>6. PROJECT[col:​Assets:​asset_model, #5] <br> | + | hard | 
 ***
 Exec acc: **0.9615**
