 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Apartment_Buildings** | building_id | + |   | 
 | 2 |   | building_short_name |   |   | 
 | 3 |   | building_full_name |   |   | 
 | 4 |   | building_description |   |   | 
 | 5 |   | building_address |   |   | 
 | 6 |   | building_manager |   |   | 
 | 7 |   | building_phone |   |   | 
 | 8 | **Apartments** | apt_id | + |   | 
 | 9 |   | building_id |   | --> 1 | 
 | 10 |   | apt_type_code |   |   | 
 | 11 |   | apt_number |   |   | 
 | 12 |   | bathroom_count |   |   | 
 | 13 |   | bedroom_count |   |   | 
 | 14 |   | room_count |   |   | 
 | 15 | **Apartment_Facilities** | apt_id | + | --> 8 | 
 | 16 |   | facility_code |   |   | 
 | 17 | **Guests** | guest_id | + |   | 
 | 18 |   | gender_code |   |   | 
 | 19 |   | guest_first_name |   |   | 
 | 20 |   | guest_last_name |   |   | 
 | 21 |   | date_of_birth |   |   | 
 | 22 | **Apartment_Bookings** | apt_booking_id | + |   | 
 | 23 |   | apt_id |   | --> 8 | 
 | 24 |   | guest_id |   | --> 17 | 
 | 25 |   | booking_status_code |   |   | 
 | 26 |   | booking_start_date |   |   | 
 | 27 |   | booking_end_date |   |   | 
 | 28 | **View_Unit_Status** | apt_id |   | --> 8 | 
 | 29 |   | apt_booking_id |   | --> 22 | 
 | 30 |   | status_date | + |   | 
 | 31 |   | available_yn |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_1194 | How many apartment bookings are there in total? | SELECT count(*) FROM Apartment_Bookings | 1. SELECT[tbl:​Apartment_Bookings] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Apartment_Bookings] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1195 | Count the total number of apartment bookings. | SELECT count(*) FROM Apartment_Bookings | 1. SELECT[tbl:​Apartment_Bookings] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Apartment_Bookings] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1196 | Show the start dates and end dates of all the apartment bookings. | SELECT booking_start_date ,  booking_end_date FROM Apartment_Bookings | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_end_date, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_end_date, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1197 | What are the start date and end date of each apartment booking? | SELECT booking_start_date ,  booking_end_date FROM Apartment_Bookings | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_end_date, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_end_date, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1198 | Show all distinct building descriptions. | SELECT DISTINCT building_description FROM Apartment_Buildings | 1. SELECT[tbl:​Apartment_Buildings] <br>2.*(distinct)* PROJECT[col:​Apartment_Buildings:​building_description, #1] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2.*(distinct)* PROJECT[col:​Apartment_Buildings:​building_description, #1] <br> | + | easy | 
  | SPIDER_train_1199 | Give me a list of all the distinct building descriptions. | SELECT DISTINCT building_description FROM Apartment_Buildings | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[col:​Apartment_Buildings:​building_description, #1] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[col:​Apartment_Buildings:​building_description, #1] <br>3.*(distinct)* PROJECT[None, #2] <br> | + | easy | 
  | SPIDER_train_1200 | Show the short names of the buildings managed by "Emma". | SELECT building_short_name FROM Apartment_Buildings WHERE building_manager	 =  "Emma" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. FILTER[#1, comparative:​=:​Emma:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_short_name, #2] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Emma:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_short_name, #2] <br> | + | easy | 
  | SPIDER_train_1201 | Which buildings does "Emma" manage? Give me the short names of the buildings. | SELECT building_short_name FROM Apartment_Buildings WHERE building_manager	 =  "Emma" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. FILTER[#1, comparative:​=:​Emma:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_short_name, #2] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Emma:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_short_name, #2] <br> | + | easy | 
  | SPIDER_train_1202 | Show the addresses and phones of all the buildings managed by "Brenden". | SELECT building_address ,  building_phone FROM Apartment_Buildings WHERE building_manager	 =  "Brenden" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. FILTER[#1, comparative:​=:​Brenden:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_address, #2] <br>4. PROJECT[col:​Apartment_Buildings:​building_phone, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Brenden:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_address, #2] <br>4. PROJECT[col:​Apartment_Buildings:​building_phone, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_1203 | What are the address and phone number of the buildings managed by "Brenden"? | SELECT building_address ,  building_phone FROM Apartment_Buildings WHERE building_manager	 =  "Brenden" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. FILTER[#1, comparative:​=:​Brenden:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_address, #2] <br>4. PROJECT[col:​Apartment_Buildings:​building_phone, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Brenden:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[col:​Apartment_Buildings:​building_address, #2] <br>4. PROJECT[col:​Apartment_Buildings:​building_phone, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_1204 | What are the building full names that contain the word "court"? | SELECT building_full_name FROM Apartment_Buildings WHERE building_full_name LIKE "%court%" | 1. SELECT[col:​Apartment_Buildings:​building_full_name] <br>2. PROJECT[col:​Apartment_Buildings:​building_full_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%court%:​col:​Apartment_Buildings:​building_full_name] <br> | 1. SELECT[col:​Apartment_Buildings:​building_full_name] <br>2. PROJECT[col:​Apartment_Buildings:​building_full_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​court:​col:​Apartment_Buildings:​building_full_name] <br> | + | medium | 
  | SPIDER_train_1205 | Find all the building full names containing the word "court". | SELECT building_full_name FROM Apartment_Buildings WHERE building_full_name LIKE "%court%" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[col:​Apartment_Buildings:​building_full_name, #1] <br>3. FILTER[#2, comparative:​like:​%court%:​col:​Apartment_Buildings:​building_full_name] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[col:​Apartment_Buildings:​building_full_name, #1] <br>3. COMPARATIVE[#2, #2, comparative:​like:​court:​col:​Apartment_Buildings:​building_full_name] <br> | + | medium | 
  | SPIDER_train_1206 | What is the minimum and maximum number of bathrooms of all the apartments? | SELECT min(bathroom_count) ,  max(bathroom_count) FROM Apartments | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bathroom_count, #1] <br>3. AGGREGATE[col:​Apartments:​bathroom_count, #2] <br>4. AGGREGATE[min, #3] <br>5. AGGREGATE[max, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bathroom_count, #1] <br>3. AGGREGATE[sum, #2] <br>4. AGGREGATE[min, #3] <br>5. AGGREGATE[max, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_1207 | Give me the minimum and maximum bathroom count among all the apartments. | SELECT min(bathroom_count) ,  max(bathroom_count) FROM Apartments | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bathroom_count, #1] <br>3. GROUP[col:​Apartments:​bathroom_count, #2, #1] <br>4. AGGREGATE[min, #3] <br>5. AGGREGATE[max, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bathroom_count, #1] <br>3. GROUP[sum, #2, #1] <br>4. AGGREGATE[min, #3] <br>5. AGGREGATE[max, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_1208 | What is the average number of bedrooms of all apartments? | SELECT avg(bedroom_count) FROM Apartments | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. AGGREGATE[col:​Apartments:​bedroom_count, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. AGGREGATE[sum, #2] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_1209 | Find the average number of bedrooms of all the apartments. | SELECT avg(bedroom_count) FROM Apartments | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[col:​Apartments:​bedroom_count, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[sum, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_1210 | Return the apartment number and the number of rooms for each apartment. | SELECT apt_number ,  room_count FROM Apartments | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. GROUP[col:​Apartments:​room_count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1211 | What are the apartment number and the room count of each apartment? | SELECT apt_number ,  room_count FROM Apartments | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. GROUP[col:​Apartments:​room_count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1212 | What is the average number of rooms of apartments with type code "Studio"? | SELECT avg(room_count) FROM Apartments WHERE apt_type_code  =  "Studio" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Studio:​col:​Apartments:​apt_type_code] <br>4. PROJECT[col:​Apartments:​room_count, #3] <br>5. AGGREGATE[col:​Apartments:​room_count, #4] <br>6. AGGREGATE[avg, #5] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Studio:​col:​Apartments:​apt_type_code] <br>4. PROJECT[col:​Apartments:​room_count, #3] <br>5. AGGREGATE[sum, #4] <br>6. AGGREGATE[avg, #5] <br> | + | easy | 
  | SPIDER_train_1213 | Find the average room count of the apartments that have the "Studio" type code. | SELECT avg(room_count) FROM Apartments WHERE apt_type_code  =  "Studio" | 1. SELECT[tbl:​Apartments] <br>2. FILTER[#1, comparative:​=:​Studio:​col:​Apartments:​apt_type_code] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Studio:​col:​Apartments:​apt_type_code] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_1214 | Return the apartment numbers of the apartments with type code "Flat". | SELECT apt_number FROM Apartments WHERE apt_type_code  =  "Flat" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Flat:​col:​Apartments:​apt_type_code] <br>4. PROJECT[col:​Apartments:​apt_number, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Flat:​col:​Apartments:​apt_type_code] <br>4. PROJECT[col:​Apartments:​apt_number, #3] <br> | + | easy | 
  | SPIDER_train_1215 | Which apartments have type code "Flat"? Give me their apartment numbers. | SELECT apt_number FROM Apartments WHERE apt_type_code  =  "Flat" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Flat:​col:​Apartments:​apt_type_code] <br>4. PROJECT[col:​Apartments:​apt_number, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Flat:​col:​Apartments:​apt_type_code] <br>4. PROJECT[col:​Apartments:​apt_number, #3] <br> | + | easy | 
  | SPIDER_train_1216 | Return the first names and last names of all guests | SELECT guest_first_name ,  guest_last_name FROM Guests | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Guests:​guest_last_name, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Guests:​guest_last_name, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1217 | What are the first names and last names of all the guests? | SELECT guest_first_name ,  guest_last_name FROM Guests | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Guests:​guest_last_name, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Guests:​guest_last_name, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1218 | Return the date of birth for all the guests with gender code "Male". | SELECT date_of_birth FROM Guests WHERE gender_code  =  "Male" | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​gender_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Male:​col:​Guests:​gender_code] <br>4. PROJECT[col:​Guests:​date_of_birth, #3] <br> | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​gender_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Male:​col:​Guests:​gender_code] <br>4. PROJECT[col:​Guests:​date_of_birth, #3] <br> | + | easy | 
  | SPIDER_train_1219 | What are dates of birth of all the guests whose gender is "Male"? | SELECT date_of_birth FROM Guests WHERE gender_code  =  "Male" | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​gender_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Male:​col:​Guests:​gender_code] <br>4. PROJECT[col:​Guests:​date_of_birth, #3] <br> | 1. SELECT[tbl:​Guests] <br>2. PROJECT[col:​Guests:​gender_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Male:​col:​Guests:​gender_code] <br>4. PROJECT[col:​Guests:​date_of_birth, #3] <br> | + | easy | 
  | SPIDER_train_1220 | Show the apartment numbers, start dates, and end dates of all the apartment bookings. | SELECT T2.apt_number ,  T1.booking_start_date ,  T1.booking_start_date FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1221 | What are the apartment number, start date, and end date of each apartment booking? | SELECT T2.apt_number ,  T1.booking_start_date ,  T1.booking_start_date FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1226 | What is the booking status code of the apartment with apartment number "Suite 634"? | SELECT T1.booking_status_code FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T2.apt_number  =  "Suite 634" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Suite 634:​col:​Apartments:​apt_number] <br>4. PROJECT[col:​Apartment_Bookings:​booking_status_code, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Suite 634:​col:​Apartments:​apt_number] <br>4. PROJECT[col:​Apartment_Bookings:​booking_status_code, #3] <br> | + | medium | 
  | SPIDER_train_1227 | Tell me the booking status code for the apartment with number "Suite 634". | SELECT T1.booking_status_code FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T2.apt_number  =  "Suite 634" | 1. SELECT[tbl:​Apartments] <br>2. FILTER[#1, comparative:​=:​Suite 634:​col:​Apartments:​apt_number] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br> | 1. SELECT[tbl:​Apartments] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Suite 634:​col:​Apartments:​apt_number] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br> | + | medium | 
  | SPIDER_train_1228 | Show the distinct apartment numbers of the apartments that have bookings with status code "Confirmed". | SELECT DISTINCT T2.apt_number FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Confirmed" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. PROJECT[col:​Apartments:​apt_number, #4] <br>6.*(distinct)* PROJECT[distinct #REF, #5] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. PROJECT[col:​Apartments:​apt_number, #4] <br>6.*(distinct)* PROJECT[None, #5] <br> | + | medium | 
  | SPIDER_train_1229 | Which apartments have bookings with status code "Confirmed"? Return their apartment numbers. | SELECT DISTINCT T2.apt_number FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Confirmed" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. PROJECT[col:​Apartment_Bookings:​booking_status_code, #3] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>6. PROJECT[col:​Apartments:​apt_number, #5] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. PROJECT[col:​Apartment_Bookings:​booking_status_code, #3] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>6. PROJECT[col:​Apartments:​apt_number, #5] <br> | + | medium | 
  | SPIDER_train_1230 | Show the average room count of the apartments that have booking status code "Provisional". | SELECT avg(room_count) FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Provisional" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>4. PROJECT[col:​Apartments:​room_count, #3] <br>5. GROUP[col:​Apartments:​room_count, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>4. PROJECT[col:​Apartments:​room_count, #3] <br>5. GROUP[sum, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | + | medium | 
  | SPIDER_train_1231 | What is the average room count of the apartments whose booking status code is "Provisional"? | SELECT avg(room_count) FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Provisional" | 1. SELECT[tbl:​Apartments] <br>2. FILTER[#1, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. AGGREGATE[avg, #3] <br> | + | medium | 
  | SPIDER_train_1232 | Show the guest first names, start dates, and end dates of all the apartment bookings. | SELECT T2.guest_first_name ,  T1.booking_start_date ,  T1.booking_start_date FROM Apartment_Bookings AS T1 JOIN Guests AS T2 ON T1.guest_id  =  T2.guest_id | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1233 | What are the guest first name, start date, and end date of each apartment booking? | SELECT T2.guest_first_name ,  T1.booking_start_date ,  T1.booking_start_date FROM Apartment_Bookings AS T1 JOIN Guests AS T2 ON T1.guest_id  =  T2.guest_id | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Guests:​guest_first_name, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_start_date, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1236 | Show the first names and last names of all the guests that have apartment bookings with status code "Confirmed". | SELECT T2.guest_first_name ,  T2.guest_last_name FROM Apartment_Bookings AS T1 JOIN Guests AS T2 ON T1.guest_id  =  T2.guest_id WHERE T1.booking_status_code  =  "Confirmed" | 1. SELECT[tbl:​Guests] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. PROJECT[col:​Guests:​guest_first_name, #4] <br>6. PROJECT[col:​Guests:​guest_last_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Guests] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. PROJECT[col:​Guests:​guest_first_name, #4] <br>6. PROJECT[col:​Guests:​guest_last_name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_1237 | Which guests have apartment bookings with status code "Confirmed"? Return their first names and last names. | SELECT T2.guest_first_name ,  T2.guest_last_name FROM Apartment_Bookings AS T1 JOIN Guests AS T2 ON T1.guest_id  =  T2.guest_id WHERE T1.booking_status_code  =  "Confirmed" | 1. SELECT[tbl:​Guests] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. PROJECT[col:​Guests:​guest_first_name, #4] <br>6. PROJECT[col:​Guests:​guest_last_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Guests] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. PROJECT[col:​Guests:​guest_first_name, #4] <br>6. PROJECT[col:​Guests:​guest_last_name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_1238 | Show the facility codes of apartments with more than 4 bedrooms. | SELECT T1.facility_code FROM Apartment_Facilities AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T2.bedroom_count  >  4 | 1. SELECT[tbl:​Apartment_Facilities] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[col:​Apartments:​bedroom_count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Apartments:​bedroom_count] <br>5. PROJECT[col:​Apartment_Facilities:​facility_code, #4] <br> | 1. SELECT[tbl:​Apartment_Facilities] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Apartments:​bedroom_count] <br>5. PROJECT[col:​Apartment_Facilities:​facility_code, #4] <br> | + | medium | 
  | SPIDER_train_1239 | What are the facility codes of the apartments with more than four bedrooms? | SELECT T1.facility_code FROM Apartment_Facilities AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T2.bedroom_count  >  4 | 1. SELECT[tbl:​Apartment_Facilities] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[col:​Apartments:​bedroom_count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Apartments:​bedroom_count] <br>5. PROJECT[col:​Apartment_Facilities:​facility_code, #4] <br> | 1. SELECT[tbl:​Apartment_Facilities] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Apartments:​bedroom_count] <br>5. PROJECT[col:​Apartment_Facilities:​facility_code, #4] <br> | + | medium | 
  | SPIDER_train_1240 | Show the total number of rooms of all apartments with facility code "Gym". | SELECT sum(T2.room_count) FROM Apartment_Facilities AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.facility_code  =  "Gym" | 1. SELECT[tbl:​Apartment_Facilities] <br>2. FILTER[#1, comparative:​=:​Gym:​col:​Apartment_Facilities:​facility_code] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. GROUP[col:​Apartments:​room_count, #3, #2] <br>5. AGGREGATE[sum, #4] <br> | 1. SELECT[tbl:​Apartment_Facilities] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Gym:​col:​Apartment_Facilities:​facility_code] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. GROUP[sum, #3, #2] <br>5. AGGREGATE[sum, #4] <br> | + | medium | 
  | SPIDER_train_1242 | Show the total number of rooms of the apartments in the building with short name "Columbus Square". | SELECT sum(T2.room_count) FROM Apartment_Buildings AS T1 JOIN Apartments AS T2 ON T1.building_id  =  T2.building_id WHERE T1.building_short_name  =  "Columbus Square" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. FILTER[#1, comparative:​=:​Columbus Square:​col:​Apartment_Buildings:​building_short_name] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. GROUP[col:​Apartments:​room_count, #3, #2] <br>5. AGGREGATE[sum, #4] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Columbus Square:​col:​Apartment_Buildings:​building_short_name] <br>3. PROJECT[col:​Apartments:​room_count, #2] <br>4. GROUP[sum, #3, #2] <br>5. AGGREGATE[sum, #4] <br> | + | medium | 
  | SPIDER_train_1244 | Show the addresses of the buildings that have apartments with more than 2 bathrooms. | SELECT T1.building_address FROM Apartment_Buildings AS T1 JOIN Apartments AS T2 ON T1.building_id  =  T2.building_id WHERE T2.bathroom_count  >  2 | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[tbl:​Apartment_Buildings, #1] <br>3. PROJECT[col:​Apartments:​bathroom_count, #2] <br>4. GROUP[col:​Apartments:​bathroom_count, #3, #2] <br>5. COMPARATIVE[#1, #4, comparative:​>:​2:​col:​Apartments:​bathroom_count] <br>6. PROJECT[col:​Apartment_Buildings:​building_address, #5] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[tbl:​Apartment_Buildings, #1] <br>3. PROJECT[col:​Apartments:​bathroom_count, #2] <br>4. GROUP[sum, #3, #2] <br>5. COMPARATIVE[#1, #4, comparative:​>:​2:​col:​Apartments:​bathroom_count] <br>6. PROJECT[col:​Apartment_Buildings:​building_address, #5] <br> | + | medium | 
  | SPIDER_train_1245 | Which buildings have apartments that have more than two bathrooms? Give me the addresses of the buildings. | SELECT T1.building_address FROM Apartment_Buildings AS T1 JOIN Apartments AS T2 ON T1.building_id  =  T2.building_id WHERE T2.bathroom_count  >  2 | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[col:​Apartments:​bathroom_count, #1] <br>3. GROUP[col:​Apartments:​bathroom_count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2:​col:​Apartments:​bathroom_count] <br>5. PROJECT[tbl:​Apartment_Buildings, #4] <br>6. PROJECT[col:​Apartment_Buildings:​building_address, #5] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. PROJECT[col:​Apartments:​bathroom_count, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2:​col:​Apartments:​bathroom_count] <br>5. PROJECT[tbl:​Apartment_Buildings, #4] <br>6. PROJECT[col:​Apartment_Buildings:​building_address, #5] <br> | + | medium | 
  | SPIDER_train_1246 | Show the apartment type codes and apartment numbers in the buildings managed by "Kyle". | SELECT T2.apt_type_code ,  T2.apt_number FROM Apartment_Buildings AS T1 JOIN Apartments AS T2 ON T1.building_id  =  T2.building_id WHERE T1.building_manager  =  "Kyle" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. FILTER[#1, comparative:​=:​Kyle:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[tbl:​Apartment_Buildings, #2] <br>4. PROJECT[col:​Apartments:​apt_type_code, #3] <br>5. PROJECT[col:​Apartments:​apt_number, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Kyle:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[tbl:​Apartment_Buildings, #2] <br>4. PROJECT[col:​Apartments:​apt_type_code, #3] <br>5. PROJECT[col:​Apartments:​apt_number, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_1247 | What apartment type codes and apartment numbers do the buildings managed by "Kyle" have? | SELECT T2.apt_type_code ,  T2.apt_number FROM Apartment_Buildings AS T1 JOIN Apartments AS T2 ON T1.building_id  =  T2.building_id WHERE T1.building_manager  =  "Kyle" | 1. SELECT[tbl:​Apartment_Buildings] <br>2. FILTER[#1, comparative:​=:​Kyle:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[tbl:​Apartment_Buildings, #2] <br>4. PROJECT[col:​Apartments:​apt_type_code, #3] <br>5. PROJECT[col:​Apartments:​apt_number, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Apartment_Buildings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Kyle:​col:​Apartment_Buildings:​building_manager] <br>3. PROJECT[tbl:​Apartment_Buildings, #2] <br>4. PROJECT[col:​Apartments:​apt_type_code, #3] <br>5. PROJECT[col:​Apartments:​apt_number, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_1248 | Show the booking status code and the corresponding number of bookings. | SELECT 	booking_status_code ,  COUNT(*) FROM Apartment_Bookings GROUP BY booking_status_code | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Apartment_Bookings:​booking_status_code, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Apartment_Bookings] <br>2. PROJECT[col:​Apartment_Bookings:​booking_status_code, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1249 | How many bookings does each booking status have? List the booking status code and the number of corresponding bookings. | SELECT 	booking_status_code ,  COUNT(*) FROM Apartment_Bookings GROUP BY booking_status_code | 1. SELECT[col:​Apartment_Bookings:​booking_status_code] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_status_code, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[col:​Apartment_Bookings:​booking_status_code] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Apartment_Bookings:​booking_status_code, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_1250 | Return all the apartment numbers sorted by the room count in ascending order. | SELECT apt_number FROM Apartments ORDER BY room_count ASC | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_1251 | Sort the apartment numbers in ascending order of room count. | SELECT apt_number FROM Apartments ORDER BY room_count ASC | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[col:​Apartments:​apt_number, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_1252 | Return the apartment number with the largest number of bedrooms. | SELECT apt_number FROM Apartments ORDER BY bedroom_count DESC LIMIT 1 | 1. SELECT[col:​Apartments:​apt_number] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[col:​Apartments:​bedroom_count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Apartments:​apt_number] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | medium | 
  | SPIDER_train_1253 | What is the apartment number of the apartment with the most beds? | SELECT apt_number FROM Apartments ORDER BY bedroom_count DESC LIMIT 1 | 1. SELECT[col:​Apartments:​apt_number] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[col:​Apartments:​bedroom_count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[col:​Apartments:​apt_number, #4] <br> | 1. SELECT[col:​Apartments:​apt_number] <br>2. PROJECT[col:​Apartments:​bedroom_count, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[sum, #4] <br> | + | medium | 
  | SPIDER_train_1254 | Show the apartment type codes and the corresponding number of apartments sorted by the number of apartments in ascending order. | SELECT apt_type_code ,  COUNT(*) FROM Apartments GROUP BY apt_type_code ORDER BY COUNT(*) ASC | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​ascending] <br> | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​ascending] <br> | + | extra | 
  | SPIDER_train_1255 | Return each apartment type code with the number of apartments having that apartment type, in ascending order of the number of apartments. | SELECT apt_type_code ,  COUNT(*) FROM Apartments GROUP BY apt_type_code ORDER BY COUNT(*) ASC | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​ascending] <br> | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​ascending] <br> | + | extra | 
  | SPIDER_train_1260 | Show the most common apartment type code. | SELECT apt_type_code FROM Apartments GROUP BY apt_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_1262 | Show the most common apartment type code among apartments with more than 1 bathroom. | SELECT apt_type_code FROM Apartments WHERE bathroom_count  >  1 GROUP BY apt_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. PROJECT[col:​Apartments:​bathroom_count, #2] <br>4. GROUP[col:​Apartments:​bathroom_count, #3, #2] <br>5. COMPARATIVE[#2, #4, comparative:​>:​1:​col:​Apartments:​bathroom_count] <br>6. GROUP[count, #5, #1] <br>7. SUPERLATIVE[comparative:​max:​None, #1, #6] <br> | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[tbl:​Apartments, #1] <br>3. PROJECT[col:​Apartments:​bathroom_count, #2] <br>4. GROUP[sum, #3, #2] <br>5. COMPARATIVE[#2, #4, comparative:​>:​1:​col:​Apartments:​bathroom_count] <br>6. GROUP[count, #5, #1] <br>7. SUPERLATIVE[comparative:​max:​None, #1, #6] <br> | + | extra | 
  | SPIDER_train_1265 | Return each apartment type code along with the maximum and minimum number of rooms among each type. | SELECT apt_type_code ,  max(room_count) ,  min(room_count) FROM Apartments GROUP BY apt_type_code | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. AGGREGATE[col:​Apartments:​room_count, #3] <br>5. GROUP[max, #4, #1] <br>6. GROUP[min, #4, #1] <br>7. UNION[#2, #5, #6] <br> | 1. SELECT[col:​Apartments:​apt_type_code] <br>2. PROJECT[col:​Apartments:​apt_type_code, #1] <br>3. PROJECT[col:​Apartments:​room_count, #1] <br>4. AGGREGATE[sum, #3] <br>5. GROUP[max, #4, #1] <br>6. GROUP[min, #4, #1] <br>7. UNION[#2, #5, #6] <br> | + | medium | 
  | SPIDER_train_1266 | Show each gender code and the corresponding count of guests sorted by the count in descending order. | SELECT gender_code ,  COUNT(*) FROM Guests GROUP BY gender_code ORDER BY COUNT(*) DESC | 1. SELECT[col:​Guests:​gender_code] <br>2. PROJECT[tbl:​Guests, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | 1. SELECT[col:​Guests:​gender_code] <br>2. PROJECT[tbl:​Guests, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | + | extra | 
  | SPIDER_train_1267 | Sort the gender codes in descending order of their corresponding number of guests. Return both the gender codes and counts. | SELECT gender_code ,  COUNT(*) FROM Guests GROUP BY gender_code ORDER BY COUNT(*) DESC | 1. SELECT[col:​Guests:​gender_code] <br>2. PROJECT[tbl:​Guests, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | 1. SELECT[col:​Guests:​gender_code] <br>2. PROJECT[tbl:​Guests, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | + | extra | 
  | SPIDER_train_1268 | How many apartments do not have any facility? | SELECT count(*) FROM Apartments WHERE apt_id NOT IN (SELECT apt_id FROM Apartment_Facilities) | 1. SELECT[tbl:​Apartments] <br>2. FILTER[#1, tbl:​Apartment_Facilities] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. COMPARATIVE[#1, #1, tbl:​Apartment_Facilities] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_1269 | Find the number of apartments that have no facility. | SELECT count(*) FROM Apartments WHERE apt_id NOT IN (SELECT apt_id FROM Apartment_Facilities) | 1. SELECT[tbl:​Apartments] <br>2. FILTER[#1, tbl:​Apartment_Facilities] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Apartments] <br>2. COMPARATIVE[#1, #1, tbl:​Apartment_Facilities] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_1270 | Show the apartment numbers of apartments with bookings that have status code both "Provisional" and "Confirmed" | SELECT T2.apt_number FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Confirmed" INTERSECT SELECT T2.apt_number FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Provisional" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Apartments:​apt_number, #5] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Apartments:​apt_number, #5] <br> | + | extra | 
  | SPIDER_train_1271 | Which apartments have bookings with both status codes "Provisional" and "Confirmed"? Give me the apartment numbers. | SELECT T2.apt_number FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Confirmed" INTERSECT SELECT T2.apt_number FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T1.booking_status_code  =  "Provisional" | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Apartments:​apt_number, #6] <br> | 1. SELECT[tbl:​Apartments] <br>2. PROJECT[tbl:​Apartment_Bookings, #1] <br>3. PROJECT[col:​Apartment_Bookings:​booking_status_code, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Provisional:​col:​Apartment_Bookings:​booking_status_code] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Confirmed:​col:​Apartment_Bookings:​booking_status_code] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Apartments:​apt_number, #6] <br> | + | extra | 
 ***
 Exec acc: **1.0000**
