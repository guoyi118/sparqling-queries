 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **shop** | Shop_ID | + | --> 14 | 
 | 2 |   | Address |   |   | 
 | 3 |   | Num_of_staff |   |   | 
 | 4 |   | Score |   |   | 
 | 5 |   | Open_Year |   |   | 
 | 6 | **member** | Member_ID | + | --> 18 | 
 | 7 |   | Name |   |   | 
 | 8 |   | Membership_card |   |   | 
 | 9 |   | Age |   |   | 
 | 10 |   | Time_of_purchase |   |   | 
 | 11 |   | Level_of_membership |   |   | 
 | 12 |   | Address |   |   | 
 | 13 | **happy_hour** | HH_ID | + | --> 17 | 
 | 14 |   | Shop_ID |   |   | 
 | 15 |   | Month |   |   | 
 | 16 |   | Num_of_shaff_in_charge |   |   | 
 | 17 | **happy_hour_member** | HH_ID | + | --> 13 | 
 | 18 |   | Member_ID |   |   | 
 | 19 |   | Total_amount |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_789 | How many members have the black membership card? | SELECT count(*) FROM member WHERE Membership_card  =  'Black' | 1. SELECT[tbl:​member] <br>2. PROJECT[tbl:​member, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Black:​col:​member:​Membership_card] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​member] <br>2. PROJECT[tbl:​member, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Black:​col:​member:​Membership_card] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_791 | Give me the names of members whose address is in Harford or Waterbury. | SELECT name FROM member WHERE address  =  'Harford' OR address  =  'Waterbury' | 1. SELECT[tbl:​member] <br>2. PROJECT[col:​member:​Address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Harford:​col:​member:​Address] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Waterbury:​col:​member:​Address] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​member:​Name, #5] <br> | 1. SELECT[tbl:​member] <br>2. PROJECT[col:​member:​Address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Harford:​col:​member:​Address] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Waterbury:​col:​member:​Address] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​member:​Name, #5] <br> | + | medium | 
  | SPIDER_train_793 | Find the purchase time, age and address of each member, and show the results in the order of purchase time. | SELECT Time_of_purchase ,  age ,  address FROM member ORDER BY Time_of_purchase | 1. SELECT[tbl:​member] <br>2. PROJECT[col:​member:​Time_of_purchase, #1] <br>3. PROJECT[col:​member:​Age, #1] <br>4. PROJECT[col:​member:​Address, #1] <br>5. UNION[#2, #3, #4] <br>6. SORT[#5, #2] <br> | 1. SELECT[tbl:​member] <br>2. PROJECT[col:​member:​Time_of_purchase, #1] <br>3. PROJECT[col:​member:​Age, #1] <br>4. PROJECT[col:​member:​Address, #1] <br>5. UNION[#2, #3, #4] <br>6. SORT[#5, #2, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_794 | Which membership card has more than 5 members? | SELECT Membership_card FROM member GROUP BY Membership_card HAVING count(*)  >  5 | 1. SELECT[col:​member:​Membership_card] <br>2. PROJECT[tbl:​member, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​5] <br> | 1. SELECT[col:​member:​Membership_card] <br>2. PROJECT[tbl:​member, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​5] <br> | + | easy | 
  | SPIDER_train_795 | Which address has both members younger than 30 and members older than 40? | SELECT address FROM member WHERE age  <  30 INTERSECT SELECT address FROM member WHERE age  >  40 | 1. SELECT[col:​member:​Address] <br>2. PROJECT[tbl:​member, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​30:​col:​member:​Age] <br>4. COMPARATIVE[#1, #2, comparative:​>:​40:​col:​member:​Age] <br>5. INTERSECTION[#1, #3, #4] <br> | 1. SELECT[col:​member:​Address] <br>2. PROJECT[tbl:​member, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​30:​col:​member:​Age] <br>4. COMPARATIVE[#1, #2, comparative:​>:​40:​col:​member:​Age] <br>5. INTERSECTION[#1, #3, #4] <br> | + | hard | 
  | SPIDER_train_796 | What is the membership card held by both members living in Hartford and ones living in Waterbury address? | SELECT membership_card FROM member WHERE address  =  'Hartford' INTERSECT SELECT membership_card FROM member WHERE address  =  'Waterbury' | 1. SELECT[col:​member:​Membership_card] <br>2. PROJECT[col:​member:​Address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Hartford:​col:​member:​Address] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Waterbury:​col:​member:​Address] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​member:​Membership_card, #5] <br> | 1. SELECT[col:​member:​Membership_card] <br>2. PROJECT[col:​member:​Address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Hartford:​col:​member:​Address] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Waterbury:​col:​member:​Address] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​member:​Membership_card, #5] <br> | + | hard | 
  | SPIDER_train_798 | Which address do not have any member with the black membership card? | SELECT address FROM member EXCEPT SELECT address FROM member WHERE Membership_card  =  'Black' | 1. SELECT[tbl:​member] <br>2. FILTER[#1, comparative:​=:​Black:​col:​member:​Membership_card] <br>3. PROJECT[col:​member:​Address, #2] <br>4. SELECT[col:​member:​Address] <br>5. DISCARD[#4, #3] <br> | 1. SELECT[tbl:​member] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Black:​col:​member:​Membership_card] <br>3. PROJECT[col:​member:​Address, #2] <br>4. SELECT[col:​member:​Address] <br>5. DISCARD[#4, #3] <br> | + | hard | 
  | SPIDER_train_799 | Show the shop addresses ordered by their opening year. | SELECT address FROM shop ORDER BY open_year | 1. SELECT[tbl:​shop] <br>2. PROJECT[col:​shop:​Address, #1] <br>3. PROJECT[col:​shop:​Open_Year, #1] <br>4. SORT[#2, #3] <br> | 1. SELECT[tbl:​shop] <br>2. PROJECT[col:​shop:​Address, #1] <br>3. PROJECT[col:​shop:​Open_Year, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_800 | What are the average score and average staff number of all shops? | SELECT avg(num_of_staff) ,  avg(score) FROM shop | 1. SELECT[tbl:​shop] <br>2. PROJECT[col:​shop:​Num_of_staff, #1] <br>3. PROJECT[col:​shop:​Score, #1] <br>4. AGGREGATE[avg, #2] <br>5. AGGREGATE[avg, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​shop] <br>2. PROJECT[col:​shop:​Num_of_staff, #1] <br>3. PROJECT[col:​shop:​Score, #1] <br>4. AGGREGATE[avg, #2] <br>5. AGGREGATE[avg, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_804 | which shop has happy hour most frequently? List its id and number of happy hours. | SELECT shop_id ,  count(*) FROM happy_hour GROUP BY shop_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​happy_hour:​Shop_ID] <br>2. PROJECT[tbl:​happy_hour, #1] <br>3. GROUP[count, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. COMPARATIVE[#1, #3, comparative:​=:​#4] <br>6. PROJECT[col:​happy_hour:​Shop_ID, #5] <br>7. UNION[#6, #4] <br> | 1. SELECT[col:​happy_hour:​Shop_ID] <br>2. PROJECT[tbl:​happy_hour, #1] <br>3. GROUP[count, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. COMPARATIVE[#1, #1, comparative:​=:​#4] <br>6. PROJECT[col:​happy_hour:​Shop_ID, #5] <br>7. UNION[#6, #4] <br> | - | hard | 
  | SPIDER_train_805 | Which month has the most happy hours? | SELECT MONTH FROM happy_hour GROUP BY MONTH ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​happy_hour:​Month] <br>2. PROJECT[tbl:​happy_hour, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​happy_hour:​Month] <br>2. PROJECT[tbl:​happy_hour, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_806 | Which months have more than 2 happy hours? | SELECT MONTH FROM happy_hour GROUP BY MONTH HAVING count(*)  >  2 | 1. SELECT[col:​happy_hour:​Month] <br>2. PROJECT[tbl:​happy_hour, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | 1. SELECT[col:​happy_hour:​Month] <br>2. PROJECT[tbl:​happy_hour, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | + | easy | 
 ***
 Exec acc: **0.9167**
