 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Addresses** | address_id | + |   | 
 | 2 |   | address_content |   |   | 
 | 3 |   | city |   |   | 
 | 4 |   | zip_postcode |   |   | 
 | 5 |   | state_province_county |   |   | 
 | 6 |   | country |   |   | 
 | 7 |   | other_address_details |   |   | 
 | 8 | **Products** | product_id | + |   | 
 | 9 |   | product_details |   |   | 
 | 10 | **Customers** | customer_id | + |   | 
 | 11 |   | payment_method |   |   | 
 | 12 |   | customer_name |   |   | 
 | 13 |   | date_became_customer |   |   | 
 | 14 |   | other_customer_details |   |   | 
 | 15 | **Customer_Addresses** | customer_id |   | --> 10 | 
 | 16 |   | address_id |   | --> 1 | 
 | 17 |   | date_address_from |   |   | 
 | 18 |   | address_type |   |   | 
 | 19 |   | date_address_to |   |   | 
 | 20 | **Customer_Contact_Channels** | customer_id |   | --> 10 | 
 | 21 |   | channel_code |   |   | 
 | 22 |   | active_from_date |   |   | 
 | 23 |   | active_to_date |   |   | 
 | 24 |   | contact_number |   |   | 
 | 25 | **Customer_Orders** | order_id | + |   | 
 | 26 |   | customer_id |   | --> 10 | 
 | 27 |   | order_status |   |   | 
 | 28 |   | order_date |   |   | 
 | 29 |   | order_details |   |   | 
 | 30 | **Order_Items** | order_id |   | --> 25 | 
 | 31 |   | product_id |   | --> 8 | 
 | 32 |   | order_quantity |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6055 | Find the name of all customers. | SELECT customer_name FROM customers | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br> | + | easy | 
  | SPIDER_train_6056 | What are the names of all the customers? | SELECT customer_name FROM customers | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br> | + | easy | 
  | SPIDER_train_6058 | Return the total number of distinct customers. | SELECT count(*) FROM customers | 1. SELECT[tbl:​Customers] <br>2.*(distinct)* PROJECT[distinct #REF, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Customers] <br>2.*(distinct)* PROJECT[None, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6059 | What is the average amount of items ordered in each order? | SELECT avg(order_quantity) FROM order_items | 1. SELECT[tbl:​Order_Items] <br>2. PROJECT[col:​Order_Items:​order_quantity, #1] <br>3. GROUP[col:​Order_Items:​order_quantity, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​Order_Items] <br>2. PROJECT[col:​Order_Items:​order_quantity, #1] <br>3. GROUP[sum, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_6061 | What are the names of customers who use payment method "Cash"? | SELECT customer_name FROM customers WHERE payment_method  =  "Cash" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​payment_method, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cash:​col:​Customers:​payment_method] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​payment_method, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cash:​col:​Customers:​payment_method] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | + | easy | 
  | SPIDER_train_6062 | Which customers use "Cash" for payment method? Return the customer names. | SELECT customer_name FROM customers WHERE payment_method  =  "Cash" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​payment_method, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cash:​col:​Customers:​payment_method] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​payment_method, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cash:​col:​Customers:​payment_method] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | + | easy | 
  | SPIDER_train_6063 | Find the "date became customers" of the customers whose ID is between 10 and 20. | SELECT date_became_customer FROM customers WHERE customer_id BETWEEN 10 AND 20 | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​>=:​10:​col:​Customers:​customer_id] <br>3. FILTER[#1, comparative:​<=:​20:​col:​Customers:​customer_id] <br>4. PROJECT[col:​Customers:​date_became_customer, #1] <br>5. INTERSECTION[#4, #2, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​>=:​10:​col:​Customers:​customer_id] <br>3. COMPARATIVE[#1, #1, comparative:​<=:​20:​col:​Customers:​customer_id] <br>4. PROJECT[col:​Customers:​date_became_customer, #1] <br>5. INTERSECTION[#4, #2, #3] <br> | - | easy | 
  | SPIDER_train_6064 | What are the dates when customers with ids between 10 and 20 became customers? | SELECT date_became_customer FROM customers WHERE customer_id BETWEEN 10 AND 20 | 1. SELECT[col:​Customers:​customer_id] <br>2. FILTER[#1, comparative:​<=:​20:​col:​Customers:​customer_id] <br>3. FILTER[#2, comparative:​>=:​10:​col:​Customers:​customer_id] <br>4. PROJECT[tbl:​Customers, #3] <br>5. PROJECT[col:​Customers:​date_became_customer, #4] <br> | 1. SELECT[col:​Customers:​customer_id] <br>2. COMPARATIVE[#1, #1, comparative:​<=:​20:​col:​Customers:​customer_id] <br>3. COMPARATIVE[#2, #2, comparative:​>=:​10:​col:​Customers:​customer_id] <br>4. PROJECT[tbl:​Customers, #3] <br>5. PROJECT[col:​Customers:​date_became_customer, #4] <br> | - | easy | 
  | SPIDER_train_6065 | Which payment method is used by most customers? | SELECT payment_method FROM customers GROUP BY payment_method ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Customers:​payment_method] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Customers:​payment_method] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6068 | Find the name of the customers who use the most frequently used payment method. | SELECT customer_name FROM customers WHERE payment_method  =  (SELECT payment_method FROM customers GROUP BY payment_method ORDER BY count(*) DESC LIMIT 1) | 1. SELECT[col:​Customers:​payment_method] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[tbl:​Customers, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br> | 1. SELECT[col:​Customers:​payment_method] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[tbl:​Customers, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br> | + | hard | 
  | SPIDER_train_6069 | What are all the payment methods? | SELECT DISTINCT payment_method FROM customers | 1. SELECT[col:​Customers:​payment_method] <br> | 1. SELECT[col:​Customers:​payment_method] <br> | + | easy | 
  | SPIDER_train_6071 | What are the details of all products? | SELECT DISTINCT product_details FROM products | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br> | + | easy | 
  | SPIDER_train_6072 | Return the the details of all products. | SELECT DISTINCT product_details FROM products | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br> | + | easy | 
  | SPIDER_train_6073 | Find the name of all customers whose name contains "Alex". | SELECT customer_name FROM customers WHERE customer_name LIKE "%Alex%" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br>3. FILTER[#2, comparative:​like:​%Alex%:​col:​Customers:​customer_name] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br>3. COMPARATIVE[#2, #2, comparative:​like:​Alex:​col:​Customers:​customer_name] <br> | + | medium | 
  | SPIDER_train_6074 | Which customer's name contains "Alex"? Find the full name. | SELECT customer_name FROM customers WHERE customer_name LIKE "%Alex%" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Alex%:​col:​Customers:​customer_name] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Alex:​col:​Customers:​customer_name] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | + | medium | 
  | SPIDER_train_6075 | Find the detail of products whose detail contains the word "Latte" or the word "Americano" | SELECT product_details FROM products WHERE product_details LIKE "%Latte%" OR product_details LIKE "%Americano%" | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br>3. FILTER[#2, comparative:​like:​%Latte%:​col:​Products:​product_details] <br>4. FILTER[#2, comparative:​like:​%Americano%:​col:​Products:​product_details] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br>3. COMPARATIVE[#2, #2, comparative:​like:​Latte:​col:​Products:​product_details] <br>4. COMPARATIVE[#2, #2, comparative:​like:​Americano:​col:​Products:​product_details] <br>5. UNION[#3, #4] <br> | + | extra | 
  | SPIDER_train_6076 | Which product's detail contains the word "Latte" or "Americano"? Return the full detail. | SELECT product_details FROM products WHERE product_details LIKE "%Latte%" OR product_details LIKE "%Americano%" | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Latte%:​col:​Products:​product_details] <br>4. COMPARATIVE[#1, #2, comparative:​like:​%Americano%:​col:​Products:​product_details] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Products:​product_details, #5] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Latte:​col:​Products:​product_details] <br>4. COMPARATIVE[#1, #2, comparative:​like:​Americano:​col:​Products:​product_details] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Products:​product_details, #5] <br> | + | extra | 
  | SPIDER_train_6077 | What is the address content of the customer named "Maudie Kertzmann"? | SELECT t3.address_content FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t1.customer_name  =  "Maudie Kertzmann" | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​=:​Maudie Kertzmann:​col:​Customers:​customer_name] <br>3. PROJECT[col:​Addresses:​address_content, #2] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Maudie Kertzmann:​col:​Customers:​customer_name] <br>3. PROJECT[col:​Addresses:​address_content, #2] <br> | + | hard | 
  | SPIDER_train_6078 | Return the address content for the customer whose name is "Maudie Kertzmann". | SELECT t3.address_content FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t1.customer_name  =  "Maudie Kertzmann" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Maudie Kertzmann:​col:​Customers:​customer_name] <br>4. PROJECT[col:​Addresses:​address_content, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Maudie Kertzmann:​col:​Customers:​customer_name] <br>4. PROJECT[col:​Addresses:​address_content, #3] <br> | + | hard | 
  | SPIDER_train_6079 | How many customers are living in city "Lake Geovannyton"? | SELECT count(*) FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t3.city  =  "Lake Geovannyton" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Lake Geovannyton:​col:​Addresses:​city] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Lake Geovannyton:​col:​Addresses:​city] <br>4. AGGREGATE[count, #3] <br> | + | hard | 
  | SPIDER_train_6080 | Find the number of customers who live in the city called Lake Geovannyton. | SELECT count(*) FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t3.city  =  "Lake Geovannyton" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Lake Geovannyton:​col:​Addresses:​city] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Lake Geovannyton:​col:​Addresses:​city] <br>4. AGGREGATE[count, #3] <br> | + | hard | 
  | SPIDER_train_6081 | Find the name of customers who are living in Colorado? | SELECT t1.customer_name FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t3.state_province_county  =  "Colorado" | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​=:​Colorado:​col:​Addresses:​state_province_county] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Colorado:​col:​Addresses:​state_province_county] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br> | + | hard | 
  | SPIDER_train_6082 | What are the names of customers who live in Colorado state? | SELECT t1.customer_name FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t3.state_province_county  =  "Colorado" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​state_province_county, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Colorado:​col:​Addresses:​state_province_county] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​state_province_county, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Colorado:​col:​Addresses:​state_province_county] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | + | hard | 
  | SPIDER_train_6085 | Which city has the most customers living in? | SELECT t3.city FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id GROUP BY t3.city ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_6086 | Find the city where the most customers live. | SELECT t3.city FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id GROUP BY t3.city ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_6087 | Retrieve the list of all cities. | SELECT DISTINCT city FROM addresses | 1. SELECT[col:​Addresses:​city] <br> | 1. SELECT[col:​Addresses:​city] <br> | + | easy | 
  | SPIDER_train_6088 | List all the distinct cities | SELECT DISTINCT city FROM addresses | 1. SELECT[col:​Addresses:​city] <br>2.*(distinct)* PROJECT[distinct #REF, #1] <br> | 1. SELECT[col:​Addresses:​city] <br>2.*(distinct)* PROJECT[None, #1] <br> | + | easy | 
  | SPIDER_train_6089 | Find the city with post code 255. | SELECT city FROM addresses WHERE zip_postcode  =  255 | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[col:​Addresses:​zip_postcode, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​255:​col:​Addresses:​zip_postcode] <br> | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[col:​Addresses:​zip_postcode, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​255:​col:​Addresses:​zip_postcode] <br> | + | easy | 
  | SPIDER_train_6090 | Which city is post code 255 located in? | SELECT city FROM addresses WHERE zip_postcode  =  255 | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[col:​Addresses:​zip_postcode, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​255:​col:​Addresses:​zip_postcode] <br> | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[col:​Addresses:​zip_postcode, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​255:​col:​Addresses:​zip_postcode] <br> | + | easy | 
  | SPIDER_train_6093 | List the countries having more than 4 addresses listed. | SELECT country FROM addresses GROUP BY country HAVING count(address_id)  >  4 | 1. SELECT[col:​Addresses:​country] <br>2. PROJECT[tbl:​Addresses, #1] <br>3. GROUP[tbl:​Addresses, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Addresses:​address_id] <br> | 1. SELECT[col:​Addresses:​country] <br>2. PROJECT[tbl:​Addresses, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Addresses:​address_id] <br> | - | easy | 
  | SPIDER_train_6094 | For which countries are there more than four distinct addresses listed? | SELECT country FROM addresses GROUP BY country HAVING count(address_id)  >  4 | 1. SELECT[col:​Addresses:​country] <br>2. PROJECT[tbl:​Addresses, #1] <br>3. GROUP[tbl:​Addresses, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Addresses:​address_id] <br> | 1. SELECT[col:​Addresses:​country] <br>2. PROJECT[tbl:​Addresses, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​4:​col:​Addresses:​address_id] <br> | - | easy | 
  | SPIDER_train_6105 | Find the name and active date of the customer that use email as the contact channel. | SELECT t1.customer_name ,  t2.active_from_date FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t2.channel_code  =  'Email' | 1. SELECT[tbl:​Customer_Contact_Channels] <br>2. PROJECT[tbl:​Customer_Contact_Channels, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Email:​col:​Customer_Contact_Channels:​channel_code] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customer_Contact_Channels:​active_from_date, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customer_Contact_Channels] <br>2. PROJECT[tbl:​Customer_Contact_Channels, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Email:​col:​Customer_Contact_Channels:​channel_code] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customer_Contact_Channels:​active_from_date, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6106 | What are the name and active date of the customers whose contact channel code is email? | SELECT t1.customer_name ,  t2.active_from_date FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t2.channel_code  =  'Email' | 1. SELECT[tbl:​Customer_Contact_Channels] <br>2. PROJECT[tbl:​Customer_Contact_Channels, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Email:​col:​Customer_Contact_Channels:​channel_code] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customer_Contact_Channels:​active_from_date, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customer_Contact_Channels] <br>2. PROJECT[tbl:​Customer_Contact_Channels, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Email:​col:​Customer_Contact_Channels:​channel_code] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br>5. PROJECT[col:​Customer_Contact_Channels:​active_from_date, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6107 | What is the name of the customer that made the order with the largest quantity? | SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id WHERE t3.order_quantity  =  ( SELECT max(order_quantity) FROM order_items) | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[col:​Order_Items:​order_quantity, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[col:​Order_Items:​order_quantity, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | + | extra | 
  | SPIDER_train_6108 | Find the name of the customer who made the order of the largest amount of goods. | SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id WHERE t3.order_quantity  =  ( SELECT max(order_quantity) FROM order_items) | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[goods in #REF, #2] <br>4. GROUP[col:​Order_Items:​order_quantity, #3, #2] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[None, #2] <br>4. GROUP[sum, #3, #2] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br> | + | extra | 
  | SPIDER_train_6109 | What is the name of the customer that has purchased the most items? | SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id GROUP BY t1.customer_name ORDER BY sum(t3.order_quantity) DESC LIMIT 1 | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | + | extra | 
  | SPIDER_train_6110 | Give me the name of the customer who ordered the most items in total. | SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id GROUP BY t1.customer_name ORDER BY sum(t3.order_quantity) DESC LIMIT 1 | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | + | extra | 
  | SPIDER_train_6112 | Tell me the payment method used by the customer who ordered the least amount of goods in total. | SELECT t1.payment_method FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id GROUP BY t1.customer_name ORDER BY sum(t3.order_quantity) LIMIT 1 | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. GROUP[col:​Order_Items:​order_quantity, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Customers:​payment_method, #4] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Customers:​payment_method, #4] <br> | + | extra | 
  | SPIDER_train_6113 | How many types of products have Rodrick Heaney bought in total? | SELECT count(DISTINCT t3.product_id) FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id WHERE t1.customer_name  =  "Rodrick Heaney" | 1. SELECT[col:​Order_Items:​product_id] <br>2. FILTER[#1, comparative:​=:​Rodrick Heaney:​col:​Customers:​customer_name] <br>3. PROJECT[types of #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​Order_Items:​product_id] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Rodrick Heaney:​col:​Customers:​customer_name] <br>3. PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | hard | 
  | SPIDER_train_6114 | Find the number of distinct products Rodrick Heaney has bought so far. | SELECT count(DISTINCT t3.product_id) FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id WHERE t1.customer_name  =  "Rodrick Heaney" | 1. SELECT[col:​Order_Items:​product_id] <br>2. FILTER[#1, comparative:​=:​Rodrick Heaney:​col:​Customers:​customer_name] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​Order_Items:​product_id] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Rodrick Heaney:​col:​Customers:​customer_name] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | hard | 
  | SPIDER_train_6117 | How many customers have at least one order with status "Cancelled"? | SELECT count(DISTINCT customer_id) FROM customer_orders WHERE order_status  =  "Cancelled" | 1. SELECT[col:​Customer_Orders:​customer_id] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[col:​Customer_Orders:​order_status, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[col:​Customer_Orders:​customer_id] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. PROJECT[col:​Customer_Orders:​order_status, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
  | SPIDER_train_6118 | Return the number of customers who have at least one order with "Cancelled" status. | SELECT count(DISTINCT customer_id) FROM customer_orders WHERE order_status  =  "Cancelled" | 1. SELECT[col:​Customer_Orders:​customer_id] <br>2. FILTER[#1, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Customer_Orders:​customer_id] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Cancelled:​col:​Customer_Orders:​order_status] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6119 | How many orders have detail "Second time"? | SELECT count(*) FROM customer_orders WHERE order_details  =  "Second time" | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[col:​Customer_Orders:​order_details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Second time:​col:​Customer_Orders:​order_details] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[col:​Customer_Orders:​order_details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Second time:​col:​Customer_Orders:​order_details] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6120 | Tell me the number of orders with "Second time" as order detail. | SELECT count(*) FROM customer_orders WHERE order_details  =  "Second time" | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Second time:​col:​Customer_Orders:​order_details] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Second time:​col:​Customer_Orders:​order_details] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6121 | Find the customer name and date of the orders that have the status "Delivered". | SELECT t1.customer_name ,  t2.order_date FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id WHERE order_status  =  "Delivered" | 1. SELECT[tbl:​Customer_Orders] <br>2. FILTER[#1, comparative:​=:​Delivered:​col:​Customer_Orders:​order_status] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br>4. PROJECT[col:​Customer_Orders:​order_date, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Delivered:​col:​Customer_Orders:​order_status] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br>4. PROJECT[col:​Customer_Orders:​order_date, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_6122 | What are the customer name and date of the orders whose status is "Delivered". | SELECT t1.customer_name ,  t2.order_date FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id WHERE order_status  =  "Delivered" | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[col:​Customer_Orders:​order_status, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Delivered:​col:​Customer_Orders:​order_status] <br>4. PROJECT[tbl:​Customer_Orders, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br>6. PROJECT[col:​Customer_Orders:​order_date, #3] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[col:​Customer_Orders:​order_status, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Delivered:​col:​Customer_Orders:​order_status] <br>4. PROJECT[tbl:​Customer_Orders, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br>6. PROJECT[col:​Customer_Orders:​order_date, #3] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6127 | Who made the latest order? | SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id ORDER BY t2.order_date DESC LIMIT 1 | 1. SELECT[col:​Customer_Orders:​order_date] <br>2. FILTER[#1, comparative:​max:​None] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br> | 1. SELECT[col:​Customer_Orders:​order_date] <br>2. SUPERLATIVE[comparative:​max:​None, #1, #1] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br> | + | hard | 
  | SPIDER_train_6132 | What are the name and ID of the product bought the most. | SELECT t2.product_details ,  t2.product_id FROM order_items AS t1 JOIN products AS t2 ON t1.product_id  =  t2.product_id GROUP BY t1.product_id ORDER BY sum(t1.order_quantity) LIMIT 1 | 1. SELECT[col:​Order_Items:​product_id] <br>2. FILTER[#1, comparative:​min:​None] <br>3. PROJECT[col:​Products:​product_details, #2] <br>4. PROJECT[col:​Products:​product_id, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​Order_Items:​product_id] <br>2. SUPERLATIVE[comparative:​min:​None, #1, #1] <br>3. PROJECT[col:​Products:​product_details, #2] <br>4. PROJECT[col:​Products:​product_id, #2] <br>5. UNION[#3, #4] <br> | - | extra | 
  | SPIDER_train_6135 | Find the name of customers who did not pay with Cash. | SELECT customer_name FROM customers WHERE payment_method != 'Cash' | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​!=:​Cash:​col:​Customers:​payment_method] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​!=:​Cash:​col:​Customers:​payment_method] <br>3. PROJECT[col:​Customers:​customer_name, #2] <br> | + | easy | 
  | SPIDER_train_6136 | What is the name of customers who do not use Cash as payment method. | SELECT customer_name FROM customers WHERE payment_method != 'Cash' | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​payment_method, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Cash:​col:​Customers:​payment_method] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​payment_method, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Cash:​col:​Customers:​payment_method] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | + | easy | 
  | SPIDER_train_6137 | Find the names of customers who never ordered product Latte. | SELECT customer_name FROM customers EXCEPT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE t4.product_details  =  'Latte' | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​=:​Latte:​col:​Products:​product_details] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Latte:​col:​Products:​product_details] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | + | hard | 
  | SPIDER_train_6138 | What are names of customers who never ordered product Latte. | SELECT customer_name FROM customers EXCEPT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE t4.product_details  =  'Latte' | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Latte:​col:​Products:​product_details] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Latte:​col:​Products:​product_details] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | + | hard | 
  | SPIDER_train_6139 | Find the names of customers who never placed an order. | SELECT customer_name FROM customers EXCEPT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Customer_Orders] <br>3. SELECT[tbl:​Customers] <br>4. DISCARD[#3, #2] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Customer_Orders] <br>3. SELECT[tbl:​Customers] <br>4. DISCARD[#3, #2] <br>5. PROJECT[col:​Customers:​customer_name, #4] <br> | + | hard | 
  | SPIDER_train_6141 | Find the names of customers who ordered both products Latte and Americano. | SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE t4.product_details  =  'Latte' INTERSECT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE t4.product_details  =  'Americano' | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Latte:​col:​Products:​product_details] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Americano:​col:​Products:​product_details] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. PROJECT[tbl:​Customer_Orders, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Latte:​col:​Products:​product_details] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Americano:​col:​Products:​product_details] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​customer_name, #5] <br> | + | extra | 
  | SPIDER_train_6142 | What are the names of customers who have purchased both products Latte and Americano? | SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE t4.product_details  =  'Latte' INTERSECT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE t4.product_details  =  'Americano' | 1. SELECT[tbl:​Customer_Orders] <br>2. FILTER[#1, comparative:​=:​Latte:​col:​Products:​product_details] <br>3. FILTER[#2, comparative:​=:​Americano:​col:​Products:​product_details] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | 1. SELECT[tbl:​Customer_Orders] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Latte:​col:​Products:​product_details] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Americano:​col:​Products:​product_details] <br>4. PROJECT[col:​Customers:​customer_name, #3] <br> | + | extra | 
 ***
 Exec acc: **0.9091**
