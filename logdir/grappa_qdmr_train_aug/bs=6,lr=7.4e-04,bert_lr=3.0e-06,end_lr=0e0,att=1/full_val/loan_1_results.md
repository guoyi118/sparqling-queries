 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **bank** | branch_ID | + | --> 12 | 
 | 2 |   | bname |   |   | 
 | 3 |   | no_of_customers |   |   | 
 | 4 |   | city |   |   | 
 | 5 |   | state |   |   | 
 | 6 | **customer** | cust_ID | + |   | 
 | 7 |   | cust_name |   |   | 
 | 8 |   | acc_type |   |   | 
 | 9 |   | acc_bal |   |   | 
 | 10 |   | no_of_loans |   |   | 
 | 11 |   | credit_score |   |   | 
 | 12 |   | branch_ID |   |   | 
 | 13 |   | state |   |   | 
 | 14 | **loan** | loan_ID | + |   | 
 | 15 |   | loan_type |   |   | 
 | 16 |   | cust_ID |   | --> 6 | 
 | 17 |   | branch_ID |   |   | 
 | 18 |   | amount |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3006 | How many bank branches are there? | SELECT count(*) FROM bank | 1. SELECT[tbl:​bank] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​bank] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3007 | Count the number of bank branches. | SELECT count(*) FROM bank | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​branch_ID, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​branch_ID, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3012 | Find the average number of customers in all banks of Utah state. | SELECT avg(no_of_customers) FROM bank WHERE state  =  'Utah' | 1. SELECT[col:​bank:​state] <br>2. FILTER[#1, comparative:​=:​Utah:​col:​bank:​state] <br>3. PROJECT[tbl:​bank, #2] <br>4. PROJECT[col:​bank:​no_of_customers, #3] <br>5. GROUP[col:​bank:​no_of_customers, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | 1. SELECT[col:​bank:​state] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Utah:​col:​bank:​state] <br>3. PROJECT[tbl:​bank, #2] <br>4. PROJECT[col:​bank:​no_of_customers, #3] <br>5. GROUP[sum, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | + | easy | 
  | SPIDER_train_3013 | What is the average number of customers across banks in the state of Utah? | SELECT avg(no_of_customers) FROM bank WHERE state  =  'Utah' | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​state, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Utah:​col:​bank:​state] <br>4. PROJECT[col:​bank:​no_of_customers, #3] <br>5. AGGREGATE[col:​bank:​no_of_customers, #4] <br>6. AGGREGATE[avg, #5] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​state, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Utah:​col:​bank:​state] <br>4. PROJECT[col:​bank:​no_of_customers, #3] <br>5. AGGREGATE[sum, #4] <br>6. AGGREGATE[avg, #5] <br> | + | easy | 
  | SPIDER_train_3014 | Find the average number of customers cross all banks. | SELECT avg(no_of_customers) FROM bank | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. AGGREGATE[col:​bank:​no_of_customers, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. AGGREGATE[sum, #2] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_3015 | What is the average number of bank customers? | SELECT avg(no_of_customers) FROM bank | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. AGGREGATE[col:​bank:​no_of_customers, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. AGGREGATE[sum, #2] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_3016 | Find the city and state of the bank branch named morningside. | SELECT city ,  state FROM bank WHERE bname  =  'morningside' | 1. SELECT[tbl:​bank] <br>2. FILTER[#1, comparative:​=:​morningside:​col:​bank:​bname] <br>3. PROJECT[col:​bank:​city, #2] <br>4. PROJECT[col:​bank:​state, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​bank] <br>2. COMPARATIVE[#1, #1, comparative:​=:​morningside:​col:​bank:​bname] <br>3. PROJECT[col:​bank:​city, #2] <br>4. PROJECT[col:​bank:​state, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3017 | What city and state is the bank with the name morningside in? | SELECT city ,  state FROM bank WHERE bname  =  'morningside' | 1. SELECT[val:​bank:​bname:​morningside] <br>2. PROJECT[col:​bank:​city, #1] <br>3. PROJECT[col:​bank:​state, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[val:​bank:​bname:​morningside] <br>2. PROJECT[col:​bank:​city, #1] <br>3. PROJECT[col:​bank:​state, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_3018 | Find the branch names of banks in the New York state. | SELECT bname FROM bank WHERE state  =  'New York' | 1. SELECT[tbl:​bank] <br>2. FILTER[#1, comparative:​=:​New York:​col:​bank:​state] <br>3. PROJECT[col:​bank:​bname, #2] <br> | 1. SELECT[tbl:​bank] <br>2. COMPARATIVE[#1, #1, comparative:​=:​New York:​col:​bank:​state] <br>3. PROJECT[col:​bank:​bname, #2] <br> | + | easy | 
  | SPIDER_train_3019 | What are the names of banks in the state of New York? | SELECT bname FROM bank WHERE state  =  'New York' | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​state, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​New York:​col:​bank:​state] <br>4. PROJECT[col:​bank:​bname, #3] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​state, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​New York:​col:​bank:​state] <br>4. PROJECT[col:​bank:​bname, #3] <br> | + | easy | 
  | SPIDER_train_3020 | List the name of all customers sorted by their account balance in ascending order. | SELECT cust_name FROM customer ORDER BY acc_bal | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. PROJECT[col:​customer:​acc_bal, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. PROJECT[col:​customer:​acc_bal, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3021 | What are the names of all customers, ordered by account balance? | SELECT cust_name FROM customer ORDER BY acc_bal | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. PROJECT[col:​customer:​acc_bal, #1] <br>4. SORT[#2, #3] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. PROJECT[col:​customer:​acc_bal, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3022 | List the name of all different customers who have some loan sorted by their total loan amount. | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name ORDER BY sum(T2.amount) | 1. SELECT[tbl:​customer] <br>2. PROJECT[different #REF, #1] <br>3. PROJECT[col:​customer:​cust_name, #2] <br>4. PROJECT[tbl:​loan, #2] <br>5. PROJECT[col:​loan:​amount, #4] <br>6. GROUP[sum, #5, #2] <br>7. SORT[#3, #6] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[None, #1] <br>3. PROJECT[col:​customer:​cust_name, #2] <br>4. PROJECT[tbl:​loan, #2] <br>5. PROJECT[col:​loan:​amount, #4] <br>6. GROUP[sum, #5, #2] <br>7. SORT[#3, #6, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_3023 | What are the names of the different customers who have taken out a loan, ordered by the total amount that they have taken? | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name ORDER BY sum(T2.amount) | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, is at least one] <br>5. PROJECT[tbl:​loan, #4] <br>6. PROJECT[col:​loan:​amount, #5] <br>7. GROUP[sum, #6, #4] <br>8. PROJECT[col:​customer:​cust_name, #4] <br>9. SORT[#8, #7] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #1, None] <br>5. PROJECT[tbl:​loan, #4] <br>6. PROJECT[col:​loan:​amount, #5] <br>7. GROUP[sum, #6, #4] <br>8. PROJECT[col:​customer:​cust_name, #4] <br>9. SORT[#8, #7, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_3026 | Find the number of different cities which banks are located at. | SELECT count(DISTINCT city) FROM bank | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​city, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​city, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3027 | In how many different cities are banks located? | SELECT count(DISTINCT city) FROM bank | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​city, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​city, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3029 | In how many different states are banks located? | SELECT count(DISTINCT state) FROM bank | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​state, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​state, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3030 | How many distinct types of accounts are there? | SELECT count(DISTINCT acc_type) FROM customer | 1. SELECT[col:​customer:​acc_type] <br>2. PROJECT[col:​customer:​acc_type, #1] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​customer:​acc_type] <br>2. PROJECT[col:​customer:​acc_type, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3031 | Count the number of different account types. | SELECT count(DISTINCT acc_type) FROM customer | 1. SELECT[col:​customer:​acc_type] <br>2. FILTER[#1, col:​customer:​acc_type] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​customer:​acc_type] <br>2. COMPARATIVE[#1, #1, col:​customer:​acc_type] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3032 | Find the name and account balance of the customer whose name includes the letter ‘a’. | SELECT cust_name ,  acc_bal FROM customer WHERE cust_name LIKE '%a%' | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%a%:​col:​customer:​cust_name] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_bal, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​a:​col:​customer:​cust_name] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_bal, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3033 | What are the names and account balances of customers with the letter a in their names? | SELECT cust_name ,  acc_bal FROM customer WHERE cust_name LIKE '%a%' | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%a%:​col:​customer:​cust_name] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_bal, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​cust_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​a:​col:​customer:​cust_name] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_bal, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3036 | Find the name of customers who have both saving and checking account types. | SELECT cust_name FROM customer WHERE acc_type  =  'saving' INTERSECT SELECT cust_name FROM customer WHERE acc_type  =  'checking' | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​acc_type, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​saving:​col:​customer:​acc_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​checking:​col:​customer:​acc_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​acc_type, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​saving:​col:​customer:​acc_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​checking:​col:​customer:​acc_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | + | hard | 
  | SPIDER_train_3037 | What are the names of customers who have both savings and checking accounts? | SELECT cust_name FROM customer WHERE acc_type  =  'saving' INTERSECT SELECT cust_name FROM customer WHERE acc_type  =  'checking' | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​acc_type, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​saving:​col:​customer:​acc_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​checking:​col:​customer:​acc_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​acc_type, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​saving:​col:​customer:​acc_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​checking:​col:​customer:​acc_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | + | hard | 
  | SPIDER_train_3038 | Find the name of customers who do not have an saving account. | SELECT cust_name FROM customer EXCEPT SELECT cust_name FROM customer WHERE acc_type  =  'saving' | 1. SELECT[tbl:​customer] <br>2. FILTER[#1, comparative:​=:​saving:​col:​customer:​acc_type] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br> | 1. SELECT[tbl:​customer] <br>2. COMPARATIVE[#1, #1, comparative:​=:​saving:​col:​customer:​acc_type] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br> | + | hard | 
  | SPIDER_train_3040 | Find the name of customers who do not have a loan with a type of Mortgages. | SELECT cust_name FROM customer EXCEPT SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE T2.loan_type  =  'Mortgages' | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Mortgages:​col:​loan:​loan_type] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Mortgages:​col:​loan:​loan_type] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | + | hard | 
  | SPIDER_train_3042 | Find the name of customers who have loans of both Mortgages and Auto. | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Mortgages' INTERSECT SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Auto' | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Mortgages:​col:​loan:​loan_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Auto:​col:​loan:​loan_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Mortgages:​col:​loan:​loan_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Auto:​col:​loan:​loan_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | + | extra | 
  | SPIDER_train_3043 | What are the names of customers who have taken both Mortgage and Auto loans? | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Mortgages' INTERSECT SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Auto' | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Mortgages:​col:​loan:​loan_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Auto:​col:​loan:​loan_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Mortgages:​col:​loan:​loan_type] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Auto:​col:​loan:​loan_type] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | + | extra | 
  | SPIDER_train_3044 | Find the name of customers whose credit score is below the average credit scores of all customers. | SELECT cust_name FROM customer WHERE credit_score  <  (SELECT avg(credit_score) FROM customer) | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | - | hard | 
  | SPIDER_train_3045 | What are the names of customers with credit score less than the average credit score across customers? | SELECT cust_name FROM customer WHERE credit_score  <  (SELECT avg(credit_score) FROM customer) | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​Business:​col:​loan:​loan_type] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | - | hard | 
  | SPIDER_train_3047 | What is the name of the bank branch with the greatest number of customers? | SELECT bname FROM bank ORDER BY no_of_customers DESC LIMIT 1 | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. PROJECT[col:​bank:​no_of_customers, #2] <br>4. GROUP[col:​bank:​no_of_customers, #3, #2] <br>5. COMPARATIVE[#2, #4, comparative:​max:​None] <br>6. PROJECT[col:​bank:​bname, #5] <br> | 1. SELECT[tbl:​bank] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. PROJECT[col:​bank:​no_of_customers, #2] <br>4. GROUP[sum, #3, #2] <br>5. SUPERLATIVE[comparative:​max:​None, #2, #4] <br>6. PROJECT[col:​bank:​bname, #5] <br> | + | medium | 
  | SPIDER_train_3048 | Find the name of customer who has the lowest credit score. | SELECT cust_name FROM customer ORDER BY credit_score LIMIT 1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br> | + | medium | 
  | SPIDER_train_3049 | What is the name of the customer with the worst credit score? | SELECT cust_name FROM customer ORDER BY credit_score LIMIT 1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br> | + | medium | 
  | SPIDER_train_3050 | Find the name, account type, and account balance of the customer who has the highest credit score. | SELECT cust_name ,  acc_type ,  acc_bal FROM customer ORDER BY credit_score DESC LIMIT 1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_type, #3] <br>6. PROJECT[col:​customer:​acc_bal, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_type, #3] <br>6. PROJECT[col:​customer:​acc_bal, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_3051 | What is the name, account type, and account balance corresponding to the customer with the highest credit score? | SELECT cust_name ,  acc_type ,  acc_bal FROM customer ORDER BY credit_score DESC LIMIT 1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_type, #3] <br>6. PROJECT[col:​customer:​acc_bal, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[col:​customer:​credit_score, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​customer:​cust_name, #3] <br>5. PROJECT[col:​customer:​acc_type, #3] <br>6. PROJECT[col:​customer:​acc_bal, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_3052 | Find the name of customer who has the highest amount of loans. | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name ORDER BY sum(T2.amount) DESC LIMIT 1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | + | extra | 
  | SPIDER_train_3053 | What is the name of the customer who has greatest total loan amount? | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name ORDER BY sum(T2.amount) DESC LIMIT 1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​customer:​cust_name, #5] <br> | + | extra | 
  | SPIDER_train_3054 | Find the state which has the most number of customers. | SELECT state FROM bank GROUP BY state ORDER BY sum(no_of_customers) DESC LIMIT 1 | 1. SELECT[col:​bank:​state] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. AGGREGATE[col:​bank:​no_of_customers, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​bank:​state] <br>2. PROJECT[col:​bank:​no_of_customers, #1] <br>3. AGGREGATE[sum, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_3055 | Which state has the greatest total number of bank customers? | SELECT state FROM bank GROUP BY state ORDER BY sum(no_of_customers) DESC LIMIT 1 | 1. SELECT[col:​bank:​state] <br>2. PROJECT[tbl:​bank, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​bank:​state] <br>2. PROJECT[tbl:​bank, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_3062 | Find the name of customers who have more than one loan. | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name HAVING count(*)  >  1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | + | medium | 
  | SPIDER_train_3063 | What are the names of customers who have taken out more than one loan? | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name HAVING count(*)  >  1 | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | + | medium | 
  | SPIDER_train_3066 | Find the name of bank branch that provided the greatest total amount of loans. | SELECT T1.bname FROM bank AS T1 JOIN loan AS T2 ON T1.branch_id  =  T2.branch_id GROUP BY T1.bname ORDER BY sum(T2.amount) DESC LIMIT 1 | 1. SELECT[tbl:​loan] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​bank:​bname, #5] <br> | 1. SELECT[tbl:​loan] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​bank:​bname, #5] <br> | + | extra | 
  | SPIDER_train_3067 | What is the name of the bank branch that has lent the greatest amount? | SELECT T1.bname FROM bank AS T1 JOIN loan AS T2 ON T1.branch_id  =  T2.branch_id GROUP BY T1.bname ORDER BY sum(T2.amount) DESC LIMIT 1 | 1. SELECT[tbl:​loan] <br>2. PROJECT[col:​loan:​amount, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​bank:​bname, #3] <br> | 1. SELECT[tbl:​loan] <br>2. PROJECT[col:​loan:​amount, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​bank:​bname, #3] <br> | + | extra | 
  | SPIDER_train_3072 | Find the name and credit score of the customers who have some loans. | SELECT DISTINCT T1.cust_name ,  T1.credit_score FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id | 1. SELECT[tbl:​customer] <br>2. FILTER[#1, tbl:​loan] <br>3. PROJECT[col:​customer:​cust_name, #2] <br>4. PROJECT[col:​customer:​credit_score, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​customer] <br>2. COMPARATIVE[#1, #1, tbl:​loan] <br>3. PROJECT[col:​customer:​cust_name, #2] <br>4. PROJECT[col:​customer:​credit_score, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3073 | What are the different names and credit scores of customers who have taken a loan? | SELECT DISTINCT T1.cust_name ,  T1.credit_score FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id | 1. SELECT[tbl:​customer] <br>2. FILTER[#1, tbl:​loan] <br>3.*(distinct)* PROJECT[col:​customer:​cust_name, #2] <br>4. PROJECT[col:​customer:​credit_score, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​customer] <br>2. COMPARATIVE[#1, #1, tbl:​loan] <br>3.*(distinct)* PROJECT[col:​customer:​cust_name, #2] <br>4. PROJECT[col:​customer:​credit_score, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3074 | Find the the name of the customers who have a loan with amount more than 3000. | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE amount  >  3000 | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3000:​col:​loan:​amount] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3000:​col:​loan:​amount] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | + | medium | 
  | SPIDER_train_3075 | What are the names of customers who have a loan of more than 3000 in amount? | SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE amount  >  3000 | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3000:​col:​loan:​amount] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | 1. SELECT[tbl:​customer] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​loan:​amount, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3000:​col:​loan:​amount] <br>5. PROJECT[col:​customer:​cust_name, #4] <br> | + | medium | 
  | SPIDER_train_3077 | What are the names and cities of bank branches that offer loans for business? | SELECT T1.bname ,  T1.city FROM bank AS T1 JOIN loan AS T2 ON T1.branch_id  =  T2.branch_id WHERE T2.loan_type  =  'Business' | 1. SELECT[tbl:​loan] <br>2. FILTER[#1, comparative:​=:​Business:​col:​loan:​loan_type] <br>3. PROJECT[col:​bank:​city, #2] <br>4. PROJECT[col:​bank:​bname, #2] <br>5. UNION[#4, #3] <br> | 1. SELECT[tbl:​loan] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Business:​col:​loan:​loan_type] <br>3. PROJECT[col:​bank:​city, #2] <br>4. PROJECT[col:​bank:​bname, #2] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_3078 | Find the names of bank branches that have provided a loan to any customer whose credit score is below 100. | SELECT T2.bname FROM loan AS T1 JOIN bank AS T2 ON T1.branch_id  =  T2.branch_id JOIN customer AS T3 ON T1.cust_id  =  T3.cust_id WHERE T3.credit_score  <  100 | 1. SELECT[tbl:​loan] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​customer:​credit_score, #2] <br>4. COMPARATIVE[#1, #3, comparative:​<:​100:​col:​customer:​credit_score] <br>5. PROJECT[col:​bank:​bname, #4] <br> | 1. SELECT[tbl:​loan] <br>2. PROJECT[tbl:​loan, #1] <br>3. PROJECT[col:​customer:​credit_score, #2] <br>4. COMPARATIVE[#1, #3, comparative:​<:​100:​col:​customer:​credit_score] <br>5. PROJECT[col:​bank:​bname, #4] <br> | + | hard | 
  | SPIDER_train_3080 | Find the total amount of loans provided by bank branches in the state of New York. | SELECT sum(T2.amount) FROM bank AS T1 JOIN loan AS T2 ON T1.branch_id  =  T2.branch_id WHERE T1.state  =  'New York' | 1. SELECT[tbl:​loan] <br>2. FILTER[#1, comparative:​=:​New York:​col:​bank:​state] <br>3. PROJECT[tbl:​loan, #2] <br>4. PROJECT[col:​loan:​amount, #3] <br>5. AGGREGATE[sum, #4] <br> | 1. SELECT[tbl:​loan] <br>2. COMPARATIVE[#1, #1, comparative:​=:​New York:​col:​bank:​state] <br>3. PROJECT[tbl:​loan, #2] <br>4. PROJECT[col:​loan:​amount, #3] <br>5. AGGREGATE[sum, #4] <br> | + | medium | 
  | SPIDER_train_3082 | Find the average credit score of the customers who have some loan. | SELECT avg(credit_score) FROM customer WHERE cust_id IN (SELECT cust_id FROM loan) | 1. SELECT[tbl:​customer] <br>2. FILTER[#1, tbl:​loan] <br>3. PROJECT[col:​customer:​credit_score, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​customer] <br>2. COMPARATIVE[#1, #1, tbl:​loan] <br>3. PROJECT[col:​customer:​credit_score, #2] <br>4. AGGREGATE[avg, #3] <br> | + | hard | 
  | SPIDER_train_3083 | What is the average credit score for customers who have taken a loan? | SELECT avg(credit_score) FROM customer WHERE cust_id IN (SELECT cust_id FROM loan) | 1. SELECT[tbl:​customer] <br>2. FILTER[#1, tbl:​loan] <br>3. PROJECT[col:​customer:​credit_score, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​customer] <br>2. COMPARATIVE[#1, #1, tbl:​loan] <br>3. PROJECT[col:​customer:​credit_score, #2] <br>4. AGGREGATE[avg, #3] <br> | + | hard | 
  | SPIDER_train_3085 | What is the average credit score for customers who have never taken a loan? | SELECT avg(credit_score) FROM customer WHERE cust_id NOT IN (SELECT cust_id FROM loan) | 1. SELECT[tbl:​customer] <br>2. FILTER[#1, tbl:​loan] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​customer:​credit_score, #3] <br>5. AGGREGATE[avg, #4] <br> | 1. SELECT[tbl:​customer] <br>2. COMPARATIVE[#1, #1, tbl:​loan] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​customer:​credit_score, #3] <br>5. AGGREGATE[avg, #4] <br> | + | extra | 
 ***
 Exec acc: **0.9615**
