 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **storm** | Storm_ID | + |   | 
 | 2 |   | Name |   |   | 
 | 3 |   | Dates_active |   |   | 
 | 4 |   | Max_speed |   |   | 
 | 5 |   | Damage_millions_USD |   |   | 
 | 6 |   | Number_Deaths |   |   | 
 | 7 | **region** | Region_id | + |   | 
 | 8 |   | Region_code |   |   | 
 | 9 |   | Region_name |   |   | 
 | 10 | **affected_region** | Region_id | + | --> 7 | 
 | 11 |   | Storm_ID |   | --> 1 | 
 | 12 |   | Number_city_affected |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_2692 | Show all region code and region name sorted by the codes. | SELECT region_code ,  region_name FROM region ORDER BY region_code | 1. SELECT[tbl:​region] <br>2. PROJECT[col:​region:​Region_code, #1] <br>3. PROJECT[col:​region:​Region_name, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2] <br> | 1. SELECT[tbl:​region] <br>2. PROJECT[col:​region:​Region_code, #1] <br>3. PROJECT[col:​region:​Region_name, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_2693 | What are the codes and names for all regions, sorted by codes? | SELECT region_code ,  region_name FROM region ORDER BY region_code | 1. SELECT[tbl:​region] <br>2. PROJECT[col:​region:​Region_code, #1] <br>3. PROJECT[col:​region:​Region_name, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2] <br> | 1. SELECT[tbl:​region] <br>2. PROJECT[col:​region:​Region_code, #1] <br>3. PROJECT[col:​region:​Region_name, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_2695 | What are the names of the regions in alphabetical order? | SELECT region_name FROM region ORDER BY region_name | 1. SELECT[tbl:​region] <br>2. PROJECT[col:​region:​Region_name, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​region] <br>2. PROJECT[col:​region:​Region_name, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_2700 | List name, dates active, and number of deaths for all storms with at least 1 death. | SELECT name ,  dates_active ,  number_deaths FROM storm WHERE number_deaths  >=  1 | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Number_Deaths, #1] <br>3. GROUP[col:​storm:​Number_Deaths, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​1:​col:​storm:​Number_Deaths] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Dates_active, #4] <br>7. PROJECT[col:​storm:​Number_Deaths, #4] <br>8. GROUP[col:​storm:​Number_Deaths, #7, #1] <br>9. UNION[#5, #6, #8] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Number_Deaths, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​1:​col:​storm:​Number_Deaths] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Dates_active, #4] <br>7. PROJECT[col:​storm:​Number_Deaths, #4] <br>8. GROUP[sum, #7, #1] <br>9. UNION[#5, #6, #8] <br> | + | medium | 
  | SPIDER_train_2701 | What are the names, dates active, and number of deaths for storms that had 1 or more death? | SELECT name ,  dates_active ,  number_deaths FROM storm WHERE number_deaths  >=  1 | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Number_Deaths, #1] <br>3. GROUP[col:​storm:​Number_Deaths, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​1:​col:​storm:​Number_Deaths] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Dates_active, #4] <br>7. PROJECT[col:​storm:​Number_Deaths, #4] <br>8. AGGREGATE[col:​storm:​Number_Deaths, #7] <br>9. UNION[#5, #6, #8] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Number_Deaths, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​1:​col:​storm:​Number_Deaths] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Dates_active, #4] <br>7. PROJECT[col:​storm:​Number_Deaths, #4] <br>8. AGGREGATE[sum, #7] <br>9. UNION[#5, #6, #8] <br> | + | medium | 
  | SPIDER_train_2702 | Show the average and maximum damage for all storms with max speed higher than 1000. | SELECT avg(damage_millions_USD) ,  max(damage_millions_USD) FROM storm WHERE max_speed  >  1000 | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Max_speed, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​1000:​col:​storm:​Max_speed] <br>4. PROJECT[col:​storm:​Damage_millions_USD, #3] <br>5. AGGREGATE[avg, #4] <br>6. AGGREGATE[max, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Max_speed, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​1000:​col:​storm:​Max_speed] <br>4. PROJECT[col:​storm:​Damage_millions_USD, #3] <br>5. AGGREGATE[avg, #4] <br>6. AGGREGATE[max, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_2703 | What is the average and maximum damage in millions for storms that had a max speed over 1000? | SELECT avg(damage_millions_USD) ,  max(damage_millions_USD) FROM storm WHERE max_speed  >  1000 | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Max_speed, #1] <br>3. AGGREGATE[col:​storm:​Max_speed, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1000:​col:​storm:​Max_speed] <br>5. PROJECT[col:​storm:​Damage_millions_USD, #4] <br>6. AGGREGATE[avg, #5] <br>7. AGGREGATE[max, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Max_speed, #1] <br>3. AGGREGATE[sum, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1000:​col:​storm:​Max_speed] <br>5. PROJECT[col:​storm:​Damage_millions_USD, #4] <br>6. AGGREGATE[avg, #5] <br>7. AGGREGATE[max, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_2706 | List name and damage for all storms in a descending order of max speed. | SELECT name ,  damage_millions_USD FROM storm ORDER BY max_speed DESC | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Name, #1] <br>3. PROJECT[col:​storm:​Damage_millions_USD, #1] <br>4. PROJECT[col:​storm:​Max_speed, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​descending] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Name, #1] <br>3. PROJECT[col:​storm:​Damage_millions_USD, #1] <br>4. PROJECT[col:​storm:​Max_speed, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_2707 | What are the names and damage in millions for storms, ordered by their max speeds descending? | SELECT name ,  damage_millions_USD FROM storm ORDER BY max_speed DESC | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Name, #1] <br>3. PROJECT[col:​storm:​Damage_millions_USD, #1] <br>4. PROJECT[col:​storm:​Max_speed, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​descending] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[col:​storm:​Name, #1] <br>3. PROJECT[col:​storm:​Damage_millions_USD, #1] <br>4. PROJECT[col:​storm:​Max_speed, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_2708 | How many regions are affected? | SELECT count(DISTINCT region_id) FROM affected_region | 1. SELECT[col:​affected_region:​Region_id] <br>2. FILTER[#1, tbl:​affected_region] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​affected_region:​Region_id] <br>2. COMPARATIVE[#1, #1, tbl:​affected_region] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_2710 | Show the name for regions not affected. | SELECT region_name FROM region WHERE region_id NOT IN (SELECT region_id FROM affected_region) | 1. SELECT[tbl:​region] <br>2. FILTER[#1, tbl:​affected_region] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​region:​Region_name, #3] <br> | 1. SELECT[tbl:​region] <br>2. COMPARATIVE[#1, #1, tbl:​affected_region] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​region:​Region_name, #3] <br> | + | hard | 
  | SPIDER_train_2712 | Show the name for regions and the number of storms for each region. | SELECT T1.region_name ,  count(*) FROM region AS T1 JOIN affected_region AS T2 ON T1.region_id = T2.region_id GROUP BY T1.region_id | 1. SELECT[col:​region:​Region_id] <br>2. PROJECT[col:​region:​Region_name, #1] <br>3. PROJECT[tbl:​storm, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​region:​Region_id] <br>2. PROJECT[col:​region:​Region_name, #1] <br>3. PROJECT[tbl:​storm, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_2713 | How many storms occured in each region? | SELECT T1.region_name ,  count(*) FROM region AS T1 JOIN affected_region AS T2 ON T1.region_id = T2.region_id GROUP BY T1.region_id | 1. SELECT[col:​region:​Region_name] <br>2. PROJECT[tbl:​storm, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​region:​Region_name] <br>2. PROJECT[tbl:​storm, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_2714 | List the name for storms and the number of affected regions for each storm. | SELECT T1.name ,  count(*) FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id | 1. SELECT[col:​storm:​Storm_ID] <br>2. PROJECT[col:​storm:​Name, #1] <br>3. PROJECT[tbl:​affected_region, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​storm:​Storm_ID] <br>2. PROJECT[col:​storm:​Name, #1] <br>3. PROJECT[tbl:​affected_region, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_2715 | How many regions were affected by each storm? | SELECT T1.name ,  count(*) FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id | 1. SELECT[col:​storm:​Name] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​storm:​Name] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_2716 | What is the storm name and max speed which affected the greatest number of regions? | SELECT T1.name ,  T1.max_speed FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Max_speed, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Max_speed, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_2717 | Return the name and max speed of the storm that affected the most regions. | SELECT T1.name ,  T1.max_speed FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Max_speed, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​storm:​Name, #4] <br>6. PROJECT[col:​storm:​Max_speed, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_2721 | What are the names of storms that both affected two or more regions and affected a total of 10 or more cities? | SELECT T1.name FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id HAVING count(*)  >=  2 INTERSECT SELECT T1.name FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id HAVING sum(T2.number_city_affected)  >=  10 | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[tbl:​affected_region, #1] <br>6. GROUP[tbl:​affected_region, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>=:​10:​col:​affected_region:​Number_city_affected] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​storm:​Name, #8] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[tbl:​affected_region, #1] <br>6. GROUP[sum, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>=:​10:​col:​affected_region:​Number_city_affected] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​storm:​Name, #8] <br> | + | extra | 
  | SPIDER_train_2723 | What are the names of storms that did not affect two or more regions? | SELECT name FROM storm EXCEPT SELECT T1.name FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. DISCARD[#1, #4] <br>6. PROJECT[col:​storm:​Name, #5] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. DISCARD[#1, #4] <br>6. PROJECT[col:​storm:​Name, #5] <br> | + | hard | 
  | SPIDER_train_2724 | What are the region names affected by the storm with a number of deaths of least 10? | SELECT T2.region_name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T3.number_deaths  >=  10 | 1. SELECT[tbl:​region] <br>2. FILTER[#1, tbl:​affected_region] <br>3. FILTER[#2, comparative:​>=:​10:​col:​storm:​Number_Deaths] <br>4. PROJECT[col:​region:​Region_name, #3] <br> | 1. SELECT[tbl:​region] <br>2. COMPARATIVE[#1, #1, tbl:​affected_region] <br>3. COMPARATIVE[#2, #2, comparative:​>=:​10:​col:​storm:​Number_Deaths] <br>4. PROJECT[col:​region:​Region_name, #3] <br> | + | hard | 
  | SPIDER_train_2725 | Return the names of the regions affected by storms that had a death count of at least 10. | SELECT T2.region_name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T3.number_deaths  >=  10 | 1. SELECT[tbl:​region] <br>2. PROJECT[tbl:​storm, #1] <br>3. PROJECT[col:​storm:​Number_Deaths, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​10:​col:​storm:​Number_Deaths] <br>5. PROJECT[col:​region:​Region_name, #4] <br> | 1. SELECT[tbl:​region] <br>2. PROJECT[tbl:​storm, #1] <br>3. PROJECT[col:​storm:​Number_Deaths, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​10:​col:​storm:​Number_Deaths] <br>5. PROJECT[col:​region:​Region_name, #4] <br> | + | hard | 
  | SPIDER_train_2726 | Show all storm names affecting region "Denmark". | SELECT T3.name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.region_name  =  'Denmark' | 1. SELECT[tbl:​storm] <br>2. FILTER[#1, comparative:​=:​Denmark:​col:​region:​Region_name] <br>3. PROJECT[col:​storm:​Name, #2] <br> | 1. SELECT[tbl:​storm] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Denmark:​col:​region:​Region_name] <br>3. PROJECT[col:​storm:​Name, #2] <br> | + | hard | 
  | SPIDER_train_2727 | What are the names of the storms that affected Denmark? | SELECT T3.name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.region_name  =  'Denmark' | 1. SELECT[tbl:​storm] <br>2. FILTER[#1, comparative:​=:​Denmark:​col:​region:​Region_name] <br>3. PROJECT[col:​storm:​Name, #2] <br> | 1. SELECT[tbl:​storm] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Denmark:​col:​region:​Region_name] <br>3. PROJECT[col:​storm:​Name, #2] <br> | + | hard | 
  | SPIDER_train_2728 | Show the region name with at least two storms. | SELECT T1.region_name FROM region AS T1 JOIN affected_region AS T2 ON T1.region_id = T2.region_id GROUP BY T1.region_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​region] <br>2. PROJECT[tbl:​storm, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​region:​Region_name, #4] <br> | 1. SELECT[tbl:​region] <br>2. PROJECT[tbl:​storm, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​region:​Region_name, #4] <br> | + | medium | 
  | SPIDER_train_2729 | What are the names of regions with two or more storms? | SELECT T1.region_name FROM region AS T1 JOIN affected_region AS T2 ON T1.region_id = T2.region_id GROUP BY T1.region_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​region] <br>2. PROJECT[tbl:​storm, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​region:​Region_name, #4] <br> | 1. SELECT[tbl:​region] <br>2. PROJECT[tbl:​storm, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​region:​Region_name, #4] <br> | + | medium | 
  | SPIDER_train_2732 | Find the name of the storm that affected both Afghanistan and Albania regions. | SELECT T3.Name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.Region_name  =  'Afghanistan' INTERSECT SELECT T3.Name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.Region_name  =  'Albania' | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Afghanistan:​col:​region:​Region_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Albania:​col:​region:​Region_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​storm:​Name, #5] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Afghanistan:​col:​region:​Region_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Albania:​col:​region:​Region_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​storm:​Name, #5] <br> | + | extra | 
  | SPIDER_train_2733 | What are the names of the storms that affected both the regions of Afghanistan and Albania? | SELECT T3.Name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.Region_name  =  'Afghanistan' INTERSECT SELECT T3.Name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.Region_name  =  'Albania' | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Afghanistan:​col:​region:​Region_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Albania:​col:​region:​Region_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​storm:​Name, #5] <br> | 1. SELECT[tbl:​storm] <br>2. PROJECT[tbl:​affected_region, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Afghanistan:​col:​region:​Region_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Albania:​col:​region:​Region_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​storm:​Name, #5] <br> | + | extra | 
 ***
 Exec acc: **1.0000**
