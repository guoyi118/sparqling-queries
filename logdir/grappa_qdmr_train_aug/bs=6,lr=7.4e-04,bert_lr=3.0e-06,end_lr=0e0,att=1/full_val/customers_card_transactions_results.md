 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Accounts** | account_id | + | --> 21 | 
 | 2 |   | customer_id |   | --> 5 | 
 | 3 |   | account_name |   |   | 
 | 4 |   | other_account_details |   |   | 
 | 5 | **Customers** | customer_id | + |   | 
 | 6 |   | customer_first_name |   |   | 
 | 7 |   | customer_last_name |   |   | 
 | 8 |   | customer_address |   |   | 
 | 9 |   | customer_phone |   |   | 
 | 10 |   | customer_email |   |   | 
 | 11 |   | other_customer_details |   |   | 
 | 12 | **Customers_Cards** | card_id | + | --> 22 | 
 | 13 |   | customer_id |   | --> 5 | 
 | 14 |   | card_type_code |   |   | 
 | 15 |   | card_number |   |   | 
 | 16 |   | date_valid_from |   |   | 
 | 17 |   | date_valid_to |   |   | 
 | 18 |   | other_card_details |   |   | 
 | 19 | **Financial_Transactions** | transaction_id |   |   | 
 | 20 |   | previous_transaction_id |   |   | 
 | 21 |   | account_id |   |   | 
 | 22 |   | card_id |   |   | 
 | 23 |   | transaction_type |   |   | 
 | 24 |   | transaction_date |   |   | 
 | 25 |   | transaction_amount |   |   | 
 | 26 |   | transaction_comment |   |   | 
 | 27 |   | other_transaction_details |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_667 | How many accounts do we have? | SELECT count(*) FROM Accounts | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_669 | Show ids, customer ids, names for all accounts. | SELECT account_id ,  customer_id ,  account_name FROM Accounts | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_id, #1] <br>3. PROJECT[col:​Accounts:​customer_id, #1] <br>4. PROJECT[col:​Accounts:​account_name, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_id, #1] <br>3. PROJECT[col:​Accounts:​customer_id, #1] <br>4. PROJECT[col:​Accounts:​account_name, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_670 | What are the account ids, customer ids, and account names for all the accounts? | SELECT account_id ,  customer_id ,  account_name FROM Accounts | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_id, #1] <br>3. PROJECT[col:​Accounts:​customer_id, #1] <br>4. PROJECT[col:​Accounts:​account_name, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_id, #1] <br>3. PROJECT[col:​Accounts:​customer_id, #1] <br>4. PROJECT[col:​Accounts:​account_name, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_671 | Show other account details for account with name 338. | SELECT other_account_details FROM Accounts WHERE account_name  =  "338" | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​338:​col:​Accounts:​account_name] <br>4. PROJECT[col:​Accounts:​other_account_details, #3] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​338:​col:​Accounts:​account_name] <br>4. PROJECT[col:​Accounts:​other_account_details, #3] <br> | + | easy | 
  | SPIDER_train_672 | What are the other account details for the account with the name 338? | SELECT other_account_details FROM Accounts WHERE account_name  =  "338" | 1. SELECT[tbl:​Accounts] <br>2. FILTER[#1, comparative:​=:​338:​col:​Accounts:​account_name] <br>3. PROJECT[col:​Accounts:​other_account_details, #2] <br> | 1. SELECT[tbl:​Accounts] <br>2. COMPARATIVE[#1, #1, comparative:​=:​338:​col:​Accounts:​account_name] <br>3. PROJECT[col:​Accounts:​other_account_details, #2] <br> | + | easy | 
  | SPIDER_train_673 | What is the first name, last name, and phone of the customer with account name 162? | SELECT T2.customer_first_name ,  T2.customer_last_name ,  T2.customer_phone FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T1.account_name  =  "162" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. PROJECT[tbl:​Accounts, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​162:​col:​Accounts:​account_name] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Customers:​customer_last_name, #4] <br>7. PROJECT[col:​Customers:​customer_phone, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. PROJECT[tbl:​Accounts, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​162:​col:​Accounts:​account_name] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Customers:​customer_last_name, #4] <br>7. PROJECT[col:​Customers:​customer_phone, #4] <br>8. UNION[#5, #6, #7] <br> | + | medium | 
  | SPIDER_train_675 | How many accounts does the customer with first name Art and last name Turcotte have? | SELECT count(*) FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.customer_first_name  =  "Art" AND T2.customer_last_name  =  "Turcotte" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Art:​col:​Customers:​customer_first_name] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Turcotte:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[tbl:​Accounts, #6] <br>8. AGGREGATE[count, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Art:​col:​Customers:​customer_first_name] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Turcotte:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[tbl:​Accounts, #6] <br>8. AGGREGATE[count, #7] <br> | + | medium | 
  | SPIDER_train_676 | Return the number of accounts that the customer with the first name Art and last name Turcotte has. | SELECT count(*) FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.customer_first_name  =  "Art" AND T2.customer_last_name  =  "Turcotte" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. PROJECT[col:​Customers:​customer_last_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Art:​col:​Customers:​customer_first_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Turcotte:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[tbl:​Accounts, #6] <br>8. AGGREGATE[count, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. PROJECT[col:​Customers:​customer_last_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Art:​col:​Customers:​customer_first_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Turcotte:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[tbl:​Accounts, #6] <br>8. AGGREGATE[count, #7] <br> | + | medium | 
  | SPIDER_train_677 | Show all customer ids and the number of accounts for each customer. | SELECT customer_id ,  count(*) FROM Accounts GROUP BY customer_id | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[col:​Accounts:​customer_id, #1] <br>3. PROJECT[tbl:​Accounts, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[col:​Accounts:​customer_id, #1] <br>3. PROJECT[tbl:​Accounts, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_678 | How many accounts are there for each customer id? | SELECT customer_id ,  count(*) FROM Accounts GROUP BY customer_id | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_679 | Show the customer id and number of accounts with most accounts. | SELECT customer_id ,  count(*) FROM Accounts GROUP BY customer_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Accounts:​customer_id, #4] <br>6. PROJECT[tbl:​Accounts, #4] <br>7. AGGREGATE[count, #6] <br>8. UNION[#5, #7] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Accounts:​customer_id, #4] <br>6. PROJECT[tbl:​Accounts, #4] <br>7. AGGREGATE[count, #6] <br>8. UNION[#5, #7] <br> | + | hard | 
  | SPIDER_train_680 | What is the customer id of the customer with the most accounts, and how many accounts does this person have? | SELECT customer_id ,  count(*) FROM Accounts GROUP BY customer_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Accounts:​customer_id] <br>2. SELECT[tbl:​Accounts] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Accounts:​customer_id, #4] <br>6. AGGREGATE[max, #3] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. SELECT[tbl:​Accounts] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Accounts:​customer_id, #4] <br>6. AGGREGATE[max, #3] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_683 | Show the number of all customers without an account. | SELECT count(*) FROM Customers WHERE customer_id NOT IN (SELECT customer_id FROM Accounts) | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_684 | How many customers do not have an account? | SELECT count(*) FROM Customers WHERE customer_id NOT IN (SELECT customer_id FROM Accounts) | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_687 | Show distinct first and last names for all customers with an account. | SELECT DISTINCT T1.customer_first_name ,  T1.customer_last_name FROM Customers AS T1 JOIN Accounts AS T2 ON T1.customer_id  =  T2.customer_id | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Accounts] <br>3. PROJECT[col:​Customers:​customer_first_name, #2] <br>4. PROJECT[col:​Customers:​customer_last_name, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. PROJECT[col:​Customers:​customer_first_name, #2] <br>4. PROJECT[col:​Customers:​customer_last_name, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_689 | How many customers have an account? | SELECT count(DISTINCT customer_id) FROM Accounts | 1. SELECT[col:​Accounts:​customer_id] <br>2. FILTER[#1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_690 | Count the number of customers who hold an account. | SELECT count(DISTINCT customer_id) FROM Accounts | 1. SELECT[col:​Accounts:​customer_id] <br>2. FILTER[#1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_692 | Count the number of customers. | SELECT count(*) FROM Customers | 1. SELECT[tbl:​Customers] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Customers] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_693 | Show ids, first names, last names, and phones for all customers. | SELECT customer_id ,  customer_first_name ,  customer_last_name ,  customer_phone FROM Customers | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_id, #1] <br>3. PROJECT[col:​Customers:​customer_first_name, #1] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. PROJECT[col:​Customers:​customer_phone, #1] <br>6. UNION[#2, #3, #4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_id, #1] <br>3. PROJECT[col:​Customers:​customer_first_name, #1] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. PROJECT[col:​Customers:​customer_phone, #1] <br>6. UNION[#2, #3, #4, #5] <br> | + | medium | 
  | SPIDER_train_695 | What is the phone and email for customer with first name Aniyah and last name Feest? | SELECT customer_phone ,  customer_email FROM Customers WHERE customer_first_name  =  "Aniyah" AND customer_last_name  =  "Feest" | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​=:​Aniyah:​col:​Customers:​customer_first_name] <br>3. FILTER[#2, comparative:​=:​Feest:​col:​Customers:​customer_last_name] <br>4. PROJECT[col:​Customers:​customer_phone, #3] <br>5. PROJECT[col:​Customers:​customer_email, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Aniyah:​col:​Customers:​customer_first_name] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Feest:​col:​Customers:​customer_last_name] <br>4. PROJECT[col:​Customers:​customer_phone, #3] <br>5. PROJECT[col:​Customers:​customer_email, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_696 | Return the phone and email of the customer with the first name Aniyah and last name Feest. | SELECT customer_phone ,  customer_email FROM Customers WHERE customer_first_name  =  "Aniyah" AND customer_last_name  =  "Feest" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Aniyah:​col:​Customers:​customer_first_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Feest:​col:​Customers:​customer_last_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​customer_phone, #5] <br>7. PROJECT[col:​Customers:​customer_email, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Aniyah:​col:​Customers:​customer_first_name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Feest:​col:​Customers:​customer_last_name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​customer_phone, #5] <br>7. PROJECT[col:​Customers:​customer_email, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_697 | Show the number of customer cards. | SELECT count(*) FROM Customers_cards | 1. SELECT[tbl:​Customers_Cards] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Customers_Cards] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_698 | How many customer cards are there? | SELECT count(*) FROM Customers_cards | 1. SELECT[tbl:​Customers_Cards] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Customers_Cards] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_706 | Count the number of cards the customer with the first name Art and last name Turcotte has. | SELECT count(*) FROM Customers_cards AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.customer_first_name  =  "Art" AND T2.customer_last_name  =  "Turcotte" | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Art:​col:​Customers:​customer_first_name] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Turcotte:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[tbl:​Customers_Cards, #6] <br>8. AGGREGATE[count, #7] <br> | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Art:​col:​Customers:​customer_first_name] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Turcotte:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[tbl:​Customers_Cards, #6] <br>8. AGGREGATE[count, #7] <br> | + | medium | 
  | SPIDER_train_707 | How many debit cards do we have? | SELECT count(*) FROM Customers_cards WHERE card_type_code  =  "Debit" | 1. SELECT[val:​Customers_Cards:​card_type_code:​Debit] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[val:​Customers_Cards:​card_type_code:​Debit] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_708 | Count the number of customer cards of the type Debit. | SELECT count(*) FROM Customers_cards WHERE card_type_code  =  "Debit" | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. PROJECT[col:​Customers_Cards:​card_type_code, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Debit:​col:​Customers_Cards:​card_type_code] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. PROJECT[col:​Customers_Cards:​card_type_code, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Debit:​col:​Customers_Cards:​card_type_code] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
  | SPIDER_train_712 | What are the different customer ids, and how many cards does each one hold? | SELECT customer_id ,  count(*) FROM Customers_cards GROUP BY customer_id | 1. SELECT[col:​Customers_Cards:​customer_id] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Customers_Cards:​customer_id, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[col:​Customers_Cards:​customer_id] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Customers_Cards:​customer_id, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_714 | Return the id of the customer who has the most cards, as well as the number of cards. | SELECT customer_id ,  count(*) FROM Customers_cards GROUP BY customer_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Customers_Cards:​customer_id] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers_Cards:​customer_id, #4] <br>6. PROJECT[tbl:​Customers_Cards, #4] <br>7. GROUP[count, #6, #4] <br>8. UNION[#5, #7] <br> | 1. SELECT[col:​Customers_Cards:​customer_id] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers_Cards:​customer_id, #4] <br>6. PROJECT[tbl:​Customers_Cards, #4] <br>7. GROUP[count, #6, #4] <br>8. UNION[#5, #7] <br> | + | hard | 
  | SPIDER_train_715 | Show id, first and last names for all customers with at least two cards. | SELECT T1.customer_id ,  T2.customer_first_name ,  T2.customer_last_name FROM Customers_cards AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Customers_Cards:​customer_id, #4] <br>6. PROJECT[col:​Customers:​customer_first_name, #4] <br>7. PROJECT[col:​Customers:​customer_last_name, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Customers_Cards:​customer_id, #4] <br>6. PROJECT[col:​Customers:​customer_first_name, #4] <br>7. PROJECT[col:​Customers:​customer_last_name, #4] <br>8. UNION[#5, #6, #7] <br> | + | medium | 
  | SPIDER_train_717 | What is the customer id, first and last name with least number of accounts. | SELECT T1.customer_id ,  T2.customer_first_name ,  T2.customer_last_name FROM Customers_cards AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) ASC LIMIT 1 | 1. SELECT[col:​Customers_Cards:​customer_id] <br>2. PROJECT[accounts of #REF, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Customers_Cards:​customer_id, #4] <br>6. PROJECT[col:​Customers:​customer_first_name, #4] <br>7. PROJECT[col:​Customers:​customer_last_name, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[col:​Customers_Cards:​customer_id] <br>2. PROJECT[None, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Customers_Cards:​customer_id, #4] <br>6. PROJECT[col:​Customers:​customer_first_name, #4] <br>7. PROJECT[col:​Customers:​customer_last_name, #4] <br>8. UNION[#5, #6, #7] <br> | + | extra | 
  | SPIDER_train_719 | Show all card type codes and the number of cards in each type. | SELECT card_type_code ,  count(*) FROM Customers_cards GROUP BY card_type_code | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_720 | What are the different card types, and how many cards are there of each? | SELECT card_type_code ,  count(*) FROM Customers_cards GROUP BY card_type_code | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. GROUP[count, #1, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. GROUP[count, #1, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_721 | What is the card type code with most number of cards? | SELECT card_type_code FROM Customers_cards GROUP BY card_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. FILTER[#1, comparative:​max:​None] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. SUPERLATIVE[comparative:​max:​None, #1, #1] <br> | + | hard | 
  | SPIDER_train_722 | Return the code of the card type that is most common. | SELECT card_type_code FROM Customers_cards GROUP BY card_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_723 | Show card type codes with at least 5 cards. | SELECT card_type_code FROM Customers_cards GROUP BY card_type_code HAVING count(*)  >=  5 | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​5] <br>5. PROJECT[col:​Customers_Cards:​card_type_code, #4] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​5] <br>5. PROJECT[col:​Customers_Cards:​card_type_code, #4] <br> | + | easy | 
  | SPIDER_train_724 | What are the codes of card types that have 5 or more cards? | SELECT card_type_code FROM Customers_cards GROUP BY card_type_code HAVING count(*)  >=  5 | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​5] <br>5. PROJECT[col:​Customers_Cards:​card_type_code, #4] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Customers_Cards, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​5] <br>5. PROJECT[col:​Customers_Cards:​card_type_code, #4] <br> | + | easy | 
  | SPIDER_train_729 | Show all card type codes. | SELECT DISTINCT card_type_code FROM Customers_Cards | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3. PROJECT[col:​Customers_Cards:​card_type_code, #2] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3. PROJECT[col:​Customers_Cards:​card_type_code, #2] <br> | + | easy | 
  | SPIDER_train_730 | What are the different card type codes? | SELECT DISTINCT card_type_code FROM Customers_Cards | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3. PROJECT[col:​Customers_Cards:​card_type_code, #2] <br>4.*(distinct)* PROJECT[different #REF, #3] <br> | 1. SELECT[tbl:​Customers_Cards] <br>2. PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3. PROJECT[col:​Customers_Cards:​card_type_code, #2] <br>4.*(distinct)* PROJECT[None, #3] <br> | + | easy | 
  | SPIDER_train_731 | Show the number of card types. | SELECT count(DISTINCT card_type_code) FROM Customers_Cards | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_732 | How many different card types are there? | SELECT count(DISTINCT card_type_code) FROM Customers_Cards | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2.*(distinct)* PROJECT[different #REF, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2.*(distinct)* PROJECT[None, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_733 | Show all transaction types. | SELECT DISTINCT transaction_type FROM Financial_Transactions | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br> | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br> | + | easy | 
  | SPIDER_train_734 | What are the different types of transactions? | SELECT DISTINCT transaction_type FROM Financial_Transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2.*(distinct)* PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2.*(distinct)* PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br> | + | easy | 
  | SPIDER_train_735 | Show the number of transaction types. | SELECT count(DISTINCT transaction_type) FROM Financial_Transactions | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_736 | How many different types of transactions are there? | SELECT count(DISTINCT transaction_type) FROM Financial_Transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_737 | What is the average and total transaction amount? | SELECT avg(transaction_amount) ,  sum(transaction_amount) FROM Financial_transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[sum, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[sum, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_738 | Return the average transaction amount, as well as the total amount of all transactions. | SELECT avg(transaction_amount) ,  sum(transaction_amount) FROM Financial_transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[sum, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[sum, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_739 | Show the card type codes and the number of transactions. | SELECT T2.card_type_code ,  count(*) FROM Financial_transactions AS T1 JOIN Customers_cards AS T2 ON T1.card_id  =  T2.card_id GROUP BY T2.card_type_code | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customers_Cards:​card_type_code] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_740 | What are the different card types, and how many transactions have been made with each? | SELECT T2.card_type_code ,  count(*) FROM Financial_transactions AS T1 JOIN Customers_cards AS T2 ON T1.card_id  =  T2.card_id GROUP BY T2.card_type_code | 1. SELECT[tbl:​Customers_Cards] <br>2.*(distinct)* PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3. PROJECT[tbl:​Financial_Transactions, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​Customers_Cards] <br>2.*(distinct)* PROJECT[col:​Customers_Cards:​card_type_code, #1] <br>3. PROJECT[tbl:​Financial_Transactions, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_741 | Show the transaction type and the number of transactions. | SELECT transaction_type ,  count(*) FROM Financial_transactions GROUP BY transaction_type | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_742 | What are the different transaction types, and how many transactions of each have taken place? | SELECT transaction_type ,  count(*) FROM Financial_transactions GROUP BY transaction_type | 1. SELECT[tbl:​Financial_Transactions] <br>2.*(distinct)* PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br>3. PROJECT[tbl:​Financial_Transactions, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2.*(distinct)* PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br>3. PROJECT[tbl:​Financial_Transactions, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_743 | What is the transaction type that has processed the greatest total amount in transactions? | SELECT transaction_type FROM Financial_transactions GROUP BY transaction_type ORDER BY sum(transaction_amount) DESC LIMIT 1 | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. PROJECT[col:​Financial_Transactions:​transaction_amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br> | 1. SELECT[col:​Financial_Transactions:​transaction_type] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. PROJECT[col:​Financial_Transactions:​transaction_amount, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br> | + | hard | 
  | SPIDER_train_744 | Return the type of transaction with the highest total amount. | SELECT transaction_type FROM Financial_transactions GROUP BY transaction_type ORDER BY sum(transaction_amount) DESC LIMIT 1 | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Financial_Transactions:​transaction_type, #4] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Financial_Transactions:​transaction_type, #4] <br> | + | hard | 
 ***
 Exec acc: **1.0000**
