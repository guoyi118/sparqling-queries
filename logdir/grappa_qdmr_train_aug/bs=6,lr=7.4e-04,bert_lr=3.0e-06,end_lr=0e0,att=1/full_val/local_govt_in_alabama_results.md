 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Services** | Service_ID | + |   | 
 | 2 |   | Service_Type_Code |   |   | 
 | 3 | **Participants** | Participant_ID | + |   | 
 | 4 |   | Participant_Type_Code |   |   | 
 | 5 |   | Participant_Details |   |   | 
 | 6 | **Events** | Event_ID | + |   | 
 | 7 |   | Service_ID |   | --> 1 | 
 | 8 |   | Event_Details |   |   | 
 | 9 | **Participants_in_Events** | Event_ID | + | --> 6 | 
 | 10 |   | Participant_ID |   | --> 3 | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_2138 | what are the event details of the services that have the type code 'Marriage'? | SELECT T1.event_details FROM EVENTS AS T1 JOIN Services AS T2 ON T1.Service_ID  =  T2.Service_ID WHERE T2.Service_Type_Code  =  'Marriage' | 1. SELECT[tbl:​Services] <br>2. PROJECT[col:​Services:​Service_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Marriage:​col:​Services:​Service_Type_Code] <br>4. PROJECT[col:​Events:​Event_Details, #3] <br> | 1. SELECT[tbl:​Services] <br>2. PROJECT[col:​Services:​Service_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Marriage:​col:​Services:​Service_Type_Code] <br>4. PROJECT[col:​Events:​Event_Details, #3] <br> | + | medium | 
  | SPIDER_train_2139 | What are the ids and details of events that have more than one participants? | SELECT T1.event_id ,  T1.event_details FROM EVENTS AS T1 JOIN Participants_in_Events AS T2 ON T1.Event_ID  =  T2.Event_ID GROUP BY T1.Event_ID HAVING count(*)  >  1 | 1. SELECT[tbl:​Events] <br>2. PROJECT[tbl:​Participants_in_Events, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Events:​Event_ID, #4] <br>6. PROJECT[col:​Events:​Event_Details, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Events] <br>2. PROJECT[tbl:​Participants_in_Events, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Events:​Event_ID, #4] <br>6. PROJECT[col:​Events:​Event_Details, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_2140 | How many events have each participants attended? List the participant id, type and the number. | SELECT T1.Participant_ID ,  T1.Participant_Type_Code ,  count(*) FROM Participants AS T1 JOIN Participants_in_Events AS T2 ON T1.Participant_ID  =  T2.Participant_ID GROUP BY T1.Participant_ID | 1. SELECT[col:​Participants:​Participant_ID] <br>2. PROJECT[tbl:​Participants_in_Events, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Participants:​Participant_ID, #1] <br>5. PROJECT[col:​Participants:​Participant_Type_Code, #1] <br>6. UNION[#4, #5, #3] <br> | 1. SELECT[col:​Participants:​Participant_ID] <br>2. PROJECT[tbl:​Participants_in_Events, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Participants:​Participant_ID, #1] <br>5. PROJECT[col:​Participants:​Participant_Type_Code, #1] <br>6. UNION[#4, #5, #3] <br> | + | medium | 
  | SPIDER_train_2141 | What are all the the participant ids, type code and details? | SELECT Participant_ID ,  Participant_Type_Code ,  Participant_Details FROM  Participants | 1. SELECT[col:​Participants:​Participant_ID] <br>2. PROJECT[col:​Participants:​Participant_Type_Code, #1] <br>3. PROJECT[col:​Participants:​Participant_Details, #1] <br>4. UNION[#1, #2, #3] <br> | 1. SELECT[col:​Participants:​Participant_ID] <br>2. PROJECT[col:​Participants:​Participant_Type_Code, #1] <br>3. PROJECT[col:​Participants:​Participant_Details, #1] <br>4. UNION[#1, #2, #3] <br> | + | medium | 
  | SPIDER_train_2142 | How many participants belong to the type 'Organizer'? | SELECT count(*) FROM participants WHERE participant_type_code  =  'Organizer' | 1. SELECT[tbl:​Participants] <br>2. PROJECT[col:​Participants:​Participant_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Organizer:​col:​Participants:​Participant_Type_Code] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Participants] <br>2. PROJECT[col:​Participants:​Participant_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Organizer:​col:​Participants:​Participant_Type_Code] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_2143 | List the type of the services in alphabetical order. | SELECT service_type_code FROM services ORDER BY service_type_code | 1. SELECT[tbl:​Services] <br>2. PROJECT[col:​Services:​Service_Type_Code, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​Services] <br>2. PROJECT[col:​Services:​Service_Type_Code, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_2144 | List the service id and details for the events. | SELECT service_id ,  event_details FROM EVENTS | 1. SELECT[tbl:​Events] <br>2. PROJECT[col:​Events:​Service_ID, #1] <br>3. PROJECT[col:​Events:​Event_Details, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Events] <br>2. PROJECT[col:​Events:​Service_ID, #1] <br>3. PROJECT[col:​Events:​Event_Details, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_2146 | What is the most common participant type? | SELECT participant_type_code FROM participants GROUP BY participant_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Participants:​Participant_Type_Code] <br>2. PROJECT[tbl:​Participants, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Participants:​Participant_Type_Code] <br>2. PROJECT[tbl:​Participants, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_2147 | Which service id and type has the least number of participants? | SELECT T3.service_id ,  T4.Service_Type_Code FROM participants AS T1 JOIN Participants_in_Events AS T2 ON T1.Participant_ID  =  T2.Participant_ID JOIN EVENTS AS T3 ON T2.Event_ID   =  T3.Event_ID JOIN services AS T4 ON T3.service_id  =  T4.service_id GROUP BY T3.service_id ORDER BY count(*) ASC LIMIT 1 | 1. SELECT[col:​Events:​Service_ID] <br>2. PROJECT[tbl:​Participants, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​min:​None] <br>5. PROJECT[col:​Services:​Service_Type_Code, #4] <br>6. UNION[#4, #5] <br> | 1. SELECT[col:​Events:​Service_ID] <br>2. PROJECT[tbl:​Participants, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Services:​Service_Type_Code, #4] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_2148 | What is the id of the event with the most participants? | SELECT Event_ID FROM Participants_in_Events GROUP BY Event_ID ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Participants_in_Events:​Event_ID] <br>2. SELECT[tbl:​Participants_in_Events] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Participants_in_Events:​Event_ID, #4] <br> | 1. SELECT[col:​Participants_in_Events:​Event_ID] <br>2. SELECT[tbl:​Participants_in_Events] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Participants_in_Events:​Event_ID, #4] <br> | + | hard | 
  | SPIDER_train_2150 | Which services type had both successful and failure event details? | SELECT T1.service_type_code FROM services AS T1 JOIN EVENTS AS T2 ON T1.service_id  =  T2.service_id WHERE T2.event_details  =  'Success' INTERSECT SELECT T1.service_type_code FROM services AS T1 JOIN EVENTS AS T2 ON T1.service_id  =  T2.service_id WHERE T2.event_details  =  'Fail' | 1. SELECT[col:​Services:​Service_Type_Code] <br>2. PROJECT[tbl:​Events, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Success:​col:​Events:​Event_Details] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Fail:​col:​Events:​Event_Details] <br>5. INTERSECTION[#1, #3, #4] <br> | 1. SELECT[col:​Services:​Service_Type_Code] <br>2. PROJECT[tbl:​Events, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Success:​col:​Events:​Event_Details] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Fail:​col:​Events:​Event_Details] <br>5. INTERSECTION[#1, #3, #4] <br> | + | extra | 
  | SPIDER_train_2151 | How many events did not have any participants? | SELECT count(*) FROM EVENTS WHERE event_id NOT IN (SELECT event_id FROM Participants_in_Events) | 1. SELECT[tbl:​Events] <br>2. FILTER[#1, tbl:​Participants_in_Events] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Events] <br>2. COMPARATIVE[#1, #1, tbl:​Participants_in_Events] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
 ***
 Exec acc: **1.0000**
