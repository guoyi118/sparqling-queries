 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Staff** | staff_id | + |   | 
 | 2 |   | gender |   |   | 
 | 3 |   | first_name |   |   | 
 | 4 |   | last_name |   |   | 
 | 5 |   | email_address |   |   | 
 | 6 |   | phone_number |   |   | 
 | 7 | **Customers** | customer_id | + |   | 
 | 8 |   | customer_type_code |   |   | 
 | 9 |   | address_line_1 |   |   | 
 | 10 |   | address_line_2 |   |   | 
 | 11 |   | town_city |   |   | 
 | 12 |   | state |   |   | 
 | 13 |   | email_address |   |   | 
 | 14 |   | phone_number |   |   | 
 | 15 | **Products** | product_id | + |   | 
 | 16 |   | parent_product_id |   |   | 
 | 17 |   | product_category_code |   |   | 
 | 18 |   | date_product_first_available |   |   | 
 | 19 |   | date_product_discontinued |   |   | 
 | 20 |   | product_name |   |   | 
 | 21 |   | product_description |   |   | 
 | 22 |   | product_price |   |   | 
 | 23 | **Complaints** | complaint_id |   |   | 
 | 24 |   | product_id |   | --> 15 | 
 | 25 |   | customer_id |   | --> 7 | 
 | 26 |   | complaint_outcome_code |   |   | 
 | 27 |   | complaint_status_code |   |   | 
 | 28 |   | complaint_type_code |   |   | 
 | 29 |   | date_complaint_raised |   |   | 
 | 30 |   | date_complaint_closed |   |   | 
 | 31 |   | staff_id |   | --> 1 | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_5770 | Find the emails and phone numbers of all the customers, ordered by email address and phone number. | SELECT email_address ,  phone_number FROM customers ORDER BY email_address ,  phone_number | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​email_address, #1] <br>3. PROJECT[col:​Customers:​phone_number, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #4] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​email_address, #1] <br>3. PROJECT[col:​Customers:​phone_number, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #4, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_5771 | What are the emails and phone numbers of all customers, sorted by email address and phone number? | SELECT email_address ,  phone_number FROM customers ORDER BY email_address ,  phone_number | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​email_address, #1] <br>3. PROJECT[col:​Customers:​phone_number, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #4] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​email_address, #1] <br>3. PROJECT[col:​Customers:​phone_number, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #4, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_5772 | Which city has the least number of customers whose type code is "Good Credit Rating"? | SELECT town_city FROM customers WHERE customer_type_code  =  "Good Credit Rating" GROUP BY town_city ORDER BY count(*) LIMIT 1 | 1. SELECT[col:​Customers:​town_city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. PROJECT[col:​Customers:​town_city, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Good Credit Rating:​col:​Customers:​customer_type_code] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​min:​None] <br> | 1. SELECT[col:​Customers:​town_city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. PROJECT[col:​Customers:​town_city, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Good Credit Rating:​col:​Customers:​customer_type_code] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​min:​None, #1, #5] <br> | + | extra | 
  | SPIDER_train_5773 | Return the city with the customer type code "Good Credit Rating" that had the fewest customers. | SELECT town_city FROM customers WHERE customer_type_code  =  "Good Credit Rating" GROUP BY town_city ORDER BY count(*) LIMIT 1 | 1. SELECT[col:​Customers:​town_city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Good Credit Rating:​col:​Customers:​customer_type_code] <br>4. PROJECT[tbl:​Customers, #3] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​min:​None, #1, #5] <br> | 1. SELECT[col:​Customers:​town_city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Good Credit Rating:​col:​Customers:​customer_type_code] <br>4. PROJECT[tbl:​Customers, #3] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​min:​None, #1, #5] <br> | + | extra | 
  | SPIDER_train_5774 | List the name of all products along with the number of complaints that they have received. | SELECT t1.product_name ,  count(*) FROM products AS t1 JOIN complaints AS t2 ON t1.product_id  =  t2.product_id GROUP BY t1.product_name | 1. SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[tbl:​Complaints, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[tbl:​Complaints, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_5775 | What are all the different product names, and how many complains has each received? | SELECT t1.product_name ,  count(*) FROM products AS t1 JOIN complaints AS t2 ON t1.product_id  =  t2.product_id GROUP BY t1.product_name | 1. SELECT[col:​Products:​product_name] <br>2.*(distinct)* PROJECT[different #REF, #1] <br>3. PROJECT[tbl:​Complaints, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Products:​product_name] <br>2.*(distinct)* PROJECT[None, #1] <br>3. PROJECT[tbl:​Complaints, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_5781 | Return the phone number of the customer who filed the complaint that was raised most recently. | SELECT t1.phone_number FROM customers AS t1 JOIN complaints AS t2 ON t1.customer_id  =  t2.customer_id ORDER BY t2.date_complaint_raised DESC LIMIT 1 | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. PROJECT[col:​Complaints:​date_complaint_raised, #2] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br>5. AGGREGATE[col:​Customers:​phone_number, #4] <br> | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. PROJECT[col:​Complaints:​date_complaint_raised, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[sum, #4] <br> | + | hard | 
  | SPIDER_train_5786 | What is the description of the product named "Chocolate"? | SELECT product_description FROM products WHERE product_name  =  "Chocolate" | 1. SELECT[val:​Products:​product_name:​Chocolate] <br>2. PROJECT[col:​Products:​product_description, #1] <br> | 1. SELECT[val:​Products:​product_name:​Chocolate] <br>2. PROJECT[col:​Products:​product_description, #1] <br> | + | easy | 
  | SPIDER_train_5787 | Return the description of the product called "Chocolate". | SELECT product_description FROM products WHERE product_name  =  "Chocolate" | 1. SELECT[tbl:​Products] <br>2. FILTER[#1, comparative:​=:​Chocolate:​col:​Products:​product_name] <br>3. PROJECT[col:​Products:​product_description, #2] <br> | 1. SELECT[tbl:​Products] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Chocolate:​col:​Products:​product_name] <br>3. PROJECT[col:​Products:​product_description, #2] <br> | + | easy | 
  | SPIDER_train_5788 | Find the name and category of the most expensive product. | SELECT product_name ,  product_category_code FROM products ORDER BY product_price DESC LIMIT 1 | 1. SELECT[col:​Products:​product_price] <br>2. FILTER[#1, comparative:​max:​None] <br>3. PROJECT[col:​Products:​product_name, #2] <br>4. PROJECT[col:​Products:​product_category_code, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​Products:​product_price] <br>2. SUPERLATIVE[comparative:​max:​None, #1, #1] <br>3. PROJECT[col:​Products:​product_name, #2] <br>4. PROJECT[col:​Products:​product_category_code, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_5789 | What is the name and category code of the product with the highest price? | SELECT product_name ,  product_category_code FROM products ORDER BY product_price DESC LIMIT 1 | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Products:​product_name, #3] <br>5. PROJECT[col:​Products:​product_category_code, #4] <br>6. PROJECT[col:​Products:​product_category_code, #5] <br>7. UNION[#4, #6] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Products:​product_name, #3] <br>5. PROJECT[col:​Products:​product_category_code, #4] <br>6. PROJECT[col:​Products:​product_category_code, #5] <br>7. UNION[#4, #6] <br> | + | medium | 
  | SPIDER_train_5790 | Find the prices of products which has never received a single complaint. | SELECT product_price FROM products WHERE product_id NOT IN (SELECT product_id FROM complaints) | 1. SELECT[tbl:​Products] <br>2. FILTER[#1, tbl:​Complaints] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Products:​product_price, #3] <br> | 1. SELECT[tbl:​Products] <br>2. COMPARATIVE[#1, #1, tbl:​Complaints] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Products:​product_price, #3] <br> | + | hard | 
  | SPIDER_train_5794 | Find the last name of the staff member who processed the complaint of the cheapest product. | SELECT t1.last_name FROM staff AS t1 JOIN complaints AS t2 ON t1.staff_id  =  t2.staff_id JOIN products AS t3 ON t2.product_id  =  t3.product_id ORDER BY t3.product_price LIMIT 1 | 1. SELECT[col:​Complaints:​product_id] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. COMPARATIVE[#2, #1, comparative:​min:​None] <br>4. PROJECT[tbl:​Staff, #3] <br>5. PROJECT[col:​Staff:​last_name, #4] <br> | 1. SELECT[col:​Complaints:​product_id] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #2, #1] <br>4. PROJECT[tbl:​Staff, #3] <br>5. PROJECT[col:​Staff:​last_name, #4] <br> | - | extra | 
  | SPIDER_train_5795 | What is the last name of the staff member in charge of the complaint on the product with the lowest price? | SELECT t1.last_name FROM staff AS t1 JOIN complaints AS t2 ON t1.staff_id  =  t2.staff_id JOIN products AS t3 ON t2.product_id  =  t3.product_id ORDER BY t3.product_price LIMIT 1 | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[tbl:​Complaints, #3] <br>5. PROJECT[tbl:​Staff, #4] <br>6. PROJECT[col:​Staff:​last_name, #5] <br> | 1. SELECT[tbl:​Products] <br>2. PROJECT[col:​Products:​product_price, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[tbl:​Complaints, #3] <br>5. PROJECT[tbl:​Staff, #4] <br>6. PROJECT[col:​Staff:​last_name, #5] <br> | + | extra | 
  | SPIDER_train_5796 | Which complaint status has more than 3 records on file? | SELECT complaint_status_code FROM complaints GROUP BY complaint_status_code HAVING count(*)  >  3 | 1. SELECT[col:​Complaints:​complaint_status_code] <br>2. PROJECT[records of #REF, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br> | 1. SELECT[col:​Complaints:​complaint_status_code] <br>2. PROJECT[None, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br> | + | easy | 
  | SPIDER_train_5797 | Return complaint status codes have more than 3 corresponding complaints? | SELECT complaint_status_code FROM complaints GROUP BY complaint_status_code HAVING count(*)  >  3 | 1. SELECT[col:​Complaints:​complaint_status_code] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br> | 1. SELECT[col:​Complaints:​complaint_status_code] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br> | + | easy | 
  | SPIDER_train_5798 | Find the last name of the staff whose email address contains "wrau". | SELECT last_name FROM staff WHERE email_address LIKE "%wrau%" | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​email_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%wrau%:​col:​Staff:​email_address] <br>4. PROJECT[col:​Staff:​last_name, #3] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​email_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​wrau:​col:​Staff:​email_address] <br>4. PROJECT[col:​Staff:​last_name, #3] <br> | + | medium | 
  | SPIDER_train_5799 | What are the last names of staff with email addressed containing the substring "wrau"? | SELECT last_name FROM staff WHERE email_address LIKE "%wrau%" | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​email_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%wrau%:​col:​Staff:​email_address] <br>4. PROJECT[col:​Staff:​last_name, #3] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​email_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​wrau:​col:​Staff:​email_address] <br>4. PROJECT[col:​Staff:​last_name, #3] <br> | + | medium | 
  | SPIDER_train_5801 | Count the number of customers that have the customer type that is most common. | SELECT count(*) FROM customers GROUP BY customer_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Customers:​customer_type_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[tbl:​Customers, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[col:​Customers:​customer_type_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[tbl:​Customers, #4] <br>6. AGGREGATE[count, #5] <br> | + | hard | 
  | SPIDER_train_5803 | Return the last name of the staff member who handled the complaint with the earliest date raised. | SELECT t1.last_name FROM staff AS t1 JOIN complaints AS t2 ON t1.staff_id  =  t2.staff_id ORDER BY t2.date_complaint_raised LIMIT 1 | 1. SELECT[tbl:​Staff] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. PROJECT[col:​Complaints:​date_complaint_raised, #2] <br>4. COMPARATIVE[#1, #3, comparative:​min:​None] <br>5. PROJECT[col:​Staff:​last_name, #4] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. PROJECT[col:​Complaints:​date_complaint_raised, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Staff:​last_name, #4] <br> | + | hard | 
  | SPIDER_train_5804 | How many distinct complaint type codes are there in the database? | SELECT count(DISTINCT complaint_type_code) FROM complaints | 1. SELECT[col:​Complaints:​complaint_type_code] <br>2.*(distinct)* PROJECT[distinct #REF, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Complaints:​complaint_type_code] <br>2.*(distinct)* PROJECT[None, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_5805 | Count the number of different complaint type codes. | SELECT count(DISTINCT complaint_type_code) FROM complaints | 1. SELECT[tbl:​Complaints] <br>2.*(distinct)* PROJECT[col:​Complaints:​complaint_type_code, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Complaints] <br>2.*(distinct)* PROJECT[col:​Complaints:​complaint_type_code, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_5807 | What are lines 1 and 2 of the addressed of the customer with the email "vbogisich@example.org"? | SELECT address_line_1 ,  address_line_2 FROM customers WHERE email_address  =  "vbogisich@example.org" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​email_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​vbogisich@example.org:​col:​Customers:​email_address] <br>4. PROJECT[col:​Customers:​email_address, #3] <br>5. PROJECT[col:​Customers:​address_line_1, #4] <br>6. PROJECT[col:​Customers:​address_line_2, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​email_address, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​vbogisich@example.org:​col:​Customers:​email_address] <br>4. PROJECT[col:​Customers:​email_address, #3] <br>5. PROJECT[col:​Customers:​address_line_1, #4] <br>6. PROJECT[col:​Customers:​address_line_2, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_5808 | Find the number of complaints with Product Failure type for each complaint status. | SELECT complaint_status_code ,  count(*) FROM complaints WHERE complaint_type_code  =  "Product Failure" GROUP BY complaint_status_code | 1. SELECT[tbl:​Complaints] <br>2. SELECT[col:​Complaints:​complaint_status_code] <br>3. FILTER[#1, comparative:​=:​Product Failure:​col:​Complaints:​complaint_type_code] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​Complaints] <br>2. SELECT[col:​Complaints:​complaint_status_code] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Product Failure:​col:​Complaints:​complaint_type_code] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_5809 | Of complaints with the type code "Product Failure", how many had each different status code? | SELECT complaint_status_code ,  count(*) FROM complaints WHERE complaint_type_code  =  "Product Failure" GROUP BY complaint_status_code | 1.*(distinct)* SELECT[col:​Complaints:​complaint_status_code] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. PROJECT[col:​Complaints:​complaint_status_code, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Product Failure:​col:​Complaints:​complaint_type_code] <br>5. GROUP[count, #4, #1] <br>6. UNION[#1, #5] <br> | 1.*(distinct)* SELECT[col:​Complaints:​complaint_status_code] <br>2. PROJECT[tbl:​Complaints, #1] <br>3. PROJECT[col:​Complaints:​complaint_status_code, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Product Failure:​col:​Complaints:​complaint_type_code] <br>5. GROUP[count, #4, #1] <br>6. UNION[#1, #5] <br> | + | medium | 
 ***
 Exec acc: **0.9600**
