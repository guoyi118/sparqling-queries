 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Ref_Document_Types** | Document_Type_Code | + |   | 
 | 2 |   | Document_Type_Name |   |   | 
 | 3 |   | Document_Type_Description |   |   | 
 | 4 | **Ref_Budget_Codes** | Budget_Type_Code | + |   | 
 | 5 |   | Budget_Type_Description |   |   | 
 | 6 | **Projects** | Project_ID | + |   | 
 | 7 |   | Project_Details |   |   | 
 | 8 | **Documents** | Document_ID | + |   | 
 | 9 |   | Document_Type_Code |   | --> 1 | 
 | 10 |   | Project_ID |   | --> 6 | 
 | 11 |   | Document_Date |   |   | 
 | 12 |   | Document_Name |   |   | 
 | 13 |   | Document_Description |   |   | 
 | 14 |   | Other_Details |   |   | 
 | 15 | **Statements** | Statement_ID | + | --> 8 | 
 | 16 |   | Statement_Details |   |   | 
 | 17 | **Documents_with_Expenses** | Document_ID | + | --> 8 | 
 | 18 |   | Budget_Type_Code |   | --> 4 | 
 | 19 |   | Document_Details |   |   | 
 | 20 | **Accounts** | Account_ID | + |   | 
 | 21 |   | Statement_ID |   | --> 15 | 
 | 22 |   | Account_Details |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6386 | Count the number of accounts. | SELECT count(*) FROM Accounts | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6389 | How many statements do we have? | SELECT count(*) FROM Statements | 1. SELECT[tbl:​Statements] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Statements] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6390 | Count the number of statements. | SELECT count(*) FROM Statements | 1. SELECT[tbl:​Statements] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Statements] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6391 | List all statement ids and statement details. | SELECT STATEMENT_ID ,  statement_details FROM Statements | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_ID, #1] <br>3. PROJECT[col:​Statements:​Statement_Details, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_ID, #1] <br>3. PROJECT[col:​Statements:​Statement_Details, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6392 | What are the ids and details of all statements? | SELECT STATEMENT_ID ,  statement_details FROM Statements | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_ID, #1] <br>3. PROJECT[col:​Statements:​Statement_Details, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_ID, #1] <br>3. PROJECT[col:​Statements:​Statement_Details, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6395 | Show all statement id and the number of accounts for each statement. | SELECT STATEMENT_ID ,  count(*) FROM Accounts GROUP BY STATEMENT_ID | 1. SELECT[col:​Accounts:​Statement_ID] <br>2. PROJECT[col:​Accounts:​Statement_ID, #1] <br>3. PROJECT[tbl:​Accounts, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Accounts:​Statement_ID] <br>2. PROJECT[col:​Accounts:​Statement_ID, #1] <br>3. PROJECT[tbl:​Accounts, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_6396 | What are the different statement ids on accounts, and the number of accounts for each? | SELECT STATEMENT_ID ,  count(*) FROM Accounts GROUP BY STATEMENT_ID | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​Statement_ID, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​Statement_ID, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6398 | What are the statement id and statement detail for the statement that has the most corresponding accounts? | SELECT T1.statement_id ,  T2.statement_details FROM Accounts AS T1 JOIN Statements AS T2 ON T1.statement_id  =  T2.statement_id GROUP BY T1.statement_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Accounts:​Statement_ID] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Accounts:​Statement_ID, #4] <br>6. PROJECT[col:​Statements:​Statement_Details, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​Accounts:​Statement_ID] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Accounts:​Statement_ID, #4] <br>6. PROJECT[col:​Statements:​Statement_Details, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_6399 | Show the number of documents. | SELECT count(*) FROM Documents | 1. SELECT[tbl:​Documents] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Documents] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6400 | Count the number of documents. | SELECT count(*) FROM Documents | 1. SELECT[tbl:​Documents] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Documents] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6403 | Show the ids and names of all documents. | SELECT document_id ,  document_name FROM Documents | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_ID, #1] <br>3. PROJECT[col:​Documents:​Document_Name, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_ID, #1] <br>3. PROJECT[col:​Documents:​Document_Name, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6404 | What are the ids and names for each of the documents? | SELECT document_id ,  document_name FROM Documents | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_ID, #1] <br>3. PROJECT[col:​Documents:​Document_Name, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_ID, #1] <br>3. PROJECT[col:​Documents:​Document_Name, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6405 | Find names and ids of all documents with document type code BK. | SELECT document_name ,  document_id FROM Documents WHERE document_type_code  =  "BK" | 1. SELECT[tbl:​Documents] <br>2. PROJECT[tbl:​Documents, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​BK:​col:​Documents:​Document_Type_Code] <br>4. PROJECT[col:​Documents:​Document_Name, #3] <br>5. PROJECT[col:​Documents:​Document_ID, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[tbl:​Documents, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​BK:​col:​Documents:​Document_Type_Code] <br>4. PROJECT[col:​Documents:​Document_Name, #3] <br>5. PROJECT[col:​Documents:​Document_ID, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6406 | What are the names and ids of documents that have the type code BK? | SELECT document_name ,  document_id FROM Documents WHERE document_type_code  =  "BK" | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​BK:​col:​Documents:​Document_Type_Code] <br>4. PROJECT[col:​Documents:​Document_Name, #3] <br>5. PROJECT[col:​Documents:​Document_ID, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​BK:​col:​Documents:​Document_Type_Code] <br>4. PROJECT[col:​Documents:​Document_Name, #3] <br>5. PROJECT[col:​Documents:​Document_ID, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6409 | Show the document name and the document date for all documents on project with details 'Graph Database project'. | SELECT document_name ,  document_date FROM Documents AS T1 JOIN projects AS T2 ON T1.project_id  =  T2.project_id WHERE T2.project_details  =  'Graph Database project' | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Graph Database project:​col:​Projects:​Project_Details] <br>4. PROJECT[tbl:​Documents, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #4] <br>6. PROJECT[col:​Documents:​Document_Date, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Graph Database project:​col:​Projects:​Project_Details] <br>4. PROJECT[tbl:​Documents, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #4] <br>6. PROJECT[col:​Documents:​Document_Date, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6410 | What are the names and dates for documents corresponding to project that has the details 'Graph Database project'? | SELECT document_name ,  document_date FROM Documents AS T1 JOIN projects AS T2 ON T1.project_id  =  T2.project_id WHERE T2.project_details  =  'Graph Database project' | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Graph Database project:​col:​Projects:​Project_Details] <br>4. PROJECT[tbl:​Documents, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #4] <br>6. PROJECT[col:​Documents:​Document_Date, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Graph Database project:​col:​Projects:​Project_Details] <br>4. PROJECT[tbl:​Documents, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #4] <br>6. PROJECT[col:​Documents:​Document_Date, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6411 | Show project ids and the number of documents in each project. | SELECT project_id ,  count(*) FROM Documents GROUP BY project_id | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[col:​Documents:​Project_ID, #1] <br>3. PROJECT[tbl:​Documents, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[col:​Documents:​Project_ID, #1] <br>3. PROJECT[tbl:​Documents, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_6412 | How many documents correspond with each project id? | SELECT project_id ,  count(*) FROM Documents GROUP BY project_id | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6413 | What is the id of the project with least number of documents? | SELECT project_id FROM Documents GROUP BY project_id ORDER BY count(*) ASC LIMIT 1 | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | + | hard | 
  | SPIDER_train_6414 | Return the id of the project that has the fewest corresponding documents. | SELECT project_id FROM Documents GROUP BY project_id ORDER BY count(*) ASC LIMIT 1 | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | + | hard | 
  | SPIDER_train_6415 | Show the ids for projects with at least 2 documents. | SELECT project_id FROM Documents GROUP BY project_id HAVING count(*)  >=  2 | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | + | easy | 
  | SPIDER_train_6416 | What are project ids of projects that have 2 or more corresponding documents? | SELECT project_id FROM Documents GROUP BY project_id HAVING count(*)  >=  2 | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | 1. SELECT[col:​Documents:​Project_ID] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Documents:​Project_ID, #4] <br> | + | easy | 
  | SPIDER_train_6417 | List document type codes and the number of documents in each code. | SELECT document_type_code ,  count(*) FROM Documents GROUP BY document_type_code | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6418 | How many documents are there of each type? | SELECT document_type_code ,  count(*) FROM Documents GROUP BY document_type_code | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6419 | What is the document type code with most number of documents? | SELECT document_type_code FROM Documents GROUP BY document_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6420 | Return the code of the document type that is most common. | SELECT document_type_code FROM Documents GROUP BY document_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_Type_Code, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​max:​None] <br>5. PROJECT[col:​Documents:​Document_Type_Code, #4] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​Document_Type_Code, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​Documents:​Document_Type_Code, #4] <br> | + | hard | 
  | SPIDER_train_6421 | Show the document type code with fewer than 3 documents. | SELECT document_type_code FROM Documents GROUP BY document_type_code HAVING count(*)  <  3 | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<:​3] <br> | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<:​3] <br> | + | easy | 
  | SPIDER_train_6422 | What are the codes corresponding to document types for which there are less than 3 documents? | SELECT document_type_code FROM Documents GROUP BY document_type_code HAVING count(*)  <  3 | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<:​3] <br>5. PROJECT[col:​Documents:​Document_Type_Code, #4] <br> | 1. SELECT[col:​Documents:​Document_Type_Code] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<:​3] <br>5. PROJECT[col:​Documents:​Document_Type_Code, #4] <br> | + | easy | 
  | SPIDER_train_6423 | Show the statement detail and the corresponding document name for the statement with detail 'Private Project'. | SELECT T1.statement_details ,  T2.document_name FROM Statements AS T1 JOIN Documents AS T2 ON T1.statement_id  =  T2.document_id WHERE T1.statement_details  =  'Private Project' | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Private Project:​col:​Statements:​Statement_Details] <br>4. PROJECT[col:​Statements:​Statement_Details, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Private Project:​col:​Statements:​Statement_Details] <br>4. PROJECT[col:​Statements:​Statement_Details, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6424 | What are the details for statements with the details 'Private Project', and what are the names of the corresponding documents? | SELECT T1.statement_details ,  T2.document_name FROM Statements AS T1 JOIN Documents AS T2 ON T1.statement_id  =  T2.document_id WHERE T1.statement_details  =  'Private Project' | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Private Project:​col:​Statements:​Statement_Details] <br>4. PROJECT[col:​Statements:​Statement_Details, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Statements] <br>2. PROJECT[col:​Statements:​Statement_Details, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Private Project:​col:​Statements:​Statement_Details] <br>4. PROJECT[col:​Statements:​Statement_Details, #3] <br>5. PROJECT[col:​Documents:​Document_Name, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6425 | Show all document type codes, document type names, document type descriptions. | SELECT document_type_code ,  document_type_name ,  document_type_description FROM Ref_document_types | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​Document_Type_Code, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #1] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​Document_Type_Code, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #1] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6426 | What are the codes, names, and descriptions of the different document types? | SELECT document_type_code ,  document_type_name ,  document_type_description FROM Ref_document_types | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[tbl:​Ref_Document_Types, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Code, #2] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #2] <br>5. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #2] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[tbl:​Ref_Document_Types, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Code, #2] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #2] <br>5. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #2] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_6427 | What is the document type description for document type named Film? | SELECT document_type_description FROM Ref_document_types WHERE document_type_name  =  "Film" | 1. SELECT[tbl:​Ref_Document_Types] <br>2. FILTER[#1, comparative:​=:​Film:​col:​Ref_Document_Types:​Document_Type_Name] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #2] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Film:​col:​Ref_Document_Types:​Document_Type_Name] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #2] <br> | + | easy | 
  | SPIDER_train_6428 | Return the description of the document type name 'Film'. | SELECT document_type_description FROM Ref_document_types WHERE document_type_name  =  "Film" | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Film:​col:​Ref_Document_Types:​Document_Type_Name] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #3] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Film:​col:​Ref_Document_Types:​Document_Type_Name] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #3] <br> | + | easy | 
  | SPIDER_train_6429 | What is the document type name and the document type description and creation date for all the documents? | SELECT T1.document_type_name ,  T1.document_type_description ,  T2.Document_date FROM Ref_document_types AS T1 JOIN Documents AS T2 ON T1.document_type_code  =  T2.document_type_code | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[tbl:​Ref_Document_Types, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #2] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #2] <br>5. PROJECT[col:​Documents:​Document_Date, #1] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[tbl:​Ref_Document_Types, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #2] <br>4. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #2] <br>5. PROJECT[col:​Documents:​Document_Date, #1] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_6430 | Return the type name, type description, and date of creation for each document. | SELECT T1.document_type_name ,  T1.document_type_description ,  T2.Document_date FROM Ref_document_types AS T1 JOIN Documents AS T2 ON T1.document_type_code  =  T2.document_type_code | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #1] <br>4. PROJECT[col:​Documents:​Document_Date, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​Document_Type_Name, #1] <br>3. PROJECT[col:​Ref_Document_Types:​Document_Type_Description, #1] <br>4. PROJECT[col:​Documents:​Document_Date, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6431 | Show the number of projects. | SELECT count(*) FROM Projects | 1. SELECT[tbl:​Projects] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Projects] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6432 | How many projects are there? | SELECT count(*) FROM Projects | 1. SELECT[tbl:​Projects] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Projects] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6433 | List ids and details for all projects. | SELECT project_id ,  project_details FROM Projects | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_ID, #1] <br>3. PROJECT[col:​Projects:​Project_Details, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_ID, #1] <br>3. PROJECT[col:​Projects:​Project_Details, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6434 | What are the ids and details for each project? | SELECT project_id ,  project_details FROM Projects | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_ID, #1] <br>3. PROJECT[col:​Projects:​Project_Details, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[col:​Projects:​Project_ID, #1] <br>3. PROJECT[col:​Projects:​Project_Details, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6435 | What is the project id and detail for the project with at least two documents? | SELECT T1.project_id ,  T1.project_details FROM Projects AS T1 JOIN Documents AS T2 ON T1.project_id  =  T2.project_id GROUP BY T1.project_id HAVING count(*)  >  2 | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Projects:​Project_ID, #4] <br>6. PROJECT[col:​Projects:​Project_Details, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Projects:​Project_ID, #4] <br>6. PROJECT[col:​Projects:​Project_Details, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6436 | Return the ids and details corresponding to projects for which there are more than two documents. | SELECT T1.project_id ,  T1.project_details FROM Projects AS T1 JOIN Documents AS T2 ON T1.project_id  =  T2.project_id GROUP BY T1.project_id HAVING count(*)  >  2 | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Projects:​Project_ID, #4] <br>6. PROJECT[col:​Projects:​Project_Details, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Projects:​Project_ID, #4] <br>6. PROJECT[col:​Projects:​Project_Details, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6437 | What is the project detail for the project with document "King Book"? | SELECT T1.project_details FROM Projects AS T1 JOIN Documents AS T2 ON T1.project_id  =  T2.project_id WHERE T2.document_name  =  "King Book" | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​King Book:​col:​Documents:​Document_Name] <br>4. PROJECT[col:​Projects:​Project_Details, #3] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​King Book:​col:​Documents:​Document_Name] <br>4. PROJECT[col:​Projects:​Project_Details, #3] <br> | + | medium | 
  | SPIDER_train_6438 | Give the details of the project with the document name 'King Book'. | SELECT T1.project_details FROM Projects AS T1 JOIN Documents AS T2 ON T1.project_id  =  T2.project_id WHERE T2.document_name  =  "King Book" | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​King Book:​col:​Documents:​Document_Name] <br>4. PROJECT[col:​Projects:​Project_Details, #3] <br> | 1. SELECT[tbl:​Projects] <br>2. PROJECT[tbl:​Documents, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​King Book:​col:​Documents:​Document_Name] <br>4. PROJECT[col:​Projects:​Project_Details, #3] <br> | + | medium | 
  | SPIDER_train_6439 | How many budget types do we have? | SELECT count(*) FROM Ref_budget_codes | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6440 | Count the number of budget codes. | SELECT count(*) FROM Ref_budget_codes | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6441 | List all budget type codes and descriptions. | SELECT budget_type_code ,  budget_type_description FROM Ref_budget_codes | 1. SELECT[col:​Ref_Budget_Codes:​Budget_Type_Code] <br>2. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #1] <br>3. UNION[#1, #2] <br> | 1. SELECT[col:​Ref_Budget_Codes:​Budget_Type_Code] <br>2. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #1] <br>3. UNION[#1, #2] <br> | + | medium | 
  | SPIDER_train_6442 | What are the type codes and descriptions of each budget type? | SELECT budget_type_code ,  budget_type_description FROM Ref_budget_codes | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Code, #1] <br>3. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Code, #1] <br>3. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6443 | What is the description for the budget type with code ORG? | SELECT budget_type_description FROM Ref_budget_codes WHERE budget_type_code  =  "ORG" | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. PROJECT[tbl:​Ref_Budget_Codes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​ORG:​col:​Ref_Budget_Codes:​Budget_Type_Code] <br>4. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #3] <br> | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. PROJECT[tbl:​Ref_Budget_Codes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​ORG:​col:​Ref_Budget_Codes:​Budget_Type_Code] <br>4. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #3] <br> | + | easy | 
  | SPIDER_train_6444 | Return the description of the budget type that has the code ORG. | SELECT budget_type_description FROM Ref_budget_codes WHERE budget_type_code  =  "ORG" | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. PROJECT[tbl:​Ref_Budget_Codes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​ORG:​col:​Ref_Budget_Codes:​Budget_Type_Code] <br>4. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #3] <br> | 1. SELECT[tbl:​Ref_Budget_Codes] <br>2. PROJECT[tbl:​Ref_Budget_Codes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​ORG:​col:​Ref_Budget_Codes:​Budget_Type_Code] <br>4. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #3] <br> | + | easy | 
  | SPIDER_train_6445 | How many documents have expenses? | SELECT count(*) FROM Documents_with_expenses | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. FILTER[#1, tbl:​Documents_with_Expenses] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. COMPARATIVE[#1, #1, tbl:​Documents_with_Expenses] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6447 | What are the document ids for the budget type code 'SF'? | SELECT document_id FROM Documents_with_expenses WHERE budget_type_code  =  'SF' | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>4. PROJECT[col:​Documents_with_Expenses:​Document_ID, #3] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>4. PROJECT[col:​Documents_with_Expenses:​Document_ID, #3] <br> | + | easy | 
  | SPIDER_train_6448 | Give the ids of documents with expenses that have the budget code 'SF'. | SELECT document_id FROM Documents_with_expenses WHERE budget_type_code  =  'SF' | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>4. PROJECT[tbl:​Documents_with_Expenses, #3] <br>5. PROJECT[col:​Documents_with_Expenses:​Document_ID, #4] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>4. PROJECT[tbl:​Documents_with_Expenses, #3] <br>5. PROJECT[col:​Documents_with_Expenses:​Document_ID, #4] <br> | + | easy | 
  | SPIDER_train_6449 | Show the budget type code and description and the corresponding document id. | SELECT T2.budget_type_code ,  T2.budget_type_description ,  T1.document_id FROM Documents_with_expenses AS T1 JOIN Ref_budget_codes AS T2 ON T1.budget_type_code  =  T2.budget_type_code | 1. SELECT[col:​Ref_Budget_Codes:​Budget_Type_Code] <br>2. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #1] <br>3. PROJECT[col:​Documents_with_Expenses:​Document_ID, #1] <br>4. UNION[#1, #2, #3] <br> | 1. SELECT[col:​Ref_Budget_Codes:​Budget_Type_Code] <br>2. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #1] <br>3. PROJECT[col:​Documents_with_Expenses:​Document_ID, #1] <br>4. UNION[#1, #2, #3] <br> | + | medium | 
  | SPIDER_train_6450 | Return the budget type codes, budget type descriptions and document ids for documents with expenses. | SELECT T2.budget_type_code ,  T2.budget_type_description ,  T1.document_id FROM Documents_with_expenses AS T1 JOIN Ref_budget_codes AS T2 ON T1.budget_type_code  =  T2.budget_type_code | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. FILTER[#1, tbl:​Documents_with_Expenses] <br>3. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Code, #2] <br>4. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #2] <br>5. PROJECT[col:​Documents_with_Expenses:​Document_ID, #2] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. COMPARATIVE[#1, #1, tbl:​Documents_with_Expenses] <br>3. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Code, #2] <br>4. PROJECT[col:​Ref_Budget_Codes:​Budget_Type_Description, #2] <br>5. PROJECT[col:​Documents_with_Expenses:​Document_ID, #2] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_6451 | Show ids for all documents with budget types described as 'Government'. | SELECT T1.document_id FROM Documents_with_expenses AS T1 JOIN Ref_Budget_Codes AS T2 ON T1.Budget_Type_code  =  T2.Budget_Type_code WHERE T2.budget_type_Description  =  "Government" | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. FILTER[#1, comparative:​=:​Government:​col:​Ref_Budget_Codes:​Budget_Type_Description] <br>3. PROJECT[col:​Documents_with_Expenses:​Document_ID, #2] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Government:​col:​Ref_Budget_Codes:​Budget_Type_Description] <br>3. PROJECT[col:​Documents_with_Expenses:​Document_ID, #2] <br> | + | medium | 
  | SPIDER_train_6452 | Give the ids for documents that have the budget description 'Government'. | SELECT T1.document_id FROM Documents_with_expenses AS T1 JOIN Ref_Budget_Codes AS T2 ON T1.Budget_Type_code  =  T2.Budget_Type_code WHERE T2.budget_type_Description  =  "Government" | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[tbl:​Ref_Budget_Codes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Government:​col:​Ref_Budget_Codes:​Budget_Type_Description] <br>4. PROJECT[col:​Documents_with_Expenses:​Document_ID, #3] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[tbl:​Ref_Budget_Codes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Government:​col:​Ref_Budget_Codes:​Budget_Type_Description] <br>4. PROJECT[col:​Documents_with_Expenses:​Document_ID, #3] <br> | + | medium | 
  | SPIDER_train_6453 | Show budget type codes and the number of documents in each budget type. | SELECT budget_type_code ,  count(*) FROM Documents_with_expenses GROUP BY budget_type_code | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. PROJECT[tbl:​Documents_with_Expenses, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. PROJECT[tbl:​Documents_with_Expenses, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_6454 | What are the different budget type codes, and how many documents are there for each? | SELECT budget_type_code ,  count(*) FROM Documents_with_expenses GROUP BY budget_type_code | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. PROJECT[tbl:​Documents_with_Expenses, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. PROJECT[tbl:​Documents_with_Expenses, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_6455 | What is the budget type code with most number of documents. | SELECT budget_type_code FROM Documents_with_expenses GROUP BY budget_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[tbl:​Documents_with_Expenses, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[tbl:​Documents_with_Expenses, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6456 | Give the budget type code that is most common among documents with expenses. | SELECT budget_type_code FROM Documents_with_expenses GROUP BY budget_type_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[tbl:​Documents_with_Expenses, #1] <br>3. FILTER[#2, tbl:​Documents_with_Expenses] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br> | 1. SELECT[col:​Documents_with_Expenses:​Budget_Type_Code] <br>2. PROJECT[tbl:​Documents_with_Expenses, #1] <br>3. COMPARATIVE[#2, #2, tbl:​Documents_with_Expenses] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br> | + | hard | 
  | SPIDER_train_6457 | What are the ids of documents which don't have expense budgets? | SELECT document_id FROM Documents EXCEPT SELECT document_id FROM Documents_with_expenses | 1. SELECT[tbl:​Documents] <br>2. FILTER[#1, tbl:​Documents_with_Expenses] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Documents:​Document_ID, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. COMPARATIVE[#1, #1, tbl:​Documents_with_Expenses] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Documents:​Document_ID, #3] <br> | + | hard | 
  | SPIDER_train_6458 | Return the ids of documents that do not have expenses. | SELECT document_id FROM Documents EXCEPT SELECT document_id FROM Documents_with_expenses | 1. SELECT[tbl:​Documents] <br>2. FILTER[#1, tbl:​Documents_with_Expenses] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Documents:​Document_ID, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. COMPARATIVE[#1, #1, tbl:​Documents_with_Expenses] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Documents:​Document_ID, #3] <br> | + | hard | 
  | SPIDER_train_6459 | Show ids for all documents in type CV without expense budgets. | SELECT document_id FROM Documents WHERE document_type_code  =  "CV" EXCEPT SELECT document_id FROM Documents_with_expenses | 1. SELECT[tbl:​Documents] <br>2. FILTER[#1, comparative:​=:​CV:​col:​Documents:​Document_Type_Code] <br>3. FILTER[#2, tbl:​Documents_with_Expenses] <br>4. DISCARD[#2, #3] <br>5. PROJECT[col:​Documents:​Document_ID, #4] <br> | 1. SELECT[tbl:​Documents] <br>2. COMPARATIVE[#1, #1, comparative:​=:​CV:​col:​Documents:​Document_Type_Code] <br>3. COMPARATIVE[#2, #2, tbl:​Documents_with_Expenses] <br>4. DISCARD[#2, #3] <br>5. PROJECT[col:​Documents:​Document_ID, #4] <br> | + | hard | 
  | SPIDER_train_6461 | What are the ids of documents with letter 's' in the name with any expense budgets. | SELECT T1.document_id FROM Documents AS T1 JOIN Documents_with_expenses AS T2 ON T1.document_id  =  T2.document_id WHERE T1.document_name LIKE '%s%' | 1. SELECT[col:​Documents:​Document_ID] <br>2. FILTER[#1, tbl:​Documents_with_Expenses] <br>3. FILTER[#1, comparative:​like:​%s%:​col:​Documents:​Document_Name] <br>4. INTERSECTION[#1, #2, #3] <br> | 1. SELECT[col:​Documents:​Document_ID] <br>2. COMPARATIVE[#1, #1, tbl:​Documents_with_Expenses] <br>3. COMPARATIVE[#1, #1, comparative:​like:​s:​col:​Documents:​Document_Name] <br>4. INTERSECTION[#1, #2, #3] <br> | + | hard | 
  | SPIDER_train_6462 | Give the ids of documents that have expenses and contain the letter s in their names. | SELECT T1.document_id FROM Documents AS T1 JOIN Documents_with_expenses AS T2 ON T1.document_id  =  T2.document_id WHERE T1.document_name LIKE '%s%' | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. FILTER[#1, tbl:​Documents_with_Expenses] <br>3. PROJECT[col:​Documents:​Document_Name, #2] <br>4. COMPARATIVE[#2, #3, comparative:​like:​%s%:​col:​Documents:​Document_Name] <br>5. PROJECT[col:​Documents:​Document_ID, #4] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. COMPARATIVE[#1, #1, tbl:​Documents_with_Expenses] <br>3. PROJECT[col:​Documents:​Document_Name, #2] <br>4. COMPARATIVE[#2, #3, comparative:​like:​s:​col:​Documents:​Document_Name] <br>5. PROJECT[col:​Documents:​Document_ID, #4] <br> | + | hard | 
  | SPIDER_train_6463 | How many documents do not have any expense? | SELECT count(*) FROM Documents WHERE document_id NOT IN ( SELECT document_id FROM Documents_with_expenses ) | 1. SELECT[tbl:​Documents] <br>2. FILTER[#1, tbl:​Documents_with_Expenses] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. COMPARATIVE[#1, #1, tbl:​Documents_with_Expenses] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_6465 | What are the dates for the documents with both 'GV' type and 'SF' type expenses? | SELECT T1.document_date FROM Documents AS T1 JOIN Documents_with_Expenses AS T2 ON T1.document_id  =  T2.document_id WHERE T2.budget_type_code  =  'GV' INTERSECT SELECT T1.document_date FROM Documents AS T1 JOIN Documents_with_Expenses AS T2 ON T1.document_id  =  T2.document_id WHERE T2.budget_type_code  =  'SF' | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[tbl:​Documents_with_Expenses, #1] <br>3. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​GV:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>5. COMPARATIVE[#1, #3, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Documents:​Document_Date, #6] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[tbl:​Documents_with_Expenses, #1] <br>3. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​GV:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>5. COMPARATIVE[#1, #3, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Documents:​Document_Date, #6] <br> | + | extra | 
  | SPIDER_train_6466 | Give the dates of creation for documents that have both budget type codes 'GV' and 'SF'. | SELECT T1.document_date FROM Documents AS T1 JOIN Documents_with_Expenses AS T2 ON T1.document_id  =  T2.document_id WHERE T2.budget_type_code  =  'GV' INTERSECT SELECT T1.document_date FROM Documents AS T1 JOIN Documents_with_Expenses AS T2 ON T1.document_id  =  T2.document_id WHERE T2.budget_type_code  =  'SF' | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​GV:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Documents:​Document_Date, #5] <br> | 1. SELECT[tbl:​Documents_with_Expenses] <br>2. PROJECT[col:​Documents_with_Expenses:​Budget_Type_Code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​GV:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>4. COMPARATIVE[#1, #2, comparative:​=:​SF:​col:​Documents_with_Expenses:​Budget_Type_Code] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Documents:​Document_Date, #5] <br> | + | extra | 
 ***
 Exec acc: **1.0000**
