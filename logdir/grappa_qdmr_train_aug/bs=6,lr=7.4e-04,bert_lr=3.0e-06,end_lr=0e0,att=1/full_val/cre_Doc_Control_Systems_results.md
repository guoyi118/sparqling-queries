 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Ref_Document_Types** | document_type_code | + | --> 14 | 
 | 2 |   | document_type_description |   |   | 
 | 3 | **Roles** | role_code | + | --> 20 | 
 | 4 |   | role_description |   |   | 
 | 5 | **Addresses** | address_id | + | --> 34 | 
 | 6 |   | address_details |   |   | 
 | 7 | **Ref_Document_Status** | document_status_code | + | --> 13 | 
 | 8 |   | document_status_description |   |   | 
 | 9 | **Ref_Shipping_Agents** | shipping_agent_code | + | --> 15 | 
 | 10 |   | shipping_agent_name |   |   | 
 | 11 |   | shipping_agent_description |   |   | 
 | 12 | **Documents** | document_id | + | --> 23 | 
 | 13 |   | document_status_code |   |   | 
 | 14 |   | document_type_code |   |   | 
 | 15 |   | shipping_agent_code |   |   | 
 | 16 |   | receipt_date |   |   | 
 | 17 |   | receipt_number |   |   | 
 | 18 |   | other_details |   |   | 
 | 19 | **Employees** | employee_id | + | --> 32 | 
 | 20 |   | role_code |   |   | 
 | 21 |   | employee_name |   |   | 
 | 22 |   | other_details |   |   | 
 | 23 | **Document_Drafts** | document_id | + | --> 26 | 
 | 24 |   | draft_number |   | --> 27 | 
 | 25 |   | draft_details |   |   | 
 | 26 | **Draft_Copies** | document_id | + | --> 12 | 
 | 27 |   | draft_number |   | --> 30 | 
 | 28 |   | copy_number |   | --> 31 | 
 | 29 | **Circulation_History** | document_id | + | --> 12 | 
 | 30 |   | draft_number |   | --> 24 | 
 | 31 |   | copy_number |   | --> 28 | 
 | 32 |   | employee_id |   |   | 
 | 33 | **Documents_Mailed** | document_id | + |   | 
 | 34 |   | mailed_to_address_id |   |   | 
 | 35 |   | mailing_date |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_2098 | What document status codes do we have? | SELECT document_status_code FROM Ref_Document_Status; | 1. SELECT[tbl:​Ref_Document_Status] <br>2. PROJECT[col:​Ref_Document_Status:​document_status_code, #1] <br> | 1. SELECT[tbl:​Ref_Document_Status] <br>2. PROJECT[col:​Ref_Document_Status:​document_status_code, #1] <br> | + | easy | 
  | SPIDER_train_2099 | What is the description of document status code 'working'? | SELECT document_status_description FROM Ref_Document_Status WHERE document_status_code = "working"; | 1. SELECT[tbl:​Ref_Document_Status] <br>2. PROJECT[col:​Ref_Document_Status:​document_status_description, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​working:​col:​Ref_Document_Status:​document_status_code] <br> | 1. SELECT[tbl:​Ref_Document_Status] <br>2. PROJECT[col:​Ref_Document_Status:​document_status_description, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​working:​col:​Ref_Document_Status:​document_status_code] <br> | + | easy | 
  | SPIDER_train_2100 | What document type codes do we have? | SELECT document_type_code FROM Ref_Document_Types; | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​document_type_code, #1] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​document_type_code, #1] <br> | + | easy | 
  | SPIDER_train_2101 | What is the description of document type 'Paper'? | SELECT document_type_description FROM Ref_Document_Types WHERE document_type_code = "Paper"; | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​document_type_description, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Paper:​col:​Ref_Document_Types:​document_type_code] <br> | 1. SELECT[tbl:​Ref_Document_Types] <br>2. PROJECT[col:​Ref_Document_Types:​document_type_description, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Paper:​col:​Ref_Document_Types:​document_type_code] <br> | + | easy | 
  | SPIDER_train_2102 | What are the shipping agent names? | SELECT shipping_agent_name FROM Ref_Shipping_Agents; | 1. SELECT[col:​Ref_Shipping_Agents:​shipping_agent_name] <br>2. FILTER[#1, tbl:​Ref_Shipping_Agents] <br> | 1. SELECT[col:​Ref_Shipping_Agents:​shipping_agent_name] <br>2. COMPARATIVE[#1, #1, tbl:​Ref_Shipping_Agents] <br> | + | easy | 
  | SPIDER_train_2103 | What is the shipping agent code of shipping agent UPS? | SELECT shipping_agent_code FROM Ref_Shipping_Agents WHERE shipping_agent_name = "UPS"; | 1. SELECT[val:​Ref_Shipping_Agents:​shipping_agent_name:​UPS] <br>2. PROJECT[col:​Ref_Shipping_Agents:​shipping_agent_code, #1] <br> | 1. SELECT[val:​Ref_Shipping_Agents:​shipping_agent_name:​UPS] <br>2. PROJECT[col:​Ref_Shipping_Agents:​shipping_agent_code, #1] <br> | + | easy | 
  | SPIDER_train_2104 | What are all role codes? | SELECT role_code FROM ROLES; | 1. SELECT[col:​Roles:​role_code] <br> | 1. SELECT[col:​Roles:​role_code] <br> | + | easy | 
  | SPIDER_train_2105 | What is the description of role code ED? | SELECT role_description FROM ROLES WHERE role_code = "ED"; | 1. SELECT[val:​Roles:​role_code:​ED] <br>2. PROJECT[col:​Roles:​role_description, #1] <br> | 1. SELECT[val:​Employees:​role_code:​ED] <br>2. PROJECT[col:​Roles:​role_description, #1] <br> | - | easy | 
  | SPIDER_train_2106 | How many employees do we have? | SELECT count(*) FROM Employees; | 1. SELECT[tbl:​Employees] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Employees] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_2107 | What is the role of the employee named Koby? | SELECT T1.role_description FROM ROLES AS T1 JOIN Employees AS T2 ON T1.role_code = T2.role_code WHERE T2.employee_name = "Koby"; | 1. SELECT[tbl:​Employees] <br>2. FILTER[#1, comparative:​=:​Koby:​col:​Employees:​employee_name] <br>3. PROJECT[col:​Roles:​role_description, #2] <br> | 1. SELECT[tbl:​Employees] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Koby:​col:​Employees:​employee_name] <br>3. PROJECT[col:​Roles:​role_description, #2] <br> | + | medium | 
  | SPIDER_train_2108 | List all document ids and receipt dates of documents. | SELECT document_id ,  receipt_date FROM Documents; | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. PROJECT[col:​Documents:​receipt_date, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. PROJECT[col:​Documents:​receipt_date, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_2109 | How many employees does each role have? List role description, id and number of employees. | SELECT T1.role_description ,  T2.role_code ,  count(*) FROM ROLES AS T1 JOIN Employees AS T2 ON T1.role_code = T2.role_code GROUP BY T2.role_code; | 1. SELECT[col:​Employees:​role_code] <br>2. PROJECT[tbl:​Employees, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Roles:​role_description, #1] <br>5. PROJECT[col:​Employees:​role_code, #1] <br>6. UNION[#4, #5, #3] <br> | 1. SELECT[col:​Employees:​role_code] <br>2. PROJECT[tbl:​Employees, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Roles:​role_description, #1] <br>5. PROJECT[col:​Employees:​role_code, #1] <br>6. UNION[#4, #5, #3] <br> | + | medium | 
  | SPIDER_train_2111 | What is the document status description of the document with id 1? | SELECT Ref_Document_Status.document_status_description FROM Ref_Document_Status JOIN Documents ON Documents.document_status_code = Ref_Document_Status.document_status_code WHERE Documents.document_id = 1; | 1. SELECT[tbl:​Ref_Document_Status] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​Documents:​document_id] <br>4. PROJECT[tbl:​Ref_Document_Status, #3] <br>5. PROJECT[col:​Ref_Document_Status:​document_status_description, #4] <br> | 1. SELECT[tbl:​Ref_Document_Status] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​Documents:​document_id] <br>4. PROJECT[tbl:​Ref_Document_Status, #3] <br>5. PROJECT[col:​Ref_Document_Status:​document_status_description, #4] <br> | + | medium | 
  | SPIDER_train_2112 | How many documents have the status code done? | SELECT count(*) FROM Documents WHERE document_status_code = "done"; | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_2113 | List the document type code for the document with the id 2. | SELECT document_type_code FROM Documents WHERE document_id = 2; | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​2:​col:​Documents:​document_id] <br>4. PROJECT[col:​Documents:​document_type_code, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​2:​col:​Documents:​document_id] <br>4. PROJECT[col:​Documents:​document_type_code, #3] <br> | + | easy | 
  | SPIDER_train_2114 | List the document ids for any documents with the status code done and the type code paper. | SELECT document_id FROM Documents WHERE document_status_code = "done" AND document_type_code = "Paper"; | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>4. PROJECT[col:​Documents:​document_status_code, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Paper:​col:​Documents:​document_type_code] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Documents:​document_id, #6] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>4. PROJECT[col:​Documents:​document_status_code, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Paper:​col:​Documents:​document_type_code] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Documents:​document_id, #6] <br> | + | medium | 
  | SPIDER_train_2115 | What is the name of the shipping agent of the document with id 2? | SELECT Ref_Shipping_Agents.shipping_agent_name FROM Ref_Shipping_Agents JOIN Documents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code WHERE Documents.document_id = 2; | 1. SELECT[tbl:​Ref_Shipping_Agents] <br>2. FILTER[#1, comparative:​=:​2:​col:​Documents:​document_id] <br>3. PROJECT[tbl:​Ref_Shipping_Agents, #2] <br>4. PROJECT[col:​Ref_Shipping_Agents:​shipping_agent_name, #3] <br> | 1. SELECT[tbl:​Ref_Shipping_Agents] <br>2. COMPARATIVE[#1, #1, comparative:​=:​2:​col:​Documents:​document_id] <br>3. PROJECT[tbl:​Ref_Shipping_Agents, #2] <br>4. PROJECT[col:​Ref_Shipping_Agents:​shipping_agent_name, #3] <br> | + | medium | 
  | SPIDER_train_2116 | How many documents were shipped by USPS? | SELECT count(*) FROM Ref_Shipping_Agents JOIN Documents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code WHERE Ref_Shipping_Agents.shipping_agent_name = "USPS"; | 1. SELECT[tbl:​Documents] <br>2. FILTER[#1, comparative:​=:​USPS:​col:​Ref_Shipping_Agents:​shipping_agent_name] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Documents] <br>2. COMPARATIVE[#1, #1, comparative:​=:​USPS:​col:​Ref_Shipping_Agents:​shipping_agent_name] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_2117 | Which shipping agent shipped the most documents? List the shipping agent name and the number of documents. | SELECT Ref_Shipping_Agents.shipping_agent_name , count(Documents.document_id) FROM Ref_Shipping_Agents JOIN Documents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code GROUP BY Ref_Shipping_Agents.shipping_agent_code ORDER BY count(Documents.document_id) DESC LIMIT 1; | 1. SELECT[col:​Ref_Shipping_Agents:​shipping_agent_code] <br>2. SELECT[col:​Documents:​document_id] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[max, #3] <br>6. PROJECT[col:​Ref_Shipping_Agents:​shipping_agent_name, #4] <br>7. UNION[#6, #5] <br> | 1. SELECT[col:​Ref_Shipping_Agents:​shipping_agent_code] <br>2. SELECT[col:​Documents:​document_id] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[max, #3] <br>6. PROJECT[col:​Ref_Shipping_Agents:​shipping_agent_name, #4] <br>7. UNION[#6, #5] <br> | + | extra | 
  | SPIDER_train_2118 | What is the receipt date of the document with id 3? | SELECT receipt_date FROM Documents WHERE document_id = 3; | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​3:​col:​Documents:​document_id] <br>4. PROJECT[col:​Documents:​receipt_date, #3] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​3:​col:​Documents:​document_id] <br>4. PROJECT[col:​Documents:​receipt_date, #3] <br> | + | easy | 
  | SPIDER_train_2119 | What address was the document with id 4 mailed to? | SELECT Addresses.address_details FROM Addresses JOIN Documents_Mailed ON Documents_Mailed.mailed_to_address_id = Addresses.address_id WHERE document_id = 4; | 1. SELECT[tbl:​Documents_Mailed] <br>2. PROJECT[col:​Documents_Mailed:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​4:​col:​Documents_Mailed:​document_id] <br>4. PROJECT[col:​Addresses:​address_details, #3] <br> | 1. SELECT[tbl:​Documents_Mailed] <br>2. PROJECT[col:​Documents_Mailed:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​4:​col:​Documents_Mailed:​document_id] <br>4. PROJECT[col:​Addresses:​address_details, #3] <br> | + | medium | 
  | SPIDER_train_2120 | What is the mail date of the document with id 7? | SELECT mailing_date FROM Documents_Mailed WHERE document_id = 7; | 1. SELECT[tbl:​Documents_Mailed] <br>2. PROJECT[col:​Documents_Mailed:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​7:​col:​Documents_Mailed:​document_id] <br>4. PROJECT[col:​Documents_Mailed:​mailing_date, #3] <br> | 1. SELECT[tbl:​Documents_Mailed] <br>2. PROJECT[col:​Documents_Mailed:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​7:​col:​Documents_Mailed:​document_id] <br>4. PROJECT[col:​Documents_Mailed:​mailing_date, #3] <br> | + | easy | 
  | SPIDER_train_2121 | List the document ids of documents with the status done and type Paper, which not shipped by the shipping agent named USPS. | SELECT document_id FROM Documents WHERE document_status_code  =  "done" AND document_type_code = "Paper" EXCEPT SELECT document_id FROM Documents JOIN Ref_Shipping_Agents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code WHERE Ref_Shipping_Agents.shipping_agent_name = "USPS"; | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. PROJECT[col:​Documents:​document_type_code, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Paper:​col:​Documents:​document_type_code] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[tbl:​Ref_Shipping_Agents, #6] <br>8. COMPARATIVE[#6, #7, comparative:​=:​USPS:​col:​Ref_Shipping_Agents:​shipping_agent_name] <br>9. DISCARD[#6, #8] <br>10. PROJECT[col:​Documents:​document_id, #9] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. PROJECT[col:​Documents:​document_type_code, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Paper:​col:​Documents:​document_type_code] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[tbl:​Ref_Shipping_Agents, #6] <br>8. COMPARATIVE[#6, #7, comparative:​=:​USPS:​col:​Ref_Shipping_Agents:​shipping_agent_name] <br>9. DISCARD[#6, #8] <br>10. PROJECT[col:​Documents:​document_id, #9] <br> | + | extra | 
  | SPIDER_train_2122 | List document id of documents status is done and document type is Paper and the document is shipped by shipping agent named USPS. | SELECT document_id FROM Documents WHERE document_status_code  =  "done" AND document_type_code = "Paper" INTERSECT SELECT document_id FROM Documents JOIN Ref_Shipping_Agents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code WHERE Ref_Shipping_Agents.shipping_agent_name = "USPS"; | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>4. PROJECT[col:​Documents:​document_type_code, #1] <br>5. COMPARATIVE[#3, #4, comparative:​=:​Paper:​col:​Documents:​document_type_code] <br>6. PROJECT[tbl:​Ref_Shipping_Agents, #1] <br>7. COMPARATIVE[#5, #6, comparative:​=:​USPS:​col:​Ref_Shipping_Agents:​shipping_agent_name] <br>8. PROJECT[col:​Documents:​document_id, #7] <br> | 1. SELECT[tbl:​Documents] <br>2. PROJECT[col:​Documents:​document_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​done:​col:​Documents:​document_status_code] <br>4. PROJECT[col:​Documents:​document_type_code, #1] <br>5. COMPARATIVE[#3, #4, comparative:​=:​Paper:​col:​Documents:​document_type_code] <br>6. PROJECT[tbl:​Ref_Shipping_Agents, #1] <br>7. COMPARATIVE[#5, #6, comparative:​=:​USPS:​col:​Ref_Shipping_Agents:​shipping_agent_name] <br>8. PROJECT[col:​Documents:​document_id, #7] <br> | + | extra | 
  | SPIDER_train_2123 | What is draft detail of the document with id 7? | SELECT draft_details FROM Document_Drafts WHERE document_id = 7; | 1. SELECT[tbl:​Document_Drafts] <br>2. PROJECT[col:​Document_Drafts:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​7:​col:​Document_Drafts:​document_id] <br>4. PROJECT[col:​Document_Drafts:​draft_details, #3] <br> | 1. SELECT[tbl:​Document_Drafts] <br>2. PROJECT[col:​Document_Drafts:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​7:​col:​Document_Drafts:​document_id] <br>4. PROJECT[col:​Document_Drafts:​draft_details, #3] <br> | + | easy | 
  | SPIDER_train_2124 | How many draft copies does the document with id 2 have? | SELECT count(*) FROM Draft_Copies WHERE document_id = 2; | 1. SELECT[col:​Draft_Copies:​document_id] <br>2. PROJECT[col:​Draft_Copies:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​2:​col:​Draft_Copies:​document_id] <br>4. PROJECT[tbl:​Draft_Copies, #3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[col:​Draft_Copies:​document_id] <br>2. PROJECT[col:​Draft_Copies:​document_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​2:​col:​Draft_Copies:​document_id] <br>4. PROJECT[tbl:​Draft_Copies, #3] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
  | SPIDER_train_2125 | Which document has the most draft copies? List its document id and number of draft copies. | SELECT document_id , count(copy_number) FROM Draft_Copies GROUP BY document_id ORDER BY count(copy_number) DESC LIMIT 1; | 1. SELECT[col:​Draft_Copies:​document_id] <br>2. PROJECT[col:​Draft_Copies:​copy_number, #1] <br>3. GROUP[count, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. COMPARATIVE[#1, #3, comparative:​=:​#4] <br>6. PROJECT[col:​Draft_Copies:​document_id, #5] <br>7. UNION[#6, #4] <br> | 1. SELECT[col:​Draft_Copies:​document_id] <br>2. PROJECT[col:​Draft_Copies:​copy_number, #1] <br>3. GROUP[count, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. COMPARATIVE[#1, #3, comparative:​=:​IE:​col:​Addresses:​address_details] <br>6. PROJECT[col:​Draft_Copies:​document_id, #4] <br>7. PROJECT[col:​Draft_Copies:​copy_number, #4] <br>8. AGGREGATE[count, #7] <br>9. UNION[#5, #8] <br> | - | hard | 
  | SPIDER_train_2126 | Which documents have more than 1 draft copies? List document id and number of draft copies. | SELECT document_id , count(*) FROM Draft_Copies GROUP BY document_id HAVING count(*)  >  1; | 1. SELECT[col:​Draft_Copies:​document_id] <br>2. PROJECT[tbl:​Draft_Copies, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Draft_Copies:​document_id, #4] <br>6. PROJECT[tbl:​Draft_Copies, #4] <br>7. AGGREGATE[count, #6] <br>8. UNION[#5, #7] <br> | 1. SELECT[col:​Draft_Copies:​document_id] <br>2. PROJECT[tbl:​Draft_Copies, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Draft_Copies:​document_id, #4] <br>6. PROJECT[tbl:​Draft_Copies, #4] <br>7. AGGREGATE[count, #6] <br>8. UNION[#5, #7] <br> | + | medium | 
  | SPIDER_train_2127 | List all employees in the circulation history of the document with id 1. List the employee's name. | SELECT Employees.employee_name FROM Employees JOIN Circulation_History ON Circulation_History.employee_id = Employees.employee_id WHERE Circulation_History.document_id = 1; | 1. SELECT[col:​Circulation_History:​document_id] <br>2. PROJECT[col:​Employees:​employee_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​Circulation_History:​document_id] <br>4. PROJECT[tbl:​Circulation_History, #3] <br>5. PROJECT[tbl:​Employees, #4] <br>6. PROJECT[col:​Employees:​employee_name, #5] <br> | 1. SELECT[col:​Circulation_History:​document_id] <br>2. PROJECT[col:​Employees:​employee_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​Circulation_History:​document_id] <br>4. PROJECT[tbl:​Circulation_History, #3] <br>5. PROJECT[tbl:​Employees, #4] <br>6. PROJECT[col:​Employees:​employee_name, #5] <br> | + | medium | 
  | SPIDER_train_2130 | For each document, list the number of employees who have showed up in the circulation history of that document. List the document ids and number of employees. | SELECT document_id ,  count(DISTINCT employee_id) FROM Circulation_History GROUP BY document_id; | 1. SELECT[col:​Circulation_History:​document_id] <br>2. PROJECT[tbl:​Circulation_History, #1] <br>3. PROJECT[col:​Circulation_History:​employee_id, #2] <br>4. GROUP[count, #3, #1] <br>5. PROJECT[col:​Circulation_History:​document_id, #1] <br>6. UNION[#5, #4] <br> | 1. SELECT[col:​Circulation_History:​document_id] <br>2. PROJECT[tbl:​Circulation_History, #1] <br>3. PROJECT[col:​Circulation_History:​employee_id, #2] <br>4. GROUP[count, #3, #1] <br>5. PROJECT[col:​Circulation_History:​document_id, #1] <br>6. UNION[#5, #4] <br> | + | medium | 
 ***
 Exec acc: **0.9333**
