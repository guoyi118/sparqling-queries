 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Person** | name | + |   | 
 | 2 |   | age |   |   | 
 | 3 |   | city |   |   | 
 | 4 |   | gender |   |   | 
 | 5 |   | job |   |   | 
 | 6 | **PersonFriend** | name |   | --> 1 | 
 | 7 |   | friend |   | --> 1 | 
 | 8 |   | year |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_4400 | How many females does this network has? | SELECT count(*) FROM Person WHERE gender  =  'female' | 1. SELECT[tbl:​Person] <br>2. PROJECT[val:​Person:​gender:​female, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Person] <br>2. PROJECT[val:​Person:​gender:​female, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_4404 | How many different cities are they from? | SELECT count(DISTINCT city) FROM Person | 1. SELECT[col:​Person:​city] <br>2. FILTER[#1, where they are from] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​Person:​city] <br>2. COMPARATIVE[#1, #1, None] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_4406 | How many type of jobs do they have? | SELECT count(DISTINCT job) FROM Person | 1. SELECT[col:​Person:​job] <br>2. PROJECT[col:​Person:​job, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Person:​job] <br>2. PROJECT[col:​Person:​job, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_4407 | How many different jobs are listed? | SELECT count(DISTINCT job) FROM Person | 1.*(distinct)* SELECT[col:​Person:​job] <br>2. AGGREGATE[count, #1] <br> | 1.*(distinct)* SELECT[col:​Person:​job] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_4414 | How old is the doctor named Zach? | SELECT age FROM Person WHERE job  =  'doctor' AND name  =  'Zach' | 1. SELECT[val:​Person:​job:​doctor] <br>2. FILTER[#1, comparative:​=:​Zach:​col:​Person:​name] <br>3. PROJECT[col:​Person:​age, #2] <br> | 1. SELECT[val:​Person:​job:​doctor] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Zach:​col:​Person:​name] <br>3. PROJECT[col:​Person:​age, #2] <br> | + | medium | 
  | SPIDER_train_4415 | What is the age of the doctor named Zach? | SELECT age FROM Person WHERE job  =  'doctor' AND name  =  'Zach' | 1. SELECT[val:​Person:​job:​doctor] <br>2. FILTER[#1, comparative:​=:​Zach:​col:​Person:​name] <br>3. PROJECT[col:​Person:​age, #2] <br> | 1. SELECT[val:​Person:​job:​doctor] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Zach:​col:​Person:​name] <br>3. PROJECT[col:​Person:​age, #2] <br> | + | medium | 
  | SPIDER_train_4416 | Who is the person whose age is below 30? | SELECT name FROM Person WHERE age  <  30 | 1. SELECT[col:​Person:​name] <br>2. PROJECT[col:​Person:​age, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​30:​col:​Person:​age] <br> | 1. SELECT[col:​Person:​name] <br>2. PROJECT[col:​Person:​age, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​30:​col:​Person:​age] <br> | + | easy | 
  | SPIDER_train_4418 | How many people whose age is greater 30 and job is engineer? | SELECT count(*) FROM Person WHERE age  >  30 AND job  =  'engineer' | 1. SELECT[tbl:​Person] <br>2. PROJECT[col:​Person:​age, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​30:​col:​Person:​age] <br>4. PROJECT[col:​Person:​job, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​engineer:​col:​Person:​job] <br>6. INTERSECTION[#1, #3, #5] <br>7. AGGREGATE[count, #6] <br> | 1. SELECT[tbl:​Person] <br>2. PROJECT[col:​Person:​age, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​30:​col:​Person:​age] <br>4. PROJECT[col:​Person:​job, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​engineer:​col:​Person:​job] <br>6. INTERSECTION[#1, #3, #5] <br>7. AGGREGATE[count, #6] <br> | + | medium | 
  | SPIDER_train_4419 | HOw many engineers are older than 30? | SELECT count(*) FROM Person WHERE age  >  30 AND job  =  'engineer' | 1. SELECT[val:​Person:​job:​engineer] <br>2. FILTER[#1, comparative:​>:​30:​col:​Person:​age] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[val:​Person:​job:​engineer] <br>2. COMPARATIVE[#1, #1, comparative:​>:​30:​col:​Person:​age] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_4439 | What is the name and age of every male? Order the results by age. | SELECT name FROM Person WHERE gender  =  'male' ORDER BY age | 1. SELECT[val:​Person:​gender:​male] <br>2. PROJECT[col:​Person:​name, #1] <br>3. PROJECT[col:​Person:​age, #1] <br>4. SORT[#2, #3] <br> | 1. SELECT[val:​Person:​gender:​male] <br>2. PROJECT[col:​Person:​name, #1] <br>3. PROJECT[col:​Person:​age, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_4454 | Find the name of persons who are friends with Bob. | SELECT T1.name FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.name WHERE T2.friend  =  'Bob' | 1. SELECT[val:​PersonFriend:​friend:​Bob] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​Person:​name, #2] <br> | 1. SELECT[val:​PersonFriend:​friend:​Bob] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​Person:​name, #2] <br> | + | medium | 
  | SPIDER_train_4455 | What are the names of all of Bob's friends? | SELECT T1.name FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.name WHERE T2.friend  =  'Bob' | 1. SELECT[val:​PersonFriend:​friend:​Bob] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​Person:​name, #2] <br> | 1. SELECT[val:​PersonFriend:​friend:​Bob] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​Person:​name, #2] <br> | + | medium | 
  | SPIDER_train_4456 | Find the names of females who are friends with Zach | SELECT T1.name FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.name WHERE T2.friend  =  'Zach' AND T1.gender  =  'female' | 1. SELECT[val:​Person:​gender:​female] <br>2. FILTER[#1, comparative:​=:​Zach:​col:​PersonFriend:​friend] <br>3. PROJECT[col:​Person:​name, #2] <br> | 1. SELECT[val:​Person:​gender:​female] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Zach:​col:​PersonFriend:​friend] <br>3. PROJECT[col:​Person:​name, #2] <br> | + | medium | 
  | SPIDER_train_4457 | What are the names of all females who are friends with Zach? | SELECT T1.name FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.name WHERE T2.friend  =  'Zach' AND T1.gender  =  'female' | 1. SELECT[val:​Person:​gender:​female] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Zach:​col:​PersonFriend:​friend] <br>4. PROJECT[col:​Person:​name, #3] <br> | 1. SELECT[val:​Person:​gender:​female] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Zach:​col:​PersonFriend:​friend] <br>4. PROJECT[col:​Person:​name, #3] <br> | + | medium | 
  | SPIDER_train_4459 | What are all the friends of Alice who are female? | SELECT T2.friend FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T2.name  =  'Alice' AND T1.gender  =  'female' | 1. SELECT[val:​PersonFriend:​name:​Alice] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. FILTER[#2, comparative:​=:​female:​col:​Person:​gender] <br> | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​female:​col:​Person:​gender] <br> | - | medium | 
  | SPIDER_train_4460 | Find the male friend of Alice whose job is a doctor? | SELECT T2.friend FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T2.name  =  'Alice' AND T1.gender  =  'male' AND T1.job  =  'doctor' | 1. SELECT[val:​PersonFriend:​name:​Alice] <br>2. PROJECT[val:​Person:​gender:​male, #1] <br>3. PROJECT[col:​Person:​job, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​doctor:​col:​Person:​job] <br> | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[val:​Person:​gender:​male, #1] <br>3. PROJECT[col:​Person:​job, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​doctor:​col:​Person:​job] <br> | + | medium | 
  | SPIDER_train_4463 | What are the names of all friends who are from New York? | SELECT T2.name FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T1.city  =  'new york city' | 1. SELECT[col:​PersonFriend:​friend] <br>2. FILTER[#1, comparative:​=:​new york city:​col:​Person:​city] <br>3. PROJECT[col:​PersonFriend:​name, #2] <br> | 1. SELECT[col:​PersonFriend:​friend] <br>2. COMPARATIVE[#1, #1, comparative:​=:​new york city:​col:​Person:​city] <br>3. PROJECT[col:​PersonFriend:​name, #2] <br> | + | medium | 
  | SPIDER_train_4465 | What are the different names of friends who are younger than the average age for a friend? | SELECT DISTINCT T2.name FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T1.age  <  (SELECT avg(age) FROM person) | 1. SELECT[col:​PersonFriend:​friend] <br>2. PROJECT[col:​Person:​age, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5.*(distinct)* PROJECT[col:​PersonFriend:​name, #4] <br> | 1. SELECT[col:​PersonFriend:​friend] <br>2. PROJECT[col:​Person:​age, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5.*(distinct)* PROJECT[col:​PersonFriend:​name, #4] <br> | - | extra | 
  | SPIDER_train_4468 | Who is the friend of Zach with longest year relationship? | SELECT friend FROM PersonFriend WHERE name =  'Zach' AND YEAR  =  (SELECT max(YEAR) FROM PersonFriend WHERE name =  'Zach') | 1. SELECT[val:​PersonFriend:​name:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. GROUP[col:​PersonFriend:​year, #3, #2] <br>5. COMPARATIVE[#2, #4, comparative:​max:​None] <br> | 1. SELECT[val:​PersonFriend:​friend:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. GROUP[sum, #3, #2] <br>5. SUPERLATIVE[comparative:​max:​None, #2, #4] <br> | - | extra | 
  | SPIDER_train_4469 | Which friend of Zach has the longest-lasting friendship? | SELECT friend FROM PersonFriend WHERE name =  'Zach' AND YEAR  =  (SELECT max(YEAR) FROM PersonFriend WHERE name =  'Zach') | 1. SELECT[val:​PersonFriend:​name:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​PersonFriend:​friend, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | 1. SELECT[val:​PersonFriend:​friend:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​PersonFriend:​friend, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | - | extra | 
  | SPIDER_train_4470 | What is the age of the friend of Zach with longest year relationship? | SELECT T1.age FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T2.name =  'Zach' AND T2.year  =  (SELECT max(YEAR) FROM PersonFriend WHERE name =  'Zach') | 1. SELECT[val:​PersonFriend:​name:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​Person:​age, #4] <br> | 1. SELECT[val:​PersonFriend:​friend:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​Person:​age, #4] <br> | - | extra | 
  | SPIDER_train_4471 | What are the ages of all of Zach's friends who are in the longest relationship? | SELECT T1.age FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T2.name =  'Zach' AND T2.year  =  (SELECT max(YEAR) FROM PersonFriend WHERE name =  'Zach') | 1. SELECT[val:​PersonFriend:​name:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[relationships of #REF, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​Person:​age, #4] <br> | 1. SELECT[val:​PersonFriend:​friend:​Zach] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[None, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​Person:​age, #4] <br> | - | extra | 
  | SPIDER_train_4472 | Find the name of persons who are friends with Alice for the shortest years. | SELECT name FROM PersonFriend WHERE friend =  'Alice' AND YEAR  =  (SELECT min(YEAR) FROM PersonFriend WHERE friend =  'Alice') | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. GROUP[count, #3, #2] <br>5. COMPARATIVE[#2, #4, comparative:​min:​None] <br>6. PROJECT[col:​PersonFriend:​name, #5] <br> | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. GROUP[count, #3, #2] <br>5. SUPERLATIVE[comparative:​min:​None, #2, #4] <br>6. PROJECT[col:​PersonFriend:​name, #5] <br> | + | extra | 
  | SPIDER_train_4473 | What are the names of all people who are friends with Alice for the shortest amount of time? | SELECT name FROM PersonFriend WHERE friend =  'Alice' AND YEAR  =  (SELECT min(YEAR) FROM PersonFriend WHERE friend =  'Alice') | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​PersonFriend:​name, #2] <br>4. COMPARATIVE[#2, #3, comparative:​min:​None] <br>5. PROJECT[col:​PersonFriend:​name, #4] <br> | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​PersonFriend:​name, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #2, #3] <br>5. PROJECT[col:​PersonFriend:​name, #4] <br> | - | extra | 
  | SPIDER_train_4474 | Find the name, age, and job title of persons who are friends with Alice for the longest years. | SELECT T1.name ,  T1.age ,  T1.job FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.name WHERE T2.friend =  'Alice' AND T2.year  =  (SELECT max(YEAR) FROM PersonFriend WHERE friend =  'Alice') | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​Person:​name, #4] <br>6. PROJECT[col:​Person:​age, #4] <br>7. PROJECT[col:​Person:​job, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[val:​PersonFriend:​friend:​Alice] <br>2. PROJECT[tbl:​PersonFriend, #1] <br>3. PROJECT[col:​PersonFriend:​year, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​Person:​name, #4] <br>6. PROJECT[col:​Person:​age, #4] <br>7. PROJECT[col:​Person:​job, #4] <br>8. UNION[#5, #6, #7] <br> | + | extra | 
  | SPIDER_train_4479 | What is the name of the person who has the oldest average age for their friends, and what is that average age? | SELECT T2.name ,  avg(T1.age) FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend GROUP BY T2.name ORDER BY avg(T1.age) DESC LIMIT 1 | 1. SELECT[tbl:​PersonFriend] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​Person:​age, #2] <br>4. AGGREGATE[col:​Person:​age, #3] <br>5. COMPARATIVE[#1, #4, comparative:​max:​None] <br>6. PROJECT[col:​PersonFriend:​name, #5] <br>7. PROJECT[oldest of #REF, #4] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​PersonFriend] <br>2. PROJECT[col:​PersonFriend:​friend, #1] <br>3. PROJECT[col:​Person:​age, #2] <br>4. AGGREGATE[sum, #3] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​PersonFriend:​name, #5] <br>7. PROJECT[None, #4] <br>8. UNION[#6, #7] <br> | + | extra | 
 ***
 Exec acc: **0.7308**
