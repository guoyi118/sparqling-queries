 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Customers** | customer_id | + |   | 
 | 2 |   | customer_first_name |   |   | 
 | 3 |   | customer_middle_initial |   |   | 
 | 4 |   | customer_last_name |   |   | 
 | 5 |   | gender |   |   | 
 | 6 |   | email_address |   |   | 
 | 7 |   | login_name |   |   | 
 | 8 |   | login_password |   |   | 
 | 9 |   | phone_number |   |   | 
 | 10 |   | town_city |   |   | 
 | 11 |   | state_county_province |   |   | 
 | 12 |   | country |   |   | 
 | 13 | **Orders** | order_id | + |   | 
 | 14 |   | customer_id |   | --> 1 | 
 | 15 |   | date_order_placed |   |   | 
 | 16 |   | order_details |   |   | 
 | 17 | **Invoices** | invoice_number | + |   | 
 | 18 |   | order_id |   | --> 13 | 
 | 19 |   | invoice_date |   |   | 
 | 20 | **Accounts** | account_id | + |   | 
 | 21 |   | customer_id |   | --> 1 | 
 | 22 |   | date_account_opened |   |   | 
 | 23 |   | account_name |   |   | 
 | 24 |   | other_account_details |   |   | 
 | 25 | **Product_Categories** | production_type_code | + |   | 
 | 26 |   | product_type_description |   |   | 
 | 27 |   | vat_rating |   |   | 
 | 28 | **Products** | product_id | + |   | 
 | 29 |   | parent_product_id |   |   | 
 | 30 |   | production_type_code |   | --> 25 | 
 | 31 |   | unit_price |   |   | 
 | 32 |   | product_name |   |   | 
 | 33 |   | product_color |   |   | 
 | 34 |   | product_size |   |   | 
 | 35 | **Financial_Transactions** | transaction_id |   |   | 
 | 36 |   | account_id |   | --> 20 | 
 | 37 |   | invoice_number |   | --> 17 | 
 | 38 |   | transaction_type |   |   | 
 | 39 |   | transaction_date |   |   | 
 | 40 |   | transaction_amount |   |   | 
 | 41 |   | transaction_comment |   |   | 
 | 42 |   | other_transaction_details |   |   | 
 | 43 | **Order_Items** | order_item_id | + |   | 
 | 44 |   | order_id |   | --> 13 | 
 | 45 |   | product_id |   | --> 28 | 
 | 46 |   | product_quantity |   |   | 
 | 47 |   | other_order_item_details |   |   | 
 | 48 | **Invoice_Line_Items** | order_item_id |   | --> 43 | 
 | 49 |   | invoice_number |   | --> 17 | 
 | 50 |   | product_id |   | --> 28 | 
 | 51 |   | product_title |   |   | 
 | 52 |   | product_quantity |   |   | 
 | 53 |   | product_price |   |   | 
 | 54 |   | derived_product_cost |   |   | 
 | 55 |   | derived_vat_payable |   |   | 
 | 56 |   | derived_total_cost |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_1547 | Show the number of accounts. | SELECT count(*) FROM Accounts | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1548 | How many accounts are there? | SELECT count(*) FROM Accounts | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Accounts] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1549 | How many customers have opened an account? | SELECT count(DISTINCT customer_id) FROM Accounts | 1. SELECT[col:​Accounts:​customer_id] <br>2. FILTER[#1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_1550 | Count the number of customers who have an account. | SELECT count(DISTINCT customer_id) FROM Accounts | 1. SELECT[col:​Accounts:​customer_id] <br>2. FILTER[#1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_1552 | What are the ids, date opened, name, and other details for all accounts? | SELECT account_id ,  date_account_opened ,  account_name ,  other_account_details FROM Accounts | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_id, #1] <br>3. PROJECT[col:​Accounts:​date_account_opened, #1] <br>4. PROJECT[col:​Accounts:​account_name, #1] <br>5. PROJECT[col:​Accounts:​other_account_details, #1] <br>6. UNION[#2, #3, #4, #5] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_id, #1] <br>3. PROJECT[col:​Accounts:​date_account_opened, #1] <br>4. PROJECT[col:​Accounts:​account_name, #1] <br>5. PROJECT[col:​Accounts:​other_account_details, #1] <br>6. UNION[#2, #3, #4, #5] <br> | + | medium | 
  | SPIDER_train_1554 | What are the ids, names, dates of opening, and other details for accounts corresponding to the customer with the first name "Meaghan"? | SELECT T1.account_id ,  T1.date_account_opened ,  T1.account_name ,  T1.other_account_details FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.customer_first_name  =  'Meaghan' | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Meaghan:​col:​Customers:​customer_first_name] <br>4. PROJECT[tbl:​Accounts, #3] <br>5. PROJECT[col:​Accounts:​account_id, #4] <br>6. PROJECT[col:​Accounts:​date_account_opened, #4] <br>7. PROJECT[col:​Accounts:​account_name, #4] <br>8. PROJECT[col:​Accounts:​other_account_details, #4] <br>9. UNION[#5, #6, #7, #8] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Meaghan:​col:​Customers:​customer_first_name] <br>4. PROJECT[tbl:​Accounts, #3] <br>5. PROJECT[col:​Accounts:​account_id, #4] <br>6. PROJECT[col:​Accounts:​date_account_opened, #4] <br>7. PROJECT[col:​Accounts:​account_name, #4] <br>8. PROJECT[col:​Accounts:​other_account_details, #4] <br>9. UNION[#5, #6, #7, #8] <br> | + | medium | 
  | SPIDER_train_1555 | Show the account name and other account detail for all accounts by the customer with first name Meaghan and last name Keeling. | SELECT T1.account_name ,  T1.other_account_details FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.customer_first_name  =  "Meaghan" AND T2.customer_last_name  =  "Keeling" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Meaghan:​col:​Customers:​customer_first_name] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Keeling:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Accounts:​account_name, #6] <br>8. PROJECT[col:​Accounts:​other_account_details, #6] <br>9. UNION[#7, #8] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Meaghan:​col:​Customers:​customer_first_name] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Keeling:​col:​Customers:​customer_last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Accounts:​account_name, #6] <br>8. PROJECT[col:​Accounts:​other_account_details, #6] <br>9. UNION[#7, #8] <br> | + | extra | 
  | SPIDER_train_1557 | Show the first name and last name for the customer with account name 900. | SELECT T2.customer_first_name ,  T2.customer_last_name FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T1.account_name  =  "900" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. PROJECT[col:​Customers:​customer_last_name, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​900:​col:​Accounts:​account_name] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Customers:​customer_last_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. PROJECT[col:​Customers:​customer_last_name, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​900:​col:​Accounts:​account_name] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Customers:​customer_last_name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_1559 | How many customers don't have an account? | SELECT count(*) FROM Customers WHERE customer_id NOT IN (SELECT customer_id FROM Accounts) | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_1562 | What are the distinct first names, last names, and phone numbers for customers with accounts? | SELECT DISTINCT T1.customer_first_name ,  T1.customer_last_name ,  T1.phone_number FROM Customers AS T1 JOIN Accounts AS T2 ON T1.customer_id  =  T2.customer_id | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Accounts] <br>3. PROJECT[col:​Customers:​customer_first_name, #2] <br>4. PROJECT[col:​Customers:​customer_last_name, #2] <br>5. PROJECT[col:​Customers:​phone_number, #2] <br>6. UNION[#3, #4, #5] <br>7. PROJECT[distinct #REF, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. PROJECT[col:​Customers:​customer_first_name, #2] <br>4. PROJECT[col:​Customers:​customer_last_name, #2] <br>5. PROJECT[col:​Customers:​phone_number, #2] <br>6. UNION[#3, #4, #5] <br>7. PROJECT[None, #6] <br> | + | medium | 
  | SPIDER_train_1563 | Show customer ids who don't have an account. | SELECT customer_id FROM Customers EXCEPT SELECT customer_id FROM Accounts | 1. SELECT[col:​Customers:​customer_id] <br>2. FILTER[#1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br> | 1. SELECT[col:​Customers:​customer_id] <br>2. COMPARATIVE[#1, #1, tbl:​Accounts] <br>3. DISCARD[#1, #2] <br> | + | hard | 
  | SPIDER_train_1565 | How many accounts does each customer have? List the number and customer id. | SELECT count(*) ,  customer_id FROM Accounts GROUP BY customer_id | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Accounts:​customer_id, #1] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Accounts:​customer_id, #1] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_1567 | What is the customer id, first and last name with most number of accounts. | SELECT T1.customer_id ,  T2.customer_first_name ,  T2.customer_last_name FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br>5. PROJECT[col:​Accounts:​customer_id, #4] <br>6. PROJECT[col:​Customers:​customer_first_name, #4] <br>7. PROJECT[col:​Customers:​customer_last_name, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Accounts:​customer_id, #4] <br>6. PROJECT[col:​Customers:​customer_first_name, #4] <br>7. PROJECT[col:​Customers:​customer_last_name, #4] <br>8. UNION[#5, #6, #7] <br> | + | extra | 
  | SPIDER_train_1569 | Show id, first name and last name for all customers and the number of accounts. | SELECT T1.customer_id ,  T2.customer_first_name ,  T2.customer_last_name ,  count(*) FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[col:​Accounts:​customer_id, #1] <br>3. PROJECT[col:​Customers:​customer_first_name, #1] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. PROJECT[tbl:​Accounts, #1] <br>6. GROUP[count, #5, #1] <br>7. UNION[#2, #3, #4, #6] <br> | 1. SELECT[col:​Accounts:​customer_id] <br>2. PROJECT[col:​Accounts:​customer_id, #1] <br>3. PROJECT[col:​Customers:​customer_first_name, #1] <br>4. PROJECT[col:​Customers:​customer_last_name, #1] <br>5. PROJECT[tbl:​Accounts, #1] <br>6. GROUP[count, #5, #1] <br>7. UNION[#2, #3, #4, #6] <br> | + | medium | 
  | SPIDER_train_1571 | Show first name and id for all customers with at least 2 accounts. | SELECT T2.customer_first_name ,  T1.customer_id FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Accounts:​customer_id, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Accounts:​customer_id, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_1572 | What are the first names and ids for customers who have two or more accounts? | SELECT T2.customer_first_name ,  T1.customer_id FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Accounts:​customer_id, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Accounts, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​Customers:​customer_first_name, #4] <br>6. PROJECT[col:​Accounts:​customer_id, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_1573 | Show the number of customers. | SELECT count(*) FROM Customers | 1. SELECT[tbl:​Customers] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Customers] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1575 | Show the number of customers for each gender. | SELECT gender ,  count(*) FROM Customers GROUP BY gender | 1. SELECT[col:​Customers:​gender] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customers:​gender] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1576 | How many customers are there of each gender? | SELECT gender ,  count(*) FROM Customers GROUP BY gender | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​gender, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​gender, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1577 | How many transactions do we have? | SELECT count(*) FROM Financial_transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1578 | Count the number of transactions. | SELECT count(*) FROM Financial_transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1581 | How many transaction does account with name 337 have? | SELECT count(*) FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id WHERE T2.account_name  =  "337" | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​337:​col:​Accounts:​account_name] <br>4. PROJECT[tbl:​Financial_Transactions, #3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​337:​col:​Accounts:​account_name] <br>4. PROJECT[tbl:​Financial_Transactions, #3] <br>5. AGGREGATE[count, #4] <br> | + | medium | 
  | SPIDER_train_1582 | Count the number of financial transactions that the account with the name 337 has. | SELECT count(*) FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id WHERE T2.account_name  =  "337" | 1. SELECT[tbl:​Accounts] <br>2. FILTER[#1, comparative:​=:​337:​col:​Accounts:​account_name] <br>3. PROJECT[tbl:​Financial_Transactions, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Accounts] <br>2. COMPARATIVE[#1, #1, comparative:​=:​337:​col:​Accounts:​account_name] <br>3. PROJECT[tbl:​Financial_Transactions, #2] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_1583 | What is the average, minimum, maximum, and total transaction amount? | SELECT avg(transaction_amount) ,  min(transaction_amount) ,  max(transaction_amount) ,   sum(transaction_amount) FROM Financial_transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[max, #2] <br>6. AGGREGATE[sum, #2] <br>7. UNION[#3, #4, #5, #6] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[max, #2] <br>6. AGGREGATE[sum, #2] <br>7. UNION[#3, #4, #5, #6] <br> | + | medium | 
  | SPIDER_train_1584 | Return the average, minimum, maximum, and total transaction amounts. | SELECT avg(transaction_amount) ,  min(transaction_amount) ,  max(transaction_amount) ,   sum(transaction_amount) FROM Financial_transactions | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[max, #2] <br>6. AGGREGATE[sum, #2] <br>7. UNION[#3, #4, #5, #6] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[max, #2] <br>6. AGGREGATE[sum, #2] <br>7. UNION[#3, #4, #5, #6] <br> | + | medium | 
  | SPIDER_train_1586 | What are the ids for transactions that have an amount greater than the average amount of a transaction? | SELECT transaction_id FROM Financial_transactions WHERE transaction_amount  >  (SELECT avg(transaction_amount) FROM Financial_transactions) | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​Financial_Transactions:​transaction_id, #4] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_amount, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​DVDs:​col:​Products:​production_type_code] <br>5. PROJECT[col:​Financial_Transactions:​transaction_id, #4] <br> | - | hard | 
  | SPIDER_train_1588 | What are total transaction amounts for each transaction type? | SELECT transaction_type ,  sum(transaction_amount) FROM Financial_transactions GROUP BY transaction_type | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br>3. PROJECT[col:​Financial_Transactions:​transaction_amount, #2] <br>4. GROUP[sum, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​Financial_Transactions] <br>2. PROJECT[col:​Financial_Transactions:​transaction_type, #1] <br>3. PROJECT[col:​Financial_Transactions:​transaction_amount, #2] <br>4. GROUP[sum, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1589 | Show the account name, id and the number of transactions for each account. | SELECT T2.account_name ,  T1.account_id ,  count(*) FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id GROUP BY T1.account_id | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. PROJECT[col:​Financial_Transactions:​account_id, #1] <br>4. PROJECT[tbl:​Financial_Transactions, #1] <br>5. GROUP[count, #4, #1] <br>6. UNION[#2, #3, #5] <br> | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. PROJECT[col:​Financial_Transactions:​account_id, #1] <br>4. PROJECT[tbl:​Financial_Transactions, #1] <br>5. GROUP[count, #4, #1] <br>6. UNION[#2, #3, #5] <br> | + | medium | 
  | SPIDER_train_1590 | Return the names and ids of each account, as well as the number of transactions. | SELECT T2.account_name ,  T1.account_id ,  count(*) FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id GROUP BY T1.account_id | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. PROJECT[col:​Financial_Transactions:​account_id, #1] <br>4. PROJECT[tbl:​Financial_Transactions, #1] <br>5. GROUP[count, #4, #1] <br>6. UNION[#2, #3, #5] <br> | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[col:​Accounts:​account_name, #1] <br>3. PROJECT[col:​Financial_Transactions:​account_id, #1] <br>4. PROJECT[tbl:​Financial_Transactions, #1] <br>5. GROUP[count, #4, #1] <br>6. UNION[#2, #3, #5] <br> | + | medium | 
  | SPIDER_train_1591 | Show the account id with most number of transactions. | SELECT account_id FROM Financial_transactions GROUP BY account_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br> | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br> | + | hard | 
  | SPIDER_train_1592 | What is the id of the account with the most transactions? | SELECT account_id FROM Financial_transactions GROUP BY account_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br> | 1. SELECT[col:​Financial_Transactions:​account_id] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br> | + | hard | 
  | SPIDER_train_1593 | Show the account id and name with at least 4 transactions. | SELECT T1.account_id ,  T2.account_name FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id GROUP BY T1.account_id HAVING count(*)  >=  4 | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br>6. PROJECT[col:​Accounts:​account_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br>6. PROJECT[col:​Accounts:​account_name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_1594 | What are the ids and names of accounts with 4 or more transactions? | SELECT T1.account_id ,  T2.account_name FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id GROUP BY T1.account_id HAVING count(*)  >=  4 | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br>6. PROJECT[col:​Accounts:​account_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Accounts] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br>5. PROJECT[col:​Financial_Transactions:​account_id, #4] <br>6. PROJECT[col:​Accounts:​account_name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_1595 | Show all product sizes. | SELECT DISTINCT product_size FROM Products | 1. SELECT[col:​Products:​product_size] <br>2. PROJECT[col:​Products:​product_size, #1] <br> | 1. SELECT[col:​Products:​product_size] <br>2. PROJECT[col:​Products:​product_size, #1] <br> | + | easy | 
  | SPIDER_train_1596 | What are the different product sizes? | SELECT DISTINCT product_size FROM Products | 1. SELECT[col:​Products:​product_size] <br>2. PROJECT[col:​Products:​product_size, #1] <br> | 1. SELECT[col:​Products:​product_size] <br>2. PROJECT[col:​Products:​product_size, #1] <br> | + | easy | 
  | SPIDER_train_1597 | Show all product colors. | SELECT DISTINCT product_color FROM Products | 1. SELECT[col:​Products:​product_color] <br>2. PROJECT[col:​Products:​product_color, #1] <br> | 1. SELECT[col:​Products:​product_color] <br>2. PROJECT[col:​Products:​product_color, #1] <br> | + | easy | 
  | SPIDER_train_1598 | What are the different product colors? | SELECT DISTINCT product_color FROM Products | 1. SELECT[tbl:​Products] <br>2.*(distinct)* PROJECT[col:​Products:​product_color, #1] <br> | 1. SELECT[tbl:​Products] <br>2.*(distinct)* PROJECT[col:​Products:​product_color, #1] <br> | + | easy | 
  | SPIDER_train_1599 | Show the invoice number and the number of transactions for each invoice. | SELECT invoice_number ,  count(*) FROM Financial_transactions GROUP BY invoice_number | 1. SELECT[col:​Financial_Transactions:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Financial_Transactions:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1600 | How many transactions correspond to each invoice number? | SELECT invoice_number ,  count(*) FROM Financial_transactions GROUP BY invoice_number | 1. SELECT[col:​Financial_Transactions:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Financial_Transactions:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1601 | What is the invoice number and invoice date for the invoice with most number of transactions? | SELECT T2.invoice_number ,  T2.invoice_date FROM Financial_transactions AS T1 JOIN Invoices AS T2 ON T1.invoice_number  =  T2.invoice_number GROUP BY T1.invoice_number ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Invoices:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[col:​Invoices:​invoice_number, #4] <br>6. PROJECT[col:​Invoices:​invoice_date, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​Invoices:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[sum, #4] <br>6. PROJECT[col:​Invoices:​invoice_date, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_1602 | What is the invoice number and invoice date corresponding to the invoice with the greatest number of transactions? | SELECT T2.invoice_number ,  T2.invoice_date FROM Financial_transactions AS T1 JOIN Invoices AS T2 ON T1.invoice_number  =  T2.invoice_number GROUP BY T1.invoice_number ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Invoices:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[col:​Invoices:​invoice_number, #4] <br>6. PROJECT[col:​Invoices:​invoice_date, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​Invoices:​invoice_number] <br>2. PROJECT[tbl:​Financial_Transactions, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. AGGREGATE[sum, #4] <br>6. PROJECT[col:​Invoices:​invoice_date, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_1603 | How many invoices do we have? | SELECT count(*) FROM Invoices | 1. SELECT[tbl:​Invoices] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Invoices] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1604 | Count the number of invoices. | SELECT count(*) FROM Invoices | 1. SELECT[tbl:​Invoices] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Invoices] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1607 | Show the order ids and the number of invoices for each order. | SELECT order_id ,  count(*) FROM Invoices GROUP BY order_id | 1. SELECT[col:​Invoices:​order_id] <br>2. PROJECT[col:​Invoices:​order_id, #1] <br>3. PROJECT[tbl:​Invoices, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Invoices:​order_id] <br>2. PROJECT[col:​Invoices:​order_id, #1] <br>3. PROJECT[tbl:​Invoices, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1608 | How many invoices correspond to each order id? | SELECT order_id ,  count(*) FROM Invoices GROUP BY order_id | 1. SELECT[col:​Invoices:​order_id] <br>2. PROJECT[tbl:​Invoices, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Invoices:​order_id] <br>2. PROJECT[tbl:​Invoices, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1611 | What is the customer last name, id and phone number with most number of orders? | SELECT T2.customer_last_name ,  T1.customer_id ,  T2.phone_number FROM Orders AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[tbl:​Orders, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_last_name, #4] <br>6. PROJECT[col:​Orders:​customer_id, #4] <br>7. AGGREGATE[col:​Customers:​phone_number, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[tbl:​Orders, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_last_name, #4] <br>6. PROJECT[col:​Orders:​customer_id, #4] <br>7. AGGREGATE[sum, #4] <br>8. UNION[#5, #6, #7] <br> | + | extra | 
  | SPIDER_train_1612 | Return the last name, id and phone number of the customer who has made the greatest number of orders. | SELECT T2.customer_last_name ,  T1.customer_id ,  T2.phone_number FROM Orders AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[tbl:​Orders, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_last_name, #4] <br>6. PROJECT[col:​Orders:​customer_id, #4] <br>7. AGGREGATE[col:​Customers:​phone_number, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[tbl:​Orders, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Customers:​customer_last_name, #4] <br>6. PROJECT[col:​Orders:​customer_id, #4] <br>7. AGGREGATE[sum, #4] <br>8. UNION[#5, #6, #7] <br> | + | extra | 
  | SPIDER_train_1614 | What are the names of products that have never been ordered? | SELECT product_name FROM Products EXCEPT SELECT T1.product_name FROM Products AS T1 JOIN Order_items AS T2 ON T1.product_id  =  T2.product_id | 1. SELECT[tbl:​Products] <br>2. FILTER[#1, tbl:​Order_Items] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Products:​product_name, #3] <br> | 1. SELECT[tbl:​Products] <br>2. COMPARATIVE[#1, #1, tbl:​Order_Items] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Products:​product_name, #3] <br> | + | hard | 
  | SPIDER_train_1615 | Show all product names and the total quantity ordered for each product name. | SELECT T2.product_name ,  sum(T1.product_quantity) FROM Order_items AS T1 JOIN Products AS T2 ON T1.product_id  =  T2.product_id GROUP BY T2.product_name | 1. SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Order_Items:​product_quantity, #1] <br>3. GROUP[sum, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Order_Items:​product_quantity, #1] <br>3. GROUP[sum, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1616 | What are the different product names, and what is the sum of quantity ordered for each product? | SELECT T2.product_name ,  sum(T1.product_quantity) FROM Order_items AS T1 JOIN Products AS T2 ON T1.product_id  =  T2.product_id GROUP BY T2.product_name | 1. SELECT[col:​Products:​product_name] <br>2.*(distinct)* PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[col:​Order_Items:​product_quantity, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Products:​product_name] <br>2.*(distinct)* PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[col:​Order_Items:​product_quantity, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1617 | Show the order ids and the number of items in each order. | SELECT order_id ,  count(*) FROM Order_items GROUP BY order_id | 1. SELECT[col:​Order_Items:​order_id] <br>2. PROJECT[col:​Order_Items:​order_id, #1] <br>3. PROJECT[tbl:​Order_Items, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Order_Items:​order_id] <br>2. PROJECT[col:​Order_Items:​order_id, #1] <br>3. PROJECT[tbl:​Order_Items, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1618 | How many order items correspond to each order id? | SELECT order_id ,  count(*) FROM Order_items GROUP BY order_id | 1. SELECT[col:​Order_Items:​order_id] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Order_Items:​order_id] <br>2. PROJECT[tbl:​Order_Items, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1621 | Show all product names and the number of customers having an order on each product. | SELECT T2.product_name ,  count(*) FROM Order_items AS T1 JOIN Products AS T2 ON T1.product_id  =  T2.product_id JOIN Orders AS T3 ON T3.order_id  =  T1.order_id GROUP BY T2.product_name | 1. SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[tbl:​Orders, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[tbl:​Orders, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | hard | 
  | SPIDER_train_1622 | What are teh names of the different products, as well as the number of customers who have ordered each product. | SELECT T2.product_name ,  count(*) FROM Order_items AS T1 JOIN Products AS T2 ON T1.product_id  =  T2.product_id JOIN Orders AS T3 ON T3.order_id  =  T1.order_id GROUP BY T2.product_name | 1.*(distinct)* SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[tbl:​Orders, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1.*(distinct)* SELECT[col:​Products:​product_name] <br>2. PROJECT[col:​Products:​product_name, #1] <br>3. PROJECT[tbl:​Orders, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | hard | 
  | SPIDER_train_1625 | Show order ids and the total quantity in each order. | SELECT order_id ,  sum(product_quantity) FROM Order_items GROUP BY order_id | 1. SELECT[col:​Order_Items:​order_id] <br>2. PROJECT[col:​Order_Items:​order_id, #1] <br>3. PROJECT[col:​Order_Items:​product_quantity, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Order_Items:​order_id] <br>2. PROJECT[col:​Order_Items:​order_id, #1] <br>3. PROJECT[col:​Order_Items:​product_quantity, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1627 | How many products were not included in any order? | SELECT count(*) FROM products WHERE product_id NOT IN ( SELECT product_id FROM Order_items ) | 1. SELECT[tbl:​Products] <br>2. FILTER[#1, tbl:​Order_Items] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Products] <br>2. COMPARATIVE[#1, #1, tbl:​Order_Items] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_1628 | Count the number of products that were never ordered. | SELECT count(*) FROM products WHERE product_id NOT IN ( SELECT product_id FROM Order_items ) | 1. SELECT[tbl:​Products] <br>2. FILTER[#1, tbl:​Order_Items] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Products] <br>2. COMPARATIVE[#1, #1, tbl:​Order_Items] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
 ***
 Exec acc: **0.9825**
