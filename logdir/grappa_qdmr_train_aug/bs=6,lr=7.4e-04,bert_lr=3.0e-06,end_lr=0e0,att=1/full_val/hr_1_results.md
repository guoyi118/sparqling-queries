 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **regions** | REGION_ID | + | --> 5 | 
 | 2 |   | REGION_NAME |   |   | 
 | 3 | **countries** | COUNTRY_ID | + | --> 35 | 
 | 4 |   | COUNTRY_NAME |   |   | 
 | 5 |   | REGION_ID |   |   | 
 | 6 | **departments** | DEPARTMENT_ID | + | --> 24 | 
 | 7 |   | DEPARTMENT_NAME |   |   | 
 | 8 |   | MANAGER_ID |   |   | 
 | 9 |   | LOCATION_ID |   | --> 30 | 
 | 10 | **jobs** | JOB_ID | + | --> 28 | 
 | 11 |   | JOB_TITLE |   |   | 
 | 12 |   | MIN_SALARY |   |   | 
 | 13 |   | MAX_SALARY |   |   | 
 | 14 | **employees** | EMPLOYEE_ID | + | --> 25 | 
 | 15 |   | FIRST_NAME |   |   | 
 | 16 |   | LAST_NAME |   |   | 
 | 17 |   | EMAIL |   |   | 
 | 18 |   | PHONE_NUMBER |   |   | 
 | 19 |   | HIRE_DATE |   |   | 
 | 20 |   | JOB_ID |   |   | 
 | 21 |   | SALARY |   |   | 
 | 22 |   | COMMISSION_PCT |   |   | 
 | 23 |   | MANAGER_ID |   |   | 
 | 24 |   | DEPARTMENT_ID |   |   | 
 | 25 | **job_history** | EMPLOYEE_ID | + |   | 
 | 26 |   | START_DATE |   |   | 
 | 27 |   | END_DATE |   |   | 
 | 28 |   | JOB_ID |   |   | 
 | 29 |   | DEPARTMENT_ID |   |   | 
 | 30 | **locations** | LOCATION_ID | + |   | 
 | 31 |   | STREET_ADDRESS |   |   | 
 | 32 |   | POSTAL_CODE |   |   | 
 | 33 |   | CITY |   |   | 
 | 34 |   | STATE_PROVINCE |   |   | 
 | 35 |   | COUNTRY_ID |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3409 | Display the first name, and department number for all employees whose last name is "McEwen". | SELECT first_name ,  department_id FROM employees WHERE last_name  =  'McEwen' | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​FIRST_NAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​McEwen:​col:​employees:​LAST_NAME] <br>4. PROJECT[col:​employees:​FIRST_NAME, #3] <br>5. PROJECT[col:​employees:​DEPARTMENT_ID, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​FIRST_NAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​McEwen:​col:​employees:​LAST_NAME] <br>4. PROJECT[col:​employees:​FIRST_NAME, #3] <br>5. PROJECT[col:​employees:​DEPARTMENT_ID, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3410 | What are the first names and department numbers for employees with last name McEwen? | SELECT first_name ,  department_id FROM employees WHERE last_name  =  'McEwen' | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​FIRST_NAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​McEwen:​col:​employees:​LAST_NAME] <br>4. PROJECT[col:​employees:​FIRST_NAME, #3] <br>5. PROJECT[col:​employees:​DEPARTMENT_ID, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​FIRST_NAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​McEwen:​col:​employees:​LAST_NAME] <br>4. PROJECT[col:​employees:​FIRST_NAME, #3] <br>5. PROJECT[col:​employees:​DEPARTMENT_ID, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3416 | On what dates were employees without the letter M in their first names hired? | SELECT hire_date FROM employees WHERE first_name NOT LIKE '%M%' | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​FIRST_NAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%M%:​col:​employees:​FIRST_NAME] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​employees:​HIRE_DATE, #4] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​FIRST_NAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​M:​col:​employees:​FIRST_NAME] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​employees:​HIRE_DATE, #4] <br> | + | medium | 
  | SPIDER_train_3421 | what is the phone number of employees whose salary is in the range of 8000 and 12000? | SELECT phone_number FROM employees WHERE salary BETWEEN 8000 AND 12000 | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​SALARY, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​12000:​col:​employees:​SALARY] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​8000:​col:​employees:​SALARY] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​employees:​PHONE_NUMBER, #5] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​SALARY, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​12000:​col:​employees:​SALARY] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​8000:​col:​employees:​SALARY] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​employees:​PHONE_NUMBER, #5] <br> | + | easy | 
  | SPIDER_train_3422 | Return the phone numbers of employees with salaries between 8000 and 12000. | SELECT phone_number FROM employees WHERE salary BETWEEN 8000 AND 12000 | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​SALARY, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​12000:​col:​employees:​SALARY] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​8000:​col:​employees:​SALARY] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​employees:​PHONE_NUMBER, #5] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​SALARY, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​12000:​col:​employees:​SALARY] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​8000:​col:​employees:​SALARY] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​employees:​PHONE_NUMBER, #5] <br> | + | easy | 
  | SPIDER_train_3429 | Find job id and date of hire for those employees who was hired between November 5th, 2007 and July 5th, 2009. | SELECT job_id ,  hire_date FROM employees WHERE hire_date BETWEEN '2007-11-05' AND '2009-07-05' | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​HIRE_DATE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​2007-11-05:​col:​employees:​HIRE_DATE] <br>4. COMPARATIVE[#3, #2, comparative:​<=:​2009-07-05:​col:​employees:​HIRE_DATE] <br>5. PROJECT[col:​employees:​JOB_ID, #4] <br>6. PROJECT[col:​employees:​HIRE_DATE, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​HIRE_DATE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​5 November 2007, 00:​00:​00:​col:​employees:​HIRE_DATE] <br>4. COMPARATIVE[#3, #2, comparative:​<=:​5 July 2009, 00:​00:​00:​col:​employees:​HIRE_DATE] <br>5. PROJECT[col:​employees:​JOB_ID, #4] <br>6. PROJECT[col:​employees:​HIRE_DATE, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_3430 | What are the job ids and dates of hire for employees hired after November 5th, 2007 and before July 5th, 2009? | SELECT job_id ,  hire_date FROM employees WHERE hire_date BETWEEN '2007-11-05' AND '2009-07-05' | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​HIRE_DATE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​2007-11-05:​col:​employees:​HIRE_DATE] <br>4. COMPARATIVE[#3, #2, comparative:​<=:​2009-07-05:​col:​employees:​HIRE_DATE] <br>5. PROJECT[col:​employees:​JOB_ID, #4] <br>6. PROJECT[col:​employees:​HIRE_DATE, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​HIRE_DATE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​5 November 2007, 00:​00:​00:​col:​employees:​HIRE_DATE] <br>4. COMPARATIVE[#3, #2, comparative:​<=:​5 July 2009, 00:​00:​00:​col:​employees:​HIRE_DATE] <br>5. PROJECT[col:​employees:​JOB_ID, #4] <br>6. PROJECT[col:​employees:​HIRE_DATE, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_3441 | display the job title of jobs which minimum salary is greater than 9000. | SELECT job_title FROM jobs WHERE min_salary  >  9000 | 1. SELECT[tbl:​jobs] <br>2. PROJECT[col:​jobs:​MIN_SALARY, #1] <br>3. GROUP[col:​jobs:​MIN_SALARY, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​9000:​col:​jobs:​MIN_SALARY] <br>5. PROJECT[col:​jobs:​JOB_TITLE, #4] <br> | 1. SELECT[tbl:​jobs] <br>2. PROJECT[col:​jobs:​MIN_SALARY, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​9000:​col:​jobs:​MIN_SALARY] <br>5. PROJECT[col:​jobs:​JOB_TITLE, #4] <br> | + | easy | 
  | SPIDER_train_3442 | Which job titles correspond to jobs with salaries over 9000? | SELECT job_title FROM jobs WHERE min_salary  >  9000 | 1. SELECT[tbl:​jobs] <br>2. PROJECT[col:​jobs:​MIN_SALARY, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​9000:​col:​jobs:​MIN_SALARY] <br>4. PROJECT[col:​jobs:​JOB_TITLE, #3] <br> | 1. SELECT[tbl:​jobs] <br>2. PROJECT[col:​jobs:​MIN_SALARY, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​9000:​col:​jobs:​MIN_SALARY] <br>4. PROJECT[col:​jobs:​JOB_TITLE, #3] <br> | + | easy | 
  | SPIDER_train_3455 | display the country ID and number of cities for each country. | SELECT country_id ,  COUNT(*) FROM locations GROUP BY country_id | 1. SELECT[col:​locations:​COUNTRY_ID] <br>2. PROJECT[col:​locations:​COUNTRY_ID, #1] <br>3. PROJECT[tbl:​locations, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​locations:​COUNTRY_ID] <br>2. PROJECT[col:​locations:​COUNTRY_ID, #1] <br>3. PROJECT[tbl:​locations, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_3456 | Give the country id and corresponding count of cities in each country. | SELECT country_id ,  COUNT(*) FROM locations GROUP BY country_id | 1. SELECT[col:​locations:​COUNTRY_ID] <br>2. PROJECT[col:​locations:​COUNTRY_ID, #1] <br>3. PROJECT[tbl:​locations, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​locations:​COUNTRY_ID] <br>2. PROJECT[col:​locations:​COUNTRY_ID, #1] <br>3. PROJECT[tbl:​locations, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_3460 | What are the employee ids for employees who have held two or more jobs? | SELECT employee_id FROM job_history GROUP BY employee_id HAVING COUNT(*)  >= 2 | 1. SELECT[col:​job_history:​EMPLOYEE_ID] <br>2. PROJECT[tbl:​job_history, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​job_history:​EMPLOYEE_ID, #4] <br> | 1. SELECT[col:​job_history:​EMPLOYEE_ID] <br>2. PROJECT[tbl:​job_history, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​job_history:​EMPLOYEE_ID, #4] <br> | + | easy | 
  | SPIDER_train_3475 | Find the employee id for all employees who earn more than the average salary. | SELECT employee_id FROM employees WHERE salary  >  (SELECT AVG(salary) FROM employees) | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​SALARY, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​employees:​EMPLOYEE_ID, #4] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​SALARY, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​SBAIDA:​col:​employees:​EMAIL] <br>5. PROJECT[col:​employees:​EMPLOYEE_ID, #4] <br> | - | hard | 
  | SPIDER_train_3485 | display the ID for those employees who did two or more jobs in the past. | SELECT employee_id FROM job_history GROUP BY employee_id HAVING COUNT(*)  >= 2 | 1. SELECT[col:​job_history:​EMPLOYEE_ID] <br>2. PROJECT[tbl:​job_history, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​job_history:​EMPLOYEE_ID, #4] <br> | 1. SELECT[col:​job_history:​EMPLOYEE_ID] <br>2. PROJECT[tbl:​job_history, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​job_history:​EMPLOYEE_ID, #4] <br> | + | easy | 
  | SPIDER_train_3507 | display the employee number and job id for all employees whose salary is smaller than any salary of those employees whose job title is MK_MAN. | SELECT employee_id ,  job_id FROM employees WHERE salary  <  ( SELECT min(salary) FROM employees WHERE job_id  =  'MK_MAN' ) | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​JOB_ID, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​MK_MAN:​col:​employees:​JOB_ID] <br>4. PROJECT[col:​employees:​SALARY, #3] <br>5. AGGREGATE[max, #4] <br>6. PROJECT[col:​employees:​SALARY, #1] <br>7. COMPARATIVE[#1, #6, comparative:​<:​#5] <br>8. PROJECT[col:​employees:​EMPLOYEE_ID, #7] <br>9. PROJECT[col:​employees:​JOB_ID, #7] <br>10. UNION[#8, #9] <br> | 1. SELECT[tbl:​employees] <br>2. PROJECT[col:​employees:​JOB_ID, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​MK_MAN:​col:​employees:​JOB_ID] <br>4. PROJECT[col:​employees:​SALARY, #3] <br>5. AGGREGATE[max, #4] <br>6. PROJECT[col:​employees:​SALARY, #1] <br>7. COMPARATIVE[#1, #6, comparative:​<:​MK_MAN:​col:​employees:​JOB_ID] <br>8. PROJECT[col:​employees:​EMPLOYEE_ID, #7] <br>9. PROJECT[col:​employees:​JOB_ID, #7] <br>10. UNION[#8, #9] <br> | - | extra | 
  | SPIDER_train_3508 | What are the employee ids and job ids for employees who make less than the lowest earning employee with title MK_MAN? | SELECT employee_id ,  job_id FROM employees WHERE salary  <  ( SELECT min(salary) FROM employees WHERE job_id  =  'MK_MAN' ) | 1. SELECT[tbl:​employees] <br>2. FILTER[#1, comparative:​=:​MK_MAN:​col:​employees:​JOB_ID] <br>3. PROJECT[col:​employees:​SALARY, #2] <br>4. AGGREGATE[min, #3] <br>5. PROJECT[col:​employees:​SALARY, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​#4] <br>7. PROJECT[col:​employees:​EMPLOYEE_ID, #6] <br>8. PROJECT[col:​employees:​JOB_ID, #6] <br>9. UNION[#7, #8] <br> | 1. SELECT[tbl:​employees] <br>2. COMPARATIVE[#1, #1, comparative:​=:​MK_MAN:​col:​employees:​JOB_ID] <br>3. PROJECT[col:​employees:​SALARY, #2] <br>4. AGGREGATE[min, #3] <br>5. PROJECT[col:​employees:​SALARY, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​MK_MAN:​col:​employees:​JOB_ID] <br>7. PROJECT[col:​employees:​EMPLOYEE_ID, #6] <br>8. PROJECT[col:​employees:​JOB_ID, #6] <br>9. UNION[#7, #8] <br> | - | extra | 
 ***
 Exec acc: **0.8125**
