 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Physician** | EmployeeID | + |   | 
 | 2 |   | Name |   |   | 
 | 3 |   | Position |   |   | 
 | 4 |   | SSN |   |   | 
 | 5 | **Department** | DepartmentID | + |   | 
 | 6 |   | Name |   |   | 
 | 7 |   | Head |   | --> 1 | 
 | 8 | **Affiliated_With** | Physician | + | --> 1 | 
 | 9 |   | Department |   | --> 5 | 
 | 10 |   | PrimaryAffiliation |   |   | 
 | 11 | **Procedures** | Code | + |   | 
 | 12 |   | Name |   |   | 
 | 13 |   | Cost |   |   | 
 | 14 | **Trained_In** | Physician | + | --> 1 | 
 | 15 |   | Treatment |   | --> 11 | 
 | 16 |   | CertificationDate |   |   | 
 | 17 |   | CertificationExpires |   |   | 
 | 18 | **Patient** | SSN | + |   | 
 | 19 |   | Name |   |   | 
 | 20 |   | Address |   |   | 
 | 21 |   | Phone |   |   | 
 | 22 |   | InsuranceID |   |   | 
 | 23 |   | PCP |   | --> 1 | 
 | 24 | **Nurse** | EmployeeID | + |   | 
 | 25 |   | Name |   |   | 
 | 26 |   | Position |   |   | 
 | 27 |   | Registered |   |   | 
 | 28 |   | SSN |   |   | 
 | 29 | **Appointment** | AppointmentID | + |   | 
 | 30 |   | Patient |   | --> 18 | 
 | 31 |   | PrepNurse |   | --> 24 | 
 | 32 |   | Physician |   | --> 1 | 
 | 33 |   | Start |   |   | 
 | 34 |   | End |   |   | 
 | 35 |   | ExaminationRoom |   |   | 
 | 36 | **Medication** | Code | + |   | 
 | 37 |   | Name |   |   | 
 | 38 |   | Brand |   |   | 
 | 39 |   | Description |   |   | 
 | 40 | **Prescribes** | Physician | + | --> 1 | 
 | 41 |   | Patient |   | --> 18 | 
 | 42 |   | Medication |   | --> 36 | 
 | 43 |   | Date |   |   | 
 | 44 |   | Appointment |   | --> 29 | 
 | 45 |   | Dose |   |   | 
 | 46 | **Block** | BlockFloor | + |   | 
 | 47 |   | BlockCode |   |   | 
 | 48 | **Room** | RoomNumber | + |   | 
 | 49 |   | RoomType |   |   | 
 | 50 |   | BlockFloor |   | --> 46 | 
 | 51 |   | BlockCode |   | --> 47 | 
 | 52 |   | Unavailable |   |   | 
 | 53 | **On_Call** | Nurse | + | --> 24 | 
 | 54 |   | BlockFloor |   | --> 46 | 
 | 55 |   | BlockCode |   | --> 47 | 
 | 56 |   | OnCallStart |   |   | 
 | 57 |   | OnCallEnd |   |   | 
 | 58 | **Stay** | StayID | + |   | 
 | 59 |   | Patient |   | --> 18 | 
 | 60 |   | Room |   | --> 48 | 
 | 61 |   | StayStart |   |   | 
 | 62 |   | StayEnd |   |   | 
 | 63 | **Undergoes** | Patient | + | --> 18 | 
 | 64 |   | Procedures |   | --> 11 | 
 | 65 |   | Stay |   | --> 58 | 
 | 66 |   | DateUndergoes |   |   | 
 | 67 |   | Physician |   | --> 1 | 
 | 68 |   | AssistingNurse |   | --> 24 | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3899 | Find the department with the most employees. | SELECT name FROM department GROUP BY departmentID ORDER BY count(departmentID) DESC LIMIT 1; | 1. SELECT[col:​Department:​Name] <br>2. PROJECT[employees of #REF, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br> | 1. SELECT[col:​Department:​Name] <br>2. PROJECT[None, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_3900 | What is the employee id of the head whose department has the least number of employees? | SELECT head FROM department GROUP BY departmentID ORDER BY count(departmentID) LIMIT 1; | 1. SELECT[tbl:​Department] <br>2. PROJECT[employees of #REF, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Department:​Head, #4] <br>6. PROJECT[col:​Department:​Head, #5] <br> | 1. SELECT[tbl:​Department] <br>2. PROJECT[None, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Department:​Head, #4] <br>6. PROJECT[col:​Department:​Head, #5] <br> | + | hard | 
  | SPIDER_train_3901 | Tell me the employee id of the head of the department with the least employees. | SELECT head FROM department GROUP BY departmentID ORDER BY count(departmentID) LIMIT 1; | 1. SELECT[tbl:​Department] <br>2. PROJECT[employees, #1] <br>3. GROUP[count, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. COMPARATIVE[#1, #4, comparative:​min:​None] <br>6. PROJECT[col:​Department:​Head, #5] <br>7. PROJECT[col:​Department:​Head, #6] <br> | 1. SELECT[tbl:​Department] <br>2. PROJECT[None, #1] <br>3. GROUP[count, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. SUPERLATIVE[comparative:​min:​None, #1, #4] <br>6. PROJECT[col:​Department:​Head, #5] <br>7. PROJECT[col:​Department:​Head, #6] <br> | + | hard | 
  | SPIDER_train_3902 | what is the name and position of the head whose department has least number of employees? | SELECT T2.name ,  T2.position FROM department AS T1 JOIN physician AS T2 ON T1.head  =  T2.EmployeeID GROUP BY departmentID ORDER BY count(departmentID) LIMIT 1; | 1. SELECT[tbl:​Department] <br>2. PROJECT[col:​Physician:​EmployeeID, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Department:​Head, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br>7. PROJECT[col:​Physician:​Position, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Department] <br>2. PROJECT[col:​Physician:​EmployeeID, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Department:​Head, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br>7. PROJECT[col:​Physician:​Position, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_3903 | Find the name and position of the head of the department with the least employees. | SELECT T2.name ,  T2.position FROM department AS T1 JOIN physician AS T2 ON T1.head  =  T2.EmployeeID GROUP BY departmentID ORDER BY count(departmentID) LIMIT 1; | 1. SELECT[tbl:​Department] <br>2. PROJECT[col:​Physician:​EmployeeID, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Department:​Head, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br>7. PROJECT[col:​Physician:​Position, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Department] <br>2. PROJECT[col:​Physician:​EmployeeID, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​Department:​Head, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br>7. PROJECT[col:​Physician:​Position, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_3905 | List the names of patients who have made appointments. | SELECT name FROM appointment AS T1 JOIN patient AS T2 ON T1.patient  =  T2.ssn | 1. SELECT[tbl:​Appointment] <br>2. PROJECT[tbl:​Patient, #1] <br>3. PROJECT[col:​Patient:​Name, #2] <br> | 1. SELECT[tbl:​Appointment] <br>2. PROJECT[tbl:​Patient, #1] <br>3. PROJECT[col:​Patient:​Name, #2] <br> | + | easy | 
  | SPIDER_train_3908 | Find the id of the appointment with the most recent start date? | SELECT appointmentid FROM appointment ORDER BY START DESC LIMIT 1 | 1. SELECT[tbl:​Appointment] <br>2. PROJECT[col:​Appointment:​Start, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Appointment:​AppointmentID, #3] <br> | 1. SELECT[tbl:​Appointment] <br>2. PROJECT[col:​Appointment:​Start, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Appointment:​AppointmentID, #3] <br> | + | medium | 
  | SPIDER_train_3917 | Find the name of the patient who made the appointment with the most recent start date. | SELECT T1.name FROM patient AS T1 JOIN appointment AS T2 ON T1.ssn = T2.patient ORDER BY T2.start DESC LIMIT 1 | 1. SELECT[tbl:​Patient] <br>2. PROJECT[tbl:​Appointment, #1] <br>3. PROJECT[col:​Appointment:​Start, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Patient:​Name, #4] <br> | 1. SELECT[tbl:​Patient] <br>2. PROJECT[tbl:​Appointment, #1] <br>3. PROJECT[col:​Appointment:​Start, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Patient:​Name, #4] <br> | + | hard | 
  | SPIDER_train_3918 | How many patients stay in room 112? | SELECT count(patient) FROM stay WHERE room  =  112 | 1. SELECT[col:​Stay:​Patient] <br>2. PROJECT[tbl:​Stay, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​112:​col:​Stay:​Room] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​Stay:​Patient] <br>2. PROJECT[tbl:​Stay, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​112:​col:​Stay:​Room] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3919 | Count the number of patients who stayed in room 112. | SELECT count(patient) FROM stay WHERE room  =  112 | 1. SELECT[col:​Stay:​Patient] <br>2. PROJECT[tbl:​Stay, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​112:​col:​Stay:​Room] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​Stay:​Patient] <br>2. PROJECT[tbl:​Stay, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​112:​col:​Stay:​Room] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3920 | How many patients' prescriptions are made by physician John Dorian? | SELECT count(T1.SSN) FROM patient AS T1 JOIN prescribes AS T2 ON T1.SSN  =  T2.patient JOIN physician AS T3 ON T2.physician  =  T3.employeeid WHERE T3.name = "John Dorian" | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Patient:​SSN, #1] <br>3. FILTER[#2, comparative:​=:​John Dorian:​col:​Physician:​Name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Patient:​SSN, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​John Dorian:​col:​Physician:​Name] <br>4. AGGREGATE[count, #3] <br> | + | hard | 
  | SPIDER_train_3921 | Find the number of patients' prescriptions physician John Dorian made. | SELECT count(T1.SSN) FROM patient AS T1 JOIN prescribes AS T2 ON T1.SSN  =  T2.patient JOIN physician AS T3 ON T2.physician  =  T3.employeeid WHERE T3.name = "John Dorian" | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Patient:​SSN, #1] <br>3. FILTER[#2, comparative:​=:​John Dorian:​col:​Physician:​Name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Patient:​SSN, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​John Dorian:​col:​Physician:​Name] <br>4. AGGREGATE[count, #3] <br> | + | hard | 
  | SPIDER_train_3922 | Find the name of medication used on the patient who stays in room 111? | SELECT T4.name FROM stay AS T1 JOIN patient AS T2 ON T1.Patient  =  T2.SSN JOIN Prescribes AS T3 ON T3.Patient  =  T2.SSN JOIN Medication AS T4 ON T3.Medication  =  T4.Code WHERE room  =  111 | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Stay:​Room, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​111:​col:​Stay:​Room] <br>4. PROJECT[tbl:​Medication, #3] <br>5. PROJECT[col:​Medication:​Name, #4] <br> | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Stay:​Room, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​111:​col:​Stay:​Room] <br>4. PROJECT[tbl:​Medication, #3] <br>5. PROJECT[col:​Medication:​Name, #4] <br> | + | extra | 
  | SPIDER_train_3923 | What is the name of the medication used for the patient staying in room 111? | SELECT T4.name FROM stay AS T1 JOIN patient AS T2 ON T1.Patient  =  T2.SSN JOIN Prescribes AS T3 ON T3.Patient  =  T2.SSN JOIN Medication AS T4 ON T3.Medication  =  T4.Code WHERE room  =  111 | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Stay:​Room, #1] <br>3. AGGREGATE[col:​Stay:​Room, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​111:​col:​Stay:​Room] <br>5. PROJECT[tbl:​Medication, #4] <br>6. PROJECT[col:​Medication:​Name, #5] <br> | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Stay:​Room, #1] <br>3. AGGREGATE[sum, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​111:​col:​Stay:​Room] <br>5. PROJECT[tbl:​Medication, #4] <br>6. PROJECT[col:​Medication:​Name, #5] <br> | + | extra | 
  | SPIDER_train_3924 | Find the patient who most recently stayed in room 111. | SELECT patient FROM stay WHERE room  =  111 ORDER BY staystart DESC LIMIT 1 | 1. SELECT[val:​Stay:​Room:​111] <br>2. PROJECT[col:​Stay:​Patient, #1] <br>3. PROJECT[col:​Stay:​StayStart, #2] <br>4. COMPARATIVE[#2, #3, comparative:​max:​None] <br> | 1. SELECT[val:​Stay:​Room:​111] <br>2. PROJECT[col:​Stay:​Patient, #1] <br>3. PROJECT[col:​Stay:​StayStart, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | + | hard | 
  | SPIDER_train_3925 | What is the id of the patient who stayed in room 111 most recently? | SELECT patient FROM stay WHERE room  =  111 ORDER BY staystart DESC LIMIT 1 | 1. SELECT[col:​Stay:​Patient] <br>2. FILTER[#1, comparative:​=:​111:​col:​Stay:​Room] <br>3. FILTER[#2, comparative:​max:​None] <br>4. PROJECT[col:​Stay:​Patient, #3] <br> | 1. SELECT[col:​Stay:​Patient] <br>2. COMPARATIVE[#1, #1, comparative:​=:​111:​col:​Stay:​Room] <br>3. SUPERLATIVE[comparative:​max:​None, #2, #2] <br>4. PROJECT[col:​Stay:​Patient, #3] <br> | - | hard | 
  | SPIDER_train_3926 | What is the name of the nurse has the most appointments? | SELECT T1.name FROM nurse AS T1 JOIN appointment AS T2 ON T1.employeeid  =  T2.prepnurse GROUP BY T1.employeeid ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​Nurse] <br>2. PROJECT[tbl:​Appointment, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Nurse:​Name, #4] <br> | 1. SELECT[tbl:​Nurse] <br>2. PROJECT[tbl:​Appointment, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Nurse:​Name, #4] <br> | + | extra | 
  | SPIDER_train_3927 | Find the name of the nurse who has the largest number of appointments. | SELECT T1.name FROM nurse AS T1 JOIN appointment AS T2 ON T1.employeeid  =  T2.prepnurse GROUP BY T1.employeeid ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​Nurse] <br>2. PROJECT[tbl:​Appointment, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Nurse:​Name, #4] <br> | 1. SELECT[tbl:​Nurse] <br>2. PROJECT[tbl:​Appointment, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Nurse:​Name, #4] <br> | + | extra | 
  | SPIDER_train_3928 | How many patients do each physician take care of? List their names and number of patients they take care of. | SELECT T1.name ,  count(*) FROM physician AS T1 JOIN patient AS T2 ON T1.employeeid  =  T2.PCP GROUP BY T1.employeeid | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Patient, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Physician:​Name, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Patient, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​Physician:​Name, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_3929 | Return the name of each physician and the number of patients he or she treats. | SELECT T1.name ,  count(*) FROM physician AS T1 JOIN patient AS T2 ON T1.employeeid  =  T2.PCP GROUP BY T1.employeeid | 1. SELECT[tbl:​Physician] <br>2. PROJECT[col:​Physician:​Name, #1] <br>3. PROJECT[tbl:​Patient, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[col:​Physician:​Name, #1] <br>3. PROJECT[tbl:​Patient, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_3930 | Find the name of physicians who are in charge of more than one patient. | SELECT T1.name FROM physician AS T1 JOIN patient AS T2 ON T1.employeeid  =  T2.PCP GROUP BY T1.employeeid HAVING count(*)  >  1 | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Patient, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Physician:​Name, #4] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Patient, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Physician:​Name, #4] <br> | + | medium | 
  | SPIDER_train_3931 | Which physicians are in charge of more than one patient? Give me their names. | SELECT T1.name FROM physician AS T1 JOIN patient AS T2 ON T1.employeeid  =  T2.PCP GROUP BY T1.employeeid HAVING count(*)  >  1 | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Patient, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Physician:​Name, #4] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Patient, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​Physician:​Name, #4] <br> | + | medium | 
  | SPIDER_train_3936 | What are the unique block codes that have available rooms? | SELECT DISTINCT blockcode FROM room WHERE unavailable  =  0 | 1. SELECT[col:​Room:​BlockCode] <br>2. FILTER[#1, tbl:​Room] <br> | 1. SELECT[col:​Room:​BlockCode] <br>2. COMPARATIVE[#1, #1, tbl:​Room] <br> | + | easy | 
  | SPIDER_train_3937 | Tell me the distinct block codes where some rooms are available. | SELECT DISTINCT blockcode FROM room WHERE unavailable  =  0 | 1. SELECT[tbl:​Room] <br>2. FILTER[#1, col:​Room:​Unavailable] <br>3. PROJECT[col:​Room:​BlockCode, #2] <br>4.*(distinct)* PROJECT[distinct #REF, #3] <br> | 1. SELECT[tbl:​Room] <br>2. COMPARATIVE[#1, #1, col:​Room:​Unavailable] <br>3. PROJECT[col:​Room:​BlockCode, #2] <br>4.*(distinct)* PROJECT[None, #3] <br> | + | easy | 
  | SPIDER_train_3938 | How many different types of rooms are there? | SELECT count(DISTINCT roomtype) FROM room | 1. SELECT[tbl:​Room] <br>2. PROJECT[col:​Room:​RoomType, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Room] <br>2. PROJECT[col:​Room:​RoomType, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3939 | Find the number of distinct room types available. | SELECT count(DISTINCT roomtype) FROM room | 1. SELECT[tbl:​Room] <br>2.*(distinct)* PROJECT[col:​Room:​RoomType, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Room] <br>2.*(distinct)* PROJECT[col:​Room:​RoomType, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3940 | What is the names of the physicians who prescribe medication Thesisin? | SELECT DISTINCT T1.name FROM physician AS T1 JOIN prescribes AS T2 ON T1.employeeid = T2.physician JOIN medication AS T3 ON T3.code = T2.medication WHERE T3.name  =  "Thesisin" | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Medication, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Thesisin:​col:​Medication:​Name] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Medication, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Thesisin:​col:​Medication:​Name] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | + | hard | 
  | SPIDER_train_3941 | List the names of all the physicians who prescribe Thesisin as medication. | SELECT DISTINCT T1.name FROM physician AS T1 JOIN prescribes AS T2 ON T1.employeeid = T2.physician JOIN medication AS T3 ON T3.code = T2.medication WHERE T3.name  =  "Thesisin" | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Medication, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Thesisin:​col:​Medication:​Name] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Medication, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Thesisin:​col:​Medication:​Name] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | + | hard | 
  | SPIDER_train_3942 | Find the name and position of physicians who prescribe some medication whose brand is X? | SELECT DISTINCT T1.name ,  T1.position FROM physician AS T1 JOIN prescribes AS T2 ON T1.employeeid = T2.physician JOIN medication AS T3 ON T3.code = T2.medication WHERE T3.Brand  =  "X" | 1. SELECT[tbl:​Medication] <br>2. PROJECT[col:​Medication:​Brand, #1] <br>3. FILTER[#1, comparative:​=:​X:​col:​Medication:​Brand] <br>4. PROJECT[tbl:​Physician, #3] <br>5. PROJECT[col:​Physician:​Name, #4] <br>6. PROJECT[col:​Physician:​Position, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Medication] <br>2. PROJECT[col:​Medication:​Brand, #1] <br>3. COMPARATIVE[#1, #1, comparative:​=:​X:​col:​Medication:​Brand] <br>4. PROJECT[tbl:​Physician, #3] <br>5. PROJECT[col:​Physician:​Name, #4] <br>6. PROJECT[col:​Physician:​Position, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_3943 | Which physicians prescribe a medication of brand X? Tell me the name and position of those physicians. | SELECT DISTINCT T1.name ,  T1.position FROM physician AS T1 JOIN prescribes AS T2 ON T1.employeeid = T2.physician JOIN medication AS T3 ON T3.code = T2.medication WHERE T3.Brand  =  "X" | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Medication, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​X:​col:​Medication:​Brand] <br>4. PROJECT[col:​Physician:​Name, #3] <br>5. PROJECT[col:​Physician:​Position, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Medication, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​X:​col:​Medication:​Brand] <br>4. PROJECT[col:​Physician:​Name, #3] <br>5. PROJECT[col:​Physician:​Position, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_3946 | Find the name of physicians whose position title contains the word 'senior'. | SELECT name FROM physician WHERE POSITION LIKE '%senior%' | 1. SELECT[tbl:​Physician] <br>2. PROJECT[col:​Physician:​Position, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%senior%:​col:​Physician:​Position] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[col:​Physician:​Position, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​senior:​col:​Physician:​Position] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | + | medium | 
  | SPIDER_train_3947 | What are the names of the physicians who have 'senior' in their titles. | SELECT name FROM physician WHERE POSITION LIKE '%senior%' | 1. SELECT[tbl:​Physician] <br>2. PROJECT[titles of #REF, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%senior%:​col:​Physician:​Position] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[None, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​senior:​col:​Physician:​Position] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | + | medium | 
  | SPIDER_train_3949 | Which patient is undergoing the most recent treatment? | SELECT patient FROM undergoes ORDER BY dateundergoes LIMIT 1 | 1. SELECT[col:​Undergoes:​Patient] <br>2. PROJECT[treatments of #REF, #1] <br>3. PROJECT[when was #REF, #2] <br>4. COMPARATIVE[#1, #3, comparative:​min:​None] <br> | 1. SELECT[col:​Undergoes:​Patient] <br>2. PROJECT[None, #1] <br>3. PROJECT[None, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | - | medium | 
  | SPIDER_train_3950 | Find the names of all patients who have an undergoing treatment and are staying in room 111. | SELECT DISTINCT T2.name FROM undergoes AS T1 JOIN patient AS T2 ON T1.patient = T2.SSN JOIN stay AS T3 ON T1.Stay  =  T3.StayID WHERE T3.room  =  111 | 1. SELECT[tbl:​Patient] <br>2. FILTER[#1, tbl:​Undergoes] <br>3. PROJECT[col:​Stay:​Room, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​111:​col:​Stay:​Room] <br>5. PROJECT[col:​Patient:​Name, #4] <br> | 1. SELECT[tbl:​Patient] <br>2. COMPARATIVE[#1, #1, tbl:​Undergoes] <br>3. PROJECT[col:​Stay:​Room, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​111:​col:​Stay:​Room] <br>5. PROJECT[col:​Patient:​Name, #4] <br> | + | hard | 
  | SPIDER_train_3951 | What are the names of patients who are staying in room 111 and have an undergoing treatment? | SELECT DISTINCT T2.name FROM undergoes AS T1 JOIN patient AS T2 ON T1.patient = T2.SSN JOIN stay AS T3 ON T1.Stay  =  T3.StayID WHERE T3.room  =  111 | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Stay:​Room, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​111:​col:​Stay:​Room] <br>4. FILTER[#3, tbl:​Undergoes] <br>5. PROJECT[col:​Patient:​Name, #4] <br> | 1. SELECT[tbl:​Patient] <br>2. PROJECT[col:​Stay:​Room, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​111:​col:​Stay:​Room] <br>4. COMPARATIVE[#3, #3, tbl:​Undergoes] <br>5. PROJECT[col:​Patient:​Name, #4] <br> | + | hard | 
  | SPIDER_train_3952 | List the names of all distinct nurses ordered by alphabetical order? | SELECT DISTINCT name FROM nurse ORDER BY name | 1. SELECT[tbl:​Nurse] <br>2. PROJECT[distinct #REF, #1] <br>3. PROJECT[col:​Nurse:​Name, #2] <br>4. SORT[#3, #3, sortdir:​ascending] <br> | 1. SELECT[tbl:​Nurse] <br>2. PROJECT[None, #1] <br>3. PROJECT[col:​Nurse:​Name, #2] <br>4. SORT[#3, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3953 | What is the alphabetically ordered list of all the distinct names of nurses? | SELECT DISTINCT name FROM nurse ORDER BY name | 1. SELECT[tbl:​Nurse] <br>2.*(distinct)* PROJECT[col:​Nurse:​Name, #1] <br>3. FILTER[#2, alphabetically ordered] <br> | 1. SELECT[tbl:​Nurse] <br>2.*(distinct)* PROJECT[col:​Nurse:​Name, #1] <br>3. COMPARATIVE[#2, #2, None] <br> | + | easy | 
  | SPIDER_train_3954 | Find the names of nurses who are nursing an undergoing treatment. | SELECT DISTINCT T2.name FROM undergoes AS T1 JOIN nurse AS T2 ON T1.AssistingNurse  =  T2.EmployeeID | 1. SELECT[tbl:​Nurse] <br>2. FILTER[#1, tbl:​Nurse] <br>3. PROJECT[col:​Nurse:​Name, #2] <br> | 1. SELECT[tbl:​Nurse] <br>2. COMPARATIVE[#1, #1, tbl:​Nurse] <br>3. PROJECT[col:​Nurse:​Name, #2] <br> | + | easy | 
  | SPIDER_train_3956 | List the names of all distinct medications, ordered in an alphabetical order. | SELECT DISTINCT name FROM medication ORDER BY name | 1. SELECT[tbl:​Medication] <br>2. PROJECT[distinct #REF, #1] <br>3. PROJECT[col:​Medication:​Name, #2] <br>4. SORT[#3, #3, sortdir:​ascending] <br> | 1. SELECT[tbl:​Medication] <br>2. PROJECT[None, #1] <br>3. PROJECT[col:​Medication:​Name, #2] <br>4. SORT[#3, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3964 | What nurses are on call with block floor 1 and block code 1? Tell me their names. | SELECT nurse FROM on_call WHERE blockfloor  =  1 AND blockcode  =  1 | 1. SELECT[col:​On_Call:​Nurse] <br>2. FILTER[#1, tbl:​On_Call] <br>3. PROJECT[col:​On_Call:​BlockFloor, #2] <br>4. PROJECT[col:​On_Call:​BlockFloor, #2] <br>5. COMPARATIVE[#2, #3, comparative:​=:​1:​col:​On_Call:​BlockFloor] <br>6. COMPARATIVE[#2, #4, comparative:​=:​1:​col:​On_Call:​BlockCode] <br>7. INTERSECTION[#2, #5, #6] <br>8. PROJECT[col:​On_Call:​Nurse, #7] <br> | 1. SELECT[col:​On_Call:​Nurse] <br>2. COMPARATIVE[#1, #1, tbl:​On_Call] <br>3. PROJECT[col:​On_Call:​BlockFloor, #2] <br>4. PROJECT[col:​On_Call:​BlockFloor, #2] <br>5. COMPARATIVE[#2, #3, comparative:​=:​1:​col:​On_Call:​BlockFloor] <br>6. COMPARATIVE[#2, #4, comparative:​=:​1:​col:​On_Call:​BlockFloor] <br>7. INTERSECTION[#2, #5, #6] <br>8. PROJECT[col:​On_Call:​Nurse, #7] <br> | - | medium | 
  | SPIDER_train_3965 | Find the ids of the nurses who are on call in block floor 1 and block code 1. | SELECT nurse FROM on_call WHERE blockfloor  =  1 AND blockcode  =  1 | 1. SELECT[col:​On_Call:​Nurse] <br>2. FILTER[#1, tbl:​On_Call] <br>3. PROJECT[col:​On_Call:​BlockFloor, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​1:​col:​On_Call:​BlockFloor] <br>5. PROJECT[col:​On_Call:​BlockFloor, #2] <br>6. COMPARATIVE[#2, #5, comparative:​=:​1:​col:​On_Call:​BlockCode] <br>7. PROJECT[col:​On_Call:​Nurse, #1] <br>8. INTERSECTION[#7, #4, #6] <br> | 1. SELECT[col:​On_Call:​Nurse] <br>2. COMPARATIVE[#1, #1, tbl:​On_Call] <br>3. PROJECT[col:​On_Call:​BlockFloor, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​1:​col:​On_Call:​BlockFloor] <br>5. PROJECT[col:​On_Call:​BlockFloor, #2] <br>6. COMPARATIVE[#2, #5, comparative:​=:​1:​col:​On_Call:​BlockFloor] <br>7. PROJECT[col:​On_Call:​Nurse, #1] <br>8. INTERSECTION[#7, #4, #6] <br> | - | medium | 
  | SPIDER_train_3966 | What are the highest cost, lowest cost and average cost of procedures? | SELECT MAX(cost) ,  MIN(cost) ,  AVG(cost) FROM procedures | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_3967 | Tell me the highest, lowest, and average cost of procedures. | SELECT MAX(cost) ,  MIN(cost) ,  AVG(cost) FROM procedures | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_3969 | Sort the list of names and costs of all procedures in the descending order of cost. | SELECT name ,  cost FROM procedures ORDER BY cost DESC | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Name, #1] <br>3. PROJECT[col:​Procedures:​Cost, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Name, #1] <br>3. PROJECT[col:​Procedures:​Cost, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_3975 | Which physician was trained in the procedure that costs the most. | SELECT T1.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment ORDER BY T3.cost DESC LIMIT 1 | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | + | extra | 
  | SPIDER_train_3976 | What is the average cost of procedures that physician John Wen was trained in? | SELECT avg(T3.cost) FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[val:​Physician:​Name:​John Wen] <br>2. PROJECT[tbl:​Trained_In, #1] <br>3. PROJECT[col:​Procedures:​Cost, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[val:​Physician:​Name:​John Wen] <br>2. PROJECT[tbl:​Trained_In, #1] <br>3. PROJECT[col:​Procedures:​Cost, #2] <br>4. AGGREGATE[avg, #3] <br> | + | hard | 
  | SPIDER_train_3977 | Compute the mean price of procedures physician John Wen was trained in. | SELECT avg(T3.cost) FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[val:​Physician:​Name:​John Wen] <br>2. PROJECT[tbl:​Trained_In, #1] <br>3. PROJECT[col:​Procedures:​Cost, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[val:​Physician:​Name:​John Wen] <br>2. PROJECT[tbl:​Trained_In, #1] <br>3. PROJECT[col:​Procedures:​Cost, #2] <br>4. AGGREGATE[avg, #3] <br> | + | hard | 
  | SPIDER_train_3978 | Find the names of procedures which physician John Wen was trained in. | SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[tbl:​Procedures] <br>2. FILTER[#1, comparative:​=:​John Wen:​col:​Physician:​Name] <br>3. PROJECT[col:​Procedures:​Name, #2] <br> | 1. SELECT[tbl:​Procedures] <br>2. COMPARATIVE[#1, #1, comparative:​=:​John Wen:​col:​Physician:​Name] <br>3. PROJECT[col:​Procedures:​Name, #2] <br> | + | hard | 
  | SPIDER_train_3979 | What are the names of procedures physician John Wen was trained in? | SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[val:​Physician:​Name:​John Wen] <br>2. PROJECT[tbl:​Trained_In, #1] <br>3. PROJECT[col:​Procedures:​Name, #2] <br> | 1. SELECT[val:​Physician:​Name:​John Wen] <br>2. PROJECT[tbl:​Trained_In, #1] <br>3. PROJECT[col:​Procedures:​Name, #2] <br> | + | hard | 
  | SPIDER_train_3980 | Find all procedures which cost more than 1000 or which physician John Wen was trained in. | SELECT name FROM procedures WHERE cost  >  1000 UNION SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[col:​Procedures:​Name] <br>2. FILTER[#1, comparative:​>:​1000:​col:​Procedures:​Cost] <br>3. FILTER[#1, comparative:​=:​John Wen:​col:​Physician:​Name] <br>4. UNION[#2, #3] <br> | 1. SELECT[col:​Procedures:​Name] <br>2. COMPARATIVE[#1, #1, comparative:​>:​1000:​col:​Procedures:​Cost] <br>3. COMPARATIVE[#1, #1, comparative:​=:​John Wen:​col:​Physician:​Name] <br>4. UNION[#2, #3] <br> | + | hard | 
  | SPIDER_train_3981 | What are the procedures that cost more than 1000 or are specialized in by physician John Wen? | SELECT name FROM procedures WHERE cost  >  1000 UNION SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[col:​Procedures:​Name] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​1000:​col:​Procedures:​Cost] <br>4. PROJECT[tbl:​Physician, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​John Wen:​col:​Physician:​Name] <br>6. UNION[#3, #5] <br> | 1. SELECT[col:​Procedures:​Name] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​1000:​col:​Procedures:​Cost] <br>4. PROJECT[tbl:​Physician, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​John Wen:​col:​Physician:​Name] <br>6. UNION[#3, #5] <br> | + | hard | 
  | SPIDER_train_3983 | Among the procedures that cost more than 1000, which were not specialized in by physician John Wen? | SELECT name FROM procedures WHERE cost  >  1000 EXCEPT SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[col:​Procedures:​Name] <br>2. FILTER[#1, comparative:​>:​1000:​col:​Procedures:​Cost] <br>3. FILTER[#2, comparative:​=:​John Wen:​col:​Physician:​Name] <br>4. DISCARD[#2, #3] <br> | 1. SELECT[col:​Procedures:​Name] <br>2. COMPARATIVE[#1, #1, comparative:​>:​1000:​col:​Procedures:​Cost] <br>3. COMPARATIVE[#2, #2, comparative:​=:​John Wen:​col:​Physician:​Name] <br>4. DISCARD[#2, #3] <br> | + | hard | 
  | SPIDER_train_3984 | Find the names of all procedures such that the cost is less than 5000 and physician John Wen was trained in. | SELECT name FROM procedures WHERE cost  <  5000 INTERSECT SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​5000:​col:​Procedures:​Cost] <br>4. PROJECT[tbl:​Physician, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​John Wen:​col:​Physician:​Name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Procedures:​Name, #6] <br> | 1. SELECT[tbl:​Procedures] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​5000:​col:​Procedures:​Cost] <br>4. PROJECT[tbl:​Physician, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​John Wen:​col:​Physician:​Name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Procedures:​Name, #6] <br> | + | hard | 
  | SPIDER_train_3985 | What procedures cost less than 5000 and have John Wen as a trained physician? | SELECT name FROM procedures WHERE cost  <  5000 INTERSECT SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  "John Wen" | 1. SELECT[col:​Procedures:​Name] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​5000:​col:​Procedures:​Cost] <br>4. PROJECT[tbl:​Physician, #1] <br>5. COMPARATIVE[#1, #2, comparative:​=:​John Wen:​col:​Physician:​Name] <br>6. INTERSECTION[#1, #3, #5] <br> | 1. SELECT[col:​Procedures:​Name] <br>2. PROJECT[col:​Procedures:​Cost, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​5000:​col:​Procedures:​Cost] <br>4. PROJECT[tbl:​Physician, #1] <br>5. COMPARATIVE[#1, #2, comparative:​=:​John Wen:​col:​Physician:​Name] <br>6. INTERSECTION[#1, #3, #5] <br> | + | hard | 
  | SPIDER_train_3986 | Find the name of physicians who are affiliated with both Surgery and Psychiatry departments. | SELECT T1.name FROM physician AS T1 JOIN affiliated_with AS T2 ON T1.EmployeeID  =  T2.physician JOIN department AS T3 ON T2.department  =  T3.DepartmentID WHERE T3.name  =  'Surgery' INTERSECT SELECT T1.name FROM physician AS T1 JOIN affiliated_with AS T2 ON T1.EmployeeID  =  T2.physician JOIN department AS T3 ON T2.department  =  T3.DepartmentID WHERE T3.name  =  'Psychiatry' | 1. SELECT[tbl:​Physician] <br>2. FILTER[#1, comparative:​=:​Surgery:​col:​Department:​Name] <br>3. FILTER[#2, comparative:​=:​Psychiatry:​col:​Department:​Name] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | 1. SELECT[tbl:​Physician] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Surgery:​col:​Department:​Name] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Psychiatry:​col:​Department:​Name] <br>4. PROJECT[col:​Physician:​Name, #3] <br> | + | extra | 
  | SPIDER_train_3987 | Which physicians are affiliated with both Surgery and Psychiatry departments? Tell me their names. | SELECT T1.name FROM physician AS T1 JOIN affiliated_with AS T2 ON T1.EmployeeID  =  T2.physician JOIN department AS T3 ON T2.department  =  T3.DepartmentID WHERE T3.name  =  'Surgery' INTERSECT SELECT T1.name FROM physician AS T1 JOIN affiliated_with AS T2 ON T1.EmployeeID  =  T2.physician JOIN department AS T3 ON T2.department  =  T3.DepartmentID WHERE T3.name  =  'Psychiatry' | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Department, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Surgery:​col:​Department:​Name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Psychiatry:​col:​Department:​Name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br> | 1. SELECT[tbl:​Physician] <br>2. PROJECT[tbl:​Department, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Surgery:​col:​Department:​Name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Psychiatry:​col:​Department:​Name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br> | + | extra | 
  | SPIDER_train_3988 | Find the name of physicians who are affiliated with Surgery or Psychiatry department. | SELECT T1.name FROM physician AS T1 JOIN affiliated_with AS T2 ON T1.EmployeeID  =  T2.physician JOIN department AS T3 ON T2.department  =  T3.DepartmentID WHERE T3.name  =  'Surgery' OR T3.name  =  'Psychiatry' | 1. SELECT[col:​Affiliated_With:​Physician] <br>2. PROJECT[tbl:​Department, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Surgery:​col:​Department:​Name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Psychiatry:​col:​Department:​Name] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br> | 1. SELECT[col:​Affiliated_With:​Physician] <br>2. PROJECT[tbl:​Department, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Surgery:​col:​Department:​Name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Psychiatry:​col:​Department:​Name] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​Physician:​Name, #5] <br> | + | extra | 
  | SPIDER_train_3991 | What are the names of patients who are not taking the medication of Procrastin-X. | SELECT name FROM patient EXCEPT SELECT T1.name FROM patient AS T1 JOIN Prescribes AS T2 ON T2.Patient  =  T1.SSN JOIN Medication AS T3 ON T2.Medication  =  T3.Code WHERE T3.name  =  'Procrastin-X' | 1. SELECT[tbl:​Patient] <br>2. FILTER[#1, comparative:​=:​Procrastin-X:​col:​Medication:​Name] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Patient:​Name, #3] <br> | 1. SELECT[tbl:​Patient] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Procrastin-X:​col:​Medication:​Name] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Patient:​Name, #3] <br> | + | hard | 
  | SPIDER_train_3993 | How many patients are not using Procrastin-X as medication? | SELECT count(*) FROM patient WHERE SSN NOT IN ( SELECT T1.patient FROM Prescribes AS T1 JOIN Medication AS T2 ON T1.Medication  =  T2.Code WHERE T2.name  =  'Procrastin-X' ) | 1. SELECT[tbl:​Patient] <br>2. FILTER[#1, comparative:​=:​Procrastin-X:​col:​Medication:​Name] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Patient] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Procrastin-X:​col:​Medication:​Name] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_3994 | How many appointments are there? | SELECT count(*) FROM appointment | 1. SELECT[tbl:​Appointment] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Appointment] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3995 | Count how many appointments have been made in total. | SELECT count(*) FROM appointment | 1. SELECT[tbl:​Appointment] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Appointment] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3996 | Find the names of nurses who are on call. | SELECT DISTINCT T1.name FROM nurse AS T1 JOIN on_call AS T2 ON T1.EmployeeID  =  T2.nurse | 1. SELECT[tbl:​Nurse] <br>2. FILTER[#1, tbl:​On_Call] <br>3. PROJECT[col:​Nurse:​Name, #2] <br> | 1. SELECT[tbl:​Nurse] <br>2. COMPARATIVE[#1, #1, tbl:​On_Call] <br>3. PROJECT[col:​Nurse:​Name, #2] <br> | + | easy | 
  | SPIDER_train_3997 | What are the distinct names of nurses on call? | SELECT DISTINCT T1.name FROM nurse AS T1 JOIN on_call AS T2 ON T1.EmployeeID  =  T2.nurse | 1. SELECT[tbl:​Nurse] <br>2. FILTER[#1, tbl:​On_Call] <br>3.*(distinct)* PROJECT[col:​Nurse:​Name, #2] <br> | 1. SELECT[tbl:​Nurse] <br>2. COMPARATIVE[#1, #1, tbl:​On_Call] <br>3.*(distinct)* PROJECT[col:​Nurse:​Name, #2] <br> | + | easy | 
 ***
 Exec acc: **0.9365**
