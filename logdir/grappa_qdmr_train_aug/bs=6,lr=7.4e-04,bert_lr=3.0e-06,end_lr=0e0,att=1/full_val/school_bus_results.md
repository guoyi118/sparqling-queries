 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **driver** | Driver_ID | + |   | 
 | 2 |   | Name |   |   | 
 | 3 |   | Party |   |   | 
 | 4 |   | Home_city |   |   | 
 | 5 |   | Age |   |   | 
 | 6 | **school** | School_ID | + |   | 
 | 7 |   | Grade |   |   | 
 | 8 |   | School |   |   | 
 | 9 |   | Location |   |   | 
 | 10 |   | Type |   |   | 
 | 11 | **school_bus** | School_ID | + | --> 6 | 
 | 12 |   | Driver_ID |   | --> 1 | 
 | 13 |   | Years_Working |   |   | 
 | 14 |   | If_full_time |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6348 | How many drivers are there? | SELECT count(*) FROM driver | 1. SELECT[tbl:​driver] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​driver] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6349 | Show the name, home city, and age for all drivers. | SELECT name ,  home_city ,  age FROM driver | 1. SELECT[tbl:​driver] <br>2. PROJECT[col:​driver:​Name, #1] <br>3. PROJECT[col:​driver:​Home_city, #1] <br>4. PROJECT[col:​driver:​Age, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​driver] <br>2. PROJECT[col:​driver:​Name, #1] <br>3. PROJECT[col:​driver:​Home_city, #1] <br>4. PROJECT[col:​driver:​Age, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6350 | Show the party and the number of drivers in each party. | SELECT party ,  count(*) FROM driver GROUP BY party | 1. SELECT[col:​driver:​Party] <br>2. PROJECT[tbl:​driver, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​driver:​Party] <br>2. PROJECT[tbl:​driver, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6352 | Show all different home cities. | SELECT DISTINCT home_city FROM driver | 1. SELECT[col:​driver:​Home_city] <br>2.*(distinct)* PROJECT[different #REF, #1] <br> | 1. SELECT[col:​driver:​Home_city] <br>2.*(distinct)* PROJECT[None, #1] <br> | + | easy | 
  | SPIDER_train_6353 | Show the home city with the most number of drivers. | SELECT home_city FROM driver GROUP BY home_city ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​driver:​Home_city] <br>2. PROJECT[tbl:​driver, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​driver:​Home_city] <br>2. PROJECT[tbl:​driver, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6355 | Show home city where at least two drivers older than 40 are from. | SELECT home_city FROM driver WHERE age  >  40 GROUP BY home_city HAVING count(*)  >=  2 | 1. SELECT[col:​driver:​Home_city] <br>2. PROJECT[tbl:​driver, #1] <br>3. FILTER[#2, comparative:​>:​40:​col:​driver:​Age] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>=:​2] <br> | 1. SELECT[col:​driver:​Home_city] <br>2. PROJECT[tbl:​driver, #1] <br>3. COMPARATIVE[#2, #2, comparative:​>:​40:​col:​driver:​Age] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>=:​2] <br> | + | medium | 
  | SPIDER_train_6356 | Show all home cities except for those having a driver older than 40. | SELECT home_city FROM driver EXCEPT SELECT home_city FROM driver WHERE age  >  40 | 1. SELECT[col:​driver:​Home_city] <br>2. PROJECT[tbl:​driver, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​40:​col:​driver:​Age] <br>4. DISCARD[#1, #3] <br> | 1. SELECT[col:​driver:​Home_city] <br>2. PROJECT[tbl:​driver, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​40:​col:​driver:​Age] <br>4. DISCARD[#1, #3] <br> | + | hard | 
  | SPIDER_train_6358 | Show the types of schools that have two schools. | SELECT TYPE FROM school GROUP BY TYPE HAVING count(*)  =  2 | 1. SELECT[tbl:​school] <br>2. PROJECT[col:​school:​Type, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​2] <br> | 1. SELECT[tbl:​school] <br>2. PROJECT[col:​school:​Type, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​2] <br> | + | easy | 
  | SPIDER_train_6359 | Show the school name and driver name for all school buses. | SELECT T2.school ,  T3.name FROM school_bus AS T1 JOIN school AS T2 ON T1.school_id  =  T2.school_id JOIN driver AS T3 ON T1.driver_id  =  T3.driver_id | 1. SELECT[tbl:​school_bus] <br>2. PROJECT[tbl:​school_bus, #1] <br>3. PROJECT[col:​school:​School, #2] <br>4. PROJECT[tbl:​driver, #1] <br>5. PROJECT[col:​driver:​Name, #4] <br>6. UNION[#3, #5] <br> | 1. SELECT[tbl:​school_bus] <br>2. PROJECT[tbl:​school_bus, #1] <br>3. PROJECT[col:​school:​School, #2] <br>4. PROJECT[tbl:​driver, #1] <br>5. PROJECT[col:​driver:​Name, #4] <br>6. UNION[#3, #5] <br> | + | medium | 
  | SPIDER_train_6360 | What is the maximum, minimum and average years spent working on a school bus? | SELECT max(years_working) ,  min(years_working) ,  avg(years_working) FROM school_bus | 1. SELECT[tbl:​school_bus] <br>2. PROJECT[col:​school_bus:​Years_Working, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[tbl:​school_bus] <br>2. PROJECT[col:​school_bus:​Years_Working, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_6362 | Show the type of school and the number of buses for each type. | SELECT T2.type ,  count(*) FROM school_bus AS T1 JOIN school AS T2 ON T1.school_id  =  T2.school_id GROUP BY T2.type | 1. SELECT[tbl:​school_bus] <br>2. PROJECT[col:​school:​Type, #1] <br>3. PROJECT[tbl:​school_bus, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​school_bus] <br>2. PROJECT[col:​school:​Type, #1] <br>3. PROJECT[tbl:​school_bus, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_6364 | List names for drivers from Hartford city and younger than 40. | SELECT name FROM driver WHERE home_city  =  'Hartford' AND age  <  40 | 1. SELECT[tbl:​driver] <br>2. PROJECT[col:​driver:​Home_city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Hartford:​col:​driver:​Home_city] <br>4. FILTER[#3, comparative:​<:​40:​col:​driver:​Age] <br>5. PROJECT[col:​driver:​Name, #4] <br> | 1. SELECT[tbl:​driver] <br>2. PROJECT[col:​driver:​Home_city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Hartford:​col:​driver:​Home_city] <br>4. COMPARATIVE[#3, #3, comparative:​<:​40:​col:​driver:​Age] <br>5. PROJECT[col:​driver:​Name, #4] <br> | + | medium | 
  | SPIDER_train_6365 | find the name of driver who is driving the school bus with the longest working history. | SELECT t1.name FROM driver AS t1 JOIN school_bus AS t2 ON t1.driver_id  =  t2.driver_id ORDER BY years_working DESC LIMIT 1 | 1. SELECT[col:​school_bus:​Driver_ID] <br>2. FILTER[#1, comparative:​max:​None] <br>3. PROJECT[col:​school_bus:​Years_Working, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​driver:​Name, #4] <br> | 1. SELECT[col:​school_bus:​Driver_ID] <br>2. SUPERLATIVE[comparative:​max:​None, #1, #1] <br>3. PROJECT[col:​school_bus:​Years_Working, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​driver:​Name, #4] <br> | - | hard | 
 ***
 Exec acc: **0.9231**
