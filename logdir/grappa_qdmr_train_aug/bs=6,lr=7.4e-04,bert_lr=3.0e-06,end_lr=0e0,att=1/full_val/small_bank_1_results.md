 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **ACCOUNTS** | custid | + |   | 
 | 2 |   | name |   |   | 
 | 3 | **SAVINGS** | custid | + | --> 1 | 
 | 4 |   | balance |   |   | 
 | 5 | **CHECKING** | custid | + | --> 1 | 
 | 6 |   | balance |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_1777 | What is the total balance of savings accounts not belonging to someone with the name Brown? | SELECT sum(T2.balance) FROM accounts AS T1 JOIN savings AS T2 ON T1.custid  =  T2.custid WHERE T1.name != 'Brown' | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​ACCOUNTS:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Brown:​col:​ACCOUNTS:​name] <br>4. PROJECT[col:​SAVINGS:​balance, #3] <br>5. AGGREGATE[sum, #4] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​ACCOUNTS:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Brown:​col:​ACCOUNTS:​name] <br>4. PROJECT[col:​SAVINGS:​balance, #3] <br>5. AGGREGATE[sum, #4] <br> | + | medium | 
  | SPIDER_train_1778 | How many accounts are there in total? | SELECT count(*) FROM accounts | 1. SELECT[tbl:​ACCOUNTS] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1781 | Find the total balance across checking accounts. | SELECT sum(balance) FROM checking | 1. SELECT[tbl:​CHECKING] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. AGGREGATE[sum, #2] <br> | 1. SELECT[tbl:​CHECKING] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. AGGREGATE[sum, #2] <br> | + | easy | 
  | SPIDER_train_1783 | What is the average balance in checking accounts? | SELECT avg(balance) FROM checking | 1. SELECT[tbl:​CHECKING] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[tbl:​CHECKING] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_1784 | How many accounts have a savings balance above the average savings balance? | SELECT count(*) FROM savings WHERE balance  >  (SELECT avg(balance) FROM savings) | 1. SELECT[tbl:​SAVINGS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​SAVINGS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​Wang:​col:​ACCOUNTS:​name] <br>5. AGGREGATE[count, #4] <br> | + | hard | 
  | SPIDER_train_1786 | Find the name and id of accounts whose checking balance is below the maximum checking balance. | SELECT T1.custid ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  <  (SELECT max(balance) FROM checking) | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. SELECT[col:​CHECKING:​balance] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5. PROJECT[col:​ACCOUNTS:​custid, #4] <br>6. PROJECT[col:​ACCOUNTS:​name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. SELECT[col:​CHECKING:​balance] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​ACCOUNTS:​custid, #4] <br>6. PROJECT[col:​ACCOUNTS:​name, #4] <br>7. UNION[#5, #6] <br> | - | extra | 
  | SPIDER_train_1787 | What are the customer id and name corresponding to accounts with a checking balance less than the largest checking balance? | SELECT T1.custid ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  <  (SELECT max(balance) FROM checking) | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​ACCOUNTS:​custid, #4] <br>6. PROJECT[col:​ACCOUNTS:​name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​ACCOUNTS:​custid, #4] <br>6. PROJECT[col:​ACCOUNTS:​name, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_1788 | What is the checking balance of the account whose owner’s name contains the substring ‘ee’? | SELECT T2.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T1.name LIKE '%ee%' | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[owners of #REF, #1] <br>3. PROJECT[col:​ACCOUNTS:​name, #2] <br>4. COMPARATIVE[#1, #3, comparative:​like:​%ee%:​col:​ACCOUNTS:​name] <br>5. PROJECT[col:​CHECKING:​balance, #4] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[None, #1] <br>3. PROJECT[col:​ACCOUNTS:​name, #2] <br>4. COMPARATIVE[#1, #3, comparative:​like:​ee:​col:​ACCOUNTS:​name] <br>5. PROJECT[col:​CHECKING:​balance, #4] <br> | + | hard | 
  | SPIDER_train_1790 | Find the checking balance and saving balance in the Brown’s account. | SELECT T2.balance ,  T3.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid WHERE T1.name  =  'Brown' | 1. SELECT[tbl:​ACCOUNTS] <br>2. FILTER[#1, comparative:​=:​Brown:​col:​ACCOUNTS:​name] <br>3. PROJECT[col:​CHECKING:​balance, #2] <br>4. PROJECT[col:​SAVINGS:​balance, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Brown:​col:​ACCOUNTS:​name] <br>3. PROJECT[col:​CHECKING:​balance, #2] <br>4. PROJECT[col:​SAVINGS:​balance, #2] <br>5. UNION[#3, #4] <br> | + | hard | 
  | SPIDER_train_1791 | What are the checking and savings balances in accounts belonging to Brown? | SELECT T2.balance ,  T3.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid WHERE T1.name  =  'Brown' | 1. SELECT[tbl:​ACCOUNTS] <br>2. FILTER[#1, comparative:​=:​Brown:​col:​ACCOUNTS:​name] <br>3. PROJECT[col:​CHECKING:​balance, #2] <br>4. PROJECT[col:​SAVINGS:​balance, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Brown:​col:​ACCOUNTS:​name] <br>3. PROJECT[col:​CHECKING:​balance, #2] <br>4. PROJECT[col:​SAVINGS:​balance, #2] <br>5. UNION[#3, #4] <br> | + | hard | 
  | SPIDER_train_1792 | Find the names of accounts whose checking balance is above the average checking balance, but savings balance is below the average savings balance. | SELECT T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  >  (SELECT avg(balance) FROM checking) INTERSECT SELECT T1.name FROM accounts AS T1 JOIN savings AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  <  (SELECT avg(balance) FROM savings) | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​CHECKING:​balance, #1] <br>6. AGGREGATE[avg, #5] <br>7. COMPARATIVE[#1, #5, comparative:​>:​#6] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​ACCOUNTS:​name, #8] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​CHECKING:​balance, #1] <br>6. AGGREGATE[avg, #5] <br>7. COMPARATIVE[#1, #1, comparative:​=:​#6] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​ACCOUNTS:​name, #8] <br> | - | extra | 
  | SPIDER_train_1793 | What are the names of accounts with checking balances greater than the average checking balance and savings balances below the average savings balance? | SELECT T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  >  (SELECT avg(balance) FROM checking) INTERSECT SELECT T1.name FROM accounts AS T1 JOIN savings AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  <  (SELECT avg(balance) FROM savings) | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[tbl:​SAVINGS, #1] <br>4. AGGREGATE[avg, #2] <br>5. AGGREGATE[avg, #3] <br>6. COMPARATIVE[#1, #2, comparative:​>:​#4] <br>7. COMPARATIVE[#1, #3, comparative:​<:​#5] <br>8. INTERSECTION[#1, #6, #7] <br>9. PROJECT[col:​ACCOUNTS:​name, #8] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[tbl:​SAVINGS, #1] <br>4. AGGREGATE[avg, #2] <br>5. AGGREGATE[avg, #3] <br>6. COMPARATIVE[#1, #1, comparative:​=:​#4] <br>7. COMPARATIVE[#1, #1, comparative:​=:​#6] <br>8. INTERSECTION[#1, #2, #7] <br>9. PROJECT[col:​ACCOUNTS:​name, #8] <br> | - | extra | 
  | SPIDER_train_1794 | Find the checking balance of the accounts whose savings balance is higher than the average savings balance. | SELECT T2.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T1.name IN (SELECT T1.name FROM accounts AS T1 JOIN savings AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  >  (SELECT avg(balance) FROM savings)) | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​CHECKING:​balance, #4] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​CHECKING:​balance, #4] <br> | - | extra | 
  | SPIDER_train_1802 | Find the name and checking balance of the account with the lowest savings balance. | SELECT T1.name ,  T2.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid ORDER BY T3.balance LIMIT 1 | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​ACCOUNTS:​name, #3] <br>5. PROJECT[col:​CHECKING:​balance, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​ACCOUNTS:​name, #3] <br>5. PROJECT[col:​CHECKING:​balance, #3] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_1803 | What are the names and balances of checking accounts belonging to the customer with the lowest savings balance? | SELECT T1.name ,  T2.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid ORDER BY T3.balance LIMIT 1 | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​ACCOUNTS:​name, #3] <br>5. PROJECT[tbl:​ACCOUNTS, #3] <br>6. PROJECT[col:​CHECKING:​balance, #5] <br>7. UNION[#4, #6] <br> | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​ACCOUNTS:​name, #3] <br>5. PROJECT[tbl:​ACCOUNTS, #3] <br>6. PROJECT[col:​CHECKING:​balance, #5] <br>7. UNION[#4, #6] <br> | + | extra | 
  | SPIDER_train_1810 | Find the saving balance of the account with the highest checking balance. | SELECT T3.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid ORDER BY T2.balance DESC LIMIT 1 | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​SAVINGS:​balance, #3] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​SAVINGS:​balance, #3] <br> | + | extra | 
  | SPIDER_train_1811 | What is the savings balance of the account belonging to the customer with the highest checking balance? | SELECT T3.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid ORDER BY T2.balance DESC LIMIT 1 | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[tbl:​ACCOUNTS, #3] <br>5. PROJECT[col:​SAVINGS:​balance, #4] <br> | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[tbl:​ACCOUNTS, #3] <br>5. PROJECT[col:​SAVINGS:​balance, #4] <br> | + | extra | 
  | SPIDER_train_1814 | Find the name and checking balance of the account with the lowest saving balance. | SELECT T2.balance ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid ORDER BY T3.balance LIMIT 1 | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​CHECKING:​balance, #3] <br>5. PROJECT[col:​ACCOUNTS:​name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​CHECKING:​balance, #3] <br>5. PROJECT[col:​ACCOUNTS:​name, #3] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_1815 | What is the name and checking balance of the account which has the lowest savings balance? | SELECT T2.balance ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid ORDER BY T3.balance LIMIT 1 | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​CHECKING:​balance, #3] <br>5. PROJECT[col:​ACCOUNTS:​name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​SAVINGS:​balance, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​CHECKING:​balance, #3] <br>5. PROJECT[col:​ACCOUNTS:​name, #3] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_1816 | Find the name, checking balance and saving balance of all accounts in the bank. | SELECT T2.balance ,  T3.balance ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. PROJECT[col:​ACCOUNTS:​name, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. PROJECT[col:​ACCOUNTS:​name, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1817 | What are the names, checking balances, and savings balances for all customers? | SELECT T2.balance ,  T3.balance ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. PROJECT[col:​ACCOUNTS:​name, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. PROJECT[col:​ACCOUNTS:​name, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1820 | Find the name of accounts whose checking balance is higher than corresponding saving balance. | SELECT T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid WHERE T2.balance  >  T3.balance | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​ACCOUNTS:​name, #4] <br> | 1. SELECT[tbl:​ACCOUNTS] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​ACCOUNTS:​name, #4] <br> | - | hard | 
  | SPIDER_train_1821 | What are the names of customers with a higher checking balance than savings balance? | SELECT T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid WHERE T2.balance  >  T3.balance | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​ACCOUNTS:​name, #4] <br> | 1. SELECT[col:​ACCOUNTS:​custid] <br>2. PROJECT[col:​CHECKING:​balance, #1] <br>3. PROJECT[col:​SAVINGS:​balance, #1] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​ACCOUNTS:​name, #4] <br> | - | hard | 
 ***
 Exec acc: **0.7391**
