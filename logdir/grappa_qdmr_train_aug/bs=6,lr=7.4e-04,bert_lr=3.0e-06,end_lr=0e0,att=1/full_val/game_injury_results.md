 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **stadium** | id | + |   | 
 | 2 |   | name |   |   | 
 | 3 |   | Home_Games |   |   | 
 | 4 |   | Average_Attendance |   |   | 
 | 5 |   | Total_Attendance |   |   | 
 | 6 |   | Capacity_Percentage |   |   | 
 | 7 | **game** | stadium_id |   | --> 1 | 
 | 8 |   | id | + |   | 
 | 9 |   | Season |   |   | 
 | 10 |   | Date |   |   | 
 | 11 |   | Home_team |   |   | 
 | 12 |   | Away_team |   |   | 
 | 13 |   | Score |   |   | 
 | 14 |   | Competition |   |   | 
 | 15 | **injury_accident** | game_id |   | --> 8 | 
 | 16 |   | id | + |   | 
 | 17 |   | Player |   |   | 
 | 18 |   | Injury |   |   | 
 | 19 |   | Number_of_matches |   |   | 
 | 20 |   | Source |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_1274 | How many games are held after season 2007? | SELECT count(*) FROM game WHERE season  >  2007 | 1. SELECT[tbl:​game] <br>2. PROJECT[col:​game:​Season, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2007:​col:​game:​Season] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​game] <br>2. PROJECT[col:​game:​Season, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2007:​col:​game:​Season] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_1275 | List the dates of games by the home team name in descending order. | SELECT Date FROM game ORDER BY home_team DESC | 1. SELECT[tbl:​game] <br>2. PROJECT[col:​game:​Date, #1] <br>3. PROJECT[tbl:​game, #1] <br>4. PROJECT[col:​game:​Home_team, #3] <br>5. SORT[#2, #4, sortdir:​descending] <br> | 1. SELECT[tbl:​game] <br>2. PROJECT[col:​game:​Date, #1] <br>3. PROJECT[tbl:​game, #1] <br>4. PROJECT[col:​game:​Home_team, #3] <br>5. SORT[#2, #4, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_1276 | List the season, home team, away team of all the games. | SELECT season ,  home_team ,  away_team FROM game | 1. SELECT[tbl:​game] <br>2. PROJECT[col:​game:​Season, #1] <br>3. PROJECT[col:​game:​Home_team, #1] <br>4. PROJECT[col:​game:​Away_team, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​game] <br>2. PROJECT[col:​game:​Season, #1] <br>3. PROJECT[col:​game:​Home_team, #1] <br>4. PROJECT[col:​game:​Away_team, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1277 | What are the maximum, minimum and average home games each stadium held? | SELECT max(home_games) ,  min(home_games) ,  avg(home_games) FROM stadium | 1. SELECT[tbl:​stadium] <br>2. PROJECT[col:​stadium:​Home_Games, #1] <br>3. GROUP[col:​stadium:​Home_Games, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. AGGREGATE[avg, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​stadium] <br>2. PROJECT[col:​stadium:​Home_Games, #1] <br>3. GROUP[sum, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. AGGREGATE[avg, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_1278 | What is the average attendance of stadiums with capacity percentage higher than 100%? | SELECT average_attendance FROM stadium WHERE capacity_percentage  >  100 | 1. SELECT[tbl:​stadium] <br>2. PROJECT[col:​stadium:​Capacity_Percentage, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100:​col:​stadium:​Capacity_Percentage] <br>4. PROJECT[col:​stadium:​Average_Attendance, #3] <br>5. AGGREGATE[col:​stadium:​Average_Attendance, #4] <br> | 1. SELECT[tbl:​stadium] <br>2. PROJECT[col:​stadium:​Capacity_Percentage, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100:​col:​stadium:​Capacity_Percentage] <br>4. PROJECT[col:​stadium:​Average_Attendance, #3] <br>5. AGGREGATE[sum, #4] <br> | + | easy | 
  | SPIDER_train_1279 | What are the player name, number of matches, and information source for players who do not suffer from injury of 'Knee problem'? | SELECT player ,  number_of_matches ,  SOURCE FROM injury_accident WHERE injury != 'Knee problem' | 1. SELECT[col:​injury_accident:​Player] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Knee problem:​col:​injury_accident:​Injury] <br>4. PROJECT[col:​injury_accident:​Player, #3] <br>5. PROJECT[col:​injury_accident:​Number_of_matches, #3] <br>6. GROUP[col:​injury_accident:​Number_of_matches, #5, #3] <br>7. PROJECT[col:​injury_accident:​Source, #3] <br>8. UNION[#4, #6, #7] <br> | 1. SELECT[col:​injury_accident:​Player] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Knee problem:​col:​injury_accident:​Injury] <br>4. PROJECT[col:​injury_accident:​Player, #3] <br>5. PROJECT[col:​injury_accident:​Number_of_matches, #3] <br>6. GROUP[sum, #5, #3] <br>7. PROJECT[col:​injury_accident:​Source, #3] <br>8. UNION[#4, #6, #7] <br> | + | medium | 
  | SPIDER_train_1280 | What is the season of the game which causes the player 'Walter Samuel' to get injured? | SELECT T1.season FROM game AS T1 JOIN injury_accident AS T2 ON T1.id  =  T2.game_id WHERE T2.player  =  'Walter Samuel' | 1. SELECT[val:​injury_accident:​Player:​Walter Samuel] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. PROJECT[col:​game:​Season, #2] <br> | 1. SELECT[val:​injury_accident:​Player:​Walter Samuel] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. PROJECT[col:​game:​Season, #2] <br> | + | medium | 
  | SPIDER_train_1281 | What are the ids, scores, and dates of the games which caused at least two injury accidents? | SELECT T1.id ,  T1.score ,  T1.date FROM game AS T1 JOIN injury_accident AS T2 ON T2.game_id  =  T1.id GROUP BY T1.id HAVING count(*)  >=  2 | 1. SELECT[tbl:​game] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​game:​id, #4] <br>6. PROJECT[col:​game:​Score, #4] <br>7. PROJECT[col:​game:​Date, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[tbl:​game] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​game:​id, #4] <br>6. PROJECT[col:​game:​Score, #4] <br>7. PROJECT[col:​game:​Date, #4] <br>8. UNION[#5, #6, #7] <br> | + | medium | 
  | SPIDER_train_1282 | What are the id and name of the stadium where the most injury accidents happened? | SELECT T1.id ,  T1.name FROM stadium AS T1 JOIN game AS T2 ON T1.id  =  T2.stadium_id JOIN injury_accident AS T3 ON T2.id  =  T3.game_id GROUP BY T1.id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​stadium:​id, #4] <br>6. PROJECT[col:​stadium:​name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​stadium:​id, #4] <br>6. PROJECT[col:​stadium:​name, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_1283 | Find the id and name of the stadium where the largest number of injury accidents occurred. | SELECT T1.id ,  T1.name FROM stadium AS T1 JOIN game AS T2 ON T1.id  =  T2.stadium_id JOIN injury_accident AS T3 ON T2.id  =  T3.game_id GROUP BY T1.id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​stadium:​id, #4] <br>6. PROJECT[col:​stadium:​name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​stadium:​id, #4] <br>6. PROJECT[col:​stadium:​name, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_1285 | How many different kinds of information sources are there for injury accidents? | SELECT count(DISTINCT SOURCE) FROM injury_accident | 1. SELECT[tbl:​injury_accident] <br>2. PROJECT[col:​injury_accident:​Source, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​injury_accident] <br>2. PROJECT[col:​injury_accident:​Source, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_1286 | How many games are free of injury accidents? | SELECT count(*) FROM game WHERE id NOT IN ( SELECT game_id FROM injury_accident ) | 1. SELECT[tbl:​game] <br>2. FILTER[#1, tbl:​injury_accident] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​game] <br>2. COMPARATIVE[#1, #1, tbl:​injury_accident] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_1287 | How many distinct kinds of injuries happened after season 2010? | SELECT count(DISTINCT T1.injury) FROM injury_accident AS T1 JOIN game AS T2 ON T1.game_id  =  T2.id WHERE T2.season  >  2010 | 1. SELECT[col:​injury_accident:​Injury] <br>2. FILTER[#1, comparative:​>:​2010:​col:​game:​Season] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[col:​injury_accident:​Injury] <br>2. COMPARATIVE[#1, #1, comparative:​>:​2010:​col:​game:​Season] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_1288 | List the name of the stadium where both the player 'Walter Samuel' and the player 'Thiago Motta' got injured. | SELECT T2.name FROM game AS T1 JOIN stadium AS T2 ON T1.stadium_id  =  T2.id JOIN injury_accident AS T3 ON T1.id  =  T3.game_id WHERE T3.player  =  'Walter Samuel' INTERSECT SELECT T2.name FROM game AS T1 JOIN stadium AS T2 ON T1.stadium_id  =  T2.id JOIN injury_accident AS T3 ON T1.id  =  T3.game_id WHERE T3.player  =  'Thiago Motta' | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Walter Samuel:​col:​injury_accident:​Player] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Thiago Motta:​col:​injury_accident:​Player] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​stadium:​name, #5] <br> | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​injury_accident, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Walter Samuel:​col:​injury_accident:​Player] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Thiago Motta:​col:​injury_accident:​Player] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​stadium:​name, #5] <br> | + | extra | 
  | SPIDER_train_1290 | Which stadium name contains the substring "Bank"? | SELECT name FROM stadium WHERE name LIKE "%Bank%" | 1. SELECT[tbl:​stadium] <br>2. PROJECT[col:​stadium:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Bank%:​col:​stadium:​name] <br>4. PROJECT[col:​stadium:​name, #3] <br> | 1. SELECT[tbl:​stadium] <br>2. PROJECT[col:​stadium:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Bank:​col:​stadium:​name] <br>4. PROJECT[col:​stadium:​name, #3] <br> | + | medium | 
  | SPIDER_train_1291 | How many games has each stadium held? | SELECT T1.id ,  count(*) FROM stadium AS T1 JOIN game AS T2 ON T1.id  =  T2.stadium_id GROUP BY T1.id | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​game, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[tbl:​stadium] <br>2. PROJECT[tbl:​game, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
 ***
 Exec acc: **1.0000**
