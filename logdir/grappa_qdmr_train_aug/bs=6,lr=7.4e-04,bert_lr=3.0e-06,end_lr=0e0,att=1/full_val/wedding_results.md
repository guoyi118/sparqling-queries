 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **people** | People_ID | + |   | 
 | 2 |   | Name |   |   | 
 | 3 |   | Country |   |   | 
 | 4 |   | Is_Male |   |   | 
 | 5 |   | Age |   |   | 
 | 6 | **church** | Church_ID | + |   | 
 | 7 |   | Name |   |   | 
 | 8 |   | Organized_by |   |   | 
 | 9 |   | Open_Date |   |   | 
 | 10 |   | Continuation_of |   |   | 
 | 11 | **wedding** | Church_ID | + | --> 6 | 
 | 12 |   | Male_ID |   | --> 1 | 
 | 13 |   | Female_ID |   | --> 1 | 
 | 14 |   | Year |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_1629 | How many churches opened before 1850 are there? | SELECT count(*) FROM Church WHERE Open_Date  <  1850 | 1. SELECT[tbl:​church] <br>2. FILTER[#1, comparative:​<:​1850:​col:​church:​Open_Date] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​church] <br>2. COMPARATIVE[#1, #1, comparative:​<:​1850:​col:​church:​Open_Date] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_1630 | Show the name, open date, and organizer for all churches. | SELECT name ,  open_date ,  organized_by FROM Church | 1. SELECT[tbl:​church] <br>2. PROJECT[col:​church:​Name, #1] <br>3. PROJECT[col:​church:​Open_Date, #1] <br>4. PROJECT[col:​church:​Organized_by, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​church] <br>2. PROJECT[col:​church:​Name, #1] <br>3. PROJECT[col:​church:​Open_Date, #1] <br>4. PROJECT[col:​church:​Organized_by, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1631 | List all church names in descending order of opening date. | SELECT name FROM church ORDER BY open_date DESC | 1. SELECT[tbl:​church] <br>2. PROJECT[col:​church:​Open_Date, #1] <br>3. PROJECT[col:​church:​Name, #1] <br>4. SORT[#3, #2, sortdir:​descending] <br> | 1. SELECT[tbl:​church] <br>2. PROJECT[col:​church:​Open_Date, #1] <br>3. PROJECT[col:​church:​Name, #1] <br>4. SORT[#3, #2, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_1632 | Show the opening year in whcih at least two churches opened. | SELECT open_date FROM church GROUP BY open_date HAVING count(*)  >=  2 | 1. SELECT[col:​church:​Open_Date] <br>2. PROJECT[tbl:​church, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br> | 1. SELECT[col:​church:​Open_Date] <br>2. PROJECT[tbl:​church, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br> | + | easy | 
  | SPIDER_train_1633 | Show the organizer and name for churches that opened between 1830 and 1840. | SELECT organized_by ,  name FROM church WHERE open_date BETWEEN 1830 AND 1840 | 1. SELECT[tbl:​church] <br>2. FILTER[#1, comparative:​>=:​1830:​col:​church:​Open_Date] <br>3. FILTER[#2, comparative:​<=:​1840:​col:​church:​Open_Date] <br>4. PROJECT[col:​church:​Organized_by, #3] <br>5. PROJECT[col:​church:​Name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​church] <br>2. COMPARATIVE[#1, #1, comparative:​>=:​1830:​col:​church:​Open_Date] <br>3. COMPARATIVE[#2, #2, comparative:​<=:​1840:​col:​church:​Open_Date] <br>4. PROJECT[col:​church:​Organized_by, #3] <br>5. PROJECT[col:​church:​Name, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_1634 | Show all opening years and the number of churches that opened in that year. | SELECT open_date ,  count(*) FROM church GROUP BY open_date | 1. SELECT[col:​church:​Open_Date] <br>2. PROJECT[tbl:​church, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​church:​Open_Date] <br>2. PROJECT[tbl:​church, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1636 | How many female people are older than 30 in our record? | SELECT count(*) FROM people WHERE is_male  =  'F' AND age  >  30 | 1. SELECT[tbl:​people] <br>2. FILTER[#1, comparative:​=:​F:​col:​people:​Is_Male] <br>3. FILTER[#2, comparative:​>:​30:​col:​people:​Age] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​people] <br>2. COMPARATIVE[#1, #1, comparative:​=:​F:​col:​people:​Is_Male] <br>3. COMPARATIVE[#2, #2, comparative:​>:​30:​col:​people:​Age] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_1637 | Show the country where people older than 30 and younger than 25 are from. | SELECT country FROM people WHERE age  <  25 INTERSECT SELECT country FROM people WHERE age  >  30 | 1. SELECT[tbl:​people] <br>2. FILTER[#1, comparative:​>:​30:​col:​people:​Age] <br>3. FILTER[#1, comparative:​<:​25:​col:​people:​Age] <br>4. PROJECT[col:​people:​Country, #2] <br>5. PROJECT[col:​people:​Country, #3] <br>6. PROJECT[col:​people:​Country, #1] <br>7. INTERSECTION[#6, #4, #5] <br> | 1. SELECT[tbl:​people] <br>2. COMPARATIVE[#1, #1, comparative:​>:​30:​col:​people:​Age] <br>3. COMPARATIVE[#1, #1, comparative:​<:​25:​col:​people:​Age] <br>4. PROJECT[col:​people:​Country, #2] <br>5. PROJECT[col:​people:​Country, #3] <br>6. PROJECT[col:​people:​Country, #1] <br>7. INTERSECTION[#6, #4, #5] <br> | + | hard | 
  | SPIDER_train_1639 | Show the name and country for all people whose age is smaller than the average. | SELECT name ,  country FROM people WHERE age  <  (SELECT avg(age) FROM people) | 1. SELECT[tbl:​people] <br>2. PROJECT[col:​people:​Age, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5. PROJECT[col:​people:​Name, #4] <br>6. PROJECT[col:​people:​Country, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​people] <br>2. PROJECT[col:​people:​Age, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​people:​Name, #4] <br>6. PROJECT[col:​people:​Country, #4] <br>7. UNION[#5, #6] <br> | - | extra | 
  | SPIDER_train_1643 | Show all church names that have hosted least two weddings. | SELECT T1.name FROM church AS T1 JOIN wedding AS T2 ON T1.church_id  =  T2.church_id GROUP BY T1.church_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​church] <br>2. PROJECT[tbl:​wedding, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​church:​Name, #4] <br> | 1. SELECT[tbl:​church] <br>2. PROJECT[tbl:​wedding, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​church:​Name, #4] <br> | + | medium | 
  | SPIDER_train_1644 | Show the names for all females from Canada having a wedding in year 2016. | SELECT T2.name FROM wedding AS T1 JOIN people AS T2 ON T1.female_id  =  T2.people_id WHERE T1.year  =  2016 AND T2.is_male  =  'F' AND T2.country  =  'Canada' | 1. SELECT[col:​wedding:​Female_ID] <br>2. FILTER[#1, comparative:​=:​Canada:​col:​people:​Country] <br>3. FILTER[#2, comparative:​=:​F:​col:​people:​Is_Male] <br>4. FILTER[#3, comparative:​=:​2016:​col:​wedding:​Year] <br>5. PROJECT[col:​people:​Name, #4] <br> | 1. SELECT[col:​wedding:​Female_ID] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Canada:​col:​people:​Country] <br>3. COMPARATIVE[#2, #2, comparative:​=:​F:​col:​people:​Is_Male] <br>4. COMPARATIVE[#3, #3, comparative:​=:​2016:​col:​wedding:​Year] <br>5. PROJECT[col:​people:​Name, #4] <br> | + | medium | 
  | SPIDER_train_1645 | How many weddings are there in year 2016? | SELECT count(*) FROM wedding WHERE YEAR  =  2016 | 1. SELECT[tbl:​wedding] <br>2. FILTER[#1, comparative:​=:​2016:​col:​wedding:​Year] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​wedding] <br>2. COMPARATIVE[#1, #1, comparative:​=:​2016:​col:​wedding:​Year] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_1646 | Show the church names for the weddings of all people older than 30. | SELECT T4.name FROM wedding AS T1 JOIN people AS T2 ON T1.male_id  =  T2.people_id JOIN people AS T3 ON T1.female_id  =  T3.people_id JOIN church AS T4 ON T4.church_id  =  T1.church_id WHERE T2.age  >  30 OR T3.age  >  30 | 1. SELECT[tbl:​people] <br>2. FILTER[#1, comparative:​>:​30:​col:​people:​Age] <br>3. PROJECT[tbl:​wedding, #2] <br>4. PROJECT[tbl:​church, #3] <br>5. PROJECT[col:​church:​Name, #4] <br> | 1. SELECT[tbl:​people] <br>2. COMPARATIVE[#1, #1, comparative:​>:​30:​col:​people:​Age] <br>3. PROJECT[tbl:​wedding, #2] <br>4. PROJECT[tbl:​church, #3] <br>5. PROJECT[col:​church:​Name, #4] <br> | + | extra | 
  | SPIDER_train_1647 | Show all countries and the number of people from each country. | SELECT country ,  count(*) FROM people GROUP BY country | 1. SELECT[col:​people:​Country] <br>2. PROJECT[tbl:​people, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​people:​Country] <br>2. PROJECT[tbl:​people, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1648 | How many churches have a wedding in year 2016? | SELECT COUNT (DISTINCT church_id) FROM wedding WHERE YEAR  =  2016 | 1. SELECT[col:​wedding:​Church_ID] <br>2. PROJECT[tbl:​wedding, #1] <br>3. PROJECT[col:​wedding:​Year, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​2016:​col:​wedding:​Year] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[col:​wedding:​Church_ID] <br>2. PROJECT[tbl:​wedding, #1] <br>3. PROJECT[col:​wedding:​Year, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​2016:​col:​wedding:​Year] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
 ***
 Exec acc: **0.9333**
