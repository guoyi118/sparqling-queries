 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **genre** | g_name | + |   | 
 | 2 |   | rating |   |   | 
 | 3 |   | most_popular_in |   |   | 
 | 4 | **artist** | artist_name | + |   | 
 | 5 |   | country |   |   | 
 | 6 |   | gender |   |   | 
 | 7 |   | preferred_genre |   | --> 1 | 
 | 8 | **files** | f_id | + |   | 
 | 9 |   | artist_name |   | --> 4 | 
 | 10 |   | file_size |   |   | 
 | 11 |   | duration |   |   | 
 | 12 |   | formats |   |   | 
 | 13 | **song** | song_name | + |   | 
 | 14 |   | artist_name |   | --> 4 | 
 | 15 |   | country |   |   | 
 | 16 |   | f_id |   | --> 8 | 
 | 17 |   | genre_is |   | --> 1 | 
 | 18 |   | rating |   |   | 
 | 19 |   | languages |   |   | 
 | 20 |   | releasedate |   |   | 
 | 21 |   | resolution |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3532 | Find the id of the song that lasts the longest. | SELECT f_id FROM files ORDER BY duration DESC LIMIT 1 | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​duration, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​files:​f_id, #3] <br> | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​duration, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​files:​f_id, #3] <br> | + | medium | 
  | SPIDER_train_3533 | Find the names of all English songs. | SELECT song_name FROM song WHERE languages  =  "english" | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​song_name, #2] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​song_name, #2] <br> | + | easy | 
  | SPIDER_train_3534 | What are the names of all songs in English? | SELECT song_name FROM song WHERE languages  =  "english" | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​song_name, #2] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​song_name, #2] <br> | + | easy | 
  | SPIDER_train_3536 | What are the id of all the files in mp3 format? | SELECT f_id FROM files WHERE formats  =  "mp3" | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp3:​col:​files:​formats] <br>4. PROJECT[col:​files:​f_id, #3] <br> | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp3:​col:​files:​formats] <br>4. PROJECT[col:​files:​f_id, #3] <br> | + | easy | 
  | SPIDER_train_3537 | List the name and country of origin for all singers who have produced songs with rating above 9. | SELECT DISTINCT T1.artist_name ,  T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T2.rating  >  9 | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​rating, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​9:​col:​song:​rating] <br>4. PROJECT[singers who produced #REF, #3] <br>5. PROJECT[col:​artist:​artist_name, #4] <br>6. PROJECT[col:​artist:​country, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​rating, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​9:​col:​song:​rating] <br>4. PROJECT[None, #3] <br>5. PROJECT[col:​artist:​artist_name, #4] <br>6. PROJECT[col:​artist:​country, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_3538 | What are the different names and countries of origins for all artists whose song ratings are above 9? | SELECT DISTINCT T1.artist_name ,  T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T2.rating  >  9 | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​9:​col:​song:​rating] <br>4.*(distinct)* PROJECT[col:​artist:​artist_name, #3] <br>5. PROJECT[col:​artist:​country, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​9:​col:​song:​rating] <br>4.*(distinct)* PROJECT[col:​artist:​artist_name, #3] <br>5. PROJECT[col:​artist:​country, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3539 | List the file size and format for all songs that have resolution lower than 800. | SELECT DISTINCT T1.file_size ,  T1.formats FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id WHERE T2.resolution  <  800 | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​resolution, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​800:​col:​song:​resolution] <br>4. PROJECT[col:​files:​file_size, #3] <br>5. PROJECT[col:​files:​formats, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​resolution, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​800:​col:​song:​resolution] <br>4. PROJECT[col:​files:​file_size, #3] <br>5. PROJECT[col:​files:​formats, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3545 | How many songs have 4 minute duration? | SELECT count(*) FROM files WHERE duration LIKE "4:​%" | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​duration, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​4:​%:​col:​files:​duration] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​duration, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​4:​:​col:​files:​duration] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_3547 | How many artists are from Bangladesh? | SELECT count(*) FROM artist WHERE country  =  "Bangladesh" | 1. SELECT[tbl:​artist] <br>2. FILTER[#1, comparative:​=:​Bangladesh:​col:​artist:​country] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​artist] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Bangladesh:​col:​artist:​country] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3548 | How many Bangladeshi artists are listed? | SELECT count(*) FROM artist WHERE country  =  "Bangladesh" | 1. SELECT[tbl:​artist] <br>2. FILTER[#1, comparative:​=:​Bangladesh:​col:​artist:​country] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​artist] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Bangladesh:​col:​artist:​country] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3549 | What is the average rating of songs produced by female artists? | SELECT avg(T2.rating) FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T1.gender  =  "Female" | 1. SELECT[tbl:​song] <br>2. PROJECT[tbl:​artist, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Female:​col:​artist:​gender] <br>4. PROJECT[col:​song:​rating, #3] <br>5. AGGREGATE[avg, #4] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[tbl:​artist, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Female:​col:​artist:​gender] <br>4. PROJECT[col:​song:​rating, #3] <br>5. AGGREGATE[avg, #4] <br> | + | medium | 
  | SPIDER_train_3550 | How many songs, on average, are sung by a female artist? | SELECT avg(T2.rating) FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T1.gender  =  "Female" | 1. SELECT[val:​artist:​gender:​Female] <br>2. PROJECT[col:​song:​rating, #1] <br>3. GROUP[col:​song:​rating, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[val:​artist:​gender:​Female] <br>2. PROJECT[col:​song:​rating, #1] <br>3. GROUP[sum, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | + | medium | 
  | SPIDER_train_3552 | Find the file format that is used by the most files. | SELECT formats FROM files GROUP BY formats ORDER BY COUNT (*) DESC LIMIT 1 | 1. SELECT[col:​files:​formats] <br>2. PROJECT[tbl:​files, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​files:​formats] <br>2. PROJECT[tbl:​files, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_3553 | Find the names of the artists who are from UK and have produced English songs. | SELECT artist_name FROM artist WHERE country  =  "UK" INTERSECT SELECT artist_name FROM song WHERE languages  =  "english" | 1. SELECT[tbl:​artist] <br>2. FILTER[#1, comparative:​=:​UK:​col:​artist:​country] <br>3. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​artist:​artist_name, #4] <br> | 1. SELECT[tbl:​artist] <br>2. COMPARATIVE[#1, #1, comparative:​=:​UK:​col:​artist:​country] <br>3. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​artist:​artist_name, #4] <br> | + | hard | 
  | SPIDER_train_3555 | Find the id of songs that are available in mp4 format and have resolution lower than 1000. | SELECT f_id FROM files WHERE formats  =  "mp4" INTERSECT SELECT f_id FROM song WHERE resolution  <  1000 | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp4:​col:​files:​formats] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. COMPARATIVE[#1, #4, comparative:​<:​1000:​col:​song:​resolution] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​files:​f_id, #6] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp4:​col:​files:​formats] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. COMPARATIVE[#1, #4, comparative:​<:​1000:​col:​song:​resolution] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​files:​f_id, #6] <br> | + | hard | 
  | SPIDER_train_3556 | What is the id of the files that are available in the format of mp4 and a resolution smaller than 1000? | SELECT f_id FROM files WHERE formats  =  "mp4" INTERSECT SELECT f_id FROM song WHERE resolution  <  1000 | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp4:​col:​files:​formats] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. COMPARATIVE[#1, #4, comparative:​<:​1000:​col:​song:​resolution] <br>6. PROJECT[col:​files:​f_id, #1] <br>7. INTERSECTION[#6, #3, #5] <br> | 1. SELECT[tbl:​files] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp4:​col:​files:​formats] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. COMPARATIVE[#1, #4, comparative:​<:​1000:​col:​song:​resolution] <br>6. PROJECT[col:​files:​f_id, #1] <br>7. INTERSECTION[#6, #3, #5] <br> | + | hard | 
  | SPIDER_train_3557 | What is the country of origin of the artist who is female and produced a song in Bangla? | SELECT T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T1.gender  =  "Female" AND T2.languages  =  "bangla" | 1. SELECT[tbl:​artist] <br>2. FILTER[#1, comparative:​=:​Female:​col:​artist:​gender] <br>3. PROJECT[tbl:​song, #1] <br>4. FILTER[#3, comparative:​=:​bangla:​col:​song:​languages] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, tbl:​artist] <br>7. INTERSECTION[#1, #2, #6] <br>8. PROJECT[col:​artist:​country, #7] <br> | 1. SELECT[tbl:​artist] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Female:​col:​artist:​gender] <br>3. PROJECT[tbl:​song, #1] <br>4. COMPARATIVE[#3, #3, comparative:​=:​bangla:​col:​song:​languages] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​=:​bangla:​col:​song:​languages] <br>7. INTERSECTION[#1, #2, #6] <br>8. PROJECT[col:​artist:​country, #7] <br> | - | medium | 
  | SPIDER_train_3558 | What countries are the female artists who sung in the language Bangla from? | SELECT T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T1.gender  =  "Female" AND T2.languages  =  "bangla" | 1. SELECT[val:​artist:​gender:​Female] <br>2. FILTER[#1, comparative:​=:​bangla:​col:​song:​languages] <br>3. PROJECT[col:​artist:​country, #2] <br> | 1. SELECT[val:​artist:​gender:​Female] <br>2. COMPARATIVE[#1, #1, comparative:​=:​bangla:​col:​song:​languages] <br>3. PROJECT[col:​artist:​country, #2] <br> | + | medium | 
  | SPIDER_train_3565 | Return the gender and name of artist who produced the song with the lowest resolution. | SELECT T1.gender ,  T1.artist_name FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name ORDER BY T2.resolution LIMIT 1 | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​resolution, #1] <br>3. COMPARATIVE[#1, #2, comparative:​min:​None] <br>4. PROJECT[tbl:​artist, #3] <br>5. PROJECT[col:​artist:​gender, #4] <br>6. PROJECT[col:​artist:​artist_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​resolution, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[tbl:​artist, #3] <br>5. PROJECT[col:​artist:​gender, #4] <br>6. PROJECT[col:​artist:​artist_name, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_3566 | What is the gender and name of the artist who sang the song with the smallest resolution? | SELECT T1.gender ,  T1.artist_name FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name ORDER BY T2.resolution LIMIT 1 | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. PROJECT[col:​song:​resolution, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​artist:​gender, #4] <br>6. PROJECT[col:​artist:​artist_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. PROJECT[col:​song:​resolution, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​artist:​gender, #4] <br>6. PROJECT[col:​artist:​artist_name, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_3569 | Find the distinct names of all songs that have a higher resolution than some songs in English. | SELECT DISTINCT song_name FROM song WHERE resolution  >  (SELECT min(resolution) FROM song WHERE languages  =  "english") | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​resolution, #2] <br>4. AGGREGATE[min, #3] <br>5. PROJECT[col:​song:​resolution, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​#4] <br>7.*(distinct)* PROJECT[col:​song:​song_name, #6] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​resolution, #2] <br>4. AGGREGATE[min, #3] <br>5. PROJECT[col:​song:​resolution, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​english:​col:​song:​languages] <br>7.*(distinct)* PROJECT[col:​song:​song_name, #6] <br> | - | hard | 
  | SPIDER_train_3570 | What are the different names for all songs that have a higher resolution than English songs? | SELECT DISTINCT song_name FROM song WHERE resolution  >  (SELECT min(resolution) FROM song WHERE languages  =  "english") | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​resolution, #1] <br>4. PROJECT[col:​song:​resolution, #2] <br>5. COMPARATIVE[#1, #3, comparative:​>:​#4] <br>6.*(distinct)* PROJECT[col:​song:​song_name, #5] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​resolution, #1] <br>4. PROJECT[col:​song:​resolution, #2] <br>5. COMPARATIVE[#1, #3, comparative:​>:​english:​col:​song:​languages] <br>6.*(distinct)* PROJECT[col:​song:​song_name, #5] <br> | - | hard | 
  | SPIDER_train_3572 | What are the names of the songs that have a lower rating than at least one blues song? | SELECT song_name FROM song WHERE rating  <  (SELECT max(rating) FROM song WHERE genre_is  =  "blues") | 1. SELECT[tbl:​song] <br>2. SELECT[val:​song:​genre_is:​blues] <br>3. PROJECT[col:​song:​rating, #2] <br>4. AGGREGATE[max, #3] <br>5. PROJECT[col:​song:​rating, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​#4] <br>7. PROJECT[col:​song:​song_name, #6] <br> | 1. SELECT[tbl:​song] <br>2. SELECT[val:​song:​genre_is:​blues] <br>3. PROJECT[col:​song:​rating, #2] <br>4. AGGREGATE[max, #3] <br>5. PROJECT[col:​song:​rating, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​#4] <br>7. PROJECT[col:​song:​song_name, #6] <br> | + | hard | 
  | SPIDER_train_3577 | List the names of all genres in alphabetical oder, together with its ratings. | SELECT g_name ,  rating FROM genre ORDER BY g_name | 1. SELECT[tbl:​genre] <br>2. PROJECT[col:​genre:​g_name, #1] <br>3. PROJECT[col:​genre:​rating, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​genre] <br>2. PROJECT[col:​genre:​g_name, #1] <br>3. PROJECT[col:​genre:​rating, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3579 | Give me a list of the names of all songs ordered by their resolution. | SELECT song_name FROM song ORDER BY resolution | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​song_name, #1] <br>3. PROJECT[col:​song:​resolution, #1] <br>4. SORT[#2, #3] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​song_name, #1] <br>3. PROJECT[col:​song:​resolution, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3580 | What are the names of all songs that are ordered by their resolution numbers? | SELECT song_name FROM song ORDER BY resolution | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​song_name, #1] <br>3. PROJECT[col:​song:​resolution, #1] <br>4. SORT[#2, #3] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​song_name, #1] <br>3. PROJECT[col:​song:​resolution, #1] <br>4. SORT[#2, #3, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3583 | List the names of all songs that have 4 minute duration or are in English. | SELECT T2.song_name FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id WHERE T1.duration LIKE "4:​%" UNION SELECT song_name FROM song WHERE languages  =  "english" | 1. SELECT[col:​song:​song_name] <br>2. PROJECT[col:​files:​duration, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​4:​%:​col:​files:​duration] <br>4. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​song:​song_name, #5] <br> | 1. SELECT[col:​song:​song_name] <br>2. PROJECT[col:​files:​duration, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​4:​:​col:​files:​duration] <br>4. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​song:​song_name, #5] <br> | + | extra | 
  | SPIDER_train_3584 | What are the names of all songs that are approximately 4 minutes long or are in English? | SELECT T2.song_name FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id WHERE T1.duration LIKE "4:​%" UNION SELECT song_name FROM song WHERE languages  =  "english" | 1. SELECT[col:​song:​song_name] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[tbl:​song, #1] <br>4. COMPARATIVE[#1, #3, comparative:​like:​4:​%:​col:​files:​duration] <br>5. UNION[#4, #2] <br>6. PROJECT[col:​song:​song_name, #5] <br> | 1. SELECT[col:​song:​song_name] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[tbl:​song, #1] <br>4. COMPARATIVE[#1, #3, comparative:​like:​4:​:​col:​files:​duration] <br>5. UNION[#4, #2] <br>6. PROJECT[col:​song:​song_name, #5] <br> | + | extra | 
  | SPIDER_train_3585 | What is the language used most often in the songs? | SELECT languages FROM song GROUP BY languages ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​song:​languages] <br>2. PROJECT[tbl:​song, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​song:​languages] <br>2. PROJECT[tbl:​song, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_3586 | What are the languages that are used most often in songs? | SELECT languages FROM song GROUP BY languages ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​song:​languages] <br>2. PROJECT[tbl:​song, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​song:​languages] <br>2. PROJECT[tbl:​song, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_3589 | What are the names of artists who are Male and are from UK? | SELECT artist_name FROM artist WHERE country  =  "UK" AND gender  =  "Male" | 1. SELECT[tbl:​artist] <br>2. FILTER[#1, comparative:​=:​Male:​col:​artist:​gender] <br>3. FILTER[#1, comparative:​=:​UK:​col:​artist:​country] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​artist:​artist_name, #4] <br> | 1. SELECT[tbl:​artist] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Male:​col:​artist:​gender] <br>3. COMPARATIVE[#1, #1, comparative:​=:​UK:​col:​artist:​country] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​artist:​artist_name, #4] <br> | + | medium | 
  | SPIDER_train_3591 | Find the names of songs whose genre is modern or language is English. | SELECT song_name FROM song WHERE genre_is  =  "modern" OR languages  =  "english" | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​genre_is, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​modern:​col:​song:​genre_is] <br>4. PROJECT[col:​song:​languages, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​english:​col:​song:​languages] <br>6. UNION[#3, #5] <br>7. PROJECT[col:​song:​song_name, #6] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​genre_is, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​modern:​col:​song:​genre_is] <br>4. PROJECT[col:​song:​languages, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​english:​col:​song:​languages] <br>6. UNION[#3, #5] <br>7. PROJECT[col:​song:​song_name, #6] <br> | + | medium | 
  | SPIDER_train_3592 | What are the names of the songs that are modern or sung in English? | SELECT song_name FROM song WHERE genre_is  =  "modern" OR languages  =  "english" | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​modern:​col:​song:​genre_is] <br>3. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​song:​song_name, #4] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​modern:​col:​song:​genre_is] <br>3. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​song:​song_name, #4] <br> | + | medium | 
  | SPIDER_train_3593 | Return the names of songs for which format is mp3 and resolution is below 1000. | SELECT T2.song_name FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id WHERE T1.formats  =  "mp3" INTERSECT SELECT song_name FROM song WHERE resolution  <  1000 | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​mp3:​col:​files:​formats] <br>3. FILTER[#2, comparative:​<:​1000:​col:​song:​resolution] <br>4. PROJECT[col:​song:​song_name, #3] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​mp3:​col:​files:​formats] <br>3. COMPARATIVE[#2, #2, comparative:​<:​1000:​col:​song:​resolution] <br>4. PROJECT[col:​song:​song_name, #3] <br> | + | extra | 
  | SPIDER_train_3594 | What are the names of all songs that are in mp3 format and have a resolution lower than 1000? | SELECT T2.song_name FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id WHERE T1.formats  =  "mp3" INTERSECT SELECT song_name FROM song WHERE resolution  <  1000 | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp3:​col:​files:​formats] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. COMPARATIVE[#1, #4, comparative:​<:​1000:​col:​song:​resolution] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​song:​song_name, #6] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​files:​formats, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​mp3:​col:​files:​formats] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. COMPARATIVE[#1, #4, comparative:​<:​1000:​col:​song:​resolution] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​song:​song_name, #6] <br> | + | extra | 
  | SPIDER_train_3597 | What are the average rating and resolution of songs that are in Bangla? | SELECT avg(rating) ,  avg(resolution) FROM song WHERE languages  =  "bangla" | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​bangla:​col:​song:​languages] <br>3. PROJECT[col:​song:​rating, #2] <br>4. AGGREGATE[avg, #3] <br>5. PROJECT[col:​song:​resolution, #2] <br>6. AGGREGATE[avg, #5] <br>7. UNION[#4, #6] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​bangla:​col:​song:​languages] <br>3. PROJECT[col:​song:​rating, #2] <br>4. AGGREGATE[avg, #3] <br>5. PROJECT[col:​song:​resolution, #2] <br>6. AGGREGATE[avg, #5] <br>7. UNION[#4, #6] <br> | + | medium | 
  | SPIDER_train_3598 | What is the average rating and resolution of all bangla songs? | SELECT avg(rating) ,  avg(resolution) FROM song WHERE languages  =  "bangla" | 1. SELECT[val:​song:​languages:​bangla] <br>2. PROJECT[col:​song:​rating, #1] <br>3. AGGREGATE[avg, #2] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. AGGREGATE[avg, #4] <br>6. UNION[#3, #5] <br> | 1. SELECT[val:​song:​languages:​bangla] <br>2. PROJECT[col:​song:​rating, #1] <br>3. AGGREGATE[avg, #2] <br>4. PROJECT[col:​song:​resolution, #1] <br>5. AGGREGATE[avg, #4] <br>6. UNION[#3, #5] <br> | + | medium | 
  | SPIDER_train_3606 | What are the names and number of works for all artists who have sung at least one song in English? | SELECT T1.artist_name ,  count(*) FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T2.languages  =  "english" GROUP BY T2.artist_name HAVING count(*)  >=  1 | 1. SELECT[col:​song:​artist_name] <br>2. PROJECT[tbl:​song, #1] <br>3. FILTER[#2, comparative:​=:​english:​col:​song:​languages] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>=:​1] <br>6. PROJECT[col:​artist:​artist_name, #5] <br>7. PROJECT[works of #REF, #5] <br>8. GROUP[count, #7, #5] <br>9. UNION[#6, #8] <br> | 1. SELECT[col:​song:​artist_name] <br>2. PROJECT[tbl:​song, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​english:​col:​song:​languages] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>=:​1] <br>6. PROJECT[col:​artist:​artist_name, #5] <br>7. PROJECT[None, #5] <br>8. GROUP[count, #7, #5] <br>9. UNION[#6, #8] <br> | + | hard | 
  | SPIDER_train_3607 | Find the name and country of origin for all artists who have release at least one song of resolution above 900. | SELECT T1.artist_name ,  T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T2.resolution  >  900 GROUP BY T2.artist_name HAVING count(*)  >=  1 | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​>:​900:​col:​song:​resolution] <br>3. PROJECT[tbl:​artist, #2] <br>4. PROJECT[col:​artist:​artist_name, #3] <br>5. PROJECT[col:​artist:​country, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​>:​900:​col:​song:​resolution] <br>3. PROJECT[tbl:​artist, #2] <br>4. PROJECT[col:​artist:​artist_name, #3] <br>5. PROJECT[col:​artist:​country, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_3608 | What is the name and country of origin for each artist who has released a song with a resolution higher than 900? | SELECT T1.artist_name ,  T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T2.resolution  >  900 GROUP BY T2.artist_name HAVING count(*)  >=  1 | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. PROJECT[col:​song:​resolution, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​900:​col:​song:​resolution] <br>5. PROJECT[col:​artist:​artist_name, #4] <br>6. PROJECT[col:​artist:​country, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. PROJECT[col:​song:​resolution, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​900:​col:​song:​resolution] <br>5. PROJECT[col:​artist:​artist_name, #4] <br>6. PROJECT[col:​artist:​country, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_3611 | Find the country of origin for the artist who made the least number of songs? | SELECT T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name GROUP BY T2.artist_name ORDER BY count(*) LIMIT 1 | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. AGGREGATE[count, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​artist:​country, #4] <br> | 1. SELECT[tbl:​artist] <br>2. PROJECT[tbl:​song, #1] <br>3. AGGREGATE[count, #2] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​artist:​country, #4] <br> | + | extra | 
  | SPIDER_train_3612 | What country is the artist who made the fewest songs from? | SELECT T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name GROUP BY T2.artist_name ORDER BY count(*) LIMIT 1 | 1. SELECT[tbl:​artist] <br>2. FILTER[#1, tbl:​song] <br>3. PROJECT[col:​artist:​country, #2] <br> | 1. SELECT[tbl:​artist] <br>2. COMPARATIVE[#1, #1, tbl:​song] <br>3. PROJECT[col:​artist:​country, #2] <br> | + | extra | 
  | SPIDER_train_3613 | What are the names of the songs whose rating is below the rating of all songs in English? | SELECT song_name FROM song WHERE rating  <   (SELECT min(rating) FROM song WHERE languages  =  'english') | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​rating, #2] <br>4. AGGREGATE[min, #3] <br>5. PROJECT[col:​song:​rating, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​#4] <br>7. PROJECT[col:​song:​song_name, #6] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​rating, #2] <br>4. AGGREGATE[min, #3] <br>5. PROJECT[col:​song:​rating, #1] <br>6. COMPARATIVE[#1, #5, comparative:​<:​english:​col:​song:​languages] <br>7. PROJECT[col:​song:​song_name, #6] <br> | - | hard | 
  | SPIDER_train_3614 | What are the song names for every song whose rating is less than the minimum rating for English songs? | SELECT song_name FROM song WHERE rating  <   (SELECT min(rating) FROM song WHERE languages  =  'english') | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​rating, #1] <br>4. PROJECT[col:​song:​rating, #2] <br>5. AGGREGATE[min, #4] <br>6. COMPARATIVE[#1, #3, comparative:​<:​#5] <br>7. PROJECT[col:​song:​song_name, #6] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​rating, #1] <br>4. PROJECT[col:​song:​rating, #2] <br>5. AGGREGATE[min, #4] <br>6. COMPARATIVE[#1, #3, comparative:​<:​english:​col:​song:​languages] <br>7. PROJECT[col:​song:​song_name, #6] <br> | - | hard | 
  | SPIDER_train_3621 | List the id, genre and artist name of English songs ordered by rating. | SELECT f_id ,  genre_is ,  artist_name FROM song WHERE languages  =   "english" ORDER BY rating | 1. SELECT[val:​song:​languages:​english] <br>2. PROJECT[col:​song:​f_id, #1] <br>3. PROJECT[col:​song:​genre_is, #1] <br>4. PROJECT[col:​song:​artist_name, #1] <br>5. PROJECT[col:​song:​rating, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5] <br> | 1. SELECT[val:​song:​languages:​english] <br>2. PROJECT[col:​song:​f_id, #1] <br>3. PROJECT[col:​song:​genre_is, #1] <br>4. PROJECT[col:​song:​artist_name, #1] <br>5. PROJECT[col:​song:​rating, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3622 | What is the id, genre, and name of the artist for every English song ordered by ascending rating? | SELECT f_id ,  genre_is ,  artist_name FROM song WHERE languages  =   "english" ORDER BY rating | 1. SELECT[tbl:​song] <br>2. FILTER[#1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​artist_name, #2] <br>4. PROJECT[col:​song:​f_id, #3] <br>5. PROJECT[col:​song:​genre_is, #3] <br>6. PROJECT[col:​song:​artist_name, #3] <br>7. PROJECT[col:​song:​rating, #3] <br>8. UNION[#4, #5, #6] <br>9. SORT[#8, #7, sortdir:​ascending] <br> | 1. SELECT[tbl:​song] <br>2. COMPARATIVE[#1, #1, comparative:​=:​english:​col:​song:​languages] <br>3. PROJECT[col:​song:​artist_name, #2] <br>4. PROJECT[col:​song:​f_id, #3] <br>5. PROJECT[col:​song:​genre_is, #3] <br>6. PROJECT[col:​song:​artist_name, #3] <br>7. PROJECT[col:​song:​rating, #3] <br>8. UNION[#4, #5, #6] <br>9. SORT[#8, #7, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3623 | List the duration, file size and format of songs whose genre is pop, ordered by title? | SELECT T1.duration ,  T1.file_size ,  T1.formats FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id WHERE T2.genre_is  =  "pop" ORDER BY T2.song_name | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​genre_is, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​pop:​col:​song:​genre_is] <br>4. PROJECT[col:​files:​duration, #3] <br>5. PROJECT[col:​files:​file_size, #3] <br>6. PROJECT[col:​files:​formats, #3] <br>7. PROJECT[col:​song:​song_name, #3] <br>8. UNION[#4, #5, #6] <br>9. SORT[#8, #7] <br> | 1. SELECT[tbl:​song] <br>2. PROJECT[col:​song:​genre_is, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​pop:​col:​song:​genre_is] <br>4. PROJECT[col:​files:​duration, #3] <br>5. PROJECT[col:​files:​file_size, #3] <br>6. PROJECT[col:​files:​formats, #3] <br>7. PROJECT[col:​song:​song_name, #3] <br>8. UNION[#4, #5, #6] <br>9. SORT[#8, #7, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_3624 | What is the duration, file size, and song format for every pop song, ordered by title alphabetically? | SELECT T1.duration ,  T1.file_size ,  T1.formats FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id WHERE T2.genre_is  =  "pop" ORDER BY T2.song_name | 1. SELECT[val:​song:​genre_is:​pop] <br>2. PROJECT[col:​files:​duration, #1] <br>3. PROJECT[col:​files:​file_size, #1] <br>4. PROJECT[col:​files:​formats, #1] <br>5. PROJECT[col:​song:​song_name, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | 1. SELECT[val:​song:​genre_is:​pop] <br>2. PROJECT[col:​files:​duration, #1] <br>3. PROJECT[col:​files:​file_size, #1] <br>4. PROJECT[col:​files:​formats, #1] <br>5. PROJECT[col:​song:​song_name, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_3625 | Find the names of the artists who have produced English songs but have never received rating higher than 8. | SELECT DISTINCT artist_name FROM song WHERE languages  =  "english" EXCEPT SELECT DISTINCT artist_name FROM song WHERE rating  >  8 | 1. SELECT[col:​song:​artist_name] <br>2. PROJECT[tbl:​song, #1] <br>3. FILTER[#2, comparative:​=:​english:​col:​song:​languages] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, col:​song:​artist_name] <br>6. PROJECT[col:​song:​rating, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​8:​col:​song:​rating] <br>8. DISCARD[#1, #7] <br>9. INTERSECTION[#1, #5, #8] <br>10. PROJECT[col:​song:​artist_name, #9] <br> | 1. SELECT[col:​song:​artist_name] <br>2. PROJECT[tbl:​song, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​english:​col:​song:​languages] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​8] <br>6. PROJECT[col:​song:​rating, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​8:​col:​song:​rating] <br>8. DISCARD[#1, #7] <br>9. INTERSECTION[#1, #5, #8] <br>10. PROJECT[col:​song:​artist_name, #9] <br> | - | hard | 
  | SPIDER_train_3626 | What are the names of the different artists that have produced a song in English but have never receieved a rating higher than 8? | SELECT DISTINCT artist_name FROM song WHERE languages  =  "english" EXCEPT SELECT DISTINCT artist_name FROM song WHERE rating  >  8 | 1. SELECT[col:​song:​artist_name] <br>2. PROJECT[tbl:​song, #1] <br>3. FILTER[#2, comparative:​=:​english:​col:​song:​languages] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, col:​song:​artist_name] <br>6. PROJECT[col:​song:​rating, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​8:​col:​song:​rating] <br>8. DISCARD[#1, #7] <br>9. INTERSECTION[#1, #5, #8] <br>10. PROJECT[col:​song:​artist_name, #9] <br> | 1. SELECT[col:​song:​artist_name] <br>2. PROJECT[tbl:​song, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​english:​col:​song:​languages] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​8] <br>6. PROJECT[col:​song:​rating, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​8:​col:​song:​rating] <br>8. DISCARD[#1, #7] <br>9. INTERSECTION[#1, #5, #8] <br>10. PROJECT[col:​song:​artist_name, #9] <br> | - | hard | 
 ***
 Exec acc: **0.8600**
