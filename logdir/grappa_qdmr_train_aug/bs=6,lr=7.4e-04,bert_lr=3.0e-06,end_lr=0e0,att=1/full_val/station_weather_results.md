 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **train** | id | + |   | 
 | 2 |   | train_number |   |   | 
 | 3 |   | name |   |   | 
 | 4 |   | origin |   |   | 
 | 5 |   | destination |   |   | 
 | 6 |   | time |   |   | 
 | 7 |   | interval |   |   | 
 | 8 | **station** | id | + |   | 
 | 9 |   | network_name |   |   | 
 | 10 |   | services |   |   | 
 | 11 |   | local_authority |   |   | 
 | 12 | **route** | train_id | + | --> 1 | 
 | 13 |   | station_id |   | --> 8 | 
 | 14 | **weekly_weather** | station_id | + | --> 8 | 
 | 15 |   | day_of_week |   |   | 
 | 16 |   | high_temperature |   |   | 
 | 17 |   | low_temperature |   |   | 
 | 18 |   | precipitation |   |   | 
 | 19 |   | wind_speed_mph |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3157 | list the local authorities and services provided by all stations. | SELECT local_authority ,  services FROM station | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​local_authority, #1] <br>3. PROJECT[col:​station:​services, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​local_authority, #1] <br>3. PROJECT[col:​station:​services, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_3158 | show all train numbers and names ordered by their time from early to late. | SELECT train_number ,  name FROM train ORDER BY TIME | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​train_number, #1] <br>3. PROJECT[col:​train:​name, #1] <br>4. PROJECT[col:​train:​time, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​train_number, #1] <br>3. PROJECT[col:​train:​name, #1] <br>4. PROJECT[col:​train:​time, #1] <br>5. UNION[#2, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3159 | Give me the times and numbers of all trains that go to Chennai, ordered by time. | SELECT TIME ,  train_number FROM train WHERE destination  =  'Chennai' ORDER BY TIME | 1. SELECT[tbl:​train] <br>2. FILTER[#1, comparative:​=:​Chennai:​col:​train:​destination] <br>3. PROJECT[col:​train:​time, #2] <br>4. PROJECT[col:​train:​train_number, #2] <br>5. UNION[#3, #4] <br>6. SORT[#5, #3] <br> | 1. SELECT[tbl:​train] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Chennai:​col:​train:​destination] <br>3. PROJECT[col:​train:​time, #2] <br>4. PROJECT[col:​train:​train_number, #2] <br>5. UNION[#3, #4] <br>6. SORT[#5, #3, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3160 | How many trains have 'Express' in their names? | SELECT count(*) FROM train WHERE name LIKE "%Express%" | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Express%:​col:​train:​name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Express:​col:​train:​name] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_3161 | Find the number and time of the train that goes from Chennai to Guruvayur. | SELECT train_number ,  TIME FROM train WHERE origin  =  'Chennai' AND destination  =  'Guruvayur' | 1. SELECT[col:​train:​train_number] <br>2. FILTER[#1, comparative:​=:​Chennai:​col:​train:​origin] <br>3. FILTER[#2, comparative:​=:​Guruvayur:​col:​train:​destination] <br>4. AGGREGATE[col:​train:​train_number, #3] <br>5. PROJECT[col:​train:​time, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[col:​train:​train_number] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Chennai:​col:​train:​origin] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Guruvayur:​col:​train:​destination] <br>4. AGGREGATE[sum, #3] <br>5. PROJECT[col:​train:​time, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3162 | Find the number of trains starting from each origin. | SELECT origin ,  count(*) FROM train GROUP BY origin | 1. SELECT[col:​train:​origin] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​train:​origin] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_3163 | Find the name of the train whose route runs through greatest number of stations. | SELECT t1.name FROM train AS t1 JOIN route AS t2 ON t1.id  =  t2.train_id GROUP BY t2.train_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​train] <br>2. PROJECT[tbl:​route, #1] <br>3. PROJECT[stations of #REF, #2] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​train:​name, #5] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[tbl:​route, #1] <br>3. PROJECT[None, #2] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​train:​name, #5] <br> | + | extra | 
  | SPIDER_train_3164 | Find the number of trains for each station, as well as the station network name and services. | SELECT count(*) ,  t1.network_name ,  t1.services FROM station AS t1 JOIN route AS t2 ON t1.id  =  t2.station_id GROUP BY t2.station_id | 1. SELECT[col:​route:​station_id] <br>2. PROJECT[trains of #REF, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​station:​network_name, #1] <br>5. PROJECT[col:​station:​services, #1] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[col:​route:​station_id] <br>2. PROJECT[None, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​station:​network_name, #1] <br>5. PROJECT[col:​station:​services, #1] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_3166 | Give me the maximum low temperature and average precipitation at the Amersham station. | SELECT max(t1.low_temperature) ,  avg(t1.precipitation) FROM weekly_weather AS t1 JOIN station AS t2 ON t1.station_id  =  t2.id WHERE t2.network_name  =  "Amersham" | 1. SELECT[val:​station:​network_name:​Amersham] <br>2. PROJECT[col:​weekly_weather:​low_temperature, #1] <br>3. AGGREGATE[max, #2] <br>4. PROJECT[col:​weekly_weather:​precipitation, #1] <br>5. AGGREGATE[avg, #4] <br>6. UNION[#3, #5] <br> | 1. SELECT[val:​station:​network_name:​Amersham] <br>2. PROJECT[col:​weekly_weather:​low_temperature, #1] <br>3. AGGREGATE[max, #2] <br>4. PROJECT[col:​weekly_weather:​precipitation, #1] <br>5. AGGREGATE[avg, #4] <br>6. UNION[#3, #5] <br> | + | extra | 
  | SPIDER_train_3167 | Find names and times of trains that run through stations for the local authority Chiltern. | SELECT t3.name ,  t3.time FROM station AS t1 JOIN route AS t2 ON t1.id  =  t2.station_id JOIN train AS t3 ON t2.train_id  =  t3.id WHERE t1.local_authority  =  "Chiltern" | 1. SELECT[tbl:​station] <br>2. FILTER[#1, comparative:​=:​Chiltern:​col:​station:​local_authority] <br>3. PROJECT[tbl:​train, #2] <br>4. PROJECT[col:​train:​name, #3] <br>5. PROJECT[col:​train:​time, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​station] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Chiltern:​col:​station:​local_authority] <br>3. PROJECT[tbl:​train, #2] <br>4. PROJECT[col:​train:​name, #3] <br>5. PROJECT[col:​train:​time, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_3168 | How many different services are provided by all stations? | SELECT count(DISTINCT services) FROM station | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​services, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​services, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3169 | Find the id and local authority of the station with has the highest average high temperature. | SELECT t2.id ,  t2.local_authority FROM weekly_weather AS t1 JOIN station AS t2 ON t1.station_id  =  t2.id GROUP BY t1.station_id ORDER BY avg(high_temperature) DESC LIMIT 1 | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​weekly_weather:​high_temperature, #1] <br>3. GROUP[avg, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​station:​id, #4] <br>6. PROJECT[col:​station:​local_authority, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​weekly_weather:​high_temperature, #1] <br>3. GROUP[avg, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​station:​id, #4] <br>6. PROJECT[col:​station:​local_authority, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_3170 | Find the id and local authority of the station whose maximum precipitation is higher than 50. | SELECT t2.id ,  t2.local_authority FROM weekly_weather AS t1 JOIN station AS t2 ON t1.station_id  =  t2.id GROUP BY t1.station_id HAVING max(t1.precipitation)  >  50 | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​station, #1] <br>3. GROUP[tbl:​station, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​50:​col:​weekly_weather:​precipitation] <br>5. PROJECT[col:​station:​id, #4] <br>6. PROJECT[col:​station:​local_authority, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​station, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​50:​col:​weekly_weather:​precipitation] <br>5. PROJECT[col:​station:​id, #4] <br>6. PROJECT[col:​station:​local_authority, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_3171 | show the lowest low temperature and highest wind speed in miles per hour. | SELECT min(low_temperature) ,  max(wind_speed_mph) FROM weekly_weather | 1. SELECT[col:​weekly_weather:​low_temperature] <br>2. AGGREGATE[min, #1] <br>3. SELECT[col:​weekly_weather:​wind_speed_mph] <br>4. FILTER[#3, col:​weekly_weather:​wind_speed_mph] <br>5. AGGREGATE[max, #4] <br>6. UNION[#2, #5] <br> | 1. SELECT[col:​weekly_weather:​low_temperature] <br>2. AGGREGATE[min, #1] <br>3. SELECT[col:​weekly_weather:​wind_speed_mph] <br>4. COMPARATIVE[#3, #3, col:​weekly_weather:​wind_speed_mph] <br>5. AGGREGATE[max, #4] <br>6. UNION[#2, #5] <br> | + | medium | 
  | SPIDER_train_3172 | Find the origins from which more than 1 train starts. | SELECT origin FROM train GROUP BY origin HAVING count(*)  >  1 | 1. SELECT[col:​train:​origin] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br> | 1. SELECT[col:​train:​origin] <br>2. PROJECT[tbl:​train, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br> | + | easy | 
 ***
 Exec acc: **1.0000**
