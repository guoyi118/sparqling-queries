 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **CLASS** | CLASS_CODE | + |   | 
 | 2 |   | CRS_CODE |   | --> 7 | 
 | 3 |   | CLASS_SECTION |   |   | 
 | 4 |   | CLASS_TIME |   |   | 
 | 5 |   | CLASS_ROOM |   |   | 
 | 6 |   | PROF_NUM |   | --> 17 | 
 | 7 | **COURSE** | CRS_CODE | + |   | 
 | 8 |   | DEPT_CODE |   | --> 11 | 
 | 9 |   | CRS_DESCRIPTION |   |   | 
 | 10 |   | CRS_CREDIT |   |   | 
 | 11 | **DEPARTMENT** | DEPT_CODE | + |   | 
 | 12 |   | DEPT_NAME |   |   | 
 | 13 |   | SCHOOL_CODE |   |   | 
 | 14 |   | EMP_NUM |   | --> 17 | 
 | 15 |   | DEPT_ADDRESS |   |   | 
 | 16 |   | DEPT_EXTENSION |   |   | 
 | 17 | **EMPLOYEE** | EMP_NUM | + |   | 
 | 18 |   | EMP_LNAME |   |   | 
 | 19 |   | EMP_FNAME |   |   | 
 | 20 |   | EMP_INITIAL |   |   | 
 | 21 |   | EMP_JOBCODE |   |   | 
 | 22 |   | EMP_HIREDATE |   |   | 
 | 23 |   | EMP_DOB |   |   | 
 | 24 | **ENROLL** | CLASS_CODE |   | --> 1 | 
 | 25 |   | STU_NUM |   | --> 32 | 
 | 26 |   | ENROLL_GRADE |   |   | 
 | 27 | **PROFESSOR** | EMP_NUM |   | --> 17 | 
 | 28 |   | DEPT_CODE |   | --> 11 | 
 | 29 |   | PROF_OFFICE |   |   | 
 | 30 |   | PROF_EXTENSION |   |   | 
 | 31 |   | PROF_HIGH_DEGREE |   |   | 
 | 32 | **STUDENT** | STU_NUM | + |   | 
 | 33 |   | STU_LNAME |   |   | 
 | 34 |   | STU_FNAME |   |   | 
 | 35 |   | STU_INIT |   |   | 
 | 36 |   | STU_DOB |   |   | 
 | 37 |   | STU_HRS |   |   | 
 | 38 |   | STU_CLASS |   |   | 
 | 39 |   | STU_GPA |   |   | 
 | 40 |   | STU_TRANSFER |   |   | 
 | 41 |   | DEPT_CODE |   | --> 11 | 
 | 42 |   | STU_PHONE |   |   | 
 | 43 |   | PROF_NUM |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_3173 | Find the number of professors in accounting department. | SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE DEPT_NAME  =  "Accounting" | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_3174 | How many professors are in the accounting dept? | SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE DEPT_NAME  =  "Accounting" | 1. SELECT[tbl:​PROFESSOR] <br>2. FILTER[#1, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_3176 | How many professors teach a class with the code ACCT-211? | SELECT count(DISTINCT PROF_NUM) FROM CLASS WHERE CRS_CODE  =  "ACCT-211" | 1. SELECT[col:​CLASS:​PROF_NUM] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. PROJECT[col:​CLASS:​CRS_CODE, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​ACCT-211:​col:​CLASS:​CRS_CODE] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[col:​CLASS:​PROF_NUM] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. PROJECT[col:​CLASS:​CRS_CODE, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​ACCT-211:​col:​CLASS:​CRS_CODE] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
  | SPIDER_train_3177 | What is the first and last name of the professor in biology department? | SELECT T3.EMP_FNAME ,  T3.EMP_LNAME FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code JOIN employee AS T3 ON T1.EMP_NUM  =  T3.EMP_NUM WHERE DEPT_NAME  =  "Biology" | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Biology:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Biology:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_3183 | What is the code of the school where the accounting department belongs to? | SELECT school_code FROM department WHERE dept_name  =  "Accounting" | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​DEPARTMENT:​SCHOOL_CODE, #3] <br> | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​DEPARTMENT:​SCHOOL_CODE, #3] <br> | + | easy | 
  | SPIDER_train_3184 | What is the school code of the accounting department? | SELECT school_code FROM department WHERE dept_name  =  "Accounting" | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br> | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br> | + | easy | 
  | SPIDER_train_3185 | How many credits does course CIS-220 have, and what its description? | SELECT crs_credit ,  crs_description FROM course WHERE crs_code  =  'CIS-220' | 1. SELECT[val:​COURSE:​CRS_CODE:​CIS-220] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[val:​COURSE:​CRS_CODE:​CIS-220] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_3186 | What is the description for the CIS-220 and how many credits does it have? | SELECT crs_credit ,  crs_description FROM course WHERE crs_code  =  'CIS-220' | 1. SELECT[val:​COURSE:​CRS_CODE:​CIS-220] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #1] <br>4. AGGREGATE[col:​COURSE:​CRS_DESCRIPTION, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[val:​COURSE:​CRS_CODE:​CIS-220] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #1] <br>4. AGGREGATE[sum, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_3187 | what is the address of history department? | SELECT dept_address FROM department WHERE dept_name  =  'History' | 1. SELECT[val:​DEPARTMENT:​DEPT_NAME:​History] <br>2. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #1] <br> | 1. SELECT[val:​DEPARTMENT:​DEPT_NAME:​History] <br>2. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #1] <br> | + | easy | 
  | SPIDER_train_3188 | Where is the history department? | SELECT dept_address FROM department WHERE dept_name  =  'History' | 1. SELECT[tbl:​DEPARTMENT] <br>2. FILTER[#1, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>3. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #2] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. COMPARATIVE[#1, #1, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>3. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #2] <br> | + | easy | 
  | SPIDER_train_3189 | How many different locations does the school with code BUS has? | SELECT count(DISTINCT dept_address) FROM department WHERE school_code  =  'BUS' | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[col:​DEPARTMENT:​SCHOOL_CODE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​BUS:​col:​DEPARTMENT:​SCHOOL_CODE] <br>4. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #3] <br>5.*(distinct)* PROJECT[different #REF, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[col:​DEPARTMENT:​SCHOOL_CODE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​BUS:​col:​DEPARTMENT:​SCHOOL_CODE] <br>4. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #3] <br>5.*(distinct)* PROJECT[None, #4] <br>6. AGGREGATE[count, #5] <br> | + | easy | 
  | SPIDER_train_3194 | What is the course description and number of credits for QM-261? | SELECT crs_credit ,  crs_description FROM course WHERE crs_code  =  'QM-261' | 1. SELECT[val:​COURSE:​CRS_CODE:​QM-261] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #1] <br>4. GROUP[col:​COURSE:​CRS_DESCRIPTION, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[val:​COURSE:​CRS_CODE:​QM-261] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #1] <br>4. GROUP[sum, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_3213 | Which school has the smallest amount of professors? | SELECT T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code ORDER BY count(*) LIMIT 1 | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_3214 | Which school has the fewest professors? | SELECT T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code ORDER BY count(*) LIMIT 1 | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​min:​None] <br> | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_3225 | how many schools exist in total? | SELECT count(DISTINCT school_code) FROM department | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3226 | How many schools are there in the department? | SELECT count(DISTINCT school_code) FROM department | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. FILTER[#1, tbl:​DEPARTMENT] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​DEPARTMENT:​SCHOOL_CODE] <br>2. COMPARATIVE[#1, #1, tbl:​DEPARTMENT] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3227 | How many different classes are there? | SELECT count(DISTINCT class_code) FROM CLASS | 1. SELECT[col:​CLASS:​CLASS_CODE] <br>2.*(distinct)* PROJECT[different #REF, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​CLASS:​CLASS_CODE] <br>2.*(distinct)* PROJECT[None, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3228 | How many unique classes are offered? | SELECT count(DISTINCT class_code) FROM CLASS | 1. SELECT[tbl:​CLASS] <br>2. PROJECT[col:​CLASS:​CLASS_CODE, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​CLASS] <br>2. PROJECT[col:​CLASS:​CLASS_CODE, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3229 | How many courses are offered? | SELECT count(DISTINCT crs_code) FROM CLASS | 1. SELECT[col:​CLASS:​CRS_CODE] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[col:​CLASS:​CRS_CODE] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3230 | What are the number of different course codes? | SELECT count(DISTINCT crs_code) FROM CLASS | 1. SELECT[col:​CLASS:​CRS_CODE] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[col:​CLASS:​CRS_CODE] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3232 | How many different departments are there? | SELECT count(DISTINCT dept_name) FROM department | 1. SELECT[col:​DEPARTMENT:​DEPT_NAME] <br>2.*(distinct)* PROJECT[different #REF, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[col:​DEPARTMENT:​DEPT_NAME] <br>2.*(distinct)* PROJECT[None, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3233 | How many courses are offered by the Computer Info. Systems department? | SELECT count(*) FROM department AS T1 JOIN course AS T2 ON T1.dept_code  =  T2.dept_code WHERE dept_name  =  "Computer Info. Systems" | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​COURSE, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​COURSE, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_3234 | How many courses does the department of Computer Information Systmes offer? | SELECT count(*) FROM department AS T1 JOIN course AS T2 ON T1.dept_code  =  T2.dept_code WHERE dept_name  =  "Computer Info. Systems" | 1. SELECT[tbl:​COURSE] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​COURSE] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_3236 | What is the number of different class sections offered in the course ACCT-211? | SELECT count(DISTINCT class_section) FROM CLASS WHERE crs_code  =  'ACCT-211' | 1. SELECT[val:​CLASS:​CRS_CODE:​ACCT-211] <br>2. PROJECT[col:​CLASS:​CLASS_SECTION, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[val:​COURSE:​CRS_CODE:​ACCT-211] <br>2. PROJECT[col:​CLASS:​CLASS_SECTION, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3239 | Find the name of the department that offers the largest number of credits of all classes. | SELECT T3.dept_name FROM course AS T1 JOIN CLASS AS T2 ON T1.crs_code  =  T2.crs_code JOIN department AS T3 ON T1.dept_code  =  T3.dept_code GROUP BY T1.dept_code ORDER BY sum(T1.crs_credit) DESC LIMIT 1 | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. PROJECT[col:​COURSE:​CRS_CREDIT, #2] <br>4. GROUP[col:​COURSE:​CRS_CREDIT, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #5] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. PROJECT[col:​COURSE:​CRS_CREDIT, #2] <br>4. GROUP[sum, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #5] <br> | + | extra | 
  | SPIDER_train_3240 | Which department offers the most credits all together? | SELECT T3.dept_name FROM course AS T1 JOIN CLASS AS T2 ON T1.crs_code  =  T2.crs_code JOIN department AS T3 ON T1.dept_code  =  T3.dept_code GROUP BY T1.dept_code ORDER BY sum(T1.crs_credit) DESC LIMIT 1 | 1. SELECT[col:​DEPARTMENT:​DEPT_NAME] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​DEPARTMENT:​DEPT_NAME] <br>2. PROJECT[col:​COURSE:​CRS_CREDIT, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_3241 | How many students enrolled in class ACCT-211? | SELECT count(*) FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code WHERE T1.crs_code  =  'ACCT-211' | 1. SELECT[tbl:​CLASS] <br>2. PROJECT[tbl:​ENROLL, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​ACCT-211:​col:​CLASS:​CRS_CODE] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​CLASS] <br>2. PROJECT[tbl:​ENROLL, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​ACCT-211:​col:​CLASS:​CRS_CODE] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_3243 | What is the first name of each student enrolled in class ACCT-211? | SELECT T3.stu_fname FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN student AS T3 ON T2.stu_num  =  T3.stu_num WHERE T1.crs_code  =  'ACCT-211' | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​ACCT-211:​col:​CLASS:​CRS_CODE] <br>4. PROJECT[col:​STUDENT:​STU_FNAME, #3] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​ACCT-211:​col:​CLASS:​CRS_CODE] <br>4. PROJECT[col:​STUDENT:​STU_FNAME, #3] <br> | + | hard | 
  | SPIDER_train_3247 | Find the total number of employees. | SELECT count(*) FROM employee | 1. SELECT[tbl:​EMPLOYEE] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​EMPLOYEE] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3248 | How many employees are there all together? | SELECT count(*) FROM employee | 1. SELECT[tbl:​EMPLOYEE] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​EMPLOYEE] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_3249 | How many professors do have a Ph.D. degree? | SELECT count(*) FROM professor WHERE prof_high_degree  =  'Ph.D.' | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_HIGH_DEGREE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_HIGH_DEGREE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_3250 | What is the total number of professors with a Ph.D. ? | SELECT count(*) FROM professor WHERE prof_high_degree  =  'Ph.D.' | 1. SELECT[tbl:​PROFESSOR] <br>2. FILTER[#1, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_3251 | How many students are enrolled in the class taught by some professor from the accounting department? | SELECT count(*) FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN course AS T3 ON T1.crs_code  =  T3.crs_code JOIN department AS T4 ON T3.dept_code  =  T4.dept_code WHERE T4.dept_name  =  'Accounting' | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[professors of #REF, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​ENROLL:​CLASS_CODE, #3] <br>5. PROJECT[students of #REF, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[None, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​ENROLL:​CLASS_CODE, #3] <br>5. PROJECT[None, #4] <br>6. AGGREGATE[count, #5] <br> | + | extra | 
  | SPIDER_train_3255 | list names of all departments ordered by their names. | SELECT dept_name FROM department ORDER BY dept_name | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #1] <br>3. SORT[#2, #2] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3256 | What are the names of all departments in alphabetical order? | SELECT dept_name FROM department ORDER BY dept_name | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_3261 | Find the first names and offices of all professors sorted by alphabetical order of their first name. | SELECT T2.emp_fname ,  T1.prof_office FROM professor AS T1 JOIN employee AS T2 ON T1.emp_num  =  T2.emp_num ORDER BY T2.emp_fname | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #1] <br>3. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #1] <br>3. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_3264 | What are the first and last names of the employee with the earliest date of birth? | SELECT emp_fname ,  emp_lname FROM employee ORDER BY emp_dob LIMIT 1 | 1. SELECT[tbl:​EMPLOYEE] <br>2. PROJECT[col:​EMPLOYEE:​EMP_DOB, #1] <br>3. COMPARATIVE[#1, #2, comparative:​min:​None] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​EMPLOYEE] <br>2. PROJECT[col:​EMPLOYEE:​EMP_DOB, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3267 | What is the first name of students who got grade C in any class? | SELECT DISTINCT stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num WHERE enroll_grade  =  'C' | 1. SELECT[tbl:​STUDENT] <br>2. FILTER[#1, comparative:​=:​C:​col:​ENROLL:​ENROLL_GRADE] <br>3. PROJECT[col:​STUDENT:​STU_FNAME, #2] <br> | 1. SELECT[tbl:​STUDENT] <br>2. COMPARATIVE[#1, #1, comparative:​=:​C:​col:​ENROLL:​ENROLL_GRADE] <br>3. PROJECT[col:​STUDENT:​STU_FNAME, #2] <br> | + | medium | 
  | SPIDER_train_3268 | What are the first names of all students who got a grade C in a class? | SELECT DISTINCT stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num WHERE enroll_grade  =  'C' | 1. SELECT[tbl:​STUDENT] <br>2. FILTER[#1, comparative:​=:​C:​col:​ENROLL:​ENROLL_GRADE] <br>3. PROJECT[col:​STUDENT:​STU_FNAME, #2] <br> | 1. SELECT[tbl:​STUDENT] <br>2. COMPARATIVE[#1, #1, comparative:​=:​C:​col:​ENROLL:​ENROLL_GRADE] <br>3. PROJECT[col:​STUDENT:​STU_FNAME, #2] <br> | + | medium | 
  | SPIDER_train_3269 | What is the name of department where has the smallest number of professors? | SELECT T2.dept_name FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY count(*) LIMIT 1 | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | + | extra | 
  | SPIDER_train_3270 | What is the name of the department with the fewest professors? | SELECT T2.dept_name FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY count(*) LIMIT 1 | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​PROFESSOR, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | + | extra | 
  | SPIDER_train_3277 | What is the last name and office of the professor from the history department? | SELECT T1.emp_lname ,  T2.prof_office FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num JOIN department AS T3 ON T2.dept_code  =  T3.dept_code WHERE T3.dept_name  =  'History' | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>5. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>4. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>5. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_3279 | What is department name and office for the professor whose last name is Heffington? | SELECT T3.dept_name  ,  T2.prof_office FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num JOIN department AS T3 ON T2.dept_code  =  T3.dept_code WHERE T1.emp_lname  =  'Heffington' | 1. SELECT[tbl:​PROFESSOR] <br>2. FILTER[#1, comparative:​=:​Heffington:​col:​EMPLOYEE:​EMP_LNAME] <br>3. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #2] <br>4. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Heffington:​col:​EMPLOYEE:​EMP_LNAME] <br>3. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #2] <br>4. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #2] <br>5. UNION[#3, #4] <br> | + | hard | 
  | SPIDER_train_3281 | Find the last name and hire date of the professor who is in office DRE 102. | SELECT T1.emp_lname ,  T1.emp_hiredate FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num WHERE T2.prof_office  =  'DRE 102' | 1. SELECT[tbl:​PROFESSOR] <br>2. FILTER[#1, comparative:​=:​DRE 102:​col:​PROFESSOR:​PROF_OFFICE] <br>3. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #2] <br>4. PROJECT[col:​EMPLOYEE:​EMP_HIREDATE, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. COMPARATIVE[#1, #1, comparative:​=:​DRE 102:​col:​PROFESSOR:​PROF_OFFICE] <br>3. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #2] <br>4. PROJECT[col:​EMPLOYEE:​EMP_HIREDATE, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3282 | What is the last name of the professor whose office is located in DRE 102, and when were they hired? | SELECT T1.emp_lname ,  T1.emp_hiredate FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num WHERE T2.prof_office  =  'DRE 102' | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​DRE 102:​col:​PROFESSOR:​PROF_OFFICE] <br>4. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>5. PROJECT[col:​EMPLOYEE:​EMP_HIREDATE, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​DRE 102:​col:​PROFESSOR:​PROF_OFFICE] <br>4. PROJECT[col:​EMPLOYEE:​EMP_LNAME, #3] <br>5. PROJECT[col:​EMPLOYEE:​EMP_HIREDATE, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_3283 | What is the code of the course which the student whose last name is Smithson took? | SELECT T1.crs_code FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN student AS T3 ON T3.stu_num  =  T2.stu_num WHERE T3.stu_lname  =  'Smithson' | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_LNAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Smithson:​col:​STUDENT:​STU_LNAME] <br>4. PROJECT[tbl:​ENROLL, #3] <br>5. PROJECT[col:​CLASS:​CRS_CODE, #4] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_LNAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Smithson:​col:​STUDENT:​STU_LNAME] <br>4. PROJECT[tbl:​ENROLL, #3] <br>5. PROJECT[col:​CLASS:​CRS_CODE, #4] <br> | + | hard | 
  | SPIDER_train_3284 | What are the course codes for every class that the student with the last name Smithson took? | SELECT T1.crs_code FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN student AS T3 ON T3.stu_num  =  T2.stu_num WHERE T3.stu_lname  =  'Smithson' | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_LNAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Smithson:​col:​STUDENT:​STU_LNAME] <br>4. PROJECT[tbl:​CLASS, #3] <br>5. PROJECT[col:​CLASS:​CRS_CODE, #4] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_LNAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Smithson:​col:​STUDENT:​STU_LNAME] <br>4. PROJECT[tbl:​CLASS, #3] <br>5. PROJECT[col:​CLASS:​CRS_CODE, #4] <br> | + | hard | 
  | SPIDER_train_3285 | What are the description and credit of the course which the student whose last name is Smithson took? | SELECT T4.crs_description ,  T4.crs_credit FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN student AS T3 ON T3.stu_num  =  T2.stu_num JOIN course AS T4 ON T4.crs_code  =  T1.crs_code WHERE T3.stu_lname  =  'Smithson' | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_LNAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Smithson:​col:​STUDENT:​STU_LNAME] <br>4. PROJECT[tbl:​ENROLL, #3] <br>5. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #4] <br>6. PROJECT[col:​COURSE:​CRS_CREDIT, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_LNAME, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Smithson:​col:​STUDENT:​STU_LNAME] <br>4. PROJECT[tbl:​ENROLL, #3] <br>5. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #4] <br>6. PROJECT[col:​COURSE:​CRS_CREDIT, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_3287 | How many professors who has a either Ph.D. or MA degree? | SELECT count(*) FROM professor WHERE prof_high_degree  =  'Ph.D.' OR prof_high_degree  =  'MA' | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_HIGH_DEGREE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. COMPARATIVE[#1, #2, comparative:​=:​MA:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_HIGH_DEGREE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. COMPARATIVE[#1, #2, comparative:​=:​MA:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | + | medium | 
  | SPIDER_train_3288 | How many professors attained either Ph.D. or Masters degrees? | SELECT count(*) FROM professor WHERE prof_high_degree  =  'Ph.D.' OR prof_high_degree  =  'MA' | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_HIGH_DEGREE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. COMPARATIVE[#1, #2, comparative:​=:​MA:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[col:​PROFESSOR:​PROF_HIGH_DEGREE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. COMPARATIVE[#1, #2, comparative:​=:​MA:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | + | medium | 
  | SPIDER_train_3289 | How many professors who are from either Accounting or Biology department? | SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE T2.dept_name  =  'Accounting' OR T2.dept_name  =  'Biology' | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Biology:​col:​DEPARTMENT:​DEPT_NAME] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Biology:​col:​DEPARTMENT:​DEPT_NAME] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | + | hard | 
  | SPIDER_train_3293 | Find the first name of student who is taking classes from accounting and Computer Info. Systems departments | SELECT T1.stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num JOIN CLASS AS T3 ON T2.class_code  =  T3.class_code JOIN course AS T4 ON T3.crs_code  =  T4.crs_code JOIN department AS T5 ON T5.dept_code  =  T4.dept_code WHERE T5.dept_name  =  'Accounting' INTERSECT SELECT T1.stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num JOIN CLASS AS T3 ON T2.class_code  =  T3.class_code JOIN course AS T4 ON T3.crs_code  =  T4.crs_code JOIN department AS T5 ON T5.dept_code  =  T4.dept_code WHERE T5.dept_name  =  'Computer Info. Systems' | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. PROJECT[tbl:​DEPARTMENT, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​STUDENT:​STU_FNAME, #6] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. PROJECT[tbl:​DEPARTMENT, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​STUDENT:​STU_FNAME, #6] <br> | + | extra | 
  | SPIDER_train_3294 | What are the first names of all students taking accoutning and Computer Information Systems classes? | SELECT T1.stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num JOIN CLASS AS T3 ON T2.class_code  =  T3.class_code JOIN course AS T4 ON T3.crs_code  =  T4.crs_code JOIN department AS T5 ON T5.dept_code  =  T4.dept_code WHERE T5.dept_name  =  'Accounting' INTERSECT SELECT T1.stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num JOIN CLASS AS T3 ON T2.class_code  =  T3.class_code JOIN course AS T4 ON T3.crs_code  =  T4.crs_code JOIN department AS T5 ON T5.dept_code  =  T4.dept_code WHERE T5.dept_name  =  'Computer Info. Systems' | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​STUDENT:​STU_FNAME, #5] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Computer Info. Systems:​col:​DEPARTMENT:​DEPT_NAME] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​STUDENT:​STU_FNAME, #5] <br> | + | extra | 
  | SPIDER_train_3301 | Find the first name and gpa of the students whose gpa is lower than the average gpa of all students. | SELECT stu_fname ,  stu_gpa FROM student WHERE stu_gpa  <  (SELECT avg(stu_gpa) FROM student) | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_GPA, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br>6. PROJECT[col:​STUDENT:​STU_GPA, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_GPA, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​ECON/FIN:​col:​PROFESSOR:​DEPT_CODE] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br>6. PROJECT[col:​STUDENT:​STU_GPA, #4] <br>7. UNION[#5, #6] <br> | - | extra | 
  | SPIDER_train_3302 | What is the first name and GPA of every student that has a GPA lower than average? | SELECT stu_fname ,  stu_gpa FROM student WHERE stu_gpa  <  (SELECT avg(stu_gpa) FROM student) | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_GPA, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​#3] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br>6. PROJECT[col:​STUDENT:​STU_GPA, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[col:​STUDENT:​STU_GPA, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​<:​Brewer:​col:​STUDENT:​STU_LNAME] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br>6. PROJECT[col:​STUDENT:​STU_GPA, #4] <br>7. UNION[#5, #6] <br> | - | extra | 
  | SPIDER_train_3303 | Find the name and address of the department that has the highest number of students. | SELECT T2.dept_name ,  T2.dept_address FROM student AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​STUDENT, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br>6. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​STUDENT, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br>6. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_3304 | What is the name and address of the department with the most students? | SELECT T2.dept_name ,  T2.dept_address FROM student AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​STUDENT, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br>6. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​STUDENT, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br>6. PROJECT[col:​DEPARTMENT:​DEPT_ADDRESS, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_3307 | Find the first name and office of the professor who is in the history department and has a Ph.D. degree. | SELECT T1.emp_fname ,  T2.prof_office FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num JOIN department AS T3 ON T3.dept_code  =  T2.dept_code WHERE T3.dept_name  =  'History' AND T2.prof_high_degree  =  'Ph.D.' | 1. SELECT[tbl:​PROFESSOR] <br>2. FILTER[#1, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>3. FILTER[#2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. COMPARATIVE[#1, #1, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_3308 | What are the first names and office of the professors who are in the history department and have a Ph.D? | SELECT T1.emp_fname ,  T2.prof_office FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num JOIN department AS T3 ON T3.dept_code  =  T2.dept_code WHERE T3.dept_name  =  'History' AND T2.prof_high_degree  =  'Ph.D.' | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>4. FILTER[#3, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>5. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #4] <br>6. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. PROJECT[tbl:​DEPARTMENT, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>4. COMPARATIVE[#3, #3, comparative:​=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>5. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #4] <br>6. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_3309 | Find the first names of all instructors who have taught some course and the course code. | SELECT T2.emp_fname ,  T1.crs_code FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num | 1. SELECT[col:​CLASS:​CRS_CODE] <br>2. PROJECT[tbl:​EMPLOYEE, #1] <br>3. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #2] <br>4. PROJECT[col:​CLASS:​CRS_CODE, #1] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​CLASS:​CRS_CODE] <br>2. PROJECT[tbl:​EMPLOYEE, #1] <br>3. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #2] <br>4. PROJECT[col:​CLASS:​CRS_CODE, #1] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_3310 | What are the first names of all teachers who have taught a course and the corresponding course codes? | SELECT T2.emp_fname ,  T1.crs_code FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num | 1. SELECT[tbl:​EMPLOYEE] <br>2. PROJECT[col:​CLASS:​CRS_CODE, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, is at least one] <br>5. PROJECT[col:​CLASS:​CRS_CODE, #4] <br>6. PROJECT[col:​CLASS:​CRS_CODE, #5] <br>7. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #4] <br>8. UNION[#7, #6] <br> | 1. SELECT[tbl:​EMPLOYEE] <br>2. PROJECT[col:​CLASS:​CRS_CODE, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, None] <br>5. PROJECT[col:​CLASS:​CRS_CODE, #4] <br>6. PROJECT[col:​CLASS:​CRS_CODE, #5] <br>7. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #4] <br>8. UNION[#7, #6] <br> | + | medium | 
  | SPIDER_train_3312 | What are the first names of all teachers who have taught a course and the corresponding descriptions? | SELECT T2.emp_fname ,  T3.crs_description FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num JOIN course AS T3 ON T1.crs_code  =  T3.crs_code | 1. SELECT[tbl:​EMPLOYEE] <br>2. FILTER[#1, tbl:​COURSE] <br>3. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #2] <br>4. PROJECT[tbl:​COURSE, #2] <br>5. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #4] <br>6. UNION[#3, #5] <br> | 1. SELECT[tbl:​EMPLOYEE] <br>2. COMPARATIVE[#1, #1, tbl:​COURSE] <br>3. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #2] <br>4. PROJECT[tbl:​COURSE, #2] <br>5. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #4] <br>6. UNION[#3, #5] <br> | + | medium | 
  | SPIDER_train_3322 | What are the first names of all Accounting professors who teach and what are the classrooms of the courses they teach? | SELECT T2.emp_fname ,  T1.class_room FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num JOIN professor AS T3 ON T2.emp_num  =  T3.emp_num JOIN department AS T4 ON T4.dept_code  =  T3.dept_code WHERE T4.dept_name  =  'Accounting' | 1. SELECT[tbl:​PROFESSOR] <br>2. FILTER[#1, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>3. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #2] <br>4. PROJECT[courses #REF teach, #2] <br>5. PROJECT[col:​CLASS:​CLASS_ROOM, #4] <br>6. UNION[#3, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Accounting:​col:​DEPARTMENT:​DEPT_NAME] <br>3. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #2] <br>4. PROJECT[None, #2] <br>5. PROJECT[col:​CLASS:​CLASS_ROOM, #4] <br>6. UNION[#3, #5] <br> | + | extra | 
  | SPIDER_train_3325 | What is the last name of the student who got a grade A in the class with code 10018. | SELECT T1.stu_lname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num WHERE T2.enroll_grade  =  'A' AND T2.class_code  =  10018 | 1. SELECT[col:​ENROLL:​CLASS_CODE] <br>2. PROJECT[col:​ENROLL:​CLASS_CODE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​10018:​col:​ENROLL:​CLASS_CODE] <br>4. PROJECT[tbl:​STUDENT, #3] <br>5. PROJECT[col:​ENROLL:​ENROLL_GRADE, #4] <br>6. COMPARATIVE[#4, #5, comparative:​=:​A:​col:​ENROLL:​ENROLL_GRADE] <br>7. PROJECT[col:​STUDENT:​STU_LNAME, #6] <br> | 1. SELECT[col:​ENROLL:​CLASS_CODE] <br>2. PROJECT[col:​ENROLL:​CLASS_CODE, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​10018:​col:​ENROLL:​CLASS_CODE] <br>4. PROJECT[tbl:​STUDENT, #3] <br>5. PROJECT[col:​ENROLL:​ENROLL_GRADE, #4] <br>6. COMPARATIVE[#4, #5, comparative:​=:​A:​col:​ENROLL:​ENROLL_GRADE] <br>7. PROJECT[col:​STUDENT:​STU_LNAME, #6] <br> | + | medium | 
  | SPIDER_train_3326 | What is the last name of the student who received an A in the class with the code 10018? | SELECT T1.stu_lname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num WHERE T2.enroll_grade  =  'A' AND T2.class_code  =  10018 | 1. SELECT[col:​ENROLL:​CLASS_CODE] <br>2. FILTER[#1, comparative:​=:​10018:​col:​ENROLL:​CLASS_CODE] <br>3. PROJECT[tbl:​STUDENT, #2] <br>4. FILTER[#3, comparative:​=:​A:​col:​ENROLL:​ENROLL_GRADE] <br>5. PROJECT[col:​STUDENT:​STU_LNAME, #4] <br> | 1. SELECT[col:​ENROLL:​CLASS_CODE] <br>2. COMPARATIVE[#1, #1, comparative:​=:​10018:​col:​ENROLL:​CLASS_CODE] <br>3. PROJECT[tbl:​STUDENT, #2] <br>4. COMPARATIVE[#3, #3, comparative:​=:​A:​col:​ENROLL:​ENROLL_GRADE] <br>5. PROJECT[col:​STUDENT:​STU_LNAME, #4] <br> | + | medium | 
  | SPIDER_train_3327 | Find the first name and office of history professor who did not get a Ph.D. degree. | SELECT T2.emp_fname ,  T1.prof_office FROM professor AS T1 JOIN employee AS T2 ON T1.emp_num  =  T2.emp_num JOIN department AS T3 ON T1.dept_code  =  T3.dept_code WHERE T3.dept_name  =  'History' AND T1.prof_high_degree != 'Ph.D.' | 1. SELECT[tbl:​PROFESSOR] <br>2. FILTER[#1, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>3. FILTER[#2, comparative:​!=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​PROFESSOR] <br>2. COMPARATIVE[#1, #1, comparative:​=:​History:​col:​DEPARTMENT:​DEPT_NAME] <br>3. COMPARATIVE[#2, #2, comparative:​!=:​Ph.D.:​col:​PROFESSOR:​PROF_HIGH_DEGREE] <br>4. PROJECT[col:​EMPLOYEE:​EMP_FNAME, #3] <br>5. PROJECT[col:​PROFESSOR:​PROF_OFFICE, #3] <br>6. UNION[#4, #5] <br> | + | hard | 
  | SPIDER_train_3331 | Find the first names of students who took exactly one class. | SELECT T1.stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num GROUP BY T2.stu_num HAVING count(*)  =  1 | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​CLASS, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br> | + | medium | 
  | SPIDER_train_3332 | What are the first names of student who only took one course? | SELECT T1.stu_fname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num GROUP BY T2.stu_num HAVING count(*)  =  1 | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​COURSE, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br> | 1. SELECT[tbl:​STUDENT] <br>2. PROJECT[tbl:​COURSE, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1] <br>5. PROJECT[col:​STUDENT:​STU_FNAME, #4] <br> | + | medium | 
  | SPIDER_train_3333 | Find the name of department that offers the class whose description has the word "Statistics". | SELECT T2.dept_name FROM course AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE T1.crs_description LIKE '%Statistics%' | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[classes of #REF, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #2] <br>4. COMPARATIVE[#1, #3, comparative:​like:​%Statistics%:​col:​COURSE:​CRS_DESCRIPTION] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[None, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #2] <br>4. COMPARATIVE[#1, #3, comparative:​like:​Statistics:​col:​COURSE:​CRS_DESCRIPTION] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | + | hard | 
  | SPIDER_train_3334 | What is the name of the department that offers a course that has a description including the word "Statistics"? | SELECT T2.dept_name FROM course AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE T1.crs_description LIKE '%Statistics%' | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​COURSE, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #2] <br>4. COMPARATIVE[#1, #3, comparative:​like:​%Statistics%:​col:​COURSE:​CRS_DESCRIPTION] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | 1. SELECT[tbl:​DEPARTMENT] <br>2. PROJECT[tbl:​COURSE, #1] <br>3. PROJECT[col:​COURSE:​CRS_DESCRIPTION, #2] <br>4. COMPARATIVE[#1, #3, comparative:​like:​Statistics:​col:​COURSE:​CRS_DESCRIPTION] <br>5. PROJECT[col:​DEPARTMENT:​DEPT_NAME, #4] <br> | + | hard | 
 ***
 Exec acc: **0.9714**
