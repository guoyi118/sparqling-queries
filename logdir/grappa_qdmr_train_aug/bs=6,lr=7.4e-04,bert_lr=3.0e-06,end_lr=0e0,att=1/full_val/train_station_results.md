 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **station** | Station_ID | + |   | 
 | 2 |   | Name |   |   | 
 | 3 |   | Annual_entry_exit |   |   | 
 | 4 |   | Annual_interchanges |   |   | 
 | 5 |   | Total_Passengers |   |   | 
 | 6 |   | Location |   |   | 
 | 7 |   | Main_Services |   |   | 
 | 8 |   | Number_of_Platforms |   |   | 
 | 9 | **train** | Train_ID | + |   | 
 | 10 |   | Name |   |   | 
 | 11 |   | Time |   |   | 
 | 12 |   | Service |   |   | 
 | 13 | **train_station** | Train_ID | + | --> 9 | 
 | 14 |   | Station_ID |   | --> 1 | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6599 | How many train stations are there? | SELECT count(*) FROM station | 1. SELECT[tbl:​station] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​station] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6600 | Show the name, location, and number of platforms for all stations. | SELECT name ,  LOCATION ,  number_of_platforms FROM station | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[col:​station:​Location, #1] <br>4. PROJECT[col:​station:​Number_of_Platforms, #1] <br>5. GROUP[col:​station:​Number_of_Platforms, #4, #1] <br>6. UNION[#2, #3, #5] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[col:​station:​Location, #1] <br>4. PROJECT[col:​station:​Number_of_Platforms, #1] <br>5. GROUP[sum, #4, #1] <br>6. UNION[#2, #3, #5] <br> | + | medium | 
  | SPIDER_train_6601 | What are all locations of train stations? | SELECT DISTINCT LOCATION FROM station | 1. SELECT[col:​station:​Location] <br>2. PROJECT[col:​station:​Location, #1] <br> | 1. SELECT[col:​station:​Location] <br>2. PROJECT[col:​station:​Location, #1] <br> | + | easy | 
  | SPIDER_train_6604 | What is the average and maximum number of total passengers for train stations in London or Glasgow? | SELECT avg(total_passengers) ,  max(total_passengers) FROM station WHERE LOCATION  =  'London' OR LOCATION  =  'Glasgow' | 1. SELECT[tbl:​station] <br>2. FILTER[#1, comparative:​=:​London:​col:​station:​Location] <br>3. FILTER[#1, comparative:​=:​Glasgow:​col:​station:​Location] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​station:​Total_Passengers, #4] <br>6. GROUP[col:​station:​Total_Passengers, #5, #4] <br>7. AGGREGATE[avg, #6] <br>8. AGGREGATE[max, #6] <br>9. UNION[#7, #8] <br> | 1. SELECT[tbl:​station] <br>2. COMPARATIVE[#1, #1, comparative:​=:​London:​col:​station:​Location] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Glasgow:​col:​station:​Location] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​station:​Total_Passengers, #4] <br>6. GROUP[sum, #5, #4] <br>7. AGGREGATE[avg, #6] <br>8. AGGREGATE[max, #6] <br>9. UNION[#7, #8] <br> | + | hard | 
  | SPIDER_train_6606 | Show all locations that have train stations with at least 15 platforms and train stations with more than 25 total passengers. | SELECT DISTINCT LOCATION FROM station WHERE number_of_platforms  >=  15 AND total_passengers  >  25 | 1. SELECT[col:​station:​Location] <br>2. PROJECT[col:​station:​Number_of_Platforms, #1] <br>3. GROUP[col:​station:​Number_of_Platforms, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​15:​col:​station:​Number_of_Platforms] <br>5. PROJECT[col:​station:​Total_Passengers, #1] <br>6. GROUP[col:​station:​Total_Passengers, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​25:​col:​station:​Total_Passengers] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​station:​Location, #8] <br> | 1. SELECT[col:​station:​Location] <br>2. PROJECT[col:​station:​Number_of_Platforms, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​15:​col:​station:​Number_of_Platforms] <br>5. PROJECT[col:​station:​Total_Passengers, #1] <br>6. GROUP[sum, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​25:​col:​station:​Total_Passengers] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​station:​Location, #8] <br> | + | medium | 
  | SPIDER_train_6607 | Show all locations which don't have a train station with at least 15 platforms. | SELECT LOCATION FROM station EXCEPT SELECT LOCATION FROM station WHERE number_of_platforms  >=  15 | 1. SELECT[col:​station:​Location] <br>2. FILTER[#1, comparative:​>=:​15:​col:​station:​Number_of_Platforms] <br>3. DISCARD[#1, #2] <br> | 1. SELECT[col:​station:​Location] <br>2. COMPARATIVE[#1, #1, comparative:​>=:​15:​col:​station:​Number_of_Platforms] <br>3. DISCARD[#1, #2] <br> | + | hard | 
  | SPIDER_train_6608 | Show the location with most number of train stations. | SELECT LOCATION FROM station GROUP BY LOCATION ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​station:​Location] <br>2. PROJECT[tbl:​station, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​station:​Location] <br>2. PROJECT[tbl:​station, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6609 | Show the name, time, and service for all trains. | SELECT name ,  TIME ,  service FROM train | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Name, #1] <br>3. PROJECT[col:​train:​Time, #1] <br>4. PROJECT[col:​train:​Service, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Name, #1] <br>3. PROJECT[col:​train:​Time, #1] <br>4. PROJECT[col:​train:​Service, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6610 | Show the number of trains | SELECT count(*) FROM train | 1. SELECT[tbl:​train] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​train] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6611 | Show the name and service for all trains in order by time. | SELECT name ,  service FROM train ORDER BY TIME | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Time, #1] <br>3. SORT[#1, #2] <br>4. PROJECT[col:​train:​Name, #3] <br>5. PROJECT[col:​train:​Service, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​train:​Time, #1] <br>3. SORT[#1, #2, sortdir:​ascending] <br>4. PROJECT[col:​train:​Name, #3] <br>5. PROJECT[col:​train:​Service, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6612 | Show the station name and number of trains in each station. | SELECT T2.name ,  count(*) FROM train_station AS T1 JOIN station AS T2 ON T1.station_id  =  T2.station_id GROUP BY T1.station_id | 1. SELECT[col:​train_station:​Station_ID] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[tbl:​train_station, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​train_station:​Station_ID] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[tbl:​train_station, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_6613 | show the train name and station name for each train. | SELECT T2.name ,  T3.name FROM train_station AS T1 JOIN station AS T2 ON T1.station_id  =  T2.station_id JOIN train AS T3 ON T3.train_id  =  T1.train_id | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[tbl:​station, #1] <br>4. PROJECT[col:​train:​Name, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​train] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[tbl:​station, #1] <br>4. PROJECT[col:​train:​Name, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_6614 | Show all train names and times in stations in London in descending order by train time. | SELECT T3.name ,  T3.time FROM train_station AS T1 JOIN station AS T2 ON T1.station_id  =  T2.station_id JOIN train AS T3 ON T3.train_id  =  T1.train_id WHERE T2.location  =  'London' ORDER BY T3.time DESC | 1. SELECT[tbl:​station] <br>2. FILTER[#1, comparative:​=:​London:​col:​station:​Location] <br>3. PROJECT[tbl:​train, #2] <br>4. PROJECT[col:​train:​Name, #3] <br>5. PROJECT[col:​train:​Time, #3] <br>6. UNION[#4, #5] <br>7. SORT[#6, #5, sortdir:​descending] <br> | 1. SELECT[tbl:​station] <br>2. COMPARATIVE[#1, #1, comparative:​=:​London:​col:​station:​Location] <br>3. PROJECT[tbl:​train, #2] <br>4. PROJECT[col:​train:​Name, #3] <br>5. PROJECT[col:​train:​Time, #3] <br>6. UNION[#4, #5] <br>7. SORT[#6, #5, sortdir:​descending] <br> | + | extra | 
  | SPIDER_train_6615 | Show the station name with greatest number of trains. | SELECT T2.name FROM train_station AS T1 JOIN station AS T2 ON T1.station_id  =  T2.station_id GROUP BY T1.station_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​train_station, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​station:​Name, #4] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​train_station, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​station:​Name, #4] <br> | + | extra | 
  | SPIDER_train_6616 | Show the station name with at least two trains. | SELECT T2.name FROM train_station AS T1 JOIN station AS T2 ON T1.station_id  =  T2.station_id GROUP BY T1.station_id HAVING count(*)  >=  2 | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​train_station, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​station:​Name, #4] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​train_station, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​station:​Name, #4] <br> | + | medium | 
  | SPIDER_train_6617 | Show all locations with only 1 station. | SELECT LOCATION FROM station GROUP BY LOCATION HAVING count(*)  =  1 | 1. SELECT[col:​station:​Location] <br>2. PROJECT[tbl:​station, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1] <br> | 1. SELECT[col:​station:​Location] <br>2. PROJECT[tbl:​station, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1] <br> | + | easy | 
  | SPIDER_train_6619 | What are the names of the stations which serve both "Ananthapuri Express" and "Guruvayur Express" trains? | SELECT T2.name FROM train_station AS T1 JOIN station AS T2 ON T1.station_id  =  T2.station_id JOIN train AS T3 ON T3.train_id  =  T1.train_id WHERE T3.Name  =  "Ananthapuri Express" INTERSECT SELECT T2.name FROM train_station AS T1 JOIN station AS T2 ON T1.station_id  =  T2.station_id JOIN train AS T3 ON T3.train_id  =  T1.train_id WHERE T3.Name  =  "Guruvayur Express" | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​train, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Guruvayur Express:​col:​train:​Name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Ananthapuri Express:​col:​train:​Name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​station:​Name, #5] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[tbl:​train, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Guruvayur Express:​col:​train:​Name] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Ananthapuri Express:​col:​train:​Name] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​station:​Name, #5] <br> | + | extra | 
  | SPIDER_train_6621 | List the names and locations of all stations ordered by their yearly entry exit and interchange amounts. | SELECT name ,  LOCATION FROM station ORDER BY Annual_entry_exit ,  Annual_interchanges | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[col:​station:​Location, #1] <br>4. PROJECT[col:​station:​Annual_entry_exit, #1] <br>5. PROJECT[col:​station:​Annual_entry_exit, #1] <br>6. PROJECT[col:​station:​Annual_interchanges, #1] <br>7. UNION[#2, #3] <br>8. UNION[#4, #5, #6] <br>9. SORT[#7, #8] <br> | 1. SELECT[tbl:​station] <br>2. PROJECT[col:​station:​Name, #1] <br>3. PROJECT[col:​station:​Location, #1] <br>4. PROJECT[col:​station:​Annual_entry_exit, #1] <br>5. PROJECT[col:​station:​Annual_entry_exit, #1] <br>6. PROJECT[col:​station:​Annual_interchanges, #1] <br>7. UNION[#2, #3] <br>8. UNION[#4, #5, #6] <br>9. SORT[#7, #8, sortdir:​ascending] <br> | + | medium | 
 ***
 Exec acc: **1.0000**
