 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **grapes** | ID | + |   | 
 | 2 |   | Grape |   |   | 
 | 3 |   | Color |   |   | 
 | 4 | **appellations** | No | + |   | 
 | 5 |   | Appelation |   |   | 
 | 6 |   | County |   |   | 
 | 7 |   | State |   |   | 
 | 8 |   | Area |   |   | 
 | 9 |   | isAVA |   |   | 
 | 10 | **wine** | No |   |   | 
 | 11 |   | Grape |   | --> 2 | 
 | 12 |   | Winery |   |   | 
 | 13 |   | Appelation |   | --> 5 | 
 | 14 |   | State |   |   | 
 | 15 |   | Name |   |   | 
 | 16 |   | Year |   |   | 
 | 17 |   | Price |   |   | 
 | 18 |   | Score |   |   | 
 | 19 |   | Cases |   |   | 
 | 20 |   | Drink |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6519 | Which winery is the wine that has the highest score from? | SELECT Winery FROM WINE ORDER BY SCORE LIMIT 1 | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Score, #1] <br>3. COMPARATIVE[#1, #2, comparative:​min:​None] <br>4. PROJECT[col:​wine:​Winery, #3] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Score, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​wine:​Winery, #3] <br> | + | medium | 
  | SPIDER_train_6521 | Find the names of all wines produced in 2008. | SELECT Name FROM WINE WHERE YEAR  =  "2008" | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​2008:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Name, #2] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​2008:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Name, #2] <br> | + | easy | 
  | SPIDER_train_6522 | What are the names of all wines produced in 2008? | SELECT Name FROM WINE WHERE YEAR  =  "2008" | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​2008:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Name, #2] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​2008:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Name, #2] <br> | + | easy | 
  | SPIDER_train_6523 | List the grapes and appelations of all wines. | SELECT Grape ,  Appelation FROM WINE | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Grape, #1] <br>3. PROJECT[col:​wine:​Appelation, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Grape, #1] <br>3. PROJECT[col:​wine:​Appelation, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6524 | What are the grapes and appelations of each wine? | SELECT Grape ,  Appelation FROM WINE | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Appelation, #1] <br>3. PROJECT[col:​wine:​Grape, #1] <br>4. UNION[#3, #2] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Appelation, #1] <br>3. PROJECT[col:​wine:​Grape, #1] <br>4. UNION[#3, #2] <br> | + | medium | 
  | SPIDER_train_6525 | List the names and scores of all wines. | SELECT Name ,  Score FROM WINE | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Name, #1] <br>3. PROJECT[col:​wine:​Score, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Name, #1] <br>3. PROJECT[col:​wine:​Score, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6526 | What are the names and scores of all wines? | SELECT Name ,  Score FROM WINE | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Name, #1] <br>3. PROJECT[col:​wine:​Score, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Name, #1] <br>3. PROJECT[col:​wine:​Score, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6527 | List the area and county of all appelations. | SELECT Area ,  County FROM APPELLATIONS | 1. SELECT[tbl:​appellations] <br>2. PROJECT[col:​appellations:​Area, #1] <br>3. PROJECT[col:​appellations:​County, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​appellations] <br>2. PROJECT[col:​appellations:​Area, #1] <br>3. PROJECT[col:​appellations:​County, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6528 | What are the areas and counties for all appelations? | SELECT Area ,  County FROM APPELLATIONS | 1. SELECT[tbl:​appellations] <br>2. PROJECT[col:​appellations:​Area, #1] <br>3. PROJECT[col:​appellations:​County, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​appellations] <br>2. PROJECT[col:​appellations:​Area, #1] <br>3. PROJECT[col:​appellations:​County, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6529 | What are the prices of wines produced before the year of 2010? | SELECT Price FROM WINE WHERE YEAR  <  2010 | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​<:​2010:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Price, #2] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​<:​2010:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Price, #2] <br> | + | easy | 
  | SPIDER_train_6530 | Return the prices of wines produced before 2010. | SELECT Price FROM WINE WHERE YEAR  <  2010 | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​<:​2010:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Price, #2] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​<:​2010:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Price, #2] <br> | + | easy | 
  | SPIDER_train_6531 | List the names of all distinct wines that have scores higher than 90. | SELECT Name FROM WINE WHERE score  >  90 | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Score, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​90:​col:​wine:​Score] <br>4. PROJECT[distinct #REF, #3] <br>5. PROJECT[col:​wine:​Name, #4] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Score, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​90:​col:​wine:​Score] <br>4. PROJECT[None, #3] <br>5. PROJECT[col:​wine:​Name, #4] <br> | + | easy | 
  | SPIDER_train_6532 | What are the names of wines with scores higher than 90? | SELECT Name FROM WINE WHERE score  >  90 | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​>:​90:​col:​wine:​Score] <br>3. PROJECT[col:​wine:​Name, #2] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​>:​90:​col:​wine:​Score] <br>3. PROJECT[col:​wine:​Name, #2] <br> | + | easy | 
  | SPIDER_train_6535 | Find the names of all distinct wines that have appellations in North Coast area. | SELECT DISTINCT T2.Name FROM APPELLATIONs AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  "North Coast" | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​North Coast:​col:​appellations:​Area] <br>3.*(distinct)* PROJECT[col:​wine:​Name, #2] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​North Coast:​col:​appellations:​Area] <br>3.*(distinct)* PROJECT[col:​wine:​Name, #2] <br> | + | medium | 
  | SPIDER_train_6536 | What are the distinct names of wines that have appellations in the North Coast area? | SELECT DISTINCT T2.Name FROM APPELLATIONs AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  "North Coast" | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​appellations, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​North Coast:​col:​appellations:​Area] <br>4.*(distinct)* PROJECT[col:​wine:​Name, #3] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​appellations, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​North Coast:​col:​appellations:​Area] <br>4.*(distinct)* PROJECT[col:​wine:​Name, #3] <br> | + | medium | 
  | SPIDER_train_6537 | How many wines are produced at Robert Biale winery? | SELECT count(*) FROM WINE WHERE Winery  =  "Robert Biale" | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Robert Biale:​col:​wine:​Winery] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Robert Biale:​col:​wine:​Winery] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6538 | Count the number of wines produced at Robert Biale winery. | SELECT count(*) FROM WINE WHERE Winery  =  "Robert Biale" | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​Robert Biale:​col:​wine:​Winery] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Robert Biale:​col:​wine:​Winery] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6539 | How many appelations are in Napa Country? | SELECT count(*) FROM APPELLATIONS WHERE County  =  "Napa" | 1. SELECT[tbl:​appellations] <br>2. FILTER[#1, comparative:​=:​Napa:​col:​appellations:​County] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​appellations] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Napa:​col:​appellations:​County] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6540 | Count the number of appelations in Napa County. | SELECT count(*) FROM APPELLATIONS WHERE County  =  "Napa" | 1. SELECT[tbl:​appellations] <br>2. FILTER[#1, comparative:​=:​Napa:​col:​appellations:​County] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​appellations] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Napa:​col:​appellations:​County] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6541 | Give me the average prices of wines that are produced by appelations in Sonoma County. | SELECT AVG(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  "Sonoma" | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​appellations, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Sonoma:​col:​appellations:​County] <br>4. PROJECT[col:​wine:​Price, #3] <br>5. AGGREGATE[avg, #4] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​appellations, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Sonoma:​col:​appellations:​County] <br>4. PROJECT[col:​wine:​Price, #3] <br>5. AGGREGATE[avg, #4] <br> | + | medium | 
  | SPIDER_train_6542 | What is the average price of wines produced in appelations in Sonoma County? | SELECT AVG(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  "Sonoma" | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​Sonoma:​col:​appellations:​County] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Sonoma:​col:​appellations:​County] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. AGGREGATE[avg, #3] <br> | + | medium | 
  | SPIDER_train_6543 | What are the names and scores of wines that are made of white color grapes? | SELECT T2.Name ,   T2.Score FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  "White" | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​grapes, #1] <br>3. PROJECT[col:​grapes:​Color, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​White:​col:​grapes:​Color] <br>5. PROJECT[col:​wine:​Name, #4] <br>6. PROJECT[col:​wine:​Score, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​grapes, #1] <br>3. PROJECT[col:​grapes:​Color, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​White:​col:​grapes:​Color] <br>5. PROJECT[col:​wine:​Name, #4] <br>6. PROJECT[col:​wine:​Score, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6544 | Give the names and scores of wines made from white grapes. | SELECT T2.Name ,   T2.Score FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  "White" | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​White:​col:​grapes:​Color] <br>3. PROJECT[col:​wine:​Name, #2] <br>4. PROJECT[col:​wine:​Score, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​White:​col:​grapes:​Color] <br>3. PROJECT[col:​wine:​Name, #2] <br>4. PROJECT[col:​wine:​Score, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_6546 | What is the maximum price of wines from the appelation in the Central Coast area, which was produced before 2005? | SELECT max(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  "Central Coast" AND T2.year  <  2005 | 1. SELECT[tbl:​appellations] <br>2. FILTER[#1, comparative:​=:​Central Coast:​col:​appellations:​Area] <br>3. PROJECT[tbl:​wine, #2] <br>4. FILTER[#3, comparative:​<:​2005:​col:​wine:​Year] <br>5. PROJECT[col:​wine:​Price, #4] <br>6. AGGREGATE[max, #5] <br> | 1. SELECT[tbl:​appellations] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Central Coast:​col:​appellations:​Area] <br>3. PROJECT[tbl:​wine, #2] <br>4. COMPARATIVE[#3, #3, comparative:​<:​2005:​col:​wine:​Year] <br>5. PROJECT[col:​wine:​Price, #4] <br>6. AGGREGATE[max, #5] <br> | + | medium | 
  | SPIDER_train_6547 | Find the the grape whose white color grapes are used to produce wines with scores higher than 90. | SELECT DISTINCT T1.Grape FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  "White" AND T2.score  >  90 | 1. SELECT[col:​grapes:​Grape] <br>2. PROJECT[col:​grapes:​Color, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​White:​col:​grapes:​Color] <br>4. PROJECT[tbl:​wine, #3] <br>5. PROJECT[col:​wine:​Score, #4] <br>6. COMPARATIVE[#3, #5, comparative:​>:​90:​col:​wine:​Score] <br> | 1. SELECT[col:​grapes:​Grape] <br>2. PROJECT[col:​grapes:​Color, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​White:​col:​grapes:​Color] <br>4. PROJECT[tbl:​wine, #3] <br>5. PROJECT[col:​wine:​Score, #4] <br>6. COMPARATIVE[#3, #5, comparative:​>:​90:​col:​wine:​Score] <br> | + | medium | 
  | SPIDER_train_6548 | Find the white grape used to produce wines with scores above 90. | SELECT DISTINCT T1.Grape FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  "White" AND T2.score  >  90 | 1. SELECT[col:​grapes:​Grape] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​White:​col:​grapes:​Color] <br>4. PROJECT[col:​wine:​Score, #3] <br>5. COMPARATIVE[#1, #4, comparative:​>:​90:​col:​wine:​Score] <br> | 1. SELECT[col:​grapes:​Grape] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#2, #1, comparative:​=:​White:​col:​grapes:​Color] <br>4. PROJECT[col:​wine:​Score, #3] <br>5. COMPARATIVE[#1, #4, comparative:​>:​90:​col:​wine:​Score] <br> | + | medium | 
  | SPIDER_train_6550 | What are the names of wines made from red grapes and with prices above 50? | SELECT T2.Name FROM Grapes AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  "Red" AND T2.price  >  50 | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​Red:​col:​grapes:​Color] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​50:​col:​wine:​Price] <br>5. PROJECT[col:​wine:​Name, #4] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Red:​col:​grapes:​Color] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​50:​col:​wine:​Price] <br>5. PROJECT[col:​wine:​Name, #4] <br> | + | medium | 
  | SPIDER_train_6552 | Give the neames of wines with prices below 50 and with appelations in Monterey county. | SELECT T2.Name FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  "Monterey" AND T2.price  <  50 | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​<:​50:​col:​wine:​Price] <br>3. FILTER[#2, comparative:​=:​Monterey:​col:​appellations:​County] <br>4. PROJECT[col:​wine:​Name, #3] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​<:​50:​col:​wine:​Price] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Monterey:​col:​appellations:​County] <br>4. PROJECT[col:​wine:​Name, #3] <br> | + | medium | 
  | SPIDER_train_6558 | What are the distinct names of wines with prices higher than any wine from John Anthony winery. | SELECT DISTINCT Name FROM WINE WHERE Price  >  (SELECT min(Price) FROM wine WHERE Winery  =  "John Anthony") | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​John Anthony:​col:​wine:​Winery] <br>4. PROJECT[col:​wine:​Price, #1] <br>5. PROJECT[col:​wine:​Price, #3] <br>6. COMPARATIVE[#1, #4, comparative:​>:​#5] <br>7. PROJECT[col:​wine:​Name, #6] <br>8.*(distinct)* PROJECT[distinct #REF, #7] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​John Anthony:​col:​wine:​Winery] <br>4. PROJECT[col:​wine:​Price, #1] <br>5. PROJECT[col:​wine:​Price, #3] <br>6. COMPARATIVE[#1, #4, comparative:​>:​John Anthony:​col:​wine:​Winery] <br>7. PROJECT[col:​wine:​Name, #5] <br>8.*(distinct)* PROJECT[None, #7] <br> | - | hard | 
  | SPIDER_train_6563 | What is the area of the appelation that produces the highest number of wines before the year of 2010? | SELECT T1.Area FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING T2.year  <  2010 ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. FILTER[#2, comparative:​<:​2010:​col:​wine:​Year] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​appellations:​Area, #5] <br> | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#2, #2, comparative:​<:​2010:​col:​wine:​Year] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​appellations:​Area, #5] <br> | + | extra | 
  | SPIDER_train_6564 | What is the area for the appelation which produced the most wines prior to 2010? | SELECT T1.Area FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING T2.year  <  2010 ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. FILTER[#2, comparative:​<:​2010:​col:​wine:​Year] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​appellations:​Area, #5] <br> | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#2, #2, comparative:​<:​2010:​col:​wine:​Year] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​appellations:​Area, #5] <br> | + | extra | 
  | SPIDER_train_6566 | Give the color of the grape whose wine products have the highest average price? | SELECT T1.Color FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape GROUP BY T2.Grape ORDER BY AVG(Price) DESC LIMIT 1 | 1. SELECT[tbl:​grapes] <br>2. PROJECT[tbl:​wine, #1] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. GROUP[avg, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​grapes:​Color, #5] <br> | 1. SELECT[tbl:​grapes] <br>2. PROJECT[tbl:​wine, #1] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. GROUP[avg, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​grapes:​Color, #5] <br> | + | extra | 
  | SPIDER_train_6567 | Find the distinct names of wines produced before the year of 2000 or after the year of 2010. | SELECT DISTINCT Name FROM WINE WHERE YEAR  <  2000 OR YEAR  >  2010 | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2010:​col:​wine:​Year] <br>4. COMPARATIVE[#1, #2, comparative:​<:​2000:​col:​wine:​Year] <br>5. UNION[#3, #4] <br>6.*(distinct)* PROJECT[col:​wine:​Name, #5] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2010:​col:​wine:​Year] <br>4. COMPARATIVE[#1, #2, comparative:​<:​2000:​col:​wine:​Year] <br>5. UNION[#3, #4] <br>6.*(distinct)* PROJECT[col:​wine:​Name, #5] <br> | + | medium | 
  | SPIDER_train_6568 | Give the distinct names of wines made before 2000 or after 2010. | SELECT DISTINCT Name FROM WINE WHERE YEAR  <  2000 OR YEAR  >  2010 | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​>:​2010:​col:​wine:​Year] <br>3. FILTER[#1, comparative:​<:​2000:​col:​wine:​Year] <br>4. UNION[#2, #3] <br>5.*(distinct)* PROJECT[col:​wine:​Name, #4] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​>:​2010:​col:​wine:​Year] <br>3. COMPARATIVE[#1, #1, comparative:​<:​2000:​col:​wine:​Year] <br>4. UNION[#2, #3] <br>5.*(distinct)* PROJECT[col:​wine:​Name, #4] <br> | + | medium | 
  | SPIDER_train_6569 | Find the distinct winery of wines having price between 50 and 100. | SELECT DISTINCT Winery FROM WINE WHERE Price BETWEEN 50 AND 100 | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​50:​col:​wine:​Price] <br>4. COMPARATIVE[#1, #2, comparative:​<=:​100:​col:​wine:​Price] <br>5. INTERSECTION[#1, #3, #4] <br>6.*(distinct)* PROJECT[col:​wine:​Winery, #5] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​50:​col:​wine:​Price] <br>4. COMPARATIVE[#1, #2, comparative:​<=:​100:​col:​wine:​Price] <br>5. INTERSECTION[#1, #3, #4] <br>6.*(distinct)* PROJECT[col:​wine:​Winery, #5] <br> | + | easy | 
  | SPIDER_train_6570 | What are the distinct wineries which produce wines costing between 50 and 100? | SELECT DISTINCT Winery FROM WINE WHERE Price BETWEEN 50 AND 100 | 1. SELECT[tbl:​wine] <br>2. PROJECT[cost of #REF, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​50:​col:​wine:​Price] <br>4. COMPARATIVE[#3, #2, comparative:​<=:​100:​col:​wine:​Price] <br>5.*(distinct)* PROJECT[col:​wine:​Winery, #4] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[None, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​50:​col:​wine:​Price] <br>4. COMPARATIVE[#3, #2, comparative:​<=:​100:​col:​wine:​Price] <br>5.*(distinct)* PROJECT[col:​wine:​Winery, #4] <br> | + | easy | 
  | SPIDER_train_6571 | What are the average prices and cases of wines produced in the year of 2009 and made of Zinfandel grape? | SELECT AVG(Price) ,  AVG(Cases) FROM WINE WHERE YEAR  =  2009 AND Grape  =  "Zinfandel" | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Grape, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Zinfandel:​col:​wine:​Grape] <br>4. FILTER[#3, comparative:​=:​2009:​col:​wine:​Year] <br>5. PROJECT[col:​wine:​Price, #4] <br>6. AGGREGATE[avg, #5] <br>7. PROJECT[col:​wine:​Cases, #4] <br>8. AGGREGATE[col:​wine:​Cases, #7] <br>9. AGGREGATE[avg, #8] <br>10. UNION[#6, #9] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Grape, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Zinfandel:​col:​wine:​Grape] <br>4. COMPARATIVE[#3, #3, comparative:​=:​2009:​col:​wine:​Year] <br>5. PROJECT[col:​wine:​Price, #4] <br>6. AGGREGATE[avg, #5] <br>7. PROJECT[col:​wine:​Cases, #4] <br>8. AGGREGATE[sum, #7] <br>9. AGGREGATE[avg, #8] <br>10. UNION[#6, #9] <br> | + | hard | 
  | SPIDER_train_6572 | Give the average price and case of wines made from Zinfandel grapes in the year 2009. | SELECT AVG(Price) ,  AVG(Cases) FROM WINE WHERE YEAR  =  2009 AND Grape  =  "Zinfandel" | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​Zinfandel:​col:​wine:​Grape] <br>3. FILTER[#2, comparative:​=:​2009:​col:​wine:​Year] <br>4. PROJECT[col:​wine:​Price, #3] <br>5. PROJECT[col:​wine:​Cases, #3] <br>6. AGGREGATE[avg, #4] <br>7. AGGREGATE[avg, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Zinfandel:​col:​wine:​Grape] <br>3. COMPARATIVE[#2, #2, comparative:​=:​2009:​col:​wine:​Year] <br>4. PROJECT[col:​wine:​Price, #3] <br>5. PROJECT[col:​wine:​Cases, #3] <br>6. AGGREGATE[avg, #4] <br>7. AGGREGATE[avg, #5] <br>8. UNION[#6, #7] <br> | + | hard | 
  | SPIDER_train_6573 | What are the maximum price and score of wines produced by St. Helena appelation? | SELECT max(Price) ,  max(Score) FROM WINE WHERE Appelation  =  "St. Helena" | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Appelation, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​St. Helena:​col:​wine:​Appelation] <br>4. PROJECT[col:​wine:​Price, #3] <br>5. AGGREGATE[max, #4] <br>6. PROJECT[col:​wine:​Score, #3] <br>7. AGGREGATE[max, #6] <br>8. UNION[#5, #7] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Appelation, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​St. Helena:​col:​wine:​Appelation] <br>4. PROJECT[col:​wine:​Price, #3] <br>5. AGGREGATE[max, #4] <br>6. PROJECT[col:​wine:​Score, #3] <br>7. AGGREGATE[max, #6] <br>8. UNION[#5, #7] <br> | + | medium | 
  | SPIDER_train_6579 | Find the wineries that have at least four wines. | SELECT Winery FROM WINE GROUP BY Winery HAVING count(*)  >=  4 | 1. SELECT[col:​wine:​Winery] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br> | 1. SELECT[col:​wine:​Winery] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br> | + | easy | 
  | SPIDER_train_6580 | Which wineries produce at least four wines? | SELECT Winery FROM WINE GROUP BY Winery HAVING count(*)  >=  4 | 1. SELECT[col:​wine:​Winery] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br> | 1. SELECT[col:​wine:​Winery] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4] <br> | + | easy | 
  | SPIDER_train_6581 | Find the country of all appelations who have at most three wines. | SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING count(*)  <=  3 | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<=:​3] <br>5. PROJECT[col:​appellations:​County, #4] <br> | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<=:​3] <br>5. PROJECT[col:​appellations:​County, #4] <br> | + | medium | 
  | SPIDER_train_6582 | What are the countries for appelations with at most 3 wines? | SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING count(*)  <=  3 | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<=:​3] <br>5. PROJECT[col:​appellations:​County, #4] <br> | 1. SELECT[tbl:​appellations] <br>2. PROJECT[tbl:​wine, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<=:​3] <br>5. PROJECT[col:​appellations:​County, #4] <br> | + | medium | 
  | SPIDER_train_6585 | What are the names of wines that are more expensive then all wines made in the year 2006? | SELECT Name FROM WINE WHERE Price  >  (SELECT max(Price) FROM WINE WHERE YEAR  =  2006) | 1. SELECT[tbl:​wine] <br>2. FILTER[#1, comparative:​=:​2006:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. AGGREGATE[max, #3] <br>5. PROJECT[col:​wine:​Price, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​#4] <br>7. PROJECT[col:​wine:​Name, #6] <br> | 1. SELECT[tbl:​wine] <br>2. COMPARATIVE[#1, #1, comparative:​=:​2006:​col:​wine:​Year] <br>3. PROJECT[col:​wine:​Price, #2] <br>4. AGGREGATE[max, #3] <br>5. PROJECT[col:​wine:​Price, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​#4] <br>7. PROJECT[col:​wine:​Name, #6] <br> | + | hard | 
  | SPIDER_train_6589 | List the grape, winery and year of the wines whose price is bigger than 100 ordered by year. | SELECT Grape ,  Winery ,  YEAR FROM WINE WHERE Price  >   100 ORDER BY YEAR | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100:​col:​wine:​Price] <br>4. PROJECT[col:​wine:​Grape, #3] <br>5. PROJECT[col:​wine:​Winery, #3] <br>6. PROJECT[col:​wine:​Year, #3] <br>7. UNION[#4, #5, #6] <br>8. SORT[#7, #6] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100:​col:​wine:​Price] <br>4. PROJECT[col:​wine:​Grape, #3] <br>5. PROJECT[col:​wine:​Winery, #3] <br>6. PROJECT[col:​wine:​Year, #3] <br>7. UNION[#4, #5, #6] <br>8. SORT[#7, #6, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_6590 | What are the grapes, wineries and years for wines with price higher than 100, sorted by year? | SELECT Grape ,  Winery ,  YEAR FROM WINE WHERE Price  >   100 ORDER BY YEAR | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100:​col:​wine:​Price] <br>4. PROJECT[col:​wine:​Grape, #3] <br>5. PROJECT[col:​wine:​Winery, #3] <br>6. PROJECT[col:​wine:​Year, #3] <br>7. UNION[#4, #5, #6] <br>8. SORT[#7, #6] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Price, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100:​col:​wine:​Price] <br>4. PROJECT[col:​wine:​Grape, #3] <br>5. PROJECT[col:​wine:​Winery, #3] <br>6. PROJECT[col:​wine:​Year, #3] <br>7. UNION[#4, #5, #6] <br>8. SORT[#7, #6, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_6591 | List the grape, appelation and name of wines whose score is higher than 93 ordered by Name. | SELECT Grape ,  Appelation ,  Name FROM WINE WHERE Score  >  93 ORDER BY Name | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Score, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​93:​col:​wine:​Score] <br>4. PROJECT[col:​wine:​Grape, #3] <br>5. PROJECT[col:​wine:​Appelation, #3] <br>6. PROJECT[col:​wine:​Name, #3] <br>7. UNION[#4, #5, #6] <br>8. SORT[#7, #6] <br> | 1. SELECT[tbl:​wine] <br>2. PROJECT[col:​wine:​Score, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​93:​col:​wine:​Score] <br>4. PROJECT[col:​wine:​Grape, #3] <br>5. PROJECT[col:​wine:​Appelation, #3] <br>6. PROJECT[col:​wine:​Name, #3] <br>7. UNION[#4, #5, #6] <br>8. SORT[#7, #6, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_6593 | Find the appelations that produce wines after the year of 2008 but not in Central Coast area. | SELECT Appelation FROM WINE WHERE YEAR  >  2008 EXCEPT SELECT Appelation FROM APPELLATIONS WHERE Area  =  "Central Coast" | 1. SELECT[col:​wine:​Appelation] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2008:​col:​wine:​Year] <br>4. FILTER[#3, comparative:​=:​Central Coast:​col:​appellations:​Area] <br>5. DISCARD[#3, #4] <br> | 1. SELECT[col:​wine:​Appelation] <br>2. PROJECT[tbl:​wine, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2008:​col:​wine:​Year] <br>4. COMPARATIVE[#3, #3, comparative:​=:​Central Coast:​col:​appellations:​Area] <br>5. DISCARD[#3, #4] <br> | + | hard | 
  | SPIDER_train_6597 | Find the county where produces the most number of wines with score higher than 90. | SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T2.Score  >  90 GROUP BY T1.County ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​appellations:​County] <br>2. PROJECT[tbl:​wine, #1] <br>3. PROJECT[col:​wine:​Score, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​90:​col:​wine:​Score] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | 1. SELECT[col:​appellations:​County] <br>2. PROJECT[tbl:​wine, #1] <br>3. PROJECT[col:​wine:​Score, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​90:​col:​wine:​Score] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | + | extra | 
  | SPIDER_train_6598 | What is the county that produces the most wines scoring higher than 90? | SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T2.Score  >  90 GROUP BY T1.County ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​appellations:​County] <br>2. PROJECT[tbl:​wine, #1] <br>3. PROJECT[col:​wine:​Score, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​90:​col:​wine:​Score] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | 1. SELECT[col:​appellations:​County] <br>2. PROJECT[tbl:​wine, #1] <br>3. PROJECT[col:​wine:​Score, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​90:​col:​wine:​Score] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | + | extra | 
 ***
 Exec acc: **0.9800**
