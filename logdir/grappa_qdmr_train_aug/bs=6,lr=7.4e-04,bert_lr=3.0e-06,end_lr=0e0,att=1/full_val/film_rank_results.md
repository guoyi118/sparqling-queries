 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **film** | Film_ID | + |   | 
 | 2 |   | Title |   |   | 
 | 3 |   | Studio |   |   | 
 | 4 |   | Director |   |   | 
 | 5 |   | Gross_in_dollar |   |   | 
 | 6 | **market** | Market_ID | + |   | 
 | 7 |   | Country |   |   | 
 | 8 |   | Number_cities |   |   | 
 | 9 | **film_market_estimation** | Estimation_ID | + |   | 
 | 10 |   | Low_Estimate |   |   | 
 | 11 |   | High_Estimate |   |   | 
 | 12 |   | Film_ID |   | --> 1 | 
 | 13 |   | Type |   |   | 
 | 14 |   | Market_ID |   | --> 6 | 
 | 15 |   | Year |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_4112 | How many film are there? | SELECT count(*) FROM film | 1. SELECT[tbl:​film] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​film] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_4113 | Count the number of films. | SELECT count(*) FROM film | 1. SELECT[tbl:​film] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​film] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_4114 | List the distinct director of all films. | SELECT DISTINCT Director FROM film | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Director, #1] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Director, #1] <br>3.*(distinct)* PROJECT[None, #2] <br> | + | easy | 
  | SPIDER_train_4115 | What are the different film Directors? | SELECT DISTINCT Director FROM film | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Director, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Director, #1] <br>3.*(distinct)* PROJECT[None, #2] <br> | + | easy | 
  | SPIDER_train_4116 | What is the average ticket sales gross in dollars of films? | SELECT avg(Gross_in_dollar) FROM film | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_4117 | Return the average gross sales in dollars across all films. | SELECT avg(Gross_in_dollar) FROM film | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_4118 | What are the low and high estimates of film markets? | SELECT Low_Estimate ,  High_Estimate FROM film_market_estimation | 1. SELECT[tbl:​film_market_estimation] <br>2. PROJECT[tbl:​film_market_estimation, #1] <br>3. AGGREGATE[col:​film_market_estimation:​Low_Estimate, #2] <br>4. AGGREGATE[col:​film_market_estimation:​High_Estimate, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​film_market_estimation] <br>2. PROJECT[tbl:​film_market_estimation, #1] <br>3. AGGREGATE[sum, #2] <br>4. AGGREGATE[sum, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_4119 | Return the low and high estimates for all film markets. | SELECT Low_Estimate ,  High_Estimate FROM film_market_estimation | 1. SELECT[tbl:​film_market_estimation] <br>2. PROJECT[col:​film_market_estimation:​Low_Estimate, #1] <br>3. PROJECT[col:​film_market_estimation:​High_Estimate, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​film_market_estimation] <br>2. PROJECT[col:​film_market_estimation:​Low_Estimate, #1] <br>3. PROJECT[col:​film_market_estimation:​High_Estimate, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_4120 | What are the types of film market estimations in year 1995? | SELECT TYPE FROM film_market_estimation WHERE YEAR  =  1995 | 1. SELECT[tbl:​film_market_estimation] <br>2. PROJECT[col:​film_market_estimation:​Year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1995:​col:​film_market_estimation:​Year] <br>4. PROJECT[col:​film_market_estimation:​Type, #3] <br> | 1. SELECT[tbl:​film_market_estimation] <br>2. PROJECT[col:​film_market_estimation:​Year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1995:​col:​film_market_estimation:​Year] <br>4. PROJECT[col:​film_market_estimation:​Type, #3] <br> | + | easy | 
  | SPIDER_train_4121 | Return the types of film market estimations in 1995. | SELECT TYPE FROM film_market_estimation WHERE YEAR  =  1995 | 1. SELECT[tbl:​film_market_estimation] <br>2. FILTER[#1, comparative:​=:​1995:​col:​film_market_estimation:​Year] <br>3. PROJECT[col:​film_market_estimation:​Type, #2] <br> | 1. SELECT[tbl:​film_market_estimation] <br>2. COMPARATIVE[#1, #1, comparative:​=:​1995:​col:​film_market_estimation:​Year] <br>3. PROJECT[col:​film_market_estimation:​Type, #2] <br> | + | easy | 
  | SPIDER_train_4122 | What are the maximum and minimum number of cities in all markets. | SELECT max(Number_cities) ,  min(Number_cities) FROM market | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. AGGREGATE[col:​market:​Number_cities, #2] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. AGGREGATE[sum, #2] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4123 | Return the maximum and minimum number of cities across all markets. | SELECT max(Number_cities) ,  min(Number_cities) FROM market | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. GROUP[col:​market:​Number_cities, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. GROUP[sum, #2, #1] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4124 | How many markets have number of cities smaller than 300? | SELECT count(*) FROM market WHERE Number_cities  <  300 | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. GROUP[col:​market:​Number_cities, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<:​300:​col:​market:​Number_cities] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​<:​300:​col:​market:​Number_cities] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
  | SPIDER_train_4125 | Count the number of markets that have a number of cities lower than 300. | SELECT count(*) FROM market WHERE Number_cities  <  300 | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. AGGREGATE[col:​market:​Number_cities, #2] <br>4. COMPARATIVE[#1, #3, comparative:​<:​300:​col:​market:​Number_cities] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Number_cities, #1] <br>3. AGGREGATE[sum, #2] <br>4. COMPARATIVE[#1, #3, comparative:​<:​300:​col:​market:​Number_cities] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
  | SPIDER_train_4126 | List all countries of markets in ascending alphabetical order. | SELECT Country FROM market ORDER BY Country ASC | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. SORT[#2, #2, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_4128 | List all countries of markets in descending order of number of cities. | SELECT Country FROM market ORDER BY Number_cities DESC | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. PROJECT[col:​market:​Number_cities, #1] <br>4. GROUP[count, #3, #1] <br>5. SORT[#2, #4, sortdir:​descending] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. PROJECT[col:​market:​Number_cities, #1] <br>4. GROUP[count, #3, #1] <br>5. SORT[#2, #4, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_4130 | Please show the titles of films and the types of market estimations. | SELECT T1.Title ,  T2.Type FROM film AS T1 JOIN film_market_estimation AS T2 ON T1.Film_ID  =  T2.Film_ID | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[tbl:​film_market_estimation, #1] <br>4. PROJECT[col:​film_market_estimation:​Type, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[tbl:​film_market_estimation, #1] <br>4. PROJECT[col:​film_market_estimation:​Type, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_4131 | What are the titles of films and corresponding types of market estimations? | SELECT T1.Title ,  T2.Type FROM film AS T1 JOIN film_market_estimation AS T2 ON T1.Film_ID  =  T2.Film_ID | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[tbl:​film_market_estimation, #1] <br>4. PROJECT[col:​film_market_estimation:​Type, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[tbl:​film_market_estimation, #1] <br>4. PROJECT[col:​film_market_estimation:​Type, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_4133 | Who are the different directors of films which had market estimation in 1995? | SELECT DISTINCT T1.Director FROM film AS T1 JOIN film_market_estimation AS T2 ON T1.Film_ID  =  T2.Film_ID WHERE T2.Year  =  1995 | 1. SELECT[tbl:​film] <br>2. FILTER[#1, comparative:​=:​1995:​col:​film_market_estimation:​Year] <br>3.*(distinct)* PROJECT[col:​film:​Director, #2] <br> | 1. SELECT[tbl:​film] <br>2. COMPARATIVE[#1, #1, comparative:​=:​1995:​col:​film_market_estimation:​Year] <br>3.*(distinct)* PROJECT[col:​film:​Director, #2] <br> | + | medium | 
  | SPIDER_train_4134 | What is the average number of cities of markets with low film market estimate bigger than 10000? | SELECT avg(T2.Number_cities) FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.Market_ID  =  T2.Market_ID WHERE T1.Low_Estimate  >  10000 | 1. SELECT[tbl:​market] <br>2. PROJECT[tbl:​market, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​10000:​col:​film_market_estimation:​Low_Estimate] <br>4. PROJECT[col:​market:​Number_cities, #3] <br>5. GROUP[col:​market:​Number_cities, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[tbl:​market, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​10000:​col:​film_market_estimation:​Low_Estimate] <br>4. PROJECT[col:​market:​Number_cities, #3] <br>5. GROUP[sum, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | + | medium | 
  | SPIDER_train_4135 | Give the average number of cities within markets that had a low market estimation larger than 10000? | SELECT avg(T2.Number_cities) FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.Market_ID  =  T2.Market_ID WHERE T1.Low_Estimate  >  10000 | 1. SELECT[tbl:​market] <br>2. PROJECT[tbl:​market, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​10000:​col:​film_market_estimation:​Low_Estimate] <br>4. PROJECT[col:​market:​Number_cities, #3] <br>5. GROUP[col:​market:​Number_cities, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[tbl:​market, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​10000:​col:​film_market_estimation:​Low_Estimate] <br>4. PROJECT[col:​market:​Number_cities, #3] <br>5. GROUP[sum, #4, #3] <br>6. AGGREGATE[avg, #5] <br> | + | medium | 
  | SPIDER_train_4136 | Please list the countries and years of film market estimations. | SELECT T2.Country ,  T1.Year FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.Market_ID  =  T2.Market_ID | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. PROJECT[col:​film_market_estimation:​Year, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. PROJECT[col:​film_market_estimation:​Year, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_4137 | What are the countries of markets and their corresponding years of market estimation? | SELECT T2.Country ,  T1.Year FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.Market_ID  =  T2.Market_ID | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. PROJECT[tbl:​market, #1] <br>4. PROJECT[col:​film_market_estimation:​Year, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[col:​market:​Country, #1] <br>3. PROJECT[tbl:​market, #1] <br>4. PROJECT[col:​film_market_estimation:​Year, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_4138 | Please list the years of film market estimations when the market is in country "Japan" in descending order. | SELECT T1.Year FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.Market_ID  =  T2.Market_ID WHERE T2.Country  =  "Japan" ORDER BY T1.Year DESC | 1. SELECT[tbl:​market] <br>2. PROJECT[tbl:​market, #1] <br>3. PROJECT[col:​market:​Country, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Japan:​col:​market:​Country] <br>5. PROJECT[col:​film_market_estimation:​Year, #4] <br>6. SORT[#5, #5, sortdir:​descending] <br> | 1. SELECT[tbl:​market] <br>2. PROJECT[tbl:​market, #1] <br>3. PROJECT[col:​market:​Country, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Japan:​col:​market:​Country] <br>5. PROJECT[col:​film_market_estimation:​Year, #4] <br>6. SORT[#5, #5, sortdir:​descending] <br> | + | hard | 
  | SPIDER_train_4139 | What are the years of film market estimation for the market of Japan, ordered by year descending? | SELECT T1.Year FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.Market_ID  =  T2.Market_ID WHERE T2.Country  =  "Japan" ORDER BY T1.Year DESC | 1. SELECT[col:​film_market_estimation:​Year] <br>2. FILTER[#1, comparative:​=:​Japan:​col:​market:​Country] <br>3. SORT[#2, #1, sortdir:​descending] <br> | 1. SELECT[col:​film_market_estimation:​Year] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Japan:​col:​market:​Country] <br>3. SORT[#2, #1, sortdir:​descending] <br> | + | hard | 
  | SPIDER_train_4140 | List the studios of each film and the number of films produced by that studio. | SELECT Studio ,  COUNT(*) FROM film GROUP BY Studio | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Studio, #1] <br>3. PROJECT[tbl:​film, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Studio, #1] <br>3. PROJECT[tbl:​film, #2] <br>4. GROUP[count, #3, #2] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_4141 | How films are produced by each studio? | SELECT Studio ,  COUNT(*) FROM film GROUP BY Studio | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_4142 | List the name of film studio that have the most number of films. | SELECT Studio FROM film GROUP BY Studio ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​film:​Studio, #4] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​film:​Studio, #4] <br> | + | hard | 
  | SPIDER_train_4143 | What is the name of teh studio that created the most films? | SELECT Studio FROM film GROUP BY Studio ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​film:​Studio, #4] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​film:​Studio, #4] <br> | + | hard | 
  | SPIDER_train_4144 | List the names of studios that have at least two films. | SELECT Studio FROM film GROUP BY Studio HAVING COUNT(*)  >=  2 | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​film:​Studio, #4] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​film:​Studio, #4] <br> | + | easy | 
  | SPIDER_train_4145 | What are the names of studios that have made two or more films? | SELECT Studio FROM film GROUP BY Studio HAVING COUNT(*)  >=  2 | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​film:​Studio, #4] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. PROJECT[col:​film:​Studio, #4] <br> | + | easy | 
  | SPIDER_train_4146 | List the title of films that do not have any market estimation. | SELECT Title FROM film WHERE Film_ID NOT IN (SELECT Film_ID FROM film_market_estimation) | 1. SELECT[tbl:​film] <br>2. FILTER[#1, tbl:​film_market_estimation] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​film:​Title, #3] <br> | 1. SELECT[tbl:​film] <br>2. COMPARATIVE[#1, #1, tbl:​film_market_estimation] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​film:​Title, #3] <br> | + | hard | 
  | SPIDER_train_4148 | Show the studios that have produced films with director "Nicholas Meyer" and "Walter Hill". | SELECT Studio FROM film WHERE Director  =  "Nicholas Meyer" INTERSECT SELECT Studio FROM film WHERE Director  =  "Walter Hill" | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. PROJECT[col:​film:​Director, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Nicholas Meyer:​col:​film:​Director] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Walter Hill:​col:​film:​Director] <br>6. INTERSECTION[#1, #4, #5] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. PROJECT[col:​film:​Director, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Nicholas Meyer:​col:​film:​Director] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Walter Hill:​col:​film:​Director] <br>6. INTERSECTION[#1, #4, #5] <br> | + | hard | 
  | SPIDER_train_4149 | What are the names of studios that have produced films with both Nicholas Meyer and Walter Hill? | SELECT Studio FROM film WHERE Director  =  "Nicholas Meyer" INTERSECT SELECT Studio FROM film WHERE Director  =  "Walter Hill" | 1. SELECT[col:​film:​Studio] <br>2. FILTER[#1, comparative:​=:​Nicholas Meyer:​col:​film:​Director] <br>3. FILTER[#1, comparative:​=:​Walter Hill:​col:​film:​Director] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​film:​Studio, #4] <br> | 1. SELECT[col:​film:​Studio] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Nicholas Meyer:​col:​film:​Director] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Walter Hill:​col:​film:​Director] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​film:​Studio, #4] <br> | + | hard | 
  | SPIDER_train_4150 | Find the titles and studios of the films that are produced by some film studios that contained the word "Universal". | SELECT title ,  Studio FROM film WHERE Studio LIKE "%Universal%" | 1. SELECT[tbl:​film] <br>2. FILTER[#1, comparative:​like:​%Universal%:​col:​film:​Studio] <br>3. PROJECT[tbl:​film, #2] <br>4. PROJECT[col:​film:​Title, #3] <br>5. PROJECT[col:​film:​Studio, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​film] <br>2. COMPARATIVE[#1, #1, comparative:​like:​Universal:​col:​film:​Studio] <br>3. PROJECT[tbl:​film, #2] <br>4. PROJECT[col:​film:​Title, #3] <br>5. PROJECT[col:​film:​Studio, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_4151 | What are the titles and studios of films that have been produced by a studio whose name contains "Universal"? | SELECT title ,  Studio FROM film WHERE Studio LIKE "%Universal%" | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[col:​film:​Studio, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Universal%:​col:​film:​Studio] <br>4. PROJECT[tbl:​film, #3] <br>5. PROJECT[col:​film:​Title, #4] <br>6. PROJECT[col:​film:​Studio, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[col:​film:​Studio, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Universal:​col:​film:​Studio] <br>4. PROJECT[tbl:​film, #3] <br>5. PROJECT[col:​film:​Title, #4] <br>6. PROJECT[col:​film:​Studio, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_4152 | Show the studios that have not produced films with director "Walter Hill". | SELECT Studio FROM film EXCEPT SELECT Studio FROM film WHERE Director  =  "Walter Hill" | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. PROJECT[col:​film:​Director, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Walter Hill:​col:​film:​Director] <br>5. DISCARD[#1, #4] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[tbl:​film, #1] <br>3. PROJECT[col:​film:​Director, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Walter Hill:​col:​film:​Director] <br>5. DISCARD[#1, #4] <br> | + | hard | 
  | SPIDER_train_4154 | List the studios which average gross is above 4500000. | SELECT Studio FROM film GROUP BY Studio HAVING avg(Gross_in_dollar)  >=  4500000 | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. GROUP[col:​film:​Gross_in_dollar, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4500000:​col:​film:​Gross_in_dollar] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4500000:​col:​film:​Gross_in_dollar] <br> | + | easy | 
  | SPIDER_train_4155 | Which studios have an average gross of over 4500000? | SELECT Studio FROM film GROUP BY Studio HAVING avg(Gross_in_dollar)  >=  4500000 | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. GROUP[col:​film:​Gross_in_dollar, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4500000:​col:​film:​Gross_in_dollar] <br> | 1. SELECT[col:​film:​Studio] <br>2. PROJECT[col:​film:​Gross_in_dollar, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​4500000:​col:​film:​Gross_in_dollar] <br> | + | easy | 
  | SPIDER_train_4156 | What is the title of the film that has the highest high market estimation. | SELECT t1.title FROM film AS T1 JOIN film_market_estimation AS T2  ON T1.Film_ID  =  T2.Film_ID ORDER BY high_estimate DESC LIMIT 1 | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film_market_estimation:​High_Estimate, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​film:​Title, #3] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film_market_estimation:​High_Estimate, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​film:​Title, #3] <br> | + | hard | 
  | SPIDER_train_4157 | Return the title of the film with the highest high estimate? | SELECT t1.title FROM film AS T1 JOIN film_market_estimation AS T2  ON T1.Film_ID  =  T2.Film_ID ORDER BY high_estimate DESC LIMIT 1 | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film_market_estimation:​High_Estimate, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​film:​Title, #3] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film_market_estimation:​High_Estimate, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​film:​Title, #3] <br> | + | hard | 
  | SPIDER_train_4159 | Return the titles and directors of films that were never in the market of China. | SELECT title ,  director FROM film WHERE film_id NOT IN (SELECT film_id FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.market_id  =  T2.Market_ID WHERE country  =  'China') | 1. SELECT[tbl:​film] <br>2. PROJECT[tbl:​market, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​China:​col:​market:​Country] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​film:​Title, #4] <br>6. PROJECT[col:​film:​Director, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[tbl:​market, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​China:​col:​market:​Country] <br>4. DISCARD[#1, #3] <br>5. PROJECT[col:​film:​Title, #4] <br>6. PROJECT[col:​film:​Director, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
 ***
 Exec acc: **1.0000**
