 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **airport** | id | + |   | 
 | 2 |   | City |   |   | 
 | 3 |   | Country |   |   | 
 | 4 |   | IATA |   |   | 
 | 5 |   | ICAO |   |   | 
 | 6 |   | name |   |   | 
 | 7 | **operate_company** | id | + |   | 
 | 8 |   | name |   |   | 
 | 9 |   | Type |   |   | 
 | 10 |   | Principal_activities |   |   | 
 | 11 |   | Incorporated_in |   |   | 
 | 12 |   | Group_Equity_Shareholding |   |   | 
 | 13 | **flight** | id | + |   | 
 | 14 |   | Vehicle_Flight_number |   |   | 
 | 15 |   | Date |   |   | 
 | 16 |   | Pilot |   |   | 
 | 17 |   | Velocity |   |   | 
 | 18 |   | Altitude |   |   | 
 | 19 |   | airport_id |   | --> 1 | 
 | 20 |   | company_id |   | --> 7 | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6366 | How many flights have a velocity larger than 200? | SELECT count(*) FROM flight WHERE velocity  >  200 | 1. SELECT[tbl:​flight] <br>2. PROJECT[col:​flight:​Velocity, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​200:​col:​flight:​Velocity] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​flight] <br>2. PROJECT[col:​flight:​Velocity, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​200:​col:​flight:​Velocity] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6367 | List the vehicle flight number, date and pilot of all the flights, ordered by altitude. | SELECT vehicle_flight_number ,  date ,  pilot FROM flight ORDER BY altitude ASC | 1. SELECT[col:​flight:​Vehicle_Flight_number] <br>2. AGGREGATE[col:​flight:​Vehicle_Flight_number, #1] <br>3. PROJECT[col:​flight:​Date, #1] <br>4. PROJECT[col:​flight:​Pilot, #1] <br>5. PROJECT[col:​flight:​Altitude, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5] <br> | 1. SELECT[col:​flight:​Vehicle_Flight_number] <br>2. AGGREGATE[sum, #1] <br>3. PROJECT[col:​flight:​Date, #1] <br>4. PROJECT[col:​flight:​Pilot, #1] <br>5. PROJECT[col:​flight:​Altitude, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_6368 | List the id, country, city and name of the airports ordered alphabetically by the name. | SELECT id ,  country ,  city ,  name FROM airport ORDER BY name | 1. SELECT[tbl:​airport] <br>2. PROJECT[col:​airport:​id, #1] <br>3. PROJECT[col:​airport:​Country, #1] <br>4. PROJECT[col:​airport:​City, #1] <br>5. PROJECT[col:​airport:​name, #1] <br>6. UNION[#2, #3, #4, #5] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | 1. SELECT[tbl:​airport] <br>2. PROJECT[col:​airport:​id, #1] <br>3. PROJECT[col:​airport:​Country, #1] <br>4. PROJECT[col:​airport:​City, #1] <br>5. PROJECT[col:​airport:​name, #1] <br>6. UNION[#2, #3, #4, #5] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_6369 | What is maximum group equity shareholding of the companies? | SELECT max(group_equity_shareholding) FROM operate_company | 1. SELECT[tbl:​operate_company] <br>2. PROJECT[col:​operate_company:​Group_Equity_Shareholding, #1] <br>3. AGGREGATE[max, #2] <br> | 1. SELECT[tbl:​operate_company] <br>2. PROJECT[col:​operate_company:​Group_Equity_Shareholding, #1] <br>3. AGGREGATE[max, #2] <br> | + | easy | 
  | SPIDER_train_6372 | What are the names of the airports which are not in the country 'Iceland'? | SELECT name FROM airport WHERE country != 'Iceland' | 1. SELECT[tbl:​airport] <br>2. PROJECT[col:​airport:​Country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Iceland:​col:​airport:​Country] <br>4. PROJECT[col:​airport:​name, #3] <br> | 1. SELECT[tbl:​airport] <br>2. PROJECT[col:​airport:​Country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​Iceland:​col:​airport:​Country] <br>4. PROJECT[col:​airport:​name, #3] <br> | + | easy | 
  | SPIDER_train_6373 | What are the distinct types of the companies that have operated any flights with velocity less than 200? | SELECT DISTINCT T1.type FROM operate_company AS T1 JOIN flight AS t2 ON T1.id  =  T2.company_id WHERE T2.velocity  <  200 | 1. SELECT[tbl:​operate_company] <br>2. PROJECT[tbl:​operate_company, #1] <br>3. PROJECT[col:​flight:​Velocity, #2] <br>4. COMPARATIVE[#1, #3, comparative:​<:​200:​col:​flight:​Velocity] <br>5.*(distinct)* PROJECT[col:​operate_company:​Type, #4] <br> | 1. SELECT[tbl:​operate_company] <br>2. PROJECT[tbl:​operate_company, #1] <br>3. PROJECT[col:​flight:​Velocity, #2] <br>4. COMPARATIVE[#1, #3, comparative:​<:​200:​col:​flight:​Velocity] <br>5.*(distinct)* PROJECT[col:​operate_company:​Type, #4] <br> | + | medium | 
  | SPIDER_train_6374 | What are the ids and names of the companies that operated more than one flight? | SELECT T1.id ,  T1.name FROM operate_company AS T1 JOIN flight AS t2 ON T1.id  =  T2.company_id GROUP BY T1.id HAVING count(*)  >  1 | 1. SELECT[col:​flight:​company_id] <br>2. PROJECT[tbl:​operate_company, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​operate_company:​id, #4] <br>6. PROJECT[col:​operate_company:​name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​flight:​company_id] <br>2. PROJECT[tbl:​operate_company, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​operate_company:​id, #4] <br>6. PROJECT[col:​operate_company:​name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6376 | What are the different pilot names who had piloted a flight in the country 'United States' or in the airport named 'Billund Airport'? | SELECT DISTINCT T2.pilot FROM airport AS T1 JOIN flight AS T2 ON T1.id  =  T2.airport_id WHERE T1.country  =  'United States' OR T1.name  =  'Billund Airport' | 1. SELECT[col:​flight:​Pilot] <br>2. PROJECT[tbl:​flight, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​United States:​col:​airport:​Country] <br>4. PROJECT[tbl:​airport, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Billund Airport:​col:​airport:​name] <br>6. UNION[#3, #5] <br>7.*(distinct)* PROJECT[col:​flight:​Pilot, #6] <br> | 1. SELECT[col:​flight:​Pilot] <br>2. PROJECT[tbl:​flight, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​United States:​col:​airport:​Country] <br>4. PROJECT[tbl:​airport, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Billund Airport:​col:​airport:​name] <br>6. UNION[#3, #5] <br>7.*(distinct)* PROJECT[col:​flight:​Pilot, #6] <br> | + | hard | 
  | SPIDER_train_6380 | Which of the airport names contains the word 'international'? | SELECT name FROM airport WHERE name LIKE '%international%' | 1. SELECT[tbl:​airport] <br>2. PROJECT[col:​airport:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%international%:​col:​airport:​name] <br>4. PROJECT[col:​airport:​name, #3] <br> | 1. SELECT[tbl:​airport] <br>2. PROJECT[col:​airport:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​international:​col:​airport:​name] <br>4. PROJECT[col:​airport:​name, #3] <br> | + | medium | 
  | SPIDER_train_6381 | How many companies operates airlines in each airport? | SELECT T3.id ,  count(*) FROM operate_company AS T1 JOIN flight AS t2 ON T1.id  =  T2.company_id JOIN airport AS T3 ON T2.airport_id  =  T3.id GROUP BY T3.id | 1. SELECT[tbl:​airport] <br>2. PROJECT[airlines in #REF, #1] <br>3. PROJECT[tbl:​operate_company, #2] <br>4. GROUP[count, #3, #1] <br>5. UNION[#1, #4] <br> | 1. SELECT[tbl:​airport] <br>2. PROJECT[None, #1] <br>3. PROJECT[tbl:​operate_company, #2] <br>4. GROUP[count, #3, #1] <br>5. UNION[#1, #4] <br> | + | hard | 
  | SPIDER_train_6383 | which countries have more than 2 airports? | SELECT country FROM airport GROUP BY country HAVING count(*)  >  2 | 1. SELECT[col:​airport:​Country] <br>2. PROJECT[tbl:​airport, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | 1. SELECT[col:​airport:​Country] <br>2. PROJECT[tbl:​airport, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | + | easy | 
  | SPIDER_train_6384 | which pilot is in charge of the most number of flights? | SELECT pilot FROM flight GROUP BY pilot ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​flight:​Pilot] <br>2. PROJECT[tbl:​flight, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​flight:​Pilot] <br>2. PROJECT[tbl:​flight, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
 ***
 Exec acc: **1.0000**
