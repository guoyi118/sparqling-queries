 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Customer_Master_Index** | master_customer_id | + | --> 4 | 
 | 2 |   | cmi_details |   |   | 
 | 3 | **CMI_Cross_References** | cmi_cross_ref_id | + | --> 17 | 
 | 4 |   | master_customer_id |   |   | 
 | 5 |   | source_system_code |   |   | 
 | 6 | **Council_Tax** | council_tax_id | + |   | 
 | 7 |   | cmi_cross_ref_id |   |   | 
 | 8 | **Business_Rates** | business_rates_id | + |   | 
 | 9 |   | cmi_cross_ref_id |   |   | 
 | 10 | **Benefits_Overpayments** | council_tax_id | + | --> 6 | 
 | 11 |   | cmi_cross_ref_id |   |   | 
 | 12 | **Parking_Fines** | council_tax_id | + | --> 6 | 
 | 13 |   | cmi_cross_ref_id |   |   | 
 | 14 | **Rent_Arrears** | council_tax_id | + | --> 6 | 
 | 15 |   | cmi_cross_ref_id |   |   | 
 | 16 | **Electoral_Register** | electoral_register_id | + |   | 
 | 17 |   | cmi_cross_ref_id |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_2646 | what are the details of the cmi masters that have the cross reference code 'Tax'? | SELECT T1.cmi_details FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id  =  T2.master_customer_id WHERE T2.source_system_code  =  'Tax' | 1. SELECT[tbl:​CMI_Cross_References] <br>2. PROJECT[tbl:​CMI_Cross_References, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Tax:​col:​CMI_Cross_References:​source_system_code] <br>4. PROJECT[col:​Customer_Master_Index:​cmi_details, #3] <br> | 1. SELECT[tbl:​CMI_Cross_References] <br>2. PROJECT[tbl:​CMI_Cross_References, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Tax:​col:​CMI_Cross_References:​source_system_code] <br>4. PROJECT[col:​Customer_Master_Index:​cmi_details, #3] <br> | + | medium | 
  | SPIDER_train_2648 | How many business rates are related to each cmi cross reference? List cross reference id, master customer id and the n | SELECT T2.cmi_cross_ref_id ,  T2.master_customer_id ,  count(*) FROM Business_Rates AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id GROUP BY T2.cmi_cross_ref_id | 1. SELECT[tbl:​Business_Rates] <br>2. PROJECT[col:​CMI_Cross_References:​cmi_cross_ref_id, #1] <br>3. GROUP[count, #1, #2] <br>4. SELECT[tbl:​CMI_Cross_References] <br>5. PROJECT[col:​CMI_Cross_References:​cmi_cross_ref_id, #4] <br>6. PROJECT[col:​CMI_Cross_References:​master_customer_id, #4] <br>7. UNION[#5, #6, #3] <br> | 1. SELECT[tbl:​Business_Rates] <br>2. PROJECT[col:​CMI_Cross_References:​cmi_cross_ref_id, #1] <br>3. GROUP[count, #1, #2] <br>4. SELECT[tbl:​CMI_Cross_References] <br>5. PROJECT[col:​CMI_Cross_References:​cmi_cross_ref_id, #4] <br>6. PROJECT[col:​CMI_Cross_References:​master_customer_id, #4] <br>7. UNION[#5, #6, #3] <br> | + | medium | 
  | SPIDER_train_2652 | What are the register ids of electoral registries that have the cross reference source system code 'Electoral' or 'Tax'? | SELECT T1.electoral_register_id FROM Electoral_Register AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id WHERE T2.source_system_code  =  'Electoral' OR T2.source_system_code  =  'Tax' | 1. SELECT[tbl:​Electoral_Register] <br>2. FILTER[#1, comparative:​=:​Electoral:​col:​CMI_Cross_References:​source_system_code] <br>3. FILTER[#1, comparative:​=:​Tax:​col:​CMI_Cross_References:​source_system_code] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​Electoral_Register:​electoral_register_id, #4] <br> | 1. SELECT[tbl:​Electoral_Register] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Electoral:​col:​CMI_Cross_References:​source_system_code] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Tax:​col:​CMI_Cross_References:​source_system_code] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​Electoral_Register:​electoral_register_id, #4] <br> | + | hard | 
  | SPIDER_train_2653 | How many different source system code for the cmi cross references are there? | SELECT count(DISTINCT source_system_code) FROM CMI_cross_references | 1. SELECT[tbl:​CMI_Cross_References] <br>2. PROJECT[col:​CMI_Cross_References:​source_system_code, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​CMI_Cross_References] <br>2. PROJECT[col:​CMI_Cross_References:​source_system_code, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_2655 | List the council tax ids and their related cmi cross references of all the parking fines. | SELECT council_tax_id ,  cmi_cross_ref_id FROM parking_fines | 1. SELECT[tbl:​Parking_Fines] <br>2. PROJECT[col:​Parking_Fines:​council_tax_id, #1] <br>3. PROJECT[col:​Parking_Fines:​cmi_cross_ref_id, #2] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Parking_Fines] <br>2. PROJECT[col:​Parking_Fines:​council_tax_id, #1] <br>3. PROJECT[col:​Parking_Fines:​cmi_cross_ref_id, #2] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_2656 | How many council taxes are collected for renting arrears ? | SELECT count(*) FROM rent_arrears | 1. SELECT[tbl:​Rent_Arrears] <br>2. PROJECT[col:​Rent_Arrears:​council_tax_id, #1] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Rent_Arrears] <br>2. PROJECT[col:​Rent_Arrears:​council_tax_id, #1] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_2657 | What are the distinct cross reference source system codes which are related to the master customer details 'Gottlieb, Becker and Wyman'? | SELECT DISTINCT T2.source_system_code FROM customer_master_index AS T1 JOIN cmi_cross_references AS T2 ON T1.master_customer_id  =  T2.master_customer_id WHERE T1.cmi_details  =  'Gottlieb ,  Becker and Wyman' | 1. SELECT[val:​Customer_Master_Index:​cmi_details:​Gottlieb ,  Becker and Wyman] <br>2.*(distinct)* PROJECT[col:​CMI_Cross_References:​source_system_code, #1] <br> | 1. SELECT[val:​Customer_Master_Index:​cmi_details:​Gottlieb ,  Becker and Wyman] <br>2.*(distinct)* PROJECT[col:​CMI_Cross_References:​source_system_code, #1] <br> | + | medium | 
  | SPIDER_train_2659 | Which distinct source system code includes the substring 'en'? | SELECT DISTINCT source_system_code FROM cmi_cross_references WHERE source_system_code LIKE '%en%' | 1. SELECT[col:​CMI_Cross_References:​source_system_code] <br>2.*(distinct)* PROJECT[the distinct #REF, #1] <br>3. PROJECT[substring of #REF, #2] <br>4. COMPARATIVE[#2, #3, comparative:​like:​%en%:​col:​CMI_Cross_References:​source_system_code] <br> | 1. SELECT[col:​CMI_Cross_References:​source_system_code] <br>2.*(distinct)* PROJECT[None, #1] <br>3. PROJECT[None, #2] <br>4. COMPARATIVE[#2, #3, comparative:​like:​en:​col:​CMI_Cross_References:​source_system_code] <br> | + | medium | 
 ***
 Exec acc: **1.0000**
