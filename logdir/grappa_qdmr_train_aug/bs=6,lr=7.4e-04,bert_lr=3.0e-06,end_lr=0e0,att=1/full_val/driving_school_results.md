 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **Addresses** | address_id | + |   | 
 | 2 |   | line_1_number_building |   |   | 
 | 3 |   | city |   |   | 
 | 4 |   | zip_postcode |   |   | 
 | 5 |   | state_province_county |   |   | 
 | 6 |   | country |   |   | 
 | 7 | **Staff** | staff_id | + |   | 
 | 8 |   | staff_address_id |   | --> 1 | 
 | 9 |   | nickname |   |   | 
 | 10 |   | first_name |   |   | 
 | 11 |   | middle_name |   |   | 
 | 12 |   | last_name |   |   | 
 | 13 |   | date_of_birth |   |   | 
 | 14 |   | date_joined_staff |   |   | 
 | 15 |   | date_left_staff |   |   | 
 | 16 | **Vehicles** | vehicle_id | + |   | 
 | 17 |   | vehicle_details |   |   | 
 | 18 | **Customers** | customer_id | + |   | 
 | 19 |   | customer_address_id |   | --> 1 | 
 | 20 |   | customer_status_code |   |   | 
 | 21 |   | date_became_customer |   |   | 
 | 22 |   | date_of_birth |   |   | 
 | 23 |   | first_name |   |   | 
 | 24 |   | last_name |   |   | 
 | 25 |   | amount_outstanding |   |   | 
 | 26 |   | email_address |   |   | 
 | 27 |   | phone_number |   |   | 
 | 28 |   | cell_mobile_phone_number |   |   | 
 | 29 | **Customer_Payments** | customer_id | + | --> 18 | 
 | 30 |   | datetime_payment |   |   | 
 | 31 |   | payment_method_code |   |   | 
 | 32 |   | amount_payment |   |   | 
 | 33 | **Lessons** | lesson_id | + |   | 
 | 34 |   | customer_id |   | --> 18 | 
 | 35 |   | lesson_status_code |   |   | 
 | 36 |   | staff_id |   | --> 7 | 
 | 37 |   | vehicle_id |   | --> 16 | 
 | 38 |   | lesson_date |   |   | 
 | 39 |   | lesson_time |   |   | 
 | 40 |   | price |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6622 | List all vehicle id | SELECT vehicle_id FROM Vehicles; | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[col:​Vehicles:​vehicle_id, #1] <br> | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[col:​Vehicles:​vehicle_id, #1] <br> | + | easy | 
  | SPIDER_train_6623 | What are the ids of all vehicles? | SELECT vehicle_id FROM Vehicles; | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[col:​Vehicles:​vehicle_id, #1] <br> | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[col:​Vehicles:​vehicle_id, #1] <br> | + | easy | 
  | SPIDER_train_6624 | How many vehicle in total? | SELECT count(*) FROM Vehicles; | 1. SELECT[tbl:​Vehicles] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Vehicles] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6625 | How many vehicles exist? | SELECT count(*) FROM Vehicles; | 1. SELECT[tbl:​Vehicles] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Vehicles] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6626 | Show the detail of vehicle with id 1. | SELECT vehicle_details FROM Vehicles WHERE vehicle_id = 1; | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[col:​Vehicles:​vehicle_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​Vehicles:​vehicle_id] <br>4. PROJECT[col:​Vehicles:​vehicle_details, #3] <br> | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[col:​Vehicles:​vehicle_id, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​Vehicles:​vehicle_id] <br>4. PROJECT[col:​Vehicles:​vehicle_details, #3] <br> | + | easy | 
  | SPIDER_train_6628 | List the first name middle name and last name of all staff. | SELECT first_name ,  middle_name ,  last_name FROM Staff; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. PROJECT[col:​Staff:​middle_name, #1] <br>4. PROJECT[col:​Staff:​last_name, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. PROJECT[col:​Staff:​middle_name, #1] <br>4. PROJECT[col:​Staff:​last_name, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6629 | What are the first, middle, and last names of all staff? | SELECT first_name ,  middle_name ,  last_name FROM Staff; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. PROJECT[col:​Staff:​middle_name, #1] <br>4. PROJECT[col:​Staff:​last_name, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. PROJECT[col:​Staff:​middle_name, #1] <br>4. PROJECT[col:​Staff:​last_name, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_6630 | What is the birthday of the staff member with first name as Janessa and last name as Sawayn? | SELECT date_of_birth FROM Staff WHERE first_name = "Janessa" AND last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Staff:​date_of_birth, #6] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Staff:​date_of_birth, #6] <br> | + | medium | 
  | SPIDER_train_6632 | When did the staff member with first name as Janessa and last name as Sawayn join the company? | SELECT date_joined_staff FROM Staff WHERE first_name = "Janessa" AND last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Staff:​date_joined_staff, #6] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Staff:​date_joined_staff, #6] <br> | + | medium | 
  | SPIDER_train_6634 | When did the staff member with first name as Janessa and last name as Sawayn leave the company? | SELECT date_left_staff FROM Staff WHERE first_name = "Janessa" AND last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Staff:​date_left_staff, #6] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Staff:​date_left_staff, #6] <br> | + | medium | 
  | SPIDER_train_6636 | How many staff have the first name Ludie? | SELECT count(*) FROM Staff WHERE first_name = "Ludie"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ludie:​col:​Staff:​first_name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ludie:​col:​Staff:​first_name] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6637 | How many employees have a first name of Ludie? | SELECT count(*) FROM Staff WHERE first_name = "Ludie"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ludie:​col:​Staff:​first_name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ludie:​col:​Staff:​first_name] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6638 | What is the nickname of staff with first name as Janessa and last name as Sawayn? | SELECT nickname FROM Staff WHERE first_name = "Janessa" AND last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. PROJECT[col:​Staff:​nickname, #1] <br>7. INTERSECTION[#6, #3, #5] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. PROJECT[col:​Staff:​nickname, #1] <br>7. INTERSECTION[#6, #3, #5] <br> | + | medium | 
  | SPIDER_train_6640 | How many staff in total? | SELECT count(*) FROM Staff; | 1. SELECT[tbl:​Staff] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Staff] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6641 | How many employees are there? | SELECT count(*) FROM Staff; | 1. SELECT[tbl:​Staff] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Staff] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6642 | Which city does staff with first name as Janessa and last name as Sawayn live? | SELECT T1.city FROM Addresses AS T1 JOIN Staff AS T2 ON T1.address_id = T2.staff_address_id WHERE T2.first_name = "Janessa" AND T2.last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Addresses:​city, #6] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Addresses:​city, #6] <br> | + | medium | 
  | SPIDER_train_6644 | Which country and state does staff with first name as Janessa and last name as Sawayn lived? | SELECT T1.country ,  T1.state_province_county FROM Addresses AS T1 JOIN Staff AS T2 ON T1.address_id = T2.staff_address_id WHERE T2.first_name = "Janessa" AND T2.last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. FILTER[#1, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>3. FILTER[#2, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>4. PROJECT[col:​Addresses:​state_province_county, #3] <br>5. PROJECT[col:​Addresses:​country, #4] <br>6. UNION[#5, #4] <br> | 1. SELECT[tbl:​Staff] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>4. PROJECT[col:​Addresses:​state_province_county, #3] <br>5. PROJECT[col:​Addresses:​country, #4] <br>6. UNION[#5, #4] <br> | + | extra | 
  | SPIDER_train_6646 | How long is the total lesson time took by customer with first name as Rylan and last name as Goodwin? | SELECT sum(T1.lesson_time) FROM Lessons AS T1 JOIN Customers AS T2 ON T1.customer_id  = T2.customer_id WHERE T2.first_name = "Rylan" AND T2.last_name = "Goodwin"; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. PROJECT[col:​Customers:​first_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Rylan:​col:​Customers:​first_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Goodwin:​col:​Customers:​last_name] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[tbl:​Lessons, #6] <br>8. PROJECT[col:​Lessons:​lesson_time, #7] <br>9. AGGREGATE[sum, #8] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. PROJECT[col:​Customers:​first_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Rylan:​col:​Customers:​first_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Goodwin:​col:​Customers:​last_name] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[tbl:​Lessons, #6] <br>8. PROJECT[col:​Lessons:​lesson_time, #7] <br>9. AGGREGATE[sum, #8] <br> | + | medium | 
  | SPIDER_train_6648 | What is the zip code of staff with first name as Janessa and last name as Sawayn lived? | SELECT T1.zip_postcode FROM Addresses AS T1 JOIN Staff AS T2 ON T1.address_id = T2.staff_address_id WHERE T2.first_name = "Janessa" AND T2.last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. FILTER[#1, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>3. FILTER[#2, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>4. PROJECT[col:​Addresses:​zip_postcode, #3] <br> | 1. SELECT[tbl:​Staff] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>4. PROJECT[col:​Addresses:​zip_postcode, #3] <br> | + | medium | 
  | SPIDER_train_6650 | How many staff live in state Georgia? | SELECT count(*) FROM Addresses WHERE state_province_county = "Georgia"; | 1. SELECT[tbl:​Addresses] <br>2. FILTER[#1, comparative:​=:​Georgia:​col:​Addresses:​state_province_county] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Addresses] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Georgia:​col:​Addresses:​state_province_county] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6651 | How many employees live in Georgia? | SELECT count(*) FROM Addresses WHERE state_province_county = "Georgia"; | 1. SELECT[tbl:​Addresses] <br>2. FILTER[#1, comparative:​=:​Georgia:​col:​Addresses:​state_province_county] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Addresses] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Georgia:​col:​Addresses:​state_province_county] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6654 | Which city lives most of staffs? List the city name and number of staffs. | SELECT T1.city ,  count(*) FROM Addresses AS T1 JOIN Staff AS T2 ON T1.address_id = T2.staff_address_id GROUP BY T1.city ORDER BY count(*) DESC LIMIT 1; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. AGGREGATE[max, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. AGGREGATE[max, #3] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_6656 | List the states which have between 2 to 4 staffs living there. | SELECT T1.state_province_county FROM Addresses AS T1 JOIN Staff AS T2 ON T1.address_id = T2.staff_address_id GROUP BY T1.state_province_county HAVING count(*) BETWEEN 2 AND 4; | 1. SELECT[col:​Addresses:​state_province_county] <br>2. PROJECT[tbl:​Staff, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. COMPARATIVE[#1, #3, comparative:​<=:​4] <br>6. INTERSECTION[#1, #4, #5] <br> | 1. SELECT[col:​Addresses:​state_province_county] <br>2. PROJECT[tbl:​Staff, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>=:​2] <br>5. COMPARATIVE[#1, #3, comparative:​<=:​4] <br>6. INTERSECTION[#1, #4, #5] <br> | + | medium | 
  | SPIDER_train_6658 | List the first name and last name of all customers. | SELECT first_name ,  last_name FROM Customers; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. PROJECT[col:​Customers:​last_name, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. PROJECT[col:​Customers:​last_name, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6659 | What are the first and last names for all customers? | SELECT first_name ,  last_name FROM Customers; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. PROJECT[col:​Customers:​last_name, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. PROJECT[col:​Customers:​last_name, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6660 | List email address and birthday of customer whose first name as Carole. | SELECT email_address ,  date_of_birth FROM Customers WHERE first_name = "Carole" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​email_address, #3] <br>5. PROJECT[col:​Customers:​date_of_birth, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​email_address, #3] <br>5. PROJECT[col:​Customers:​date_of_birth, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6661 | What are the email addresses and date of births for all customers who have a first name of Carole? | SELECT email_address ,  date_of_birth FROM Customers WHERE first_name = "Carole" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​email_address, #3] <br>5. PROJECT[col:​Customers:​date_of_birth, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​email_address, #3] <br>5. PROJECT[col:​Customers:​date_of_birth, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6662 | List phone number and email address of customer with more than 2000 outstanding balance. | SELECT phone_number ,  email_address FROM Customers WHERE amount_outstanding  >  2000; | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2000:​col:​Customers:​amount_outstanding] <br>4. AGGREGATE[col:​Customers:​phone_number, #3] <br>5. PROJECT[col:​Customers:​email_address, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[col:​Customers:​phone_number] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2000:​col:​Customers:​amount_outstanding] <br>4. AGGREGATE[sum, #3] <br>5. PROJECT[col:​Customers:​email_address, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6663 | What are the phone numbers and email addresses of all customers who have an outstanding balance of more than 2000? | SELECT phone_number ,  email_address FROM Customers WHERE amount_outstanding  >  2000; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2000:​col:​Customers:​amount_outstanding] <br>4. PROJECT[col:​Customers:​phone_number, #3] <br>5. PROJECT[col:​Customers:​email_address, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​2000:​col:​Customers:​amount_outstanding] <br>4. PROJECT[col:​Customers:​phone_number, #3] <br>5. PROJECT[col:​Customers:​email_address, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6664 | What is the status code, mobile phone number and email address of customer with last name as Kohler or first name as Marina? | SELECT customer_status_code ,  cell_mobile_phone_number ,  email_address FROM Customers WHERE first_name = "Marina" OR last_name  =  "Kohler" | 1. SELECT[col:​Customers:​cell_mobile_phone_number] <br>2. FILTER[#1, comparative:​=:​Kohler:​col:​Customers:​last_name] <br>3. FILTER[#1, comparative:​=:​Marina:​col:​Customers:​first_name] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​Customers:​customer_status_code, #4] <br>6. AGGREGATE[col:​Customers:​cell_mobile_phone_number, #4] <br>7. PROJECT[col:​Customers:​email_address, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[col:​Customers:​cell_mobile_phone_number] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Kohler:​col:​Customers:​last_name] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Marina:​col:​Customers:​first_name] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​Customers:​customer_status_code, #4] <br>6. AGGREGATE[sum, #4] <br>7. PROJECT[col:​Customers:​email_address, #4] <br>8. UNION[#5, #6, #7] <br> | + | extra | 
  | SPIDER_train_6665 | What is the status code, phone number, and email address of the customer whose last name is Kohler or whose first name is Marina? | SELECT customer_status_code ,  cell_mobile_phone_number ,  email_address FROM Customers WHERE first_name = "Marina" OR last_name  =  "Kohler" | 1. SELECT[col:​Customers:​cell_mobile_phone_number] <br>2. PROJECT[col:​Customers:​last_name, #1] <br>3. PROJECT[col:​Customers:​last_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Kohler:​col:​Customers:​last_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Marina:​col:​Customers:​first_name] <br>6. UNION[#4, #5] <br>7. PROJECT[col:​Customers:​customer_status_code, #6] <br>8. AGGREGATE[col:​Customers:​cell_mobile_phone_number, #6] <br>9. PROJECT[col:​Customers:​email_address, #6] <br>10. UNION[#7, #8, #9] <br> | 1. SELECT[col:​Customers:​cell_mobile_phone_number] <br>2. PROJECT[col:​Customers:​last_name, #1] <br>3. PROJECT[col:​Customers:​last_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Kohler:​col:​Customers:​last_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Marina:​col:​Customers:​first_name] <br>6. UNION[#4, #5] <br>7. PROJECT[col:​Customers:​customer_status_code, #6] <br>8. AGGREGATE[sum, #6] <br>9. PROJECT[col:​Customers:​email_address, #6] <br>10. UNION[#7, #8, #9] <br> | + | extra | 
  | SPIDER_train_6666 | When are the birthdays of customer who are classified as 'Good Customer' status? | SELECT date_of_birth FROM Customers WHERE customer_status_code  =  'Good Customer' | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Good Customer:​col:​Customers:​customer_status_code] <br>4. PROJECT[col:​Customers:​date_of_birth, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Good Customer:​col:​Customers:​customer_status_code] <br>4. PROJECT[col:​Customers:​date_of_birth, #3] <br> | + | easy | 
  | SPIDER_train_6667 | What is the date of birth of every customer whose status code is 'Good Customer'? | SELECT date_of_birth FROM Customers WHERE customer_status_code  =  'Good Customer' | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Good Customer:​col:​Customers:​customer_status_code] <br>4. PROJECT[col:​Customers:​date_of_birth, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​customer_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Good Customer:​col:​Customers:​customer_status_code] <br>4. PROJECT[col:​Customers:​date_of_birth, #3] <br> | + | easy | 
  | SPIDER_train_6668 | When did customer with first name as Carole and last name as Bernhard became a customer? | SELECT date_became_customer FROM Customers WHERE first_name = "Carole" AND last_name = "Bernhard"; | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, comparative:​=:​Carole:​col:​Customers:​first_name] <br>3. FILTER[#2, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>4. PROJECT[col:​Customers:​date_became_customer, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Carole:​col:​Customers:​first_name] <br>3. COMPARATIVE[#2, #2, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>4. PROJECT[col:​Customers:​date_became_customer, #3] <br> | + | medium | 
  | SPIDER_train_6670 | How many customers in total? | SELECT count(*) FROM Customers; | 1. SELECT[tbl:​Customers] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Customers] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6672 | List all customer status codes and the number of customers having each status code. | SELECT customer_status_code , count(*) FROM Customers GROUP BY customer_status_code; | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6673 | For each customer status code, how many customers are classified that way? | SELECT customer_status_code , count(*) FROM Customers GROUP BY customer_status_code; | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6674 | Which customer status code has least number of customers? | SELECT customer_status_code FROM Customers GROUP BY customer_status_code ORDER BY count(*) ASC LIMIT 1; | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6675 | What is the status code with the least number of customers? | SELECT customer_status_code FROM Customers GROUP BY customer_status_code ORDER BY count(*) ASC LIMIT 1; | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​min:​None] <br> | 1. SELECT[col:​Customers:​customer_status_code] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​min:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6676 | How many lessons taken by customer with first name as Rylan and last name as Goodwin were completed? | SELECT count(*) FROM Lessons AS T1 JOIN Customers AS T2 ON T1.customer_id  = T2.customer_id WHERE T2.first_name = "Rylan" AND T2.last_name = "Goodwin" AND T1.lesson_status_code = "Completed"; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Rylan:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Goodwin:​col:​Customers:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[tbl:​Lessons, #6] <br>8. FILTER[#7, comparative:​=:​Completed:​col:​Lessons:​lesson_status_code] <br>9. AGGREGATE[count, #8] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Rylan:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Goodwin:​col:​Customers:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[tbl:​Lessons, #6] <br>8. COMPARATIVE[#7, #7, comparative:​=:​Completed:​col:​Lessons:​lesson_status_code] <br>9. AGGREGATE[count, #8] <br> | + | medium | 
  | SPIDER_train_6678 | What is maximum, minimum and average amount of outstanding of customer? | SELECT max(amount_outstanding) ,  min(amount_outstanding) ,  avg(amount_outstanding) FROM Customers; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. AGGREGATE[max, #2] <br>4. AGGREGATE[min, #2] <br>5. AGGREGATE[avg, #2] <br>6. UNION[#3, #4, #5] <br> | + | medium | 
  | SPIDER_train_6679 | What is the maximum, minimum, and average amount of money outsanding for all customers? | SELECT max(amount_outstanding) ,  min(amount_outstanding) ,  avg(amount_outstanding) FROM Customers; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. PROJECT[col:​Customers:​amount_outstanding, #2] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. AGGREGATE[avg, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. PROJECT[col:​Customers:​amount_outstanding, #2] <br>4. AGGREGATE[max, #3] <br>5. AGGREGATE[min, #3] <br>6. AGGREGATE[avg, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6680 | List the first name and last name of customers have the amount of outstanding between 1000 and 3000. | SELECT first_name ,  last_name FROM Customers WHERE amount_outstanding BETWEEN 1000 AND 3000; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​1000:​col:​Customers:​amount_outstanding] <br>4. COMPARATIVE[#1, #2, comparative:​<=:​3000:​col:​Customers:​amount_outstanding] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​first_name, #5] <br>7. PROJECT[col:​Customers:​last_name, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​1000:​col:​Customers:​amount_outstanding] <br>4. COMPARATIVE[#1, #2, comparative:​<=:​3000:​col:​Customers:​amount_outstanding] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​first_name, #5] <br>7. PROJECT[col:​Customers:​last_name, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_6681 | What are the first and last names of all customers with between 1000 and 3000 dollars outstanding? | SELECT first_name ,  last_name FROM Customers WHERE amount_outstanding BETWEEN 1000 AND 3000; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​1000:​col:​Customers:​amount_outstanding] <br>4. COMPARATIVE[#1, #2, comparative:​<=:​3000:​col:​Customers:​amount_outstanding] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​first_name, #5] <br>7. PROJECT[col:​Customers:​last_name, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​amount_outstanding, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​1000:​col:​Customers:​amount_outstanding] <br>4. COMPARATIVE[#1, #2, comparative:​<=:​3000:​col:​Customers:​amount_outstanding] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​Customers:​first_name, #5] <br>7. PROJECT[col:​Customers:​last_name, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_6682 | List first name and last name of customers lived in city Lockmanfurt. | SELECT T1.first_name ,  T1.last_name FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id WHERE T2.city = "Lockmanfurt"; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Lockmanfurt:​col:​Addresses:​city] <br>4. PROJECT[col:​Customers:​first_name, #3] <br>5. PROJECT[col:​Customers:​last_name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Addresses:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Lockmanfurt:​col:​Addresses:​city] <br>4. PROJECT[col:​Customers:​first_name, #3] <br>5. PROJECT[col:​Customers:​last_name, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6683 | What are the first and last names of all customers who lived in Lockmanfurt? | SELECT T1.first_name ,  T1.last_name FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id WHERE T2.city = "Lockmanfurt"; | 1. SELECT[val:​Addresses:​city:​Lockmanfurt] <br>2. PROJECT[tbl:​Customers, #1] <br>3. PROJECT[col:​Customers:​first_name, #2] <br>4. PROJECT[col:​Customers:​last_name, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[val:​Addresses:​city:​Lockmanfurt] <br>2. PROJECT[tbl:​Customers, #1] <br>3. PROJECT[col:​Customers:​first_name, #2] <br>4. PROJECT[col:​Customers:​last_name, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_6684 | Which country does customer with first name as Carole and last name as Bernhard lived in? | SELECT T2.country FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id WHERE T1.first_name = "Carole" AND T1.last_name = "Bernhard" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>6. PROJECT[col:​Addresses:​country, #1] <br>7. INTERSECTION[#6, #3, #5] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>6. PROJECT[col:​Addresses:​country, #1] <br>7. INTERSECTION[#6, #3, #5] <br> | + | medium | 
  | SPIDER_train_6686 | What is zip code of customer with first name as Carole and last name as Bernhard? | SELECT T2.zip_postcode FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id WHERE T1.first_name = "Carole" AND T1.last_name = "Bernhard" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Addresses:​zip_postcode, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​last_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Carole:​col:​Customers:​first_name] <br>4. PROJECT[col:​Customers:​last_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Addresses:​zip_postcode, #6] <br> | + | medium | 
  | SPIDER_train_6688 | Which city does has most number of customers? | SELECT T2.city FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id GROUP BY T2.city ORDER BY count(*) DESC LIMIT 1; | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_6689 | What is the city with the most customers? | SELECT T2.city FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id GROUP BY T2.city ORDER BY count(*) DESC LIMIT 1; | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br> | 1. SELECT[col:​Addresses:​city] <br>2. PROJECT[tbl:​Customers, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_6690 | How much in total does customer with first name as Carole and last name as Bernhard paid? | SELECT sum(T1.amount_payment) FROM Customer_Payments AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id WHERE T2.first_name = "Carole" AND T2.last_name = "Bernhard" | 1. SELECT[tbl:​Customer_Payments] <br>2. FILTER[#1, comparative:​=:​Carole:​col:​Customers:​first_name] <br>3. FILTER[#1, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​Customer_Payments:​amount_payment, #4] <br>6. AGGREGATE[sum, #5] <br> | 1. SELECT[tbl:​Customer_Payments] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Carole:​col:​Customers:​first_name] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Bernhard:​col:​Customers:​last_name] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​Customer_Payments:​amount_payment, #4] <br>6. AGGREGATE[sum, #5] <br> | + | medium | 
  | SPIDER_train_6692 | List the number of customers that did not have any payment history. | SELECT count(*) FROM Customers WHERE customer_id NOT IN ( SELECT customer_id FROM Customer_Payments ); | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Customer_Payments] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Customer_Payments] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_6693 | How many customers have no payment histories? | SELECT count(*) FROM Customers WHERE customer_id NOT IN ( SELECT customer_id FROM Customer_Payments ); | 1. SELECT[tbl:​Customers] <br>2. FILTER[#1, tbl:​Customer_Payments] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Customers] <br>2. COMPARATIVE[#1, #1, tbl:​Customer_Payments] <br>3. DISCARD[#1, #2] <br>4. AGGREGATE[count, #3] <br> | + | extra | 
  | SPIDER_train_6694 | List first name and last name of customers that have more than 2 payments. | SELECT T2.first_name ,  T2.last_name FROM Customer_Payments AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >  2; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Customers:​first_name, #4] <br>6. PROJECT[col:​Customers:​last_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Customers:​first_name, #4] <br>6. PROJECT[col:​Customers:​last_name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6695 | What are the first and last names of all customers with more than 2 payments? | SELECT T2.first_name ,  T2.last_name FROM Customer_Payments AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >  2; | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Customers:​first_name, #4] <br>6. PROJECT[col:​Customers:​last_name, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Customers:​first_name, #4] <br>6. PROJECT[col:​Customers:​last_name, #4] <br>7. UNION[#5, #6] <br> | + | medium | 
  | SPIDER_train_6696 | List all payment methods and number of payments using each payment methods. | SELECT payment_method_code ,  count(*) FROM Customer_Payments GROUP BY payment_method_code; | 1. SELECT[col:​Customer_Payments:​payment_method_code] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customer_Payments:​payment_method_code] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6697 | For each payment method, how many payments were made? | SELECT payment_method_code ,  count(*) FROM Customer_Payments GROUP BY payment_method_code; | 1. SELECT[col:​Customer_Payments:​payment_method_code] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Customer_Payments:​payment_method_code] <br>2. PROJECT[tbl:​Customer_Payments, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6698 | How many lessons were in cancelled state? | SELECT count(*) FROM Lessons WHERE lesson_status_code = "Cancelled"; | 1. SELECT[tbl:​Lessons] <br>2. PROJECT[col:​Lessons:​lesson_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cancelled:​col:​Lessons:​lesson_status_code] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Lessons] <br>2. PROJECT[col:​Lessons:​lesson_status_code, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Cancelled:​col:​Lessons:​lesson_status_code] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_6699 | How many lessons have been cancelled? | SELECT count(*) FROM Lessons WHERE lesson_status_code = "Cancelled"; | 1. SELECT[tbl:​Lessons] <br>2. FILTER[#1, comparative:​=:​Cancelled:​col:​Lessons:​lesson_status_code] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​Lessons] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Cancelled:​col:​Lessons:​lesson_status_code] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6700 | List lesson id of all lessons taught by staff with first name as Janessa, last name as Sawayn and nickname containing letter 's'. | SELECT T1.lesson_id FROM Lessons AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T2.first_name = "Janessa" AND T2.last_name = "Sawayn" AND nickname LIKE "%s%"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #3] <br>5. COMPARATIVE[#3, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. PROJECT[col:​Staff:​first_name, #5] <br>7. COMPARATIVE[#5, #6, comparative:​like:​%s%:​col:​Staff:​nickname] <br>8. PROJECT[tbl:​Lessons, #7] <br>9. PROJECT[col:​Lessons:​lesson_id, #8] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #3] <br>5. COMPARATIVE[#3, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. PROJECT[col:​Staff:​first_name, #5] <br>7. COMPARATIVE[#5, #6, comparative:​like:​s:​col:​Staff:​nickname] <br>8. PROJECT[tbl:​Lessons, #7] <br>9. PROJECT[col:​Lessons:​lesson_id, #8] <br> | + | hard | 
  | SPIDER_train_6702 | How many lessons taught by staff whose first name has letter 'a' in it? | SELECT count(*) FROM Lessons AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T2.first_name LIKE "%a%" | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%a%:​col:​Staff:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​a:​col:​Staff:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | + | hard | 
  | SPIDER_train_6703 | How many lessons were taught by a staff member whose first name has the letter 'a' in it? | SELECT count(*) FROM Lessons AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T2.first_name LIKE "%a%" | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%a%:​col:​Staff:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​a:​col:​Staff:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | + | hard | 
  | SPIDER_train_6704 | How long is the total lesson time taught by staff with first name as Janessa and last name as Sawayn? | SELECT sum(lesson_time) FROM Lessons AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T2.first_name = "Janessa" AND T2.last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. PROJECT[col:​Staff:​first_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Lessons:​lesson_time, #6] <br>8. AGGREGATE[sum, #7] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. PROJECT[col:​Staff:​first_name, #1] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>5. COMPARATIVE[#1, #3, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #4, #5] <br>7. PROJECT[col:​Lessons:​lesson_time, #6] <br>8. AGGREGATE[sum, #7] <br> | + | medium | 
  | SPIDER_train_6706 | What is average lesson price taught by staff with first name as Janessa and last name as Sawayn? | SELECT avg(price) FROM Lessons AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T2.first_name = "Janessa" AND T2.last_name = "Sawayn"; | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Lessons:​price, #6] <br>8. AGGREGATE[avg, #7] <br> | 1. SELECT[tbl:​Staff] <br>2. PROJECT[col:​Staff:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Janessa:​col:​Staff:​first_name] <br>4. PROJECT[col:​Staff:​first_name, #1] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Sawayn:​col:​Staff:​last_name] <br>6. INTERSECTION[#1, #3, #5] <br>7. PROJECT[col:​Lessons:​price, #6] <br>8. AGGREGATE[avg, #7] <br> | + | medium | 
  | SPIDER_train_6708 | How many lesson does customer with first name Ray took? | SELECT count(*) FROM Lessons AS T1 JOIN Customers AS T2 ON T1.customer_id  = T2.customer_id WHERE T2.first_name = "Ray" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ray:​col:​Customers:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ray:​col:​Customers:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | + | medium | 
  | SPIDER_train_6709 | How many lessons did the customer with the first name Ray take? | SELECT count(*) FROM Lessons AS T1 JOIN Customers AS T2 ON T1.customer_id  = T2.customer_id WHERE T2.first_name = "Ray" | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ray:​col:​Customers:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​Customers] <br>2. PROJECT[col:​Customers:​first_name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Ray:​col:​Customers:​first_name] <br>4. PROJECT[tbl:​Lessons, #3] <br>5. AGGREGATE[count, #4] <br> | + | medium | 
  | SPIDER_train_6712 | What is the first name of the staff who did not give any lesson? | SELECT first_name FROM Staff EXCEPT SELECT T2.first_name FROM Lessons AS T1 JOIN Staff AS T2 ON T1.staff_id  =  T2.staff_id | 1. SELECT[tbl:​Staff] <br>2. FILTER[#1, tbl:​Lessons] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Staff:​first_name, #3] <br> | 1. SELECT[tbl:​Staff] <br>2. COMPARATIVE[#1, #1, tbl:​Lessons] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​Staff:​first_name, #3] <br> | + | hard | 
  | SPIDER_train_6714 | What is the id and detail of the vehicle used in lessons for most of the times? | SELECT T1.vehicle_id ,  T1.vehicle_details FROM Vehicles AS T1 JOIN Lessons AS T2 ON T1.vehicle_id  =  T2.vehicle_id GROUP BY T1.vehicle_id ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[tbl:​Lessons, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Vehicles:​vehicle_id, #4] <br>6. PROJECT[col:​Vehicles:​vehicle_details, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​Vehicles] <br>2. PROJECT[tbl:​Lessons, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​Vehicles:​vehicle_id, #4] <br>6. PROJECT[col:​Vehicles:​vehicle_details, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
 ***
 Exec acc: **1.0000**
