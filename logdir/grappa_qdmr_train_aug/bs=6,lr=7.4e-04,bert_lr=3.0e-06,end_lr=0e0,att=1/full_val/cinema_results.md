 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **film** | Film_ID | + |   | 
 | 2 |   | Rank_in_series |   |   | 
 | 3 |   | Number_in_season |   |   | 
 | 4 |   | Title |   |   | 
 | 5 |   | Directed_by |   |   | 
 | 6 |   | Original_air_date |   |   | 
 | 7 |   | Production_code |   |   | 
 | 8 | **cinema** | Cinema_ID | + |   | 
 | 9 |   | Name |   |   | 
 | 10 |   | Openning_year |   |   | 
 | 11 |   | Capacity |   |   | 
 | 12 |   | Location |   |   | 
 | 13 | **schedule** | Cinema_ID | + | --> 8 | 
 | 14 |   | Film_ID |   | --> 1 | 
 | 15 |   | Date |   |   | 
 | 16 |   | Show_times_per_day |   |   | 
 | 17 |   | Price |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_1932 | How many cinema do we have? | SELECT count(*) FROM cinema | 1. SELECT[tbl:​cinema] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​cinema] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1933 | Count the number of cinemas. | SELECT count(*) FROM cinema | 1. SELECT[tbl:​cinema] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​cinema] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_1934 | Show name, opening year, and capacity for each cinema. | SELECT name ,  openning_year ,  capacity FROM cinema | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Name, #1] <br>3. PROJECT[col:​cinema:​Openning_year, #1] <br>4. PROJECT[col:​cinema:​Capacity, #1] <br>5. UNION[#2, #3, #4] <br> | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Name, #1] <br>3. PROJECT[col:​cinema:​Openning_year, #1] <br>4. PROJECT[col:​cinema:​Capacity, #1] <br>5. UNION[#2, #3, #4] <br> | + | medium | 
  | SPIDER_train_1935 | Show the cinema name and location for cinemas with capacity above average. | SELECT name ,  LOCATION FROM cinema WHERE capacity  >  (SELECT avg(capacity) FROM cinema) | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Capacity, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #2, comparative:​>:​#3] <br>5. PROJECT[col:​cinema:​Name, #4] <br>6. PROJECT[col:​cinema:​Location, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Capacity, #1] <br>3. AGGREGATE[avg, #2] <br>4. COMPARATIVE[#1, #1, comparative:​=:​#3] <br>5. PROJECT[col:​cinema:​Name, #4] <br>6. PROJECT[col:​cinema:​Location, #4] <br>7. UNION[#5, #6] <br> | - | extra | 
  | SPIDER_train_1936 | What are all the locations with a cinema? | SELECT DISTINCT LOCATION FROM cinema | 1. SELECT[col:​cinema:​Location] <br>2. FILTER[#1, tbl:​cinema] <br> | 1. SELECT[col:​cinema:​Location] <br>2. COMPARATIVE[#1, #1, tbl:​cinema] <br> | + | easy | 
  | SPIDER_train_1937 | Find the distinct locations that has a cinema. | SELECT DISTINCT LOCATION FROM cinema | 1. SELECT[col:​cinema:​Location] <br>2. FILTER[#1, tbl:​cinema] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br> | 1. SELECT[col:​cinema:​Location] <br>2. COMPARATIVE[#1, #1, tbl:​cinema] <br>3.*(distinct)* PROJECT[None, #2] <br> | + | easy | 
  | SPIDER_train_1938 | Show all the cinema names and opening years in descending order of opening year. | SELECT name ,  openning_year FROM cinema ORDER BY openning_year DESC | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Name, #1] <br>3. PROJECT[col:​cinema:​Openning_year, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Name, #1] <br>3. PROJECT[col:​cinema:​Openning_year, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #3, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_1939 | What are the name and location of the cinema with the largest capacity? | SELECT name ,  LOCATION FROM cinema ORDER BY capacity DESC LIMIT 1 | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Capacity, #1] <br>3. COMPARATIVE[#1, #2, comparative:​max:​None] <br>4. PROJECT[col:​cinema:​Name, #3] <br>5. PROJECT[col:​cinema:​Location, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Capacity, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​cinema:​Name, #3] <br>5. PROJECT[col:​cinema:​Location, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_1940 | Show the average, minimum, and maximum capacity for all the cinemas opened in year 2011 or later. | SELECT avg(capacity) ,  min(capacity) ,  max(capacity) FROM cinema WHERE openning_year  >=  2011 | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Openning_year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​2011:​col:​cinema:​Openning_year] <br>4. PROJECT[col:​cinema:​Capacity, #3] <br>5. AGGREGATE[avg, #4] <br>6. AGGREGATE[min, #4] <br>7. AGGREGATE[max, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[tbl:​cinema] <br>2. PROJECT[col:​cinema:​Openning_year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>=:​2011:​col:​cinema:​Openning_year] <br>4. PROJECT[col:​cinema:​Capacity, #3] <br>5. AGGREGATE[avg, #4] <br>6. AGGREGATE[min, #4] <br>7. AGGREGATE[max, #4] <br>8. UNION[#5, #6, #7] <br> | + | medium | 
  | SPIDER_train_1941 | Show each location and the number of cinemas there. | SELECT LOCATION ,  count(*) FROM cinema GROUP BY LOCATION | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1942 | What is the location with the most cinemas opened in year 2010 or later? | SELECT LOCATION FROM cinema WHERE openning_year  >=  2010 GROUP BY LOCATION ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Openning_year, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>=:​2010:​col:​cinema:​Openning_year] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Openning_year, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>=:​2010:​col:​cinema:​Openning_year] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | + | extra | 
  | SPIDER_train_1943 | Show all the locations with at least two cinemas with capacity above 300. | SELECT LOCATION FROM cinema WHERE capacity  >  300 GROUP BY LOCATION HAVING count(*)  >=  2 | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>=:​2] <br> | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>=:​2] <br> | + | medium | 
  | SPIDER_train_1944 | Which locations have 2 or more cinemas with capacity over 300? | SELECT LOCATION FROM cinema WHERE capacity  >  300 GROUP BY LOCATION HAVING count(*)  >=  2 | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>=:​2] <br> | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>=:​2] <br> | + | medium | 
  | SPIDER_train_1945 | Show the title and director for all films. | SELECT title ,  directed_by FROM film | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[col:​film:​Directed_by, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[col:​film:​Directed_by, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1946 | What are the title and director of each film? | SELECT title ,  directed_by FROM film | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[col:​film:​Directed_by, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[col:​film:​Directed_by, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_1947 | Show all directors. | SELECT DISTINCT directed_by FROM film | 1. SELECT[col:​film:​Directed_by] <br> | 1. SELECT[col:​film:​Directed_by] <br> | + | easy | 
  | SPIDER_train_1948 | Who are all the directors? | SELECT DISTINCT directed_by FROM film | 1. SELECT[col:​film:​Directed_by] <br> | 1. SELECT[col:​film:​Directed_by] <br> | + | easy | 
  | SPIDER_train_1949 | List all directors along with the number of films directed by each director. | SELECT directed_by ,  count(*) FROM film GROUP BY directed_by | 1. SELECT[col:​film:​Directed_by] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​film:​Directed_by] <br>2. PROJECT[tbl:​film, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_1951 | What are the title and maximum price of each film? | SELECT T2.title ,  max(T1.price) FROM schedule AS T1 JOIN film AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id | 1. SELECT[col:​schedule:​Film_ID] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[col:​schedule:​Price, #1] <br>4. GROUP[max, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​schedule:​Film_ID] <br>2. PROJECT[col:​film:​Title, #1] <br>3. PROJECT[col:​schedule:​Price, #1] <br>4. GROUP[max, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_1952 | Give me the title and highest price for each film. | SELECT T2.title ,  max(T1.price) FROM schedule AS T1 JOIN film AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id | 1. SELECT[col:​schedule:​Film_ID] <br>2. PROJECT[col:​schedule:​Price, #1] <br>3. GROUP[max, #2, #1] <br>4. PROJECT[col:​film:​Title, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[col:​schedule:​Film_ID] <br>2. PROJECT[col:​schedule:​Price, #1] <br>3. GROUP[max, #2, #1] <br>4. PROJECT[col:​film:​Title, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_1954 | What are the title and director of the films without any schedule? | SELECT title ,  directed_by FROM film WHERE film_id NOT IN (SELECT film_id FROM schedule) | 1. SELECT[tbl:​film] <br>2. FILTER[#1, tbl:​schedule] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​film:​Title, #3] <br>5. PROJECT[col:​film:​Directed_by, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​film] <br>2. COMPARATIVE[#1, #1, tbl:​schedule] <br>3. DISCARD[#1, #2] <br>4. PROJECT[col:​film:​Title, #3] <br>5. PROJECT[col:​film:​Directed_by, #3] <br>6. UNION[#4, #5] <br> | + | extra | 
  | SPIDER_train_1955 | Show director with the largest number of show times in total. | SELECT T2.directed_by FROM schedule AS T1 JOIN film AS T2 ON T1.film_id  =  T2.film_id GROUP BY T2.directed_by ORDER BY sum(T1.show_times_per_day) DESC LIMIT 1 | 1. SELECT[col:​film:​Directed_by] <br>2. PROJECT[col:​schedule:​Show_times_per_day, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​film:​Directed_by] <br>2. PROJECT[col:​schedule:​Show_times_per_day, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | extra | 
  | SPIDER_train_1956 | Find the locations that have more than one movie theater with capacity above 300. | SELECT LOCATION FROM cinema WHERE capacity  >  300 GROUP BY LOCATION HAVING count(*)  >  1 | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​1] <br> | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​1] <br> | + | medium | 
  | SPIDER_train_1957 | In which locations are there more than one movie theater with capacity above 300? | SELECT LOCATION FROM cinema WHERE capacity  >  300 GROUP BY LOCATION HAVING count(*)  >  1 | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​1] <br> | 1. SELECT[col:​cinema:​Location] <br>2. PROJECT[tbl:​cinema, #1] <br>3. PROJECT[col:​cinema:​Capacity, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​300:​col:​cinema:​Capacity] <br>5. GROUP[count, #4, #1] <br>6. COMPARATIVE[#1, #5, comparative:​>:​1] <br> | + | medium | 
  | SPIDER_train_1959 | Count the number of films whose title contains the word 'Dummy'. | SELECT count(*) FROM film WHERE title LIKE "%Dummy%" | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%Dummy%:​col:​film:​Title] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​film] <br>2. PROJECT[col:​film:​Title, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Dummy:​col:​film:​Title] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
 ***
 Exec acc: **0.9600**
