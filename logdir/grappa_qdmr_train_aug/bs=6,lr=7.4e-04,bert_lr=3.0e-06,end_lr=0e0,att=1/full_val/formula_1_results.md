 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **circuits** | circuitId | + | --> 13 | 
 | 2 |   | circuitRef |   |   | 
 | 3 |   | name |   |   | 
 | 4 |   | location |   |   | 
 | 5 |   | country |   |   | 
 | 6 |   | lat |   |   | 
 | 7 |   | lng |   |   | 
 | 8 |   | alt |   |   | 
 | 9 |   | url |   |   | 
 | 10 | **races** | raceId | + | --> 82 | 
 | 11 |   | year |   | --> 29 | 
 | 12 |   | round |   |   | 
 | 13 |   | circuitId |   |   | 
 | 14 |   | name |   |   | 
 | 15 |   | date |   |   | 
 | 16 |   | time |   |   | 
 | 17 |   | url |   |   | 
 | 18 | **drivers** | driverId | + | --> 83 | 
 | 19 |   | driverRef |   |   | 
 | 20 |   | number |   |   | 
 | 21 |   | code |   |   | 
 | 22 |   | forename |   |   | 
 | 23 |   | surname |   |   | 
 | 24 |   | dob |   |   | 
 | 25 |   | nationality |   |   | 
 | 26 |   | url |   |   | 
 | 27 | **status** | statusId | + |   | 
 | 28 |   | status |   |   | 
 | 29 | **seasons** | year | + |   | 
 | 30 |   | url |   |   | 
 | 31 | **constructors** | constructorId | + | --> 76 | 
 | 32 |   | constructorRef |   |   | 
 | 33 |   | name |   |   | 
 | 34 |   | nationality |   |   | 
 | 35 |   | url |   |   | 
 | 36 | **constructorStandings** | constructorStandingsId | + |   | 
 | 37 |   | raceId |   |   | 
 | 38 |   | constructorId |   |   | 
 | 39 |   | points |   |   | 
 | 40 |   | position |   |   | 
 | 41 |   | positionText |   |   | 
 | 42 |   | wins |   |   | 
 | 43 | **results** | resultId | + |   | 
 | 44 |   | raceId |   |   | 
 | 45 |   | driverId |   |   | 
 | 46 |   | constructorId |   |   | 
 | 47 |   | number |   |   | 
 | 48 |   | grid |   |   | 
 | 49 |   | position |   |   | 
 | 50 |   | positionText |   |   | 
 | 51 |   | positionOrder |   |   | 
 | 52 |   | points |   |   | 
 | 53 |   | laps |   |   | 
 | 54 |   | time |   |   | 
 | 55 |   | milliseconds |   |   | 
 | 56 |   | fastestLap |   |   | 
 | 57 |   | rank |   |   | 
 | 58 |   | fastestLapTime |   |   | 
 | 59 |   | fastestLapSpeed |   |   | 
 | 60 |   | statusId |   | --> 27 | 
 | 61 | **driverStandings** | driverStandingsId | + |   | 
 | 62 |   | raceId |   |   | 
 | 63 |   | driverId |   |   | 
 | 64 |   | points |   |   | 
 | 65 |   | position |   |   | 
 | 66 |   | positionText |   |   | 
 | 67 |   | wins |   |   | 
 | 68 | **constructorResults** | constructorResultsId | + |   | 
 | 69 |   | raceId |   |   | 
 | 70 |   | constructorId |   |   | 
 | 71 |   | points |   |   | 
 | 72 |   | status |   |   | 
 | 73 | **qualifying** | qualifyId | + |   | 
 | 74 |   | raceId |   |   | 
 | 75 |   | driverId |   |   | 
 | 76 |   | constructorId |   |   | 
 | 77 |   | number |   |   | 
 | 78 |   | position |   |   | 
 | 79 |   | q1 |   |   | 
 | 80 |   | q2 |   |   | 
 | 81 |   | q3 |   |   | 
 | 82 | **pitStops** | raceId | + |   | 
 | 83 |   | driverId |   |   | 
 | 84 |   | stop |   |   | 
 | 85 |   | lap |   |   | 
 | 86 |   | time |   |   | 
 | 87 |   | duration |   |   | 
 | 88 |   | milliseconds |   |   | 
 | 89 | **lapTimes** | raceId | + |   | 
 | 90 |   | driverId |   |   | 
 | 91 |   | lap |   |   | 
 | 92 |   | position |   |   | 
 | 93 |   | time |   |   | 
 | 94 |   | milliseconds |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_2157 | Find the names of all races held in 2017. | SELECT name FROM races WHERE YEAR = 2017 | 1. SELECT[tbl:​races] <br>2. FILTER[#1, comparative:​=:​2017:​col:​races:​year] <br>3. PROJECT[col:​races:​name, #2] <br> | 1. SELECT[tbl:​races] <br>2. COMPARATIVE[#1, #1, comparative:​=:​2017:​col:​races:​year] <br>3. PROJECT[col:​races:​name, #2] <br> | + | easy | 
  | SPIDER_train_2158 | What are the names of all the races that occurred in the year 2017? | SELECT name FROM races WHERE YEAR = 2017 | 1. SELECT[tbl:​races] <br>2. PROJECT[col:​races:​year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​2017:​col:​races:​year] <br>4. PROJECT[col:​races:​name, #3] <br> | 1. SELECT[tbl:​races] <br>2. PROJECT[col:​races:​year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​2017:​col:​races:​year] <br>4. PROJECT[col:​races:​name, #3] <br> | + | easy | 
  | SPIDER_train_2159 | Find the distinct names of all races held between 2014 and 2017? | SELECT DISTINCT name FROM races WHERE YEAR BETWEEN 2014 AND 2017 | 1. SELECT[tbl:​races] <br>2. FILTER[#1, comparative:​>=:​2014:​col:​races:​year] <br>3. FILTER[#2, comparative:​<=:​2017:​col:​races:​year] <br>4.*(distinct)* PROJECT[col:​races:​name, #3] <br> | 1. SELECT[tbl:​races] <br>2. COMPARATIVE[#1, #1, comparative:​>=:​2014:​col:​races:​year] <br>3. COMPARATIVE[#2, #2, comparative:​<=:​2017:​col:​races:​year] <br>4.*(distinct)* PROJECT[col:​races:​name, #3] <br> | - | easy | 
  | SPIDER_train_2161 | List the forename and surname of all distinct drivers who once had laptime less than 93000 milliseconds? | SELECT DISTINCT T1.forename ,  T1.surname FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid WHERE T2.milliseconds < 93000 | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​lapTimes, #1] <br>3. FILTER[#2, col:​lapTimes:​milliseconds] <br>4. COMPARATIVE[#1, #3, comparative:​<:​93000:​col:​lapTimes:​milliseconds] <br>5. PROJECT[the distinct #REF, #4] <br>6. PROJECT[col:​drivers:​forename, #5] <br>7. PROJECT[col:​drivers:​surname, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​lapTimes, #1] <br>3. COMPARATIVE[#2, #2, col:​lapTimes:​milliseconds] <br>4. COMPARATIVE[#1, #3, comparative:​<:​93000:​col:​lapTimes:​milliseconds] <br>5. PROJECT[None, #4] <br>6. PROJECT[col:​drivers:​forename, #5] <br>7. PROJECT[col:​drivers:​surname, #5] <br>8. UNION[#6, #7] <br> | + | medium | 
  | SPIDER_train_2162 | What are the forenames and surnames of all unique drivers who had a lap time of less than 93000 milliseconds? | SELECT DISTINCT T1.forename ,  T1.surname FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid WHERE T2.milliseconds < 93000 | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​lapTimes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​93000:​col:​lapTimes:​milliseconds] <br>4. PROJECT[col:​drivers:​forename, #3] <br>5. PROJECT[col:​drivers:​surname, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​lapTimes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​93000:​col:​lapTimes:​milliseconds] <br>4. PROJECT[col:​drivers:​forename, #3] <br>5. PROJECT[col:​drivers:​surname, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_2163 | Find all the distinct id and nationality of drivers who have had laptime more than 100000 milliseconds? | SELECT DISTINCT T1.driverid ,  T1.nationality FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid WHERE T2.milliseconds >  100000 | 1. SELECT[col:​drivers:​driverId] <br>2. FILTER[#1, comparative:​>:​100000:​col:​lapTimes:​milliseconds] <br>3.*(distinct)* FILTER[#2, col:​drivers:​driverId] <br>4. PROJECT[col:​drivers:​nationality, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​drivers:​driverId] <br>2. COMPARATIVE[#1, #1, comparative:​>:​100000:​col:​lapTimes:​milliseconds] <br>3.*(distinct)* COMPARATIVE[#2, #2, col:​drivers:​driverId] <br>4. PROJECT[col:​drivers:​nationality, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_2164 | What are the different driver ids and nationalities of all drivers who had a laptime of more than 100000 milliseconds? | SELECT DISTINCT T1.driverid ,  T1.nationality FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid WHERE T2.milliseconds >  100000 | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​lapTimes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100000:​col:​lapTimes:​milliseconds] <br>4.*(distinct)* PROJECT[col:​drivers:​driverId, #3] <br>5. PROJECT[col:​drivers:​nationality, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​lapTimes, #1] <br>3. COMPARATIVE[#1, #2, comparative:​>:​100000:​col:​lapTimes:​milliseconds] <br>4.*(distinct)* PROJECT[col:​drivers:​driverId, #3] <br>5. PROJECT[col:​drivers:​nationality, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_2169 | What is the id, forname and surname of the driver who had the first position in terms of laptime at least twice? | SELECT T1.driverid ,  T1.forename ,  T1.surname FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid WHERE POSITION  =  '1' GROUP BY T1.driverid HAVING count(*)  >=  2 | 1. SELECT[tbl:​drivers] <br>2. FILTER[#1, comparative:​>=:​2] <br>3. FILTER[#2, comparative:​=:​1:​col:​lapTimes:​position] <br>4. PROJECT[col:​drivers:​driverId, #3] <br>5. PROJECT[col:​drivers:​forename, #3] <br>6. PROJECT[col:​drivers:​surname, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​drivers] <br>2. COMPARATIVE[#1, #1, comparative:​>=:​1:​col:​lapTimes:​position] <br>3. COMPARATIVE[#2, #2, comparative:​=:​1:​col:​lapTimes:​position] <br>4. PROJECT[col:​drivers:​driverId, #3] <br>5. PROJECT[col:​drivers:​forename, #3] <br>6. PROJECT[col:​drivers:​surname, #3] <br>7. UNION[#4, #5, #6] <br> | + | hard | 
  | SPIDER_train_2170 | What is the id, first name, and last name of the driver who was in the first position for laptime at least twice? | SELECT T1.driverid ,  T1.forename ,  T1.surname FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid WHERE POSITION  =  '1' GROUP BY T1.driverid HAVING count(*)  >=  2 | 1. SELECT[tbl:​drivers] <br>2. FILTER[#1, comparative:​>=:​2] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​lapTimes:​position] <br>4. PROJECT[col:​drivers:​driverId, #3] <br>5. PROJECT[col:​drivers:​forename, #3] <br>6. PROJECT[col:​drivers:​surname, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​drivers] <br>2. COMPARATIVE[#1, #1, comparative:​>=:​1:​col:​lapTimes:​position] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​lapTimes:​position] <br>4. PROJECT[col:​drivers:​driverId, #3] <br>5. PROJECT[col:​drivers:​forename, #3] <br>6. PROJECT[col:​drivers:​surname, #3] <br>7. UNION[#4, #5, #6] <br> | + | hard | 
  | SPIDER_train_2175 | Give me a list of names and years of races that had any driver whose forename is Lewis? | SELECT T2.name ,  T2.year FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T1.driverid = T3.driverid WHERE T3.forename = "Lewis" | 1. SELECT[col:​results:​raceId] <br>2. PROJECT[tbl:​drivers, #1] <br>3. PROJECT[col:​drivers:​forename, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Lewis:​col:​drivers:​forename] <br>5. PROJECT[col:​races:​name, #4] <br>6. PROJECT[col:​races:​year, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​results:​raceId] <br>2. PROJECT[tbl:​drivers, #1] <br>3. PROJECT[col:​drivers:​forename, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Lewis:​col:​drivers:​forename] <br>5. PROJECT[col:​races:​name, #4] <br>6. PROJECT[col:​races:​year, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_2176 | What are the names and years of all races that had a driver with the last name Lewis? | SELECT T2.name ,  T2.year FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T1.driverid = T3.driverid WHERE T3.forename = "Lewis" | 1. SELECT[col:​results:​raceId] <br>2. PROJECT[tbl:​drivers, #1] <br>3. PROJECT[col:​drivers:​forename, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Lewis:​col:​drivers:​forename] <br>5. PROJECT[col:​races:​name, #4] <br>6. PROJECT[col:​races:​year, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​results:​raceId] <br>2. PROJECT[tbl:​drivers, #1] <br>3. PROJECT[col:​drivers:​forename, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Lewis:​col:​drivers:​forename] <br>5. PROJECT[col:​races:​name, #4] <br>6. PROJECT[col:​races:​year, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_2177 | Find the forename and surname of drivers whose nationality is German? | SELECT forename ,  surname FROM drivers WHERE nationality = "German" | 1. SELECT[tbl:​drivers] <br>2. PROJECT[col:​drivers:​nationality, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​German:​col:​drivers:​nationality] <br>4. PROJECT[col:​drivers:​forename, #3] <br>5. PROJECT[col:​drivers:​surname, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​drivers] <br>2. PROJECT[col:​drivers:​nationality, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​German:​col:​drivers:​nationality] <br>4. PROJECT[col:​drivers:​forename, #3] <br>5. PROJECT[col:​drivers:​surname, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_2178 | What is the first and last name of all the German drivers? | SELECT forename ,  surname FROM drivers WHERE nationality = "German" | 1. SELECT[tbl:​drivers] <br>2. FILTER[#1, comparative:​=:​German:​col:​drivers:​nationality] <br>3. PROJECT[col:​drivers:​forename, #2] <br>4. PROJECT[col:​drivers:​surname, #2] <br>5. UNION[#3, #4] <br> | 1. SELECT[tbl:​drivers] <br>2. COMPARATIVE[#1, #1, comparative:​=:​German:​col:​drivers:​nationality] <br>3. PROJECT[col:​drivers:​forename, #2] <br>4. PROJECT[col:​drivers:​surname, #2] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_2179 | Find the id and forenames of drivers who participated both the races with name Australian Grand Prix and the races with name Chinese Grand Prix? | SELECT T2.driverid ,  T3.forename FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid  =  T3.driverid WHERE T1.name = "Australian Grand Prix" INTERSECT SELECT T2.driverid ,  T3.forename FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid  =  T3.driverid WHERE T1.name = "Chinese Grand Prix" | 1. SELECT[val:​races:​name:​Chinese Grand Prix] <br>2. SELECT[val:​races:​name:​Australian Grand Prix] <br>3. SELECT[col:​results:​driverId] <br>4. INTERSECTION[#3, #1, #2] <br>5. PROJECT[col:​results:​driverId, #4] <br>6. PROJECT[col:​drivers:​forename, #5] <br>7. UNION[#5, #6] <br> | 1. SELECT[val:​races:​name:​Chinese Grand Prix] <br>2. SELECT[val:​races:​name:​Australian Grand Prix] <br>3. SELECT[col:​results:​driverId] <br>4. INTERSECTION[#3, #1, #2] <br>5. PROJECT[col:​results:​driverId, #4] <br>6. PROJECT[col:​drivers:​forename, #5] <br>7. UNION[#5, #6] <br> | - | extra | 
  | SPIDER_train_2182 | What are the first and last names of all drivers who participated in the Australian Grand Prix but not the Chinese Grand Prix? | SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = "Australian Grand Prix" EXCEPT SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = "Chinese Grand Prix" | 1. SELECT[col:​results:​driverId] <br>2. FILTER[#1, comparative:​=:​Australian Grand Prix:​col:​races:​name] <br>3. FILTER[#1, comparative:​=:​Chinese Grand Prix:​col:​races:​name] <br>4. INTERSECTION[#1, #2, #3] <br>5. DISCARD[#2, #4] <br>6. PROJECT[col:​drivers:​forename, #5] <br>7. PROJECT[col:​drivers:​surname, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[col:​results:​driverId] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Australian Grand Prix:​col:​races:​name] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Chinese Grand Prix:​col:​races:​name] <br>4. INTERSECTION[#1, #2, #3] <br>5. DISCARD[#2, #4] <br>6. PROJECT[col:​drivers:​forename, #5] <br>7. PROJECT[col:​drivers:​surname, #5] <br>8. UNION[#6, #7] <br> | - | extra | 
  | SPIDER_train_2184 | What are all the different first names of the drivers who are in position as standing and won? | SELECT DISTINCT T1.forename FROM drivers AS T1 JOIN driverstandings AS T2 ON T1.driverid = T2.driverid WHERE T2.position = 1 AND T2.wins = 1 | 1. SELECT[tbl:​driverStandings] <br>2. PROJECT[col:​driverStandings:​position, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​driverStandings:​position] <br>4. FILTER[#3, comparative:​=:​1:​col:​driverStandings:​wins] <br>5.*(distinct)* PROJECT[col:​drivers:​forename, #4] <br> | 1. SELECT[tbl:​driverStandings] <br>2. PROJECT[col:​driverStandings:​position, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​1:​col:​driverStandings:​position] <br>4. COMPARATIVE[#3, #3, comparative:​=:​1:​col:​driverStandings:​position] <br>5.*(distinct)* PROJECT[col:​drivers:​forename, #4] <br> | - | medium | 
  | SPIDER_train_2191 | What are the names of races that were held after 2017 and the circuits were in the country of Spain? | SELECT T1.name FROM races AS T1 JOIN circuits AS T2 ON T1.circuitid = T2.circuitid WHERE T2.country = "Spain" AND T1.year > 2017 | 1. SELECT[tbl:​races] <br>2. FILTER[#1, comparative:​>:​2017:​col:​races:​year] <br>3. PROJECT[tbl:​circuits, #1] <br>4. PROJECT[col:​circuits:​country, #3] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Spain:​col:​circuits:​country] <br>6. INTERSECTION[#1, #2, #5] <br>7. PROJECT[col:​races:​name, #6] <br> | 1. SELECT[tbl:​races] <br>2. COMPARATIVE[#1, #1, comparative:​>:​2017:​col:​races:​year] <br>3. PROJECT[tbl:​circuits, #1] <br>4. PROJECT[col:​circuits:​country, #3] <br>5. COMPARATIVE[#1, #4, comparative:​=:​Spain:​col:​circuits:​country] <br>6. INTERSECTION[#1, #2, #5] <br>7. PROJECT[col:​races:​name, #6] <br> | - | medium | 
  | SPIDER_train_2192 | What are the names of the races held after 2017 in Spain? | SELECT T1.name FROM races AS T1 JOIN circuits AS T2 ON T1.circuitid = T2.circuitid WHERE T2.country = "Spain" AND T1.year > 2017 | 1. SELECT[tbl:​races] <br>2. FILTER[#1, comparative:​>:​2017:​col:​races:​year] <br>3. FILTER[#1, comparative:​=:​Spain:​col:​circuits:​country] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​races:​name, #4] <br> | 1. SELECT[tbl:​races] <br>2. COMPARATIVE[#1, #1, comparative:​>:​2017:​col:​races:​year] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Spain:​col:​circuits:​country] <br>4. INTERSECTION[#1, #2, #3] <br>5. PROJECT[col:​races:​name, #4] <br> | - | medium | 
  | SPIDER_train_2195 | Find the distinct driver id and the stop number of all drivers that have a shorter pit stop duration than some drivers in the race with id 841. | SELECT DISTINCT driverid ,  STOP FROM pitstops WHERE duration  <  (SELECT max(duration) FROM pitstops WHERE raceid  =  841) | 1. SELECT[col:​pitStops:​driverId] <br>2. PROJECT[col:​pitStops:​raceId, #1] <br>3. PROJECT[col:​pitStops:​raceId, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​841:​col:​pitStops:​raceId] <br>5. PROJECT[tbl:​pitStops, #4] <br>6. AGGREGATE[max, #5] <br>7. PROJECT[tbl:​pitStops, #1] <br>8. COMPARATIVE[#1, #7, comparative:​<:​#6] <br>9. PROJECT[col:​pitStops:​driverId, #8] <br>10. PROJECT[col:​pitStops:​stop, #8] <br>11. AGGREGATE[count, #10] <br>12. UNION[#9, #11] <br> | 1. SELECT[col:​pitStops:​driverId] <br>2. PROJECT[col:​pitStops:​raceId, #1] <br>3. PROJECT[col:​pitStops:​raceId, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​841:​col:​pitStops:​raceId] <br>5. PROJECT[tbl:​pitStops, #4] <br>6. AGGREGATE[max, #5] <br>7. PROJECT[tbl:​pitStops, #1] <br>8. COMPARATIVE[#1, #7, comparative:​<:​#6] <br>9. PROJECT[col:​pitStops:​driverId, #8] <br>10. PROJECT[col:​pitStops:​stop, #8] <br>11. AGGREGATE[count, #10] <br>12. UNION[#9, #11] <br> | + | extra | 
  | SPIDER_train_2198 | What are the different ids and stop durations of all the drivers whose stop lasted longer than the driver in the race with the id 841? | SELECT DISTINCT driverid ,  STOP FROM pitstops WHERE duration  >  (SELECT min(duration) FROM pitstops WHERE raceid  =  841) | 1. SELECT[col:​pitStops:​driverId] <br>2. PROJECT[col:​pitStops:​driverId, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​841:​col:​pitStops:​raceId] <br>4. PROJECT[col:​pitStops:​stop, #1] <br>5. PROJECT[tbl:​pitStops, #3] <br>6. COMPARATIVE[#1, #4, comparative:​>:​#5] <br>7. COMPARATIVE[#2, #1, comparative:​=:​#6] <br>8. COMPARATIVE[#4, #1, comparative:​=:​#6] <br>9. UNION[#7, #8] <br> | 1. SELECT[col:​pitStops:​driverId] <br>2. PROJECT[col:​pitStops:​driverId, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​841:​col:​pitStops:​raceId] <br>4. PROJECT[col:​pitStops:​stop, #1] <br>5. PROJECT[tbl:​pitStops, #3] <br>6. COMPARATIVE[#1, #4, comparative:​>:​#5] <br>7. COMPARATIVE[#2, #1, comparative:​=:​#6] <br>8. COMPARATIVE[#4, #1, comparative:​=:​#6] <br>9. UNION[#7, #8] <br> | + | extra | 
  | SPIDER_train_2203 | What are the names of races held between 2009 and 2011? | SELECT name FROM races WHERE YEAR BETWEEN 2009 AND 2011 | 1. SELECT[tbl:​races] <br>2. FILTER[#1, comparative:​<=:​2011:​col:​races:​year] <br>3. FILTER[#2, comparative:​>=:​2009:​col:​races:​year] <br>4. PROJECT[col:​races:​name, #3] <br> | 1. SELECT[tbl:​races] <br>2. COMPARATIVE[#1, #1, comparative:​<=:​2011:​col:​races:​year] <br>3. COMPARATIVE[#2, #2, comparative:​>=:​2009:​col:​races:​year] <br>4. PROJECT[col:​races:​name, #3] <br> | - | easy | 
  | SPIDER_train_2204 | What are the names of all races held between 2009 and 2011? | SELECT name FROM races WHERE YEAR BETWEEN 2009 AND 2011 | 1. SELECT[tbl:​races] <br>2. FILTER[#1, comparative:​<=:​2011:​col:​races:​year] <br>3. FILTER[#2, comparative:​>=:​2009:​col:​races:​year] <br>4. PROJECT[col:​races:​name, #3] <br> | 1. SELECT[tbl:​races] <br>2. COMPARATIVE[#1, #1, comparative:​<=:​2011:​col:​races:​year] <br>3. COMPARATIVE[#2, #2, comparative:​>=:​2009:​col:​races:​year] <br>4. PROJECT[col:​races:​name, #3] <br> | - | easy | 
  | SPIDER_train_2207 | What are the drivers' first, last names and id who had more than 8 pit stops or participated in more than 5 race results? | SELECT T1.forename ,  T1.surname ,  T1.driverid FROM drivers AS T1 JOIN pitstops AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  8 UNION SELECT T1.forename ,  T1.surname ,  T1.driverid FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  5 | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[tbl:​pitStops, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​8] <br>5. PROJECT[tbl:​results, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​5] <br>8. UNION[#4, #7] <br>9. PROJECT[col:​drivers:​forename, #8] <br>10. PROJECT[col:​drivers:​surname, #8] <br>11. PROJECT[col:​drivers:​driverId, #8] <br>12. UNION[#9, #10, #11] <br> | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[tbl:​pitStops, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​8] <br>5. PROJECT[tbl:​results, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​5] <br>8. UNION[#4, #7] <br>9. PROJECT[col:​drivers:​forename, #8] <br>10. PROJECT[col:​drivers:​surname, #8] <br>11. PROJECT[col:​drivers:​driverId, #8] <br>12. UNION[#9, #10, #11] <br> | + | extra | 
  | SPIDER_train_2209 | What are the drivers' last names and id who had 11 pit stops and participated in more than 5 race results? | SELECT T1.surname ,  T1.driverid FROM drivers AS T1 JOIN pitstops AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  =  11 INTERSECT SELECT T1.surname ,  T1.driverid FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  5 | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​pitStops, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​11] <br>5. PROJECT[tbl:​results, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​5] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​drivers:​surname, #8] <br>10. PROJECT[col:​drivers:​driverId, #8] <br>11. UNION[#9, #10] <br> | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​pitStops, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​11] <br>5. PROJECT[tbl:​results, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​5] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​drivers:​surname, #8] <br>10. PROJECT[col:​drivers:​driverId, #8] <br>11. UNION[#9, #10] <br> | + | extra | 
  | SPIDER_train_2210 | What are the last names and ids of all drivers who had 11 pit stops and participated in more than 5 races? | SELECT T1.surname ,  T1.driverid FROM drivers AS T1 JOIN pitstops AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  =  11 INTERSECT SELECT T1.surname ,  T1.driverid FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  5 | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​pitStops, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​11] <br>5. PROJECT[tbl:​circuits, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​5] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​drivers:​surname, #8] <br>10. PROJECT[col:​drivers:​driverId, #8] <br>11. UNION[#9, #10] <br> | 1. SELECT[tbl:​drivers] <br>2. PROJECT[tbl:​pitStops, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​11] <br>5. PROJECT[tbl:​circuits, #1] <br>6. GROUP[count, #5, #1] <br>7. COMPARATIVE[#1, #6, comparative:​>:​5] <br>8. INTERSECTION[#1, #4, #7] <br>9. PROJECT[col:​drivers:​surname, #8] <br>10. PROJECT[col:​drivers:​driverId, #8] <br>11. UNION[#9, #10] <br> | + | extra | 
  | SPIDER_train_2211 | What is the id and last name of the driver who participated in the most races after 2010? | SELECT T1.driverid ,  T1.surname FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid WHERE T3.year > 2010 GROUP BY T1.driverid ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[col:​results:​raceId, #1] <br>3. FILTER[#2, comparative:​>:​2010:​col:​races:​year] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​drivers:​driverId, #5] <br>7. PROJECT[col:​drivers:​surname, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[col:​results:​raceId, #1] <br>3. COMPARATIVE[#2, #2, comparative:​>:​2010:​col:​races:​year] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​drivers:​driverId, #5] <br>7. PROJECT[col:​drivers:​surname, #5] <br>8. UNION[#6, #7] <br> | - | extra | 
  | SPIDER_train_2213 | What are the names of circuits that belong to UK or Malaysia? | SELECT name FROM circuits WHERE country = "UK" OR country = "Malaysia" | 1. SELECT[tbl:​circuits] <br>2. FILTER[#1, comparative:​=:​UK:​col:​circuits:​country] <br>3. FILTER[#1, comparative:​=:​Malaysia:​col:​circuits:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​circuits:​name, #4] <br> | 1. SELECT[tbl:​circuits] <br>2. COMPARATIVE[#1, #1, comparative:​=:​UK:​col:​circuits:​country] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Malaysia:​col:​circuits:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​circuits:​name, #4] <br> | + | medium | 
  | SPIDER_train_2214 | What are the names of all the circuits that are in the UK or Malaysia? | SELECT name FROM circuits WHERE country = "UK" OR country = "Malaysia" | 1. SELECT[tbl:​circuits] <br>2. FILTER[#1, comparative:​=:​UK:​col:​circuits:​country] <br>3. FILTER[#1, comparative:​=:​Malaysia:​col:​circuits:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​circuits:​name, #4] <br> | 1. SELECT[tbl:​circuits] <br>2. COMPARATIVE[#1, #1, comparative:​=:​UK:​col:​circuits:​country] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Malaysia:​col:​circuits:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​circuits:​name, #4] <br> | + | medium | 
  | SPIDER_train_2215 | Find the id and location of circuits that belong to France or Belgium? | SELECT circuitid ,  LOCATION FROM circuits WHERE country = "France" OR country = "Belgium" | 1. SELECT[tbl:​circuits] <br>2. FILTER[#1, comparative:​=:​France:​col:​circuits:​country] <br>3. FILTER[#1, comparative:​=:​Belgium:​col:​circuits:​country] <br>4. PROJECT[col:​circuits:​circuitId, #2] <br>5. PROJECT[col:​circuits:​location, #2] <br>6. PROJECT[col:​circuits:​circuitId, #3] <br>7. PROJECT[col:​circuits:​location, #3] <br>8. UNION[#4, #5] <br>9. UNION[#6, #7] <br>10. UNION[#8, #9] <br> | 1. SELECT[tbl:​circuits] <br>2. COMPARATIVE[#1, #1, comparative:​=:​France:​col:​circuits:​country] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Belgium:​col:​circuits:​country] <br>4. PROJECT[col:​circuits:​circuitId, #2] <br>5. PROJECT[col:​circuits:​location, #2] <br>6. PROJECT[col:​circuits:​circuitId, #3] <br>7. PROJECT[col:​circuits:​location, #3] <br>8. UNION[#4, #5] <br>9. UNION[#6, #7] <br>10. UNION[#8, #9] <br> | + | extra | 
  | SPIDER_train_2216 | What are the ids and locations of all circuits in France or Belgium? | SELECT circuitid ,  LOCATION FROM circuits WHERE country = "France" OR country = "Belgium" | 1. SELECT[tbl:​circuits] <br>2. FILTER[#1, comparative:​=:​France:​col:​circuits:​country] <br>3. FILTER[#1, comparative:​=:​Belgium:​col:​circuits:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​circuits:​circuitId, #4] <br>6. PROJECT[col:​circuits:​location, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​circuits] <br>2. COMPARATIVE[#1, #1, comparative:​=:​France:​col:​circuits:​country] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Belgium:​col:​circuits:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​circuits:​circuitId, #4] <br>6. PROJECT[col:​circuits:​location, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_2217 | Find the names of Japanese constructors that have once earned more than 5 points? | SELECT T1.name FROM constructors AS T1 JOIN constructorstandings AS T2 ON T1.constructorid = T2.constructorid WHERE T1.nationality = "Japanese" AND T2.points > 5 | 1. SELECT[tbl:​constructorStandings] <br>2. FILTER[#1, comparative:​=:​Japanese:​col:​constructors:​nationality] <br>3. PROJECT[col:​constructorStandings:​points, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​5:​col:​constructorStandings:​points] <br>5. PROJECT[col:​constructors:​name, #4] <br> | 1. SELECT[tbl:​constructorStandings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Japanese:​col:​constructors:​nationality] <br>3. PROJECT[col:​constructorStandings:​points, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​5:​col:​constructorStandings:​points] <br>5. PROJECT[col:​constructors:​name, #4] <br> | - | medium | 
  | SPIDER_train_2218 | What are the names of all the Japanese constructors that have earned more than 5 points? | SELECT T1.name FROM constructors AS T1 JOIN constructorstandings AS T2 ON T1.constructorid = T2.constructorid WHERE T1.nationality = "Japanese" AND T2.points > 5 | 1. SELECT[tbl:​constructorStandings] <br>2. FILTER[#1, comparative:​=:​Japanese:​col:​constructors:​nationality] <br>3. PROJECT[col:​constructorStandings:​points, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​5:​col:​constructorStandings:​points] <br>5. PROJECT[col:​constructors:​name, #4] <br> | 1. SELECT[tbl:​constructorStandings] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Japanese:​col:​constructors:​nationality] <br>3. PROJECT[col:​constructorStandings:​points, #2] <br>4. COMPARATIVE[#2, #3, comparative:​>:​5:​col:​constructorStandings:​points] <br>5. PROJECT[col:​constructors:​name, #4] <br> | - | medium | 
  | SPIDER_train_2221 | What is the maximum fastest lap speed in race named 'Monaco Grand Prix' in 2008 ? | SELECT max(T2.fastestlapspeed) FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year = 2008 AND T1.name = "Monaco Grand Prix" | 1. SELECT[col:​results:​raceId] <br>2. FILTER[#1, comparative:​=:​Monaco Grand Prix:​col:​races:​name] <br>3. FILTER[#2, comparative:​=:​2008:​col:​races:​year] <br>4. PROJECT[col:​results:​fastestLapSpeed, #3] <br>5. AGGREGATE[max, #4] <br> | 1. SELECT[col:​results:​raceId] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Monaco Grand Prix:​col:​races:​name] <br>3. COMPARATIVE[#2, #2, comparative:​=:​2008:​col:​races:​year] <br>4. PROJECT[col:​results:​fastestLapSpeed, #3] <br>5. AGGREGATE[max, #4] <br> | + | medium | 
  | SPIDER_train_2231 | Find the id and surname of the driver who participated the most number of races? | SELECT T1.driverid ,  T1.surname FROM drivers AS T1 JOIN results AS T2 ON T1.driverid = T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid GROUP BY T1.driverid ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[tbl:​races, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​drivers:​driverId, #4] <br>6. PROJECT[col:​drivers:​surname, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[tbl:​races, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​drivers:​driverId, #4] <br>6. PROJECT[col:​drivers:​surname, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
  | SPIDER_train_2232 | What are the ids and last names of all drivers who participated in the most races? | SELECT T1.driverid ,  T1.surname FROM drivers AS T1 JOIN results AS T2 ON T1.driverid = T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid GROUP BY T1.driverid ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[tbl:​races, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​drivers:​driverId, #4] <br>6. PROJECT[col:​drivers:​surname, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[col:​results:​driverId] <br>2. PROJECT[tbl:​races, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​drivers:​driverId, #4] <br>6. PROJECT[col:​drivers:​surname, #4] <br>7. UNION[#5, #6] <br> | + | extra | 
 ***
 Exec acc: **0.6857**
