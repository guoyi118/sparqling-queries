 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **book_club** | book_club_id | + |   | 
 | 2 |   | Year |   |   | 
 | 3 |   | Author_or_Editor |   |   | 
 | 4 |   | Book_Title |   |   | 
 | 5 |   | Publisher |   |   | 
 | 6 |   | Category |   |   | 
 | 7 |   | Result |   |   | 
 | 8 | **movie** | movie_id | + |   | 
 | 9 |   | Title |   |   | 
 | 10 |   | Year |   |   | 
 | 11 |   | Director |   |   | 
 | 12 |   | Budget_million |   |   | 
 | 13 |   | Gross_worldwide |   |   | 
 | 14 | **culture_company** | Company_name | + |   | 
 | 15 |   | Type |   |   | 
 | 16 |   | Incorporated_in |   |   | 
 | 17 |   | Group_Equity_Shareholding |   |   | 
 | 18 |   | book_club_id |   | --> 1 | 
 | 19 |   | movie_id |   | --> 8 | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6962 | How many book clubs are there? | SELECT count(*) FROM book_club | 1. SELECT[tbl:​book_club] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​book_club] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6963 | Count the number of book clubs. | SELECT count(*) FROM book_club | 1. SELECT[tbl:​book_club] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​book_club] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6966 | Show all distinct publishers for books. | SELECT DISTINCT publisher FROM book_club | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Publisher, #1] <br>3.*(distinct)* PROJECT[distinct #REF, #2] <br> | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Publisher, #1] <br>3.*(distinct)* PROJECT[None, #2] <br> | + | easy | 
  | SPIDER_train_6967 | What are all the different book publishers? | SELECT DISTINCT publisher FROM book_club | 1. SELECT[col:​book_club:​Publisher] <br>2.*(distinct)* PROJECT[different #REF, #1] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2.*(distinct)* PROJECT[None, #1] <br> | + | easy | 
  | SPIDER_train_6968 | Show the years, book titles, and publishers for all books, in descending order by year. | SELECT YEAR ,  book_title ,  publisher FROM book_club ORDER BY YEAR DESC | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Year, #1] <br>3. PROJECT[col:​book_club:​Book_Title, #1] <br>4. PROJECT[col:​book_club:​Publisher, #1] <br>5. UNION[#2, #3, #4] <br>6. SORT[#5, #2, sortdir:​descending] <br> | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Year, #1] <br>3. PROJECT[col:​book_club:​Book_Title, #1] <br>4. PROJECT[col:​book_club:​Publisher, #1] <br>5. UNION[#2, #3, #4] <br>6. SORT[#5, #2, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_6969 | What are the years, titles, and publishers for all books, ordered by year descending? | SELECT YEAR ,  book_title ,  publisher FROM book_club ORDER BY YEAR DESC | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Year, #1] <br>3. PROJECT[col:​book_club:​Book_Title, #1] <br>4. PROJECT[col:​book_club:​Publisher, #1] <br>5. UNION[#2, #3, #4] <br>6. SORT[#5, #2, sortdir:​descending] <br> | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Year, #1] <br>3. PROJECT[col:​book_club:​Book_Title, #1] <br>4. PROJECT[col:​book_club:​Publisher, #1] <br>5. UNION[#2, #3, #4] <br>6. SORT[#5, #2, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_6970 | Show all publishers and the number of books for each publisher. | SELECT publisher ,  count(*) FROM book_club GROUP BY publisher | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6971 | How many books are there for each publisher? | SELECT publisher ,  count(*) FROM book_club GROUP BY publisher | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6972 | What is the publisher with most number of books? | SELECT publisher FROM book_club GROUP BY publisher ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6973 | Return the publisher that has published the most books. | SELECT publisher FROM book_club GROUP BY publisher ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6974 | Show all book categories and the number of books in each category. | SELECT category ,  count(*) FROM book_club GROUP BY category | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Category, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​book_club] <br>2. PROJECT[col:​book_club:​Category, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_6975 | How many books fall into each category? | SELECT category ,  count(*) FROM book_club GROUP BY category | 1. SELECT[col:​book_club:​Category] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​book_club:​Category] <br>2. PROJECT[tbl:​book_club, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_6976 | List categories that have at least two books after year 1989. | SELECT category FROM book_club WHERE YEAR  >  1989 GROUP BY category HAVING count(*)  >=  2 | 1. SELECT[tbl:​book_club] <br>2. FILTER[#1, comparative:​>:​1989:​col:​book_club:​Year] <br>3. PROJECT[col:​book_club:​Category, #2] <br>4. GROUP[count, #2, #3] <br>5. COMPARATIVE[#3, #4, comparative:​>=:​2] <br> | 1. SELECT[tbl:​book_club] <br>2. COMPARATIVE[#1, #1, comparative:​>:​1989:​col:​book_club:​Year] <br>3. PROJECT[col:​book_club:​Category, #2] <br>4. GROUP[count, #2, #3] <br>5. COMPARATIVE[#3, #4, comparative:​>=:​2] <br> | + | medium | 
  | SPIDER_train_6977 | What categories have two or more corresponding books that were made after 1989? | SELECT category FROM book_club WHERE YEAR  >  1989 GROUP BY category HAVING count(*)  >=  2 | 1. SELECT[col:​book_club:​Category] <br>2. PROJECT[tbl:​book_club, #1] <br>3. FILTER[#2, comparative:​>:​1989:​col:​book_club:​Year] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>=:​2] <br> | 1. SELECT[col:​book_club:​Category] <br>2. PROJECT[tbl:​book_club, #1] <br>3. COMPARATIVE[#2, #2, comparative:​>:​1989:​col:​book_club:​Year] <br>4. GROUP[count, #3, #1] <br>5. COMPARATIVE[#1, #4, comparative:​>=:​2] <br> | + | medium | 
  | SPIDER_train_6978 | Show publishers with a book published in 1989 and a book in 1990. | SELECT publisher FROM book_club WHERE YEAR  =  1989 INTERSECT SELECT publisher FROM book_club WHERE YEAR  =  1990 | 1. SELECT[col:​book_club:​Publisher] <br>2. FILTER[#1, comparative:​=:​1990:​col:​book_club:​Year] <br>3. FILTER[#1, comparative:​=:​1989:​col:​book_club:​Year] <br>4. INTERSECTION[#1, #2, #3] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2. COMPARATIVE[#1, #1, comparative:​=:​1990:​col:​book_club:​Year] <br>3. COMPARATIVE[#1, #1, comparative:​=:​1989:​col:​book_club:​Year] <br>4. INTERSECTION[#1, #2, #3] <br> | + | hard | 
  | SPIDER_train_6979 | What are the publishers who have published a book in both 1989 and 1990? | SELECT publisher FROM book_club WHERE YEAR  =  1989 INTERSECT SELECT publisher FROM book_club WHERE YEAR  =  1990 | 1. SELECT[col:​book_club:​Publisher] <br>2. FILTER[#1, tbl:​book_club] <br>3. FILTER[#2, comparative:​=:​1990:​col:​book_club:​Year] <br>4. FILTER[#2, comparative:​=:​1989:​col:​book_club:​Year] <br>5. INTERSECTION[#1, #3, #4] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2. COMPARATIVE[#1, #1, tbl:​book_club] <br>3. COMPARATIVE[#2, #2, comparative:​=:​1990:​col:​book_club:​Year] <br>4. COMPARATIVE[#2, #2, comparative:​=:​1989:​col:​book_club:​Year] <br>5. INTERSECTION[#1, #3, #4] <br> | + | hard | 
  | SPIDER_train_6981 | Which publishers did not publish a book in 1989? | SELECT publisher FROM book_club EXCEPT SELECT publisher FROM book_club WHERE YEAR  =  1989 | 1. SELECT[col:​book_club:​Publisher] <br>2. FILTER[#1, comparative:​=:​1989:​col:​book_club:​Year] <br>3. DISCARD[#1, #2] <br> | 1. SELECT[col:​book_club:​Publisher] <br>2. COMPARATIVE[#1, #1, comparative:​=:​1989:​col:​book_club:​Year] <br>3. DISCARD[#1, #2] <br> | + | hard | 
  | SPIDER_train_6982 | Show all movie titles, years, and directors, ordered by budget. | SELECT title ,  YEAR ,  director FROM movie ORDER BY budget_million | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Title, #1] <br>3. PROJECT[col:​movie:​Year, #1] <br>4. PROJECT[col:​movie:​Director, #1] <br>5. PROJECT[col:​movie:​Budget_million, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5] <br> | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Title, #1] <br>3. PROJECT[col:​movie:​Year, #1] <br>4. PROJECT[col:​movie:​Director, #1] <br>5. PROJECT[col:​movie:​Budget_million, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_6983 | What are the titles, years, and directors of all movies, ordered by budget in millions? | SELECT title ,  YEAR ,  director FROM movie ORDER BY budget_million | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Title, #1] <br>3. PROJECT[col:​movie:​Year, #1] <br>4. PROJECT[col:​movie:​Director, #1] <br>5. PROJECT[col:​movie:​Budget_million, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Title, #1] <br>3. PROJECT[col:​movie:​Year, #1] <br>4. PROJECT[col:​movie:​Director, #1] <br>5. PROJECT[col:​movie:​Budget_million, #1] <br>6. UNION[#2, #3, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_6984 | How many movie directors are there? | SELECT COUNT (DISTINCT director) FROM movie | 1. SELECT[col:​movie:​Director] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[col:​movie:​Director] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6986 | What is the title and director for the movie with highest worldwide gross in the year 2000 or before? | SELECT title ,  director FROM movie WHERE YEAR  <=  2000 ORDER BY gross_worldwide DESC LIMIT 1 | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Gross_worldwide, #1] <br>3. FILTER[#2, comparative:​<=:​2000:​col:​movie:​Year] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br>5. PROJECT[col:​movie:​Title, #4] <br>6. PROJECT[col:​movie:​Director, #4] <br>7. UNION[#5, #6] <br> | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Gross_worldwide, #1] <br>3. COMPARATIVE[#2, #2, comparative:​<=:​2000:​col:​movie:​Year] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​movie:​Title, #4] <br>6. PROJECT[col:​movie:​Director, #4] <br>7. UNION[#5, #6] <br> | + | hard | 
  | SPIDER_train_6989 | Which directors had a movie both in the year 1999 and 2000? | SELECT director FROM movie WHERE YEAR  =  2000 INTERSECT SELECT director FROM movie WHERE YEAR  =  1999 | 1. SELECT[col:​movie:​Director] <br>2. PROJECT[tbl:​movie, #1] <br>3. FILTER[#2, comparative:​=:​1999:​col:​movie:​Year] <br>4. FILTER[#2, comparative:​=:​2000:​col:​movie:​Year] <br>5. INTERSECTION[#1, #3, #4] <br> | 1. SELECT[col:​movie:​Director] <br>2. PROJECT[tbl:​movie, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​1999:​col:​movie:​Year] <br>4. COMPARATIVE[#2, #2, comparative:​=:​2000:​col:​movie:​Year] <br>5. INTERSECTION[#1, #3, #4] <br> | + | hard | 
  | SPIDER_train_6992 | What is the average, maximum, and minimum budget for all movies before 2000. | SELECT avg(budget_million) ,  max(budget_million) ,  min(budget_million) FROM movie WHERE YEAR  <  2000 | 1. SELECT[tbl:​movie] <br>2. FILTER[#1, comparative:​<:​2000:​col:​movie:​Year] <br>3. PROJECT[col:​movie:​Budget_million, #2] <br>4. AGGREGATE[avg, #3] <br>5. AGGREGATE[max, #3] <br>6. AGGREGATE[min, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​movie] <br>2. COMPARATIVE[#1, #1, comparative:​<:​2000:​col:​movie:​Year] <br>3. PROJECT[col:​movie:​Budget_million, #2] <br>4. AGGREGATE[avg, #3] <br>5. AGGREGATE[max, #3] <br>6. AGGREGATE[min, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6993 | Return the average, maximum, and minimum budgets in millions for movies made before the year 2000. | SELECT avg(budget_million) ,  max(budget_million) ,  min(budget_million) FROM movie WHERE YEAR  <  2000 | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​2000:​col:​movie:​Year] <br>4. PROJECT[col:​movie:​Budget_million, #3] <br>5. AGGREGATE[avg, #4] <br>6. AGGREGATE[max, #4] <br>7. AGGREGATE[min, #4] <br>8. UNION[#5, #6, #7] <br> | 1. SELECT[tbl:​movie] <br>2. PROJECT[col:​movie:​Year, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<:​2000:​col:​movie:​Year] <br>4. PROJECT[col:​movie:​Budget_million, #3] <br>5. AGGREGATE[avg, #4] <br>6. AGGREGATE[max, #4] <br>7. AGGREGATE[min, #4] <br>8. UNION[#5, #6, #7] <br> | + | medium | 
  | SPIDER_train_6994 | List all company names with a book published by Alyson. | SELECT T1.company_name FROM culture_company AS T1 JOIN book_club AS T2 ON T1.book_club_id  =  T2.book_club_id WHERE T2.publisher  =  'Alyson' | 1. SELECT[val:​book_club:​Publisher:​Alyson] <br>2. PROJECT[tbl:​book_club, #1] <br>3. PROJECT[tbl:​culture_company, #2] <br>4. PROJECT[col:​culture_company:​Company_name, #3] <br> | 1. SELECT[val:​book_club:​Publisher:​Alyson] <br>2. PROJECT[tbl:​book_club, #1] <br>3. PROJECT[tbl:​culture_company, #2] <br>4. PROJECT[col:​culture_company:​Company_name, #3] <br> | + | medium | 
  | SPIDER_train_6995 | What are all the company names that have a book published by Alyson? | SELECT T1.company_name FROM culture_company AS T1 JOIN book_club AS T2 ON T1.book_club_id  =  T2.book_club_id WHERE T2.publisher  =  'Alyson' | 1. SELECT[val:​book_club:​Publisher:​Alyson] <br>2. PROJECT[tbl:​book_club, #1] <br>3. PROJECT[col:​culture_company:​Company_name, #2] <br> | 1. SELECT[val:​book_club:​Publisher:​Alyson] <br>2. PROJECT[tbl:​book_club, #1] <br>3. PROJECT[col:​culture_company:​Company_name, #2] <br> | + | medium | 
  | SPIDER_train_6996 | Show the movie titles and book titles for all companies in China. | SELECT T1.title ,  T3.book_title FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id JOIN book_club AS T3 ON T3.book_club_id  =  T2.book_club_id WHERE T2.incorporated_in  =  'China' | 1. SELECT[tbl:​culture_company] <br>2. FILTER[#1, comparative:​=:​China:​col:​culture_company:​Incorporated_in] <br>3. PROJECT[tbl:​movie, #2] <br>4. PROJECT[col:​movie:​Title, #3] <br>5. PROJECT[tbl:​book_club, #2] <br>6. PROJECT[col:​book_club:​Book_Title, #5] <br>7. UNION[#4, #6] <br> | 1. SELECT[tbl:​culture_company] <br>2. COMPARATIVE[#1, #1, comparative:​=:​China:​col:​culture_company:​Incorporated_in] <br>3. PROJECT[tbl:​movie, #2] <br>4. PROJECT[col:​movie:​Title, #3] <br>5. PROJECT[tbl:​book_club, #2] <br>6. PROJECT[col:​book_club:​Book_Title, #5] <br>7. UNION[#4, #6] <br> | + | hard | 
  | SPIDER_train_6997 | What are the titles of movies and books corresponding to companies incorporated in China? | SELECT T1.title ,  T3.book_title FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id JOIN book_club AS T3 ON T3.book_club_id  =  T2.book_club_id WHERE T2.incorporated_in  =  'China' | 1. SELECT[tbl:​culture_company] <br>2. FILTER[#1, comparative:​=:​China:​col:​culture_company:​Incorporated_in] <br>3. PROJECT[tbl:​movie, #2] <br>4. PROJECT[col:​movie:​Title, #3] <br>5. PROJECT[tbl:​book_club, #2] <br>6. PROJECT[col:​book_club:​Book_Title, #5] <br>7. UNION[#4, #6] <br> | 1. SELECT[tbl:​culture_company] <br>2. COMPARATIVE[#1, #1, comparative:​=:​China:​col:​culture_company:​Incorporated_in] <br>3. PROJECT[tbl:​movie, #2] <br>4. PROJECT[col:​movie:​Title, #3] <br>5. PROJECT[tbl:​book_club, #2] <br>6. PROJECT[col:​book_club:​Book_Title, #5] <br>7. UNION[#4, #6] <br> | + | hard | 
  | SPIDER_train_6998 | Show all company names with a movie directed in year 1999. | SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999 | 1. SELECT[tbl:​movie] <br>2. FILTER[#1, comparative:​=:​1999:​col:​movie:​Year] <br>3. PROJECT[tbl:​culture_company, #2] <br>4. PROJECT[col:​culture_company:​Company_name, #3] <br> | 1. SELECT[tbl:​movie] <br>2. COMPARATIVE[#1, #1, comparative:​=:​1999:​col:​movie:​Year] <br>3. PROJECT[tbl:​culture_company, #2] <br>4. PROJECT[col:​culture_company:​Company_name, #3] <br> | + | medium | 
  | SPIDER_train_6999 | What are all company names that have a corresponding movie directed in the year 1999? | SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999 | 1. SELECT[tbl:​culture_company] <br>2. PROJECT[tbl:​movie, #1] <br>3. PROJECT[col:​movie:​Year, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1999:​col:​movie:​Year] <br>5. PROJECT[col:​culture_company:​Company_name, #4] <br> | 1. SELECT[tbl:​culture_company] <br>2. PROJECT[tbl:​movie, #1] <br>3. PROJECT[col:​movie:​Year, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​1999:​col:​movie:​Year] <br>5. PROJECT[col:​culture_company:​Company_name, #4] <br> | + | medium | 
 ***
 Exec acc: **1.0000**
