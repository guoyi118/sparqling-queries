 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **routes** | rid | + |   | 
 | 2 |   | dst_apid |   | --> 9 | 
 | 3 |   | dst_ap |   |   | 
 | 4 |   | src_apid |   | --> 9 | 
 | 5 |   | src_ap |   |   | 
 | 6 |   | alid |   | --> 18 | 
 | 7 |   | airline |   |   | 
 | 8 |   | codeshare |   |   | 
 | 9 | **airports** | apid | + |   | 
 | 10 |   | name |   |   | 
 | 11 |   | city |   |   | 
 | 12 |   | country |   |   | 
 | 13 |   | x |   |   | 
 | 14 |   | y |   |   | 
 | 15 |   | elevation |   |   | 
 | 16 |   | iata |   |   | 
 | 17 |   | icao |   |   | 
 | 18 | **airlines** | alid | + |   | 
 | 19 |   | name |   |   | 
 | 20 |   | iata |   |   | 
 | 21 |   | icao |   |   | 
 | 22 |   | callsign |   |   | 
 | 23 |   | country |   |   | 
 | 24 |   | active |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_6803 | Find the name of the airport in the city of Goroka. | SELECT name FROM airports WHERE city  =  'Goroka' | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Goroka:​col:​airports:​city] <br>4. PROJECT[col:​airports:​name, #3] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Goroka:​col:​airports:​city] <br>4. PROJECT[col:​airports:​name, #3] <br> | + | easy | 
  | SPIDER_train_6804 | What are the names of the airports in the city of Goroka? | SELECT name FROM airports WHERE city  =  'Goroka' | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Goroka:​col:​airports:​city] <br>4. PROJECT[col:​airports:​name, #3] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Goroka:​col:​airports:​city] <br>4. PROJECT[col:​airports:​name, #3] <br> | + | easy | 
  | SPIDER_train_6805 | Find the name, city, country, and altitude (or elevation) of the airports in the city of New York. | SELECT name ,  city ,  country ,  elevation FROM airports WHERE city  =  'New York' | 1. SELECT[tbl:​airports] <br>2. FILTER[#1, comparative:​=:​New York:​col:​airports:​city] <br>3. PROJECT[col:​airports:​name, #2] <br>4. PROJECT[col:​airports:​city, #2] <br>5. PROJECT[col:​airports:​country, #2] <br>6. PROJECT[col:​airports:​elevation, #2] <br>7. UNION[#3, #4, #5, #6] <br> | 1. SELECT[tbl:​airports] <br>2. COMPARATIVE[#1, #1, comparative:​=:​New York:​col:​airports:​city] <br>3. PROJECT[col:​airports:​name, #2] <br>4. PROJECT[col:​airports:​city, #2] <br>5. PROJECT[col:​airports:​country, #2] <br>6. PROJECT[col:​airports:​elevation, #2] <br>7. UNION[#3, #4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6806 | What is the name, city, country, and elevation for every airport in the city of New York? | SELECT name ,  city ,  country ,  elevation FROM airports WHERE city  =  'New York' | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​New York:​col:​airports:​city] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. PROJECT[col:​airports:​elevation, #3] <br>8. UNION[#4, #5, #6, #7] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​city, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​New York:​col:​airports:​city] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. PROJECT[col:​airports:​elevation, #3] <br>8. UNION[#4, #5, #6, #7] <br> | + | medium | 
  | SPIDER_train_6807 | How many airlines are there? | SELECT count(*) FROM airlines | 1. SELECT[tbl:​airlines] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​airlines] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6808 | What is the total number of airlines? | SELECT count(*) FROM airlines | 1. SELECT[tbl:​airlines] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​airlines] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_6809 | How many airlines does Russia has? | SELECT count(*) FROM airlines WHERE country  =  'Russia' | 1. SELECT[tbl:​airlines] <br>2. FILTER[#1, comparative:​=:​Russia:​col:​airlines:​country] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​airlines] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Russia:​col:​airlines:​country] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6810 | What is the number of airlines based in Russia? | SELECT count(*) FROM airlines WHERE country  =  'Russia' | 1. SELECT[tbl:​airlines] <br>2. FILTER[#1, comparative:​=:​Russia:​col:​airlines:​country] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​airlines] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Russia:​col:​airlines:​country] <br>3. AGGREGATE[count, #2] <br> | + | easy | 
  | SPIDER_train_6811 | What is the maximum elevation of all airports in the country of Iceland? | SELECT max(elevation) FROM airports WHERE country  =  'Iceland' | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Iceland:​col:​airports:​country] <br>4. PROJECT[col:​airports:​elevation, #3] <br>5. AGGREGATE[max, #4] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Iceland:​col:​airports:​country] <br>4. PROJECT[col:​airports:​elevation, #3] <br>5. AGGREGATE[max, #4] <br> | + | easy | 
  | SPIDER_train_6812 | What is the highest elevation of an airport in the country of Iceland? | SELECT max(elevation) FROM airports WHERE country  =  'Iceland' | 1. SELECT[val:​airports:​country:​Iceland] <br>2. PROJECT[tbl:​airports, #1] <br>3. PROJECT[col:​airports:​elevation, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​airports:​elevation, #4] <br> | 1. SELECT[val:​airlines:​country:​Iceland] <br>2. PROJECT[tbl:​airports, #1] <br>3. PROJECT[col:​airports:​elevation, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br>5. PROJECT[col:​airports:​elevation, #4] <br> | - | easy | 
  | SPIDER_train_6813 | Find the name of the airports located in Cuba or Argentina. | SELECT name FROM airports WHERE country  =  'Cuba' OR country  =  'Argentina' | 1. SELECT[tbl:​airports] <br>2. FILTER[#1, comparative:​=:​Cuba:​col:​airports:​country] <br>3. FILTER[#1, comparative:​=:​Argentina:​col:​airports:​country] <br>4. PROJECT[col:​airports:​name, #2] <br>5. PROJECT[col:​airports:​name, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​airports] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Cuba:​col:​airports:​country] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Argentina:​col:​airports:​country] <br>4. PROJECT[col:​airports:​name, #2] <br>5. PROJECT[col:​airports:​name, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_6814 | What are the names of all airports in Cuba or Argentina? | SELECT name FROM airports WHERE country  =  'Cuba' OR country  =  'Argentina' | 1. SELECT[tbl:​airports] <br>2. FILTER[#1, comparative:​=:​Cuba:​col:​airports:​country] <br>3. FILTER[#1, comparative:​=:​Argentina:​col:​airports:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​airports:​name, #4] <br> | 1. SELECT[tbl:​airports] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Cuba:​col:​airports:​country] <br>3. COMPARATIVE[#1, #1, comparative:​=:​Argentina:​col:​airports:​country] <br>4. UNION[#2, #3] <br>5. PROJECT[col:​airports:​name, #4] <br> | + | medium | 
  | SPIDER_train_6815 | Find the country of the airlines whose name starts with 'Orbit'. | SELECT country FROM airlines WHERE name LIKE 'Orbit%' | 1. SELECT[tbl:​airlines] <br>2. PROJECT[col:​airlines:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Orbit%:​col:​airlines:​name] <br>4. PROJECT[col:​airlines:​country, #3] <br> | 1. SELECT[tbl:​airlines] <br>2. PROJECT[col:​airlines:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Orbit:​col:​airlines:​name] <br>4. PROJECT[col:​airlines:​country, #3] <br> | + | medium | 
  | SPIDER_train_6816 | What are the countries of all airlines whose names start with Orbit? | SELECT country FROM airlines WHERE name LIKE 'Orbit%' | 1. SELECT[tbl:​airlines] <br>2. PROJECT[col:​airlines:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Orbit%:​col:​airlines:​name] <br>4. PROJECT[col:​airlines:​country, #3] <br> | 1. SELECT[tbl:​airlines] <br>2. PROJECT[col:​airlines:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​Orbit:​col:​airlines:​name] <br>4. PROJECT[col:​airlines:​country, #3] <br> | + | medium | 
  | SPIDER_train_6817 | Find the name of airports whose altitude is between -50 and 50. | SELECT name FROM airports WHERE elevation BETWEEN -50 AND 50 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​50:​col:​airports:​elevation] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​-50:​col:​airports:​elevation] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​airports:​name, #5] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​50:​col:​airports:​elevation] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​-50:​col:​airports:​elevation] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​airports:​name, #5] <br> | - | easy | 
  | SPIDER_train_6818 | What are the names of all airports whose elevation is between -50 and 50? | SELECT name FROM airports WHERE elevation BETWEEN -50 AND 50 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​50:​col:​airports:​elevation] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​-50:​col:​airports:​elevation] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​airports:​name, #5] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. COMPARATIVE[#1, #2, comparative:​<=:​50:​col:​airports:​elevation] <br>4. COMPARATIVE[#1, #2, comparative:​>=:​-50:​col:​airports:​elevation] <br>5. INTERSECTION[#1, #3, #4] <br>6. PROJECT[col:​airports:​name, #5] <br> | - | easy | 
  | SPIDER_train_6819 | Which country is the airport that has the highest altitude located in? | SELECT country FROM airports ORDER BY elevation DESC LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​country, #3] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​country, #3] <br> | + | medium | 
  | SPIDER_train_6820 | What is the country of the airport with the highest elevation? | SELECT country FROM airports ORDER BY elevation DESC LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​country, #3] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​country, #3] <br> | + | medium | 
  | SPIDER_train_6821 | Find the number of airports whose name contain the word 'International'. | SELECT count(*) FROM airports WHERE name LIKE '%International%' | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​%International%:​col:​airports:​name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​name, #1] <br>3. COMPARATIVE[#1, #2, comparative:​like:​International:​col:​airports:​name] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_6822 | How many airports' names have the word Interanation in them? | SELECT count(*) FROM airports WHERE name LIKE '%International%' | 1. SELECT[tbl:​airports] <br>2. PROJECT[tbl:​airports, #1] <br>3. FILTER[#2, comparative:​like:​%International%:​col:​airports:​name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[tbl:​airports, #1] <br>3. COMPARATIVE[#2, #2, comparative:​like:​International:​col:​airports:​name] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_6823 | How many different cities do have some airport in the country of Greenland? | SELECT count(DISTINCT city) FROM airports WHERE country  =  'Greenland' | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Greenland:​col:​airports:​country] <br>4. PROJECT[col:​airports:​city, #3] <br>5.*(distinct)* PROJECT[different #REF, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​country, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Greenland:​col:​airports:​country] <br>4. PROJECT[col:​airports:​city, #3] <br>5.*(distinct)* PROJECT[None, #4] <br>6. AGGREGATE[count, #5] <br> | + | easy | 
  | SPIDER_train_6825 | Find the number of routes operated by American Airlines. | SELECT count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines' | 1. SELECT[tbl:​routes] <br>2. FILTER[#1, comparative:​=:​American Airlines:​col:​airlines:​name] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​routes] <br>2. COMPARATIVE[#1, #1, comparative:​=:​American Airlines:​col:​airlines:​name] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_6826 | How many routes does American Airlines operate? | SELECT count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines' | 1. SELECT[tbl:​routes] <br>2. FILTER[#1, comparative:​=:​American Airlines:​col:​airlines:​name] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​routes] <br>2. COMPARATIVE[#1, #1, comparative:​=:​American Airlines:​col:​airlines:​name] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_6827 | Find the number of routes whose destination airports are in Canada. | SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE country  =  'Canada' | 1. SELECT[tbl:​routes] <br>2. PROJECT[tbl:​airports, #1] <br>3. PROJECT[where are #REF, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Canada:​col:​airports:​country] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​routes] <br>2. PROJECT[tbl:​airports, #1] <br>3. PROJECT[None, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​Canada:​col:​airports:​country] <br>5. AGGREGATE[count, #4] <br> | + | medium | 
  | SPIDER_train_6828 | How many routes end in a Canadian airport? | SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE country  =  'Canada' | 1. SELECT[tbl:​routes] <br>2. FILTER[#1, comparative:​=:​Canada:​col:​airports:​country] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​routes] <br>2. COMPARATIVE[#1, #1, comparative:​=:​Canada:​col:​airports:​country] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_6829 | Find the name, city, and country of the airport that has the lowest altitude. | SELECT name ,  city ,  country FROM airports ORDER BY elevation LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6830 | What is the name, city, and country of the airport with the lowest altitude? | SELECT name ,  city ,  country FROM airports ORDER BY elevation LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. COMPARATIVE[#1, #2, comparative:​min:​None] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​min:​None, #1, #2] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6831 | Find the name, city, and country of the airport that has the highest latitude. | SELECT name ,  city ,  country FROM airports ORDER BY elevation DESC LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6832 | What is the name, city, and country of the airport with the highest elevation? | SELECT name ,  city ,  country FROM airports ORDER BY elevation DESC LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[col:​airports:​elevation, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​airports:​name, #3] <br>5. PROJECT[col:​airports:​city, #3] <br>6. PROJECT[col:​airports:​country, #3] <br>7. UNION[#4, #5, #6] <br> | + | medium | 
  | SPIDER_train_6840 | What is the number of different different airports that are destinations for American Airlines? | SELECT count(DISTINCT dst_apid) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines' | 1. SELECT[val:​airlines:​name:​American Airlines] <br>2. PROJECT[destinations of #REF, #1] <br>3. PROJECT[col:​routes:​dst_apid, #2] <br>4.*(distinct)* PROJECT[different #REF, #3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[val:​airlines:​name:​American Airlines] <br>2. PROJECT[None, #1] <br>3. PROJECT[col:​routes:​dst_apid, #2] <br>4.*(distinct)* PROJECT[None, #3] <br>5. AGGREGATE[count, #4] <br> | + | medium | 
  | SPIDER_train_6841 | Which countries has the most number of airlines? | SELECT country FROM airlines GROUP BY country ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_6842 | What is the name of the country with the most number of home airlines? | SELECT country FROM airlines GROUP BY country ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​airlines:​country, #4] <br> | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​airlines:​country, #4] <br> | + | hard | 
  | SPIDER_train_6843 | Which countries has the most number of airlines whose active status is 'Y'? | SELECT country FROM airlines WHERE active  =  'Y' GROUP BY country ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. PROJECT[col:​airlines:​active, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Y:​col:​airlines:​active] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. PROJECT[col:​airlines:​active, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Y:​col:​airlines:​active] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | - | extra | 
  | SPIDER_train_6844 | What are the countries with the most airlines whose active status is Y? | SELECT country FROM airlines WHERE active  =  'Y' GROUP BY country ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. PROJECT[col:​airlines:​active, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Y:​col:​airlines:​active] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | 1. SELECT[col:​airlines:​country] <br>2. PROJECT[tbl:​airlines, #1] <br>3. PROJECT[col:​airlines:​active, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Y:​col:​airlines:​active] <br>5. GROUP[count, #4, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #1, #5] <br> | - | extra | 
  | SPIDER_train_6853 | How many cities are there that have more than 3 airports? | SELECT count(*) FROM (SELECT city FROM airports GROUP BY city HAVING count(*)  >  3) | 1. SELECT[col:​airports:​city] <br>2. PROJECT[tbl:​airports, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[col:​airports:​city] <br>2. PROJECT[tbl:​airports, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​3] <br>5. AGGREGATE[count, #4] <br> | + | easy | 
  | SPIDER_train_6859 | Find the number of routes for each source airport and the airport name. | SELECT count(*) ,  T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T1.name | 1. SELECT[col:​airports:​name] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​airports:​name, #1] <br>5. UNION[#3, #4] <br> | 1. SELECT[col:​airports:​name] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​airports:​name, #1] <br>5. UNION[#3, #4] <br> | + | medium | 
  | SPIDER_train_6861 | Find the number of routes and airport name for each source airport, order the results by decreasing number of routes. | SELECT count(*) ,  T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T1.name ORDER BY count(*) DESC | 1. SELECT[col:​airports:​name] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​airports:​name, #1] <br>5. UNION[#3, #4] <br>6. SORT[#5, #3, sortdir:​descending] <br> | 1. SELECT[col:​airports:​name] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. PROJECT[col:​airports:​name, #1] <br>5. UNION[#3, #4] <br>6. SORT[#5, #3, sortdir:​descending] <br> | + | hard | 
  | SPIDER_train_6866 | What are the cities with exactly two airports? | SELECT city FROM airports GROUP BY city HAVING count(*)  =  2 | 1. SELECT[col:​airports:​city] <br>2. PROJECT[tbl:​airports, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​2] <br> | 1. SELECT[col:​airports:​city] <br>2. PROJECT[tbl:​airports, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​=:​2] <br> | + | easy | 
  | SPIDER_train_6869 | Find the number of routes with destination airports in Italy. | SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid WHERE T2.country  =  'Italy' | 1. SELECT[tbl:​routes] <br>2. PROJECT[tbl:​airports, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Italy:​col:​airports:​country] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​routes] <br>2. PROJECT[tbl:​airports, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Italy:​col:​airports:​country] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_6870 | What is the number of routes whose destinations are Italian airports? | SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid WHERE T2.country  =  'Italy' | 1. SELECT[tbl:​routes] <br>2. PROJECT[destinations of #REF, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Italy:​col:​airports:​country] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​routes] <br>2. PROJECT[None, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Italy:​col:​airports:​country] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_6871 | Return the number of routes with destination airport in Italy operated by the airline with name 'American Airlines'. | SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid JOIN airlines AS T3 ON T1.alid  =  T3.alid WHERE T2.country  =  'Italy' AND T3.name  =  'American Airlines' | 1. SELECT[tbl:​routes] <br>2. PROJECT[tbl:​airports, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Italy:​col:​airports:​country] <br>4. PROJECT[tbl:​airlines, #1] <br>5. PROJECT[col:​airlines:​name, #4] <br>6. COMPARATIVE[#1, #5, comparative:​=:​American Airlines:​col:​airlines:​name] <br>7. INTERSECTION[#1, #3, #6] <br>8. AGGREGATE[count, #7] <br> | 1. SELECT[tbl:​routes] <br>2. PROJECT[tbl:​airports, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Italy:​col:​airports:​country] <br>4. PROJECT[tbl:​airlines, #1] <br>5. PROJECT[col:​airlines:​name, #4] <br>6. COMPARATIVE[#1, #5, comparative:​=:​American Airlines:​col:​airlines:​name] <br>7. INTERSECTION[#1, #3, #6] <br>8. AGGREGATE[count, #7] <br> | - | hard | 
  | SPIDER_train_6872 | What is the number of routes operated by the airline American Airlines whose destinations are in Italy? | SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid JOIN airlines AS T3 ON T1.alid  =  T3.alid WHERE T2.country  =  'Italy' AND T3.name  =  'American Airlines' | 1. SELECT[tbl:​routes] <br>2. FILTER[#1, comparative:​=:​American Airlines:​col:​airlines:​name] <br>3. PROJECT[destinations of #REF, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Italy:​col:​airports:​country] <br>5. AGGREGATE[count, #4] <br> | 1. SELECT[tbl:​routes] <br>2. COMPARATIVE[#1, #1, comparative:​=:​American Airlines:​col:​airlines:​name] <br>3. PROJECT[None, #2] <br>4. COMPARATIVE[#2, #3, comparative:​=:​Italy:​col:​airports:​country] <br>5. AGGREGATE[count, #4] <br> | - | hard | 
  | SPIDER_train_6873 | Find the number of routes that have destination John F Kennedy International Airport. | SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.name  =  'John F Kennedy International Airport' | 1. SELECT[tbl:​routes] <br>2. PROJECT[destinations of #REF, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​John F Kennedy International Airport:​col:​airports:​name] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​routes] <br>2. PROJECT[None, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​John F Kennedy International Airport:​col:​airports:​name] <br>4. AGGREGATE[count, #3] <br> | + | medium | 
  | SPIDER_train_6874 | What is the number of routes that end at John F Kennedy International Airport? | SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.name  =  'John F Kennedy International Airport' | 1. SELECT[tbl:​routes] <br>2. FILTER[#1, comparative:​=:​John F Kennedy International Airport:​col:​airports:​name] <br>3. AGGREGATE[count, #2] <br> | 1. SELECT[tbl:​routes] <br>2. COMPARATIVE[#1, #1, comparative:​=:​John F Kennedy International Airport:​col:​airports:​name] <br>3. AGGREGATE[count, #2] <br> | + | medium | 
  | SPIDER_train_6879 | Find the name of airline which runs the most number of routes. | SELECT T1.name FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​airlines] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​airlines:​name, #4] <br> | 1. SELECT[tbl:​airlines] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​airlines:​name, #4] <br> | + | extra | 
  | SPIDER_train_6880 | What is the name of the airline with the most routes? | SELECT T1.name FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​airlines] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​airlines:​name, #4] <br> | 1. SELECT[tbl:​airlines] <br>2. PROJECT[tbl:​routes, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​airlines:​name, #4] <br> | + | extra | 
  | SPIDER_train_6881 | Find the busiest source airport that runs most number of routes in China. | SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[tbl:​routes, #1] <br>3. FILTER[#2, comparative:​=:​China:​col:​airports:​country] <br>4. GROUP[count, #3, #1] <br>5. PROJECT[col:​airports:​name, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #5, #4] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[tbl:​routes, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​China:​col:​airports:​country] <br>4. GROUP[count, #3, #1] <br>5. PROJECT[col:​airports:​name, #1] <br>6. SUPERLATIVE[comparative:​max:​None, #5, #4] <br> | - | extra | 
  | SPIDER_train_6882 | What is the name of the airport with the most number of routes that start in China? | SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[tbl:​airports] <br>2. PROJECT[tbl:​routes, #1] <br>3. FILTER[#2, comparative:​=:​China:​col:​airports:​country] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​airports:​name, #5] <br> | 1. SELECT[tbl:​airports] <br>2. PROJECT[tbl:​routes, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​China:​col:​airports:​country] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br>6. PROJECT[col:​airports:​name, #5] <br> | - | extra | 
  | SPIDER_train_6883 | Find the busiest destination airport that runs most number of routes in China. | SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1 | 1. SELECT[col:​airports:​name] <br>2. PROJECT[tbl:​routes, #1] <br>3. FILTER[#2, comparative:​=:​China:​col:​airports:​country] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br> | 1. SELECT[col:​airports:​name] <br>2. PROJECT[tbl:​routes, #1] <br>3. COMPARATIVE[#2, #2, comparative:​=:​China:​col:​airports:​country] <br>4. GROUP[count, #3, #1] <br>5. SUPERLATIVE[comparative:​max:​None, #1, #4] <br> | - | extra | 
 ***
 Exec acc: **0.7959**
