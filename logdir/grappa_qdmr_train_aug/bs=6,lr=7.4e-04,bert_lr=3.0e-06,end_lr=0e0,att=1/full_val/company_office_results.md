 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **buildings** | id | + |   | 
 | 2 |   | name |   |   | 
 | 3 |   | City |   |   | 
 | 4 |   | Height |   |   | 
 | 5 |   | Stories |   |   | 
 | 6 |   | Status |   |   | 
 | 7 | **Companies** | id | + |   | 
 | 8 |   | name |   |   | 
 | 9 |   | Headquarters |   |   | 
 | 10 |   | Industry |   |   | 
 | 11 |   | Sales_billion |   |   | 
 | 12 |   | Profits_billion |   |   | 
 | 13 |   | Assets_billion |   |   | 
 | 14 |   | Market_Value_billion |   |   | 
 | 15 | **Office_locations** | building_id | + | --> 1 | 
 | 16 |   | company_id |   | --> 7 | 
 | 17 |   | move_in_year |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_4543 | How many companies are there? | SELECT count(*) FROM Companies | 1. SELECT[tbl:​Companies] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Companies] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_4544 | Count the number of companies. | SELECT count(*) FROM Companies | 1. SELECT[tbl:​Companies] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​Companies] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_4545 | List the names of companies in descending order of market value. | SELECT name FROM Companies ORDER BY Market_Value_billion DESC | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Market_Value_billion, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Market_Value_billion, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_4546 | Sort the company names in descending order of the company's market value. | SELECT name FROM Companies ORDER BY Market_Value_billion DESC | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Market_Value_billion, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Market_Value_billion, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_4547 | What are the names of companies whose headquarters are not "USA"? | SELECT name FROM Companies WHERE Headquarters != 'USA' | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Headquarters, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​USA:​col:​Companies:​Headquarters] <br>4. PROJECT[col:​Companies:​name, #3] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Headquarters, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​USA:​col:​Companies:​Headquarters] <br>4. PROJECT[col:​Companies:​name, #3] <br> | + | easy | 
  | SPIDER_train_4548 | Find the names of the companies whose headquarters are not located in "USA". | SELECT name FROM Companies WHERE Headquarters != 'USA' | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Headquarters, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​USA:​col:​Companies:​Headquarters] <br>4. PROJECT[col:​Companies:​name, #3] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Headquarters, #1] <br>3. COMPARATIVE[#1, #2, comparative:​!=:​USA:​col:​Companies:​Headquarters] <br>4. PROJECT[col:​Companies:​name, #3] <br> | + | easy | 
  | SPIDER_train_4549 | What are the name and assets of each company, sorted in ascending order of company name? | SELECT name ,  Assets_billion FROM Companies ORDER BY name ASC | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Assets_billion, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Assets_billion, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_4550 | List the name and assets of each company in ascending order of company name. | SELECT name ,  Assets_billion FROM Companies ORDER BY name ASC | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Assets_billion, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[col:​Companies:​Assets_billion, #1] <br>4. UNION[#2, #3] <br>5. SORT[#4, #2, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_4551 | What are the average profits of companies? | SELECT avg(Profits_billion) FROM Companies | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Profits_billion, #1] <br>3. AGGREGATE[avg, #2] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Profits_billion, #1] <br>3. AGGREGATE[avg, #2] <br> | + | easy | 
  | SPIDER_train_4555 | How many different industries are the companies in? | SELECT count(DISTINCT Industry) FROM Companies | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Industry, #1] <br>3.*(distinct)* PROJECT[different #REF, #2] <br>4. AGGREGATE[count, #3] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Industry, #1] <br>3.*(distinct)* PROJECT[None, #2] <br>4. AGGREGATE[count, #3] <br> | + | easy | 
  | SPIDER_train_4557 | List the names of buildings in descending order of building height. | SELECT name FROM buildings ORDER BY Height DESC | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​name, #1] <br>3. PROJECT[col:​buildings:​Height, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​name, #1] <br>3. PROJECT[col:​buildings:​Height, #1] <br>4. SORT[#2, #3, sortdir:​descending] <br> | + | easy | 
  | SPIDER_train_4559 | Find the stories of the building with the largest height. | SELECT Stories FROM buildings ORDER BY Height DESC LIMIT 1 | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​Height, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​buildings:​Stories, #3] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​Height, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​buildings:​Stories, #3] <br> | + | medium | 
  | SPIDER_train_4561 | List the name of a building along with the name of a company whose office is in the building. | SELECT T3.name ,  T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. PROJECT[col:​buildings:​name, #2] <br>4. PROJECT[col:​Companies:​name, #1] <br>5. UNION[#4, #3] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. PROJECT[col:​buildings:​name, #2] <br>4. PROJECT[col:​Companies:​name, #1] <br>5. UNION[#4, #3] <br> | + | medium | 
  | SPIDER_train_4562 | For each company, return the company name and the name of the building its office is located in. | SELECT T3.name ,  T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[tbl:​Office_locations, #1] <br>4. PROJECT[tbl:​buildings, #3] <br>5. PROJECT[col:​buildings:​name, #4] <br>6. UNION[#2, #5] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​name, #1] <br>3. PROJECT[tbl:​Office_locations, #1] <br>4. PROJECT[tbl:​buildings, #3] <br>5. PROJECT[col:​buildings:​name, #4] <br>6. UNION[#2, #5] <br> | + | medium | 
  | SPIDER_train_4563 | Show the names of the buildings that have more than one company offices. | SELECT T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id GROUP BY T1.building_id HAVING COUNT(*)  >  1 | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​buildings:​name, #4] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​buildings:​name, #4] <br> | + | hard | 
  | SPIDER_train_4564 | Which buildings have more than one company offices? Give me the building names. | SELECT T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id GROUP BY T1.building_id HAVING COUNT(*)  >  1 | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​buildings:​name, #4] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​1] <br>5. PROJECT[col:​buildings:​name, #4] <br> | + | hard | 
  | SPIDER_train_4565 | Show the name of the building that has the most company offices. | SELECT T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id GROUP BY T1.building_id ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​buildings:​name, #4] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​buildings:​name, #4] <br> | + | extra | 
  | SPIDER_train_4566 | Which building has the largest number of company offices? Give me the building name. | SELECT T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id GROUP BY T1.building_id ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​buildings:​name, #4] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[tbl:​Office_locations, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​buildings:​name, #4] <br> | + | extra | 
  | SPIDER_train_4567 | Please show the names of the buildings whose status is "on-hold", in ascending order of stories. | SELECT name FROM buildings WHERE Status  =  "on-hold" ORDER BY Stories ASC | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​Status, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​on-hold:​col:​buildings:​Status] <br>4. PROJECT[col:​buildings:​Stories, #3] <br>5. PROJECT[col:​buildings:​name, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​Status, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​on-hold:​col:​buildings:​Status] <br>4. PROJECT[col:​buildings:​Stories, #3] <br>5. PROJECT[col:​buildings:​name, #3] <br>6. SORT[#5, #4, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_4568 | Find the names of the buildings in "on-hold" status, and sort them in ascending order of building stories. | SELECT name FROM buildings WHERE Status  =  "on-hold" ORDER BY Stories ASC | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​Status, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​on-hold:​col:​buildings:​Status] <br>4. PROJECT[col:​buildings:​name, #3] <br>5. PROJECT[col:​buildings:​Stories, #3] <br>6. GROUP[count, #5, #3] <br>7. SORT[#4, #6, sortdir:​ascending] <br> | 1. SELECT[tbl:​buildings] <br>2. PROJECT[col:​buildings:​Status, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​on-hold:​col:​buildings:​Status] <br>4. PROJECT[col:​buildings:​name, #3] <br>5. PROJECT[col:​buildings:​Stories, #3] <br>6. GROUP[count, #5, #3] <br>7. SORT[#4, #6, sortdir:​ascending] <br> | + | medium | 
  | SPIDER_train_4569 | Please show each industry and the corresponding number of companies in that industry. | SELECT Industry ,  COUNT(*) FROM Companies GROUP BY Industry | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_4570 | Whah are the name of each industry and the number of companies in that industry? | SELECT Industry ,  COUNT(*) FROM Companies GROUP BY Industry | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[col:​Companies:​Industry, #1] <br>3. PROJECT[tbl:​Companies, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[col:​Companies:​Industry, #1] <br>3. PROJECT[tbl:​Companies, #1] <br>4. GROUP[count, #3, #1] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_4571 | Please show the industries of companies in descending order of the number of companies. | SELECT Industry FROM Companies GROUP BY Industry ORDER BY COUNT(*) DESC | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. SORT[#1, #3, sortdir:​descending] <br> | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. SORT[#1, #3, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_4572 | Sort all the industries in descending order of the count of companies in each industry | SELECT Industry FROM Companies GROUP BY Industry ORDER BY COUNT(*) DESC | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. SORT[#1, #3, sortdir:​descending] <br> | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. SORT[#1, #3, sortdir:​descending] <br> | + | medium | 
  | SPIDER_train_4573 | List the industry shared by the most companies. | SELECT Industry FROM Companies GROUP BY Industry ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_4574 | Which industry has the most companies? | SELECT Industry FROM Companies GROUP BY Industry ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​max:​None] <br> | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_4577 | Show the industries shared by companies whose headquarters are "USA" and companies whose headquarters are "China". | SELECT Industry FROM Companies WHERE Headquarters  =  "USA" INTERSECT SELECT Industry FROM Companies WHERE Headquarters  =  "China" | 1. SELECT[tbl:​Companies] <br>2. FILTER[#1, comparative:​=:​USA:​col:​Companies:​Headquarters] <br>3. FILTER[#1, comparative:​=:​China:​col:​Companies:​Headquarters] <br>4. PROJECT[col:​Companies:​Industry, #1] <br>5. INTERSECTION[#4, #2, #3] <br> | 1. SELECT[tbl:​Companies] <br>2. COMPARATIVE[#1, #1, comparative:​=:​USA:​col:​Companies:​Headquarters] <br>3. COMPARATIVE[#1, #1, comparative:​=:​China:​col:​Companies:​Headquarters] <br>4. PROJECT[col:​Companies:​Industry, #1] <br>5. INTERSECTION[#4, #2, #3] <br> | + | hard | 
  | SPIDER_train_4578 | Which industries have both companies with headquarter in "USA" and companies with headquarter in "China"? | SELECT Industry FROM Companies WHERE Headquarters  =  "USA" INTERSECT SELECT Industry FROM Companies WHERE Headquarters  =  "China" | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. PROJECT[col:​Companies:​Headquarters, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​USA:​col:​Companies:​Headquarters] <br>5. COMPARATIVE[#1, #3, comparative:​=:​China:​col:​Companies:​Headquarters] <br>6. INTERSECTION[#1, #4, #5] <br> | 1. SELECT[col:​Companies:​Industry] <br>2. PROJECT[tbl:​Companies, #1] <br>3. PROJECT[col:​Companies:​Headquarters, #2] <br>4. COMPARATIVE[#1, #3, comparative:​=:​USA:​col:​Companies:​Headquarters] <br>5. COMPARATIVE[#1, #3, comparative:​=:​China:​col:​Companies:​Headquarters] <br>6. INTERSECTION[#1, #4, #5] <br> | + | hard | 
  | SPIDER_train_4580 | How many companies are in either "Banking" industry or "Conglomerate" industry? | SELECT count(*) FROM Companies WHERE Industry  =  "Banking" OR Industry  =  "Conglomerate" | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Industry, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Banking:​col:​Companies:​Industry] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Conglomerate:​col:​Companies:​Industry] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | 1. SELECT[tbl:​Companies] <br>2. PROJECT[col:​Companies:​Industry, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Banking:​col:​Companies:​Industry] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Conglomerate:​col:​Companies:​Industry] <br>5. UNION[#3, #4] <br>6. AGGREGATE[count, #5] <br> | + | medium | 
  | SPIDER_train_4581 | Show the headquarters shared by more than two companies. | SELECT Headquarters FROM Companies GROUP BY Headquarters HAVING COUNT(*)  >  2 | 1. SELECT[col:​Companies:​Headquarters] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | 1. SELECT[col:​Companies:​Headquarters] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br> | + | easy | 
  | SPIDER_train_4582 | Which headquarter locations are used by more than 2 companies? | SELECT Headquarters FROM Companies GROUP BY Headquarters HAVING COUNT(*)  >  2 | 1. SELECT[col:​Companies:​Headquarters] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Companies:​Headquarters, #4] <br> | 1. SELECT[col:​Companies:​Headquarters] <br>2. PROJECT[tbl:​Companies, #1] <br>3. GROUP[count, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​2] <br>5. PROJECT[col:​Companies:​Headquarters, #4] <br> | + | easy | 
 ***
 Exec acc: **1.0000**
