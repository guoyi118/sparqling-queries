 | Idx | Table      | Column | Primary Key | Foreign Key | 
 | ----------- | ----------- | ----------- | ----------- | ----------- | 
  | 0 |  | * |   |   | 
 | 1 | **party** | Party_ID | + |   | 
 | 2 |   | Party_Theme |   |   | 
 | 3 |   | Location |   |   | 
 | 4 |   | First_year |   |   | 
 | 5 |   | Last_year |   |   | 
 | 6 |   | Number_of_hosts |   |   | 
 | 7 | **host** | Host_ID | + |   | 
 | 8 |   | Name |   |   | 
 | 9 |   | Nationality |   |   | 
 | 10 |   | Age |   |   | 
 | 11 | **party_host** | Party_ID | + | --> 1 | 
 | 12 |   | Host_ID |   | --> 7 | 
 | 13 |   | Is_Main_in_Charge |   |   | 
 
  | Index | Question  | SQL | gold QDMR | pred QDMR | Exec | SQL hardness |
  | ----------- | ----------- | ----------- |  ----------- | ----------- | ----------- | ----------- | 
 | SPIDER_train_2660 | How many parties are there? | SELECT count(*) FROM party | 1. SELECT[tbl:​party] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​party] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_2661 | Count the number of parties. | SELECT count(*) FROM party | 1. SELECT[tbl:​party] <br>2. AGGREGATE[count, #1] <br> | 1. SELECT[tbl:​party] <br>2. AGGREGATE[count, #1] <br> | + | easy | 
  | SPIDER_train_2662 | List the themes of parties in ascending order of number of hosts. | SELECT Party_Theme FROM party ORDER BY Number_of_hosts ASC | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Number_of_hosts, #1] <br>4. GROUP[count, #3, #1] <br>5. SORT[#2, #4, sortdir:​ascending] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Number_of_hosts, #1] <br>4. GROUP[count, #3, #1] <br>5. SORT[#2, #4, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_2663 | What are the themes of parties ordered by the number of hosts in ascending manner? | SELECT Party_Theme FROM party ORDER BY Number_of_hosts ASC | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Number_of_hosts, #1] <br>4. GROUP[count, #3, #1] <br>5. SORT[#2, #4, sortdir:​ascending] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Number_of_hosts, #1] <br>4. GROUP[count, #3, #1] <br>5. SORT[#2, #4, sortdir:​ascending] <br> | + | easy | 
  | SPIDER_train_2664 | What are the themes and locations of parties? | SELECT Party_Theme ,  LOCATION FROM party | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Location, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Location, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_2665 | Give me the theme and location of each party. | SELECT Party_Theme ,  LOCATION FROM party | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Location, #1] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[col:​party:​Location, #1] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_2666 | Show the first year and last year of parties with theme "Spring" or "Teqnology". | SELECT First_year ,  Last_year FROM party WHERE Party_Theme  =  "Spring" OR Party_Theme  =  "Teqnology" | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Spring:​col:​party:​Party_Theme] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Teqnology:​col:​party:​Party_Theme] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​party:​First_year, #5] <br>7. PROJECT[col:​party:​Last_year, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Spring:​col:​party:​Party_Theme] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Teqnology:​col:​party:​Party_Theme] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​party:​First_year, #5] <br>7. PROJECT[col:​party:​Last_year, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_2667 | What are the first year and last year of the parties whose theme is "Spring" or "Teqnology"? | SELECT First_year ,  Last_year FROM party WHERE Party_Theme  =  "Spring" OR Party_Theme  =  "Teqnology" | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Spring:​col:​party:​Party_Theme] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Teqnology:​col:​party:​Party_Theme] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​party:​First_year, #5] <br>7. PROJECT[col:​party:​Last_year, #5] <br>8. UNION[#6, #7] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. COMPARATIVE[#1, #2, comparative:​=:​Spring:​col:​party:​Party_Theme] <br>4. COMPARATIVE[#1, #2, comparative:​=:​Teqnology:​col:​party:​Party_Theme] <br>5. UNION[#3, #4] <br>6. PROJECT[col:​party:​First_year, #5] <br>7. PROJECT[col:​party:​Last_year, #5] <br>8. UNION[#6, #7] <br> | + | extra | 
  | SPIDER_train_2668 | What is the average number of hosts for parties? | SELECT avg(Number_of_hosts) FROM party | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Number_of_hosts, #1] <br>3. GROUP[col:​party:​Number_of_hosts, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Number_of_hosts, #1] <br>3. GROUP[sum, #2, #1] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_2669 | Compute the average number of hosts for parties. | SELECT avg(Number_of_hosts) FROM party | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Number_of_hosts, #1] <br>3. AGGREGATE[col:​party:​Number_of_hosts, #2] <br>4. AGGREGATE[avg, #3] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Number_of_hosts, #1] <br>3. AGGREGATE[sum, #2] <br>4. AGGREGATE[avg, #3] <br> | + | easy | 
  | SPIDER_train_2671 | Which party had the most hosts? Give me the party location. | SELECT LOCATION FROM party ORDER BY Number_of_hosts DESC LIMIT 1 | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Number_of_hosts, #1] <br>3. GROUP[col:​party:​Number_of_hosts, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​party:​Location, #4] <br> | 1. SELECT[tbl:​party] <br>2. PROJECT[col:​party:​Number_of_hosts, #1] <br>3. GROUP[sum, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br>5. PROJECT[col:​party:​Location, #4] <br> | + | medium | 
  | SPIDER_train_2672 | Show different nationalities along with the number of hosts of each nationality. | SELECT Nationality ,  COUNT(*) FROM HOST GROUP BY Nationality | 1. SELECT[tbl:​host] <br>2.*(distinct)* PROJECT[col:​host:​Nationality, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | 1. SELECT[tbl:​host] <br>2.*(distinct)* PROJECT[col:​host:​Nationality, #1] <br>3. GROUP[count, #1, #2] <br>4. UNION[#2, #3] <br> | + | medium | 
  | SPIDER_train_2673 | How many hosts does each nationality have? List the nationality and the count. | SELECT Nationality ,  COUNT(*) FROM HOST GROUP BY Nationality | 1. SELECT[col:​host:​Nationality] <br>2. PROJECT[tbl:​host, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | 1. SELECT[col:​host:​Nationality] <br>2. PROJECT[tbl:​host, #1] <br>3. GROUP[count, #2, #1] <br>4. UNION[#1, #3] <br> | + | medium | 
  | SPIDER_train_2674 | Show the most common nationality of hosts. | SELECT Nationality FROM HOST GROUP BY Nationality ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[tbl:​host] <br>2. PROJECT[col:​host:​Nationality, #1] <br>3. GROUP[count, #1, #2] <br>4. COMPARATIVE[#2, #3, comparative:​max:​None] <br> | 1. SELECT[tbl:​host] <br>2. PROJECT[col:​host:​Nationality, #1] <br>3. GROUP[count, #1, #2] <br>4. SUPERLATIVE[comparative:​max:​None, #2, #3] <br> | + | hard | 
  | SPIDER_train_2675 | Which nationality has the most hosts? | SELECT Nationality FROM HOST GROUP BY Nationality ORDER BY COUNT(*) DESC LIMIT 1 | 1. SELECT[col:​host:​Nationality] <br>2. PROJECT[tbl:​host, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | 1. SELECT[col:​host:​Nationality] <br>2. PROJECT[tbl:​host, #1] <br>3. GROUP[count, #2, #1] <br>4. SUPERLATIVE[comparative:​max:​None, #1, #3] <br> | + | hard | 
  | SPIDER_train_2676 | Show the nations that have both hosts older than 45 and hosts younger than 35. | SELECT Nationality FROM HOST WHERE Age  >  45 INTERSECT SELECT Nationality FROM HOST WHERE Age  <  35 | 1. SELECT[tbl:​host] <br>2. FILTER[#1, comparative:​>:​45:​col:​host:​Age] <br>3. FILTER[#1, comparative:​<:​35:​col:​host:​Age] <br>4. PROJECT[col:​host:​Nationality, #2] <br>5. PROJECT[col:​host:​Nationality, #3] <br>6. PROJECT[col:​host:​Nationality, #1] <br>7. INTERSECTION[#6, #4, #5] <br> | 1. SELECT[tbl:​host] <br>2. COMPARATIVE[#1, #1, comparative:​>:​45:​col:​host:​Age] <br>3. COMPARATIVE[#1, #1, comparative:​<:​35:​col:​host:​Age] <br>4. PROJECT[col:​host:​Nationality, #2] <br>5. PROJECT[col:​host:​Nationality, #3] <br>6. PROJECT[col:​host:​Nationality, #1] <br>7. INTERSECTION[#6, #4, #5] <br> | + | hard | 
  | SPIDER_train_2677 | Which nations have both hosts of age above 45 and hosts of age below 35? | SELECT Nationality FROM HOST WHERE Age  >  45 INTERSECT SELECT Nationality FROM HOST WHERE Age  <  35 | 1. SELECT[col:​host:​Nationality] <br>2. PROJECT[tbl:​host, #1] <br>3. PROJECT[col:​host:​Age, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​45:​col:​host:​Age] <br>5. COMPARATIVE[#1, #3, comparative:​<:​35:​col:​host:​Age] <br>6. INTERSECTION[#1, #4, #5] <br> | 1. SELECT[col:​host:​Nationality] <br>2. PROJECT[tbl:​host, #1] <br>3. PROJECT[col:​host:​Age, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​45:​col:​host:​Age] <br>5. COMPARATIVE[#1, #3, comparative:​<:​35:​col:​host:​Age] <br>6. INTERSECTION[#1, #4, #5] <br> | + | hard | 
  | SPIDER_train_2678 | Show the themes of parties and the names of the party hosts. | SELECT T3.Party_Theme ,  T2.Name FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_2679 | For each party, return its theme and the name of its host. | SELECT T3.Party_Theme ,  T2.Name FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. UNION[#2, #4] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Party_Theme, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. UNION[#2, #4] <br> | + | medium | 
  | SPIDER_train_2680 | Show the locations of parties and the names of the party hosts in ascending order of the age of the host. | SELECT T3.Location ,  T2.Name FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID ORDER BY T2.Age | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Location, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. PROJECT[col:​host:​Age, #3] <br>6. UNION[#2, #4] <br>7. SORT[#6, #5] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Location, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. PROJECT[col:​host:​Age, #3] <br>6. UNION[#2, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_2681 | For each party, find its location and the name of its host. Sort the result in ascending order of the age of the host. | SELECT T3.Location ,  T2.Name FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID ORDER BY T2.Age | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Location, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. PROJECT[col:​host:​Age, #3] <br>6. UNION[#2, #4] <br>7. SORT[#6, #5] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[col:​party:​Location, #1] <br>3. PROJECT[tbl:​party_host, #1] <br>4. PROJECT[col:​host:​Name, #3] <br>5. PROJECT[col:​host:​Age, #3] <br>6. UNION[#2, #4] <br>7. SORT[#6, #5, sortdir:​ascending] <br> | + | hard | 
  | SPIDER_train_2682 | Show the locations of parties with hosts older than 50. | SELECT T3.Location FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID WHERE T2.Age  >  50 | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. PROJECT[oldness of #REF, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​50:​col:​host:​Age] <br>5. PROJECT[col:​party:​Location, #4] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. PROJECT[None, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​50:​col:​host:​Age] <br>5. PROJECT[col:​party:​Location, #4] <br> | + | hard | 
  | SPIDER_train_2683 | Which parties have hosts of age above 50? Give me the party locations. | SELECT T3.Location FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID WHERE T2.Age  >  50 | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. PROJECT[col:​host:​Age, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​50:​col:​host:​Age] <br>5. PROJECT[col:​party:​Location, #4] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. PROJECT[col:​host:​Age, #2] <br>4. COMPARATIVE[#1, #3, comparative:​>:​50:​col:​host:​Age] <br>5. PROJECT[col:​party:​Location, #4] <br> | + | hard | 
  | SPIDER_train_2684 | Show the host names for parties with number of hosts greater than 20. | SELECT T2.Name FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID WHERE T3.Number_of_hosts  >  20 | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. GROUP[tbl:​party_host, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​20:​col:​party:​Number_of_hosts] <br>5. PROJECT[tbl:​party_host, #4] <br>6. PROJECT[col:​host:​Name, #5] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​20:​col:​party:​Number_of_hosts] <br>5. PROJECT[tbl:​party_host, #4] <br>6. PROJECT[col:​host:​Name, #5] <br> | + | hard | 
  | SPIDER_train_2685 | Which parties have more than 20 hosts? Give me the host names for these parties. | SELECT T2.Name FROM party_host AS T1 JOIN HOST AS T2 ON T1.Host_ID  =  T2.Host_ID JOIN party AS T3 ON T1.Party_ID  =  T3.Party_ID WHERE T3.Number_of_hosts  >  20 | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. GROUP[tbl:​party_host, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​20:​col:​party:​Number_of_hosts] <br>5. PROJECT[tbl:​party_host, #4] <br>6. PROJECT[col:​host:​Name, #5] <br> | 1. SELECT[tbl:​party_host] <br>2. PROJECT[tbl:​party_host, #1] <br>3. GROUP[sum, #2, #1] <br>4. COMPARATIVE[#1, #3, comparative:​>:​20:​col:​party:​Number_of_hosts] <br>5. PROJECT[tbl:​party_host, #4] <br>6. PROJECT[col:​host:​Name, #5] <br> | + | hard | 
  | SPIDER_train_2687 | What are the name and the nationality of the host of the highest age? | SELECT Name ,  Nationality FROM HOST ORDER BY Age DESC LIMIT 1 | 1. SELECT[tbl:​host] <br>2. PROJECT[col:​host:​Age, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​host:​Name, #3] <br>5. PROJECT[col:​host:​Nationality, #3] <br>6. UNION[#4, #5] <br> | 1. SELECT[tbl:​host] <br>2. PROJECT[col:​host:​Age, #1] <br>3. SUPERLATIVE[comparative:​max:​None, #1, #2] <br>4. PROJECT[col:​host:​Name, #3] <br>5. PROJECT[col:​host:​Nationality, #3] <br>6. UNION[#4, #5] <br> | + | medium | 
  | SPIDER_train_2688 | List the names of hosts who did not serve as a host of any party in our record. | SELECT Name FROM HOST WHERE Host_ID NOT IN (SELECT Host_ID FROM party_host) | 1. SELECT[tbl:​party_host] <br>2. FILTER[#1, in our record] <br>3. PROJECT[tbl:​host, #2] <br>4. SELECT[tbl:​host] <br>5. DISCARD[#4, #3] <br>6. PROJECT[col:​host:​Name, #5] <br> | 1. SELECT[tbl:​party_host] <br>2. COMPARATIVE[#1, #1, None] <br>3. PROJECT[tbl:​host, #2] <br>4. SELECT[tbl:​host] <br>5. DISCARD[#4, #3] <br>6. PROJECT[col:​host:​Name, #5] <br> | + | hard | 
 ***
 Exec acc: **1.0000**
